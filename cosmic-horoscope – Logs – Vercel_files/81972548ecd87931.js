;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="ae8710a8-1eb1-b520-5e59-922feccc6c4e")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2511665,e=>{e.v({addStorage:"clone-skeletons-module__P9jXfG__addStorage",configureProject:"clone-skeletons-module__P9jXfG__configureProject",hideGetStarted:"clone-skeletons-module__P9jXfG__hideGetStarted",integrations:"clone-skeletons-module__P9jXfG__integrations",maybeHideGetStarted:"clone-skeletons-module__P9jXfG__maybeHideGetStarted",maybeShowAddStorage:"clone-skeletons-module__P9jXfG__maybeShowAddStorage",maybeShowConfigureProject:"clone-skeletons-module__P9jXfG__maybeShowConfigureProject",maybeShowIntegrations:"clone-skeletons-module__P9jXfG__maybeShowIntegrations",showAddStorage:"clone-skeletons-module__P9jXfG__showAddStorage",showConfigureProject:"clone-skeletons-module__P9jXfG__showConfigureProject",showIntegrations:"clone-skeletons-module__P9jXfG__showIntegrations"})},50727,e=>{e.v({main:"add-integrations-collapsed-module__vml7Da__main",noIntegrationsInstalledInnerCircle:"add-integrations-collapsed-module__vml7Da__noIntegrationsInstalledInnerCircle",noIntegrationsInstalledOuterCircle:"add-integrations-collapsed-module__vml7Da__noIntegrationsInstalledOuterCircle"})},9300592,e=>{e.v({inactive:"install-integrations-module__aOSvuW__inactive",maybeShowSkippableIntegrations:"install-integrations-module__aOSvuW__maybeShowSkippableIntegrations",showSkippableIntegrations:"install-integrations-module__aOSvuW__showSkippableIntegrations",skipButton:"install-integrations-module__aOSvuW__skipButton"})},4370029,e=>{e.v({inactive:"integration-item-module__J2N8ma__inactive",installed:"integration-item-module__J2N8ma__installed"})},1679431,e=>{e.v({avatar:"cloning-module__JQUL6a__avatar",cloning:"cloning-module__JQUL6a__cloning",cross:"cloning-module__JQUL6a__cross",enter:"cloning-module__JQUL6a__enter",error:"cloning-module__JQUL6a__error",errorMessage:"cloning-module__JQUL6a__errorMessage",from:"cloning-module__JQUL6a__from",inactive:"cloning-module__JQUL6a__inactive",indicator:"cloning-module__JQUL6a__indicator",line:"cloning-module__JQUL6a__line",lineWrapper:"cloning-module__JQUL6a__lineWrapper",meta:"cloning-module__JQUL6a__meta",pulse:"cloning-module__JQUL6a__pulse",shake:"cloning-module__JQUL6a__shake",slide:"cloning-module__JQUL6a__slide",text:"cloning-module__JQUL6a__text"})},3313652,e=>{e.v({description:"get-started-module__BOWvwW__description",formContainer:"get-started-module__BOWvwW__formContainer",learnMore:"get-started-module__BOWvwW__learnMore",login:"get-started-module__BOWvwW__login"})},3433070,e=>{e.v({collapsed:"git-input-collapsed-module__pFYy0q__collapsed",fullRepoName:"git-input-collapsed-module__pFYy0q__fullRepoName",selectedTeam:"git-input-collapsed-module__pFYy0q__selectedTeam"})},6425569,e=>{e.v({inactive:"git-input-module__Ii3qfq__inactive",login:"git-input-module__Ii3qfq__login"})},2226996,e=>{e.v({frameworkAvatar:"main-clone-module__plQ-AG__frameworkAvatar"})},5888315,e=>{e.v({envButton:"env-variable-form-input-module__kYXEvW__envButton",valueTextarea:"env-variable-form-input-module__kYXEvW__valueTextarea"})},929107,e=>{e.v({envDescription:"configure-project-env-vars-module__9SCz9W__envDescription"})},8490110,e=>{e.v({avatar:"monorepo-deploy-card-module__jWGO8G__avatar",enter:"monorepo-deploy-card-module__jWGO8G__enter",from:"monorepo-deploy-card-module__jWGO8G__from",pulse:"monorepo-deploy-card-module__jWGO8G__pulse"})},426021,e=>{e.v({cloneMain:"index-module__-UFkwG__cloneMain",createTeamStep:"index-module__-UFkwG__createTeamStep",gradientOverlay:"index-module__-UFkwG__gradientOverlay",headerSpacer:"index-module__-UFkwG__headerSpacer",hideCreateTeamStep:"index-module__-UFkwG__hideCreateTeamStep",mainContent:"index-module__-UFkwG__mainContent",narrative:"index-module__-UFkwG__narrative",newMain:"index-module__-UFkwG__newMain",newMainContent:"index-module__-UFkwG__newMainContent",newMainWrapper:"index-module__-UFkwG__newMainWrapper",screenStyle:"index-module__-UFkwG__screenStyle",showCreateTeamStep:"index-module__-UFkwG__showCreateTeamStep",sidebar:"index-module__-UFkwG__sidebar",sidebarContainer:"index-module__-UFkwG__sidebarContainer"})},3706649,e=>{"use strict";var t=e.i(8711407),r=e.i(1176592),i=e.i(9722978),a=e.i(512540),n=e.i(1991452),s=e.i(9318197),l=e.i(119294),o=e.i(6352514),d=e.i(5338940),c=e.i(5140444),u=e.i(1717203),p=e.i(7557283),m=e.i(6232213),g=e.i(6228447),f=e.i(5255926),h=e.i(1574218),x=e.i(3196486),y=e.i(8631221),j=e.i(7562527),v=e.i(2511665),_=e.i(4298944),T=e.i(7909933),S=e.i(8248823),w=e.i(1875382),E=e.i(2504781),C=e.i(455575),b=e.i(4030453),N=e.i(9070994),I=e.i(4244280),P=e.i(5819220),k=e.i(4712634),A=e.i(979715),R=e.i(4450569),M=e.i(2704354),O=e.i(1719521),L=e.i(6038905),G=e.i(377478),U=e.i(2160483),$=e.i(4585051),D=e.i(57106),B=e.i(8042625),F=e.i(277234),V=e.i(50727);function H(e){let{deploymentData:a,installedIntegration:n,onCancelSuccess:s,dispatch:l,configurationId:o,projectId:c,mutateConfigurationsData:u}=e,[p,m]=(0,r.useState)(!1),g=(0,C.useToasts)(),{team:f}=(0,d.useTeam)();async function h(){if(!a||a?.readyState==="READY")return void m(!1);let e=f?.id?`?teamId=${f.id}`:"";"CANCELED"===(await (0,F.fetchAPI)(`${(0,I.API_DEPLOYMENTS)("v12")}/${a.id}/cancel`+e,{throwOnHTTPError:!1,method:"PATCH"})).readyState&&(g.success("Deployment canceled."),s&&s()),m(!1)}let x=async()=>{if(m(!0),o){let e=await (0,F.fetchAPI)(`${I.API_INTEGRATION_CONTROLLER}/configuration/${o}${(0,B.encode)({teamId:f?.id})}`);e.projects?.length>1?await (0,F.fetchAPI)(`${I.API_INTEGRATION_CONTROLLER}/configuration/${o}${(0,B.encode)({teamId:f?.id})}`,{method:"PATCH",body:JSON.stringify({projects:e.projects.filter(e=>e!==c)})}):e.projects?.[0]===c&&await (0,F.fetchAPI)(`${I.API_INTEGRATION_CONTROLLER}/configuration/${o}${(0,B.encode)({teamId:f?.id})}`,{method:"DELETE"})}await u(),l({type:"SET_STATUS",status:"installing-integrations-started"}),h()};return(0,t.jsx)(P.Entity,{actions:(0,t.jsx)(R.default,{gap:.5,row:!0,children:(0,t.jsx)(E.Button,{disabled:p,loading:p,onClick:x,size:"small",type:"secondary",children:"Change"})}),className:V.default.main,thumbnail:(0,t.jsx)(k.EntityThumbnail,{size:24,children:n?(0,t.jsx)($.Avatar,{hash:n?.icon,size:32}):(0,t.jsx)("div",{className:(0,i.default)("flex flex-col items-center justify-center flex-initial",V.default.noIntegrationsInstalledOuterCircle),children:(0,t.jsx)("div",{className:V.default.noIntegrationsInstalledInnerCircle})})}),children:(0,t.jsx)(A.EntityField,{description:n?.shortDescription||"No Integrations added",title:n?.website?(0,t.jsx)(D.Link,{external:!0,href:n?.website,children:n?.name}):n?.name?n?.name:""})})}async function z(e){let{teamId:t,projectName:r,type:i,repoId:a,owner:n,repo:s,ref:l="main",source:o="import",signal:d,meta:c}=e;return(0,F.fetchAPI)(`${(0,I.API_DEPLOYMENTS)("v13")}${(0,B.encode)({teamId:t,skipAutoDetectionConfirmation:1})}`,{method:"POST",signal:d,body:JSON.stringify({gitSource:{type:i,ref:l,repoId:"github"===i?a:void 0,projectId:"gitlab"===i?a:void 0,owner:"bitbucket"===i?n:void 0,slug:"bitbucket"===i?s:void 0},name:r,target:"production",source:o,meta:c}),throwOnHTTPError:!0})}let J=async e=>{let{scopeId:t,gitNamespaces:r,currentNamespace:i}=e,a=r?.find(e=>e.name===i);t&&a&&await (0,F.fetchAPI)(I.API_USER,{method:"PATCH",body:JSON.stringify({scopeId:t,gitNamespaceId:a.id})})};var Q=e.i(9871375),W=e.i(9300592),q=e.i(3306538),Y=e.i(5468328),X=e.i(5761705),K=e.i(7917902),Z=e.i(3186231),ee=e.i(6891161),et=e.i(3322724);function er(e){let{integration:r,active:i,onCancel:a,onResumeClick:n}=e,l=(0,et.useIsMobile)();return(0,t.jsxs)(ee.Modal.Modal,{active:i,onClickOutside:()=>{},children:[(0,t.jsxs)(ee.Modal.Body,{children:[(0,t.jsxs)(ee.Modal.Title,{children:["Adding ",r.name]}),(0,t.jsx)(s.Spacer,{y:.5}),(0,t.jsx)(ee.Modal.Subtitle,{children:"Please continue setting it up in the separate window."}),!l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Spacer,{}),(0,t.jsx)(E.Button,{onClick:n,width:"100%",children:"Resume Setup"})]})]}),(0,t.jsx)(ee.Modal.Actions,{children:(0,t.jsx)(ee.Modal.Action,{fullWidth:!0,onClick:a,children:"Cancel"})})]})}var ei=e.i(4363398),ea=e.i(4370029);function en(e){let{integration:a,projectId:n,externalId:s,onInstall:l,loading:o}=e,{active:d}=(0,L.useCardContext)(),{account:c}=(0,K.useAccount)(),u=(0,C.useToasts)(),p=(0,ei.useIntegrationControl)({integration:a,account:c??void 0}),m=(0,w.useSearchParams)(),[g,f]=(0,r.useState)(!1),h=m?.get("skippable-integrations"),{open:x,close:y}=(0,Z.useInstallIntegrationPopup)({integration:a,source:"deploy-button",onSuccess:e=>{let{configuration:t}=e;l?.(t.id),u.success("Added Integration successfully."),v()},onError:e=>{let{message:t}=e;t&&v()}}),j=async()=>{if(n)return f(!0),x({account:c,projects:[n],additionalQueryParameters:{"external-id":s?.toString()??"",currentProjectId:n}})},v=(0,r.useCallback)(()=>(f(!1),y()),[y]),_=(0,i.clsx)({[ea.default.inactive]:!d});return(0,r.useEffect)(()=>{g&&!d&&v()},[d,v,g]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(er,{active:g,integration:a,onCancel:()=>v(),onResumeClick:()=>j()}),(0,t.jsxs)(P.Entity,{actions:a.installation?null:(0,t.jsx)(R.default,{gap:.5,row:!0,children:(0,t.jsx)(Y.Tooltip,{forceHide:!!p?.canInstallIntegration,text:"This integration is only available on Pro/Enterprise plans.",children:(0,t.jsx)(E.Button,{disabled:!d||o||!n||!p?.canInstallIntegration,onClick:()=>void j(),size:"small",children:"Add"})})}),className:(0,i.clsx)(_,{[ea.default.installed]:a.installation}),thumbnail:(0,t.jsx)(k.EntityThumbnail,{size:24,children:(0,t.jsx)($.Avatar,{hash:a.icon,size:32})}),children:[(0,t.jsx)(A.EntityField,{description:(0,t.jsx)("span",{className:_,children:a.shortDescription}),title:a.website?(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(D.Link,{external:!0,href:a.website,tab:!0,children:a.name}),!h&&(0,t.jsx)(q.Badge,{size:"sm",variant:"gray-subtle",children:"Required"})]}):a.name,width:a.installation?"80%":"100%"}),a.installation?(0,t.jsx)(A.EntityField,{avatar:(0,t.jsx)(X.CheckCircle,{className:"checkmark-icon",color:d?"green-700":"gray-500"}),right:!0}):null]})]})}var es=e.i(8492314);function el(e){let{projectId:a,integrationIds:n,installationIds:s,externalId:u,onInstall:p,deploymentId:m}=e,{projectName:g,status:f,dispatch:h,repo:x,clonedRepo:y,cloneRepoStatus:j}=(0,Q.useProjectCloneContext)(),[{env:v}]=(0,G.default)(),_=s.length>3,$=(0,w.useSearchParams)(),D=$?.get("skippable-integrations"),{data:B}=(0,es.useNewDeploymentInterval)(m),[F,V]=(0,r.useState)(!1),[q,Y]=(0,r.useState)(),[X,K]=(0,r.useState)(),Z=n.some(e=>!e.startsWith("oac_")),{data:ee}=(0,T.default)(()=>["integrationsByIds",...n],async e=>{let[t,...r]=e;return(await Promise.all(r.map(async e=>{try{return await (0,N.default)(`${I.API_INTEGRATION_CONTROLLER_V2}/integration/${e}?public=1`)}catch{}}))).filter(Boolean)},{revalidateOnFocus:!1,revalidateOnReconnect:!1}),{data:et,mutate:er}=(0,O.default)(_?null:a),ei=(0,r.useMemo)(()=>et?.integrations.filter(e=>s.includes(e.id)),[s,et]),ea=(0,r.useMemo)(()=>ee?.map(e=>({...e,installation:ei?.find(t=>t.integrationId===e.id)})),[ee,ei]),el=ea&&ea.length>0&&ea.every(e=>e.installation);(0,r.useEffect)(()=>{"installing-integrations-finished"!==f&&"deploying"!==f&&"creating-repo"!==f&&el&&(l.analytics.track(o.AnalyticsEvent.PROJECT_CREATION_ADDED_ALL_INTEGRATIONS,{version:3}),v?h({type:"SET_STATUS",status:"configure-project"}):h({type:"SET_STATUS",status:"installing-integrations-finished"}))},[el,h,f,v]);let eo=ea?.some(e=>(0,M.isLegacyIntegration)(e)),{active:ed}=(0,L.useCardContext)(),{team:ec}=(0,d.useTeam)(),{user:eu}=(0,c.useUser)(),{data:ep}=(0,U.default)({provider:x.gitType}),em=(0,C.useToasts)(),eg=async()=>{if("finished"===j&&x.gitType){V(!0);try{if(y.id&&y.slug){let e=await z({teamId:ec?.id,projectName:g,type:x.gitType,repoId:y.id,owner:x.namespace,repo:y.slug});e.id&&(h({type:"SET_STATUS",status:"deploying"}),h({type:"SET_DEPLOYMENT_ID",deploymentId:e.id}),J({gitNamespaces:ep,currentNamespace:x.namespace,scopeId:ec?.id||eu?.uid}))}}catch(e){em.error((0,S.errorToString)(e))}V(!1)}else h({type:"SET_STATUS",status:"installing-integrations-finished"})};return D&&("deploying"===f||"installing-integrations-finished"===f)?(0,t.jsx)(H,{configurationId:X,deploymentData:B,dispatch:h,installedIntegration:q,mutateConfigurationsData:er,onCancelSuccess:()=>{K(null),Y(null)},projectId:a}):(0,t.jsxs)("div",{className:(0,i.clsx)("flex flex-col items-stretch justify-between gap-5 flex-initial",ed?"":W.default.inactive),children:[(0,t.jsx)("div",{children:_?(0,t.jsx)(b.Error,{children:"Only up to three integrations are allowed for a project."}):Z?(0,t.jsx)(b.Error,{error:{message:(0,t.jsx)(t.Fragment,{children:"The `integration-ids` query string parameter can only contain the IDs of Integrations (starting with `oac_`)."}),link:"/docs/integrations/deploy-button/integrations",action:"Learn More"}}):eo?(0,t.jsx)(b.Error,{error:{message:"Integrations that have a UI Hook URL configured cannot be rendered. Only the Redirect URL field is allowed.",link:"/docs/integrations/deploy-button/integrations",action:"Learn More"}}):ea?ea?.map(e=>(0,t.jsx)(en,{externalId:u,integration:e,loading:F,onInstall:t=>{p&&p(t),D&&(Y(e),K(t),v?h({type:"SET_STATUS",status:"configure-project"}):h({type:"SET_STATUS",status:"installing-integrations-finished"}))},projectId:a},e.id)):Array.from(Array(n.length),(e,r)=>(0,t.jsx)(P.Entity,{actions:(0,t.jsx)(R.default,{className:"geist-hide-on-mobile",gap:.5,row:!0,children:(0,t.jsx)(E.Button,{disabled:!0,size:"small",children:"Add"})}),placeholder:!0,thumbnail:(0,t.jsx)(k.EntityThumbnail,{size:32}),children:(0,t.jsx)(A.EntityField,{description:"",height:45,title:""})},r))}),(0,t.jsx)("div",{className:(0,i.clsx)(W.default.skipButton,{[W.default.showSkippableIntegrations]:!!D}),children:(0,t.jsx)(E.Button,{disabled:!ed||F,loading:F,onClick:eg,size:"small",type:"secondary",children:F?"Skipping…":"Skip"})})]})}var eo=e.i(6942035),ed=e.i(5614970),ec=e.i(1679431);function eu(e){let{from:r,to:a,error:n,provider:l}=e,{active:o}=(0,L.useCardContext)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(R.default,{className:(0,i.clsx)(ec.default.cloning,{[ec.default.inactive]:!o,[ec.default.error]:!!n}),hcenter:!0,vcenter:!0,children:[(0,t.jsxs)(R.default,{direction:["column","row","row"],flex:0,gap:0,hcenter:!0,vcenter:!0,children:[(0,t.jsx)(R.default,{children:(0,t.jsx)(R.default,{className:(0,i.clsx)(ec.default.avatar,ec.default.from),hcenter:!0,vcenter:!0,children:(0,t.jsx)(em,{height:26,width:26})})}),(0,t.jsxs)("div",{className:ec.default.lineWrapper,children:[(0,t.jsx)(eo.Cross,{className:ec.default.cross,color:"red-700"}),(0,t.jsx)("svg",{className:ec.default.line,fill:"none",height:"2",viewBox:"0 0 66 2",width:"64",children:(0,t.jsx)("path",{d:"M65 0.625H1",stroke:"var(--ds-gray-500)",strokeDasharray:"3 3",strokeLinecap:"square"})}),(0,t.jsx)("span",{className:ec.default.indicator,"data-iteration":0,onAnimationIteration:e=>{let t=["circle","square","triangle"],r=["var(--ds-blue-700)","var(--ds-amber-700)","var(--ds-green-700)","var(--ds-purple-700)","var(--ds-pink-700)"];if(e.target instanceof HTMLSpanElement){let i=t[Math.floor(Math.random()*t.length)],a=r[Math.floor(Math.random()*r.length)];switch(e.target.style.cssText="",i){case"circle":e.target.style.borderRadius="50%",e.target.style.backgroundColor=a;break;case"square":e.target.style.borderRadius="0%",e.target.style.backgroundColor=a;break;case"triangle":e.target.style.borderBottom=`calc(0.866 * var(--size)) solid ${a}`,e.target.style.borderLeft="calc(var(--size) / 2) solid transparent",e.target.style.borderRight="calc(var(--size) / 2) solid transparent",e.target.style.borderTop="0",e.target.style.height="0",e.target.style.width="0",e.target.style.top="-2px"}}}})]}),(0,t.jsxs)(R.default,{children:[(0,t.jsx)(R.default,{className:(0,i.clsx)(ec.default.avatar,ec.default.enter),hcenter:!0,vcenter:!0,children:(0,t.jsx)(ep,{height:26,provider:l,width:26})}),(0,t.jsx)("div",{className:ec.default.pulse}),(0,t.jsx)("div",{className:ec.default.pulse}),(0,t.jsx)("div",{className:ec.default.pulse})]})]}),(0,t.jsxs)("div",{className:ec.default.text,children:[(0,t.jsxs)("span",{className:`text-copy-14 text-gray-900 ${ec.default.meta}`,"aria-hidden":!!n,style:{opacity:n||!r?0:1,transition:"opacity 150ms ease"},children:["Cloning"," ",(0,t.jsxs)("strong",{className:"text-[14px] leading-[20px] font-medium inline-flex items-baseline gap-1",children:[(0,t.jsx)(ep,{provider:l})," ",r]})," ",a?(0,t.jsxs)(t.Fragment,{children:["to"," ",(0,t.jsxs)("strong",{className:"text-[14px] leading-[20px] font-medium inline-flex items-baseline",children:[(0,t.jsx)("span",{style:{flexShrink:0},children:(0,t.jsx)(ep,{provider:l})}),(0,t.jsx)(s.Spacer,{inline:!0,x:1/6})," ",a]})]}):null]}),(0,t.jsx)("p",{className:`text-copy-14 text-gray-900 ${ec.default.errorMessage}`,"aria-hidden":!n,style:{opacity:+!!n,transition:"opacity 150ms ease"},children:n})]})]}),o?(0,t.jsxs)("span",{"aria-live":"assertive",className:"geist-sr-only",role:"status",children:["Cloning ",r," to ",a]}):null]})}function ep(e){return"github"===e.provider||"gitlab"===e.provider||"bitbucket"===e.provider?(0,t.jsx)(ed.default,{gitType:e.provider,...e}):(0,t.jsx)(em,{height:e.height,width:e.width})}function em(e){let{width:r,height:i}=e;return(0,t.jsx)("svg",{fill:"none",height:i||12,viewBox:"0 0 32 32",width:r||12,xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M3.60899 10.6889V8.02848C3.60899 6.81616 4.62518 5.83337 5.87872 5.83337H12.3358C12.9377 5.83337 13.5151 6.06464 13.9407 6.47631L14.5953 7.1094C14.7624 7.271 14.9891 7.36179 15.2254 7.36179H26.4235C27.6771 7.36179 28.354 8.30855 28.354 9.52087V10.6889M3.60899 10.6889H3.13775C2.8698 10.6889 2.65577 10.9047 2.66692 11.1636L3.33317 26.3409C3.35306 26.8024 3.74575 27.1667 4.22341 27.1667H27.2677C27.7454 27.1667 28.1381 26.8024 28.158 26.3409L29.3328 11.1636C29.3439 10.9047 29.1299 10.6889 28.8619 10.6889H28.354M3.60899 10.6889H28.354",stroke:"var(--ds-gray-1000)","stroke-width":"1.5"})})}var eg=e.i(1801538),ef=e.i(3671642),eh=e.i(8522580),ex=e.i(8172029),ey=e.i(4004502),ej=e.i(1857939),ev=e.i(1114103),e_=e.i(8436238),eT=e.i(1119178),eS=e.i(4339584),ew=e.i(4586231),eE=e.i(2661670),eC=e.i(9192668),eb=e.i(1565534);function eN(){return(0,t.jsx)(eh.Note,{fill:!0,label:!1,type:"warning",children:"The Vercel Tutor template can only be deployed to GitHub."})}var eI=e.i(4528275),eP=e.i(8451453),ek=e.i(3313652);let eA="signup",eR=e=>{let{eventLabel:r,className:a}=e,{mutate:n}=(0,K.useAccount)(),{login:s,state:d}=(0,eP.useAuth)(eA,{onAuthenticated:()=>{n()}}),{loginState:c,loginError:u}=d;return(0,t.jsx)(R.default,{center:!0,className:(0,i.clsx)(ek.default.login,a),"data-testid":(0,ey.tid)("new","get-started"),children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)("span",{className:`text-copy-14 text-gray-900 ${ek.default.description}`,children:"Select a Git provider to continue with:"}),(0,t.jsx)("div",{className:ek.default.formContainer,children:(0,t.jsx)(eI.default,{disableEmail:!0,disableSAML:!0,disableGoogle:!0,large:!1,loginError:u,loginState:c,login:e=>{if(r){let t="Start with Bitbucket";"github"===e?t="Start with Github":"gitlab"===e&&(t="Start with Gitlab"),l.analytics.track(o.AnalyticsEvent.CLICK_EVENT,{click_name:"import_flow_login_click",click_value:t})}return s(e)},mode:eA})}),(0,t.jsx)("span",{className:`text-[14px] leading-[20px] font-medium ${ek.default.learnMore}`,children:(0,t.jsxs)(D.Link,{href:"/",tab:!0,children:["Learn more about ",h.PRODUCT," →"]})})]})})};var eM=e.i(7102400),eO=e.i(4909757),eL=e.i(6475061),eG=e.i(8313631),eU=e.i(7249340);function e$(e){let{account:i,onConnect:a,hasAccess:n,loading:s}=e,l=(0,eU.useConnectPopup)({onSuccess:a}),o=r.useCallback(e=>{i&&e in i&&i[e]?.verified?a(e):(0,eT.promiseToCallback)(l.open)(e)},[i,a,l]),d=(0,t.jsxs)(R.default,{direction:["column","row","row"],gap:1/3,children:[(0,t.jsx)(R.default,{flex:"0 0 1",children:(0,t.jsx)(f.Skeleton,{show:!i||!n,children:(0,t.jsx)(eD,{"data-testid":"github-connect-button",disabled:!i,gitType:"github",loading:s,onClick:()=>o("github"),value:"github",width:108,typeName:"button",children:"GitHub"})})}),(0,t.jsx)(R.default,{flex:"0 0 1",children:(0,t.jsx)(f.Skeleton,{show:!i||!n,children:(0,t.jsx)(eD,{disabled:!i,gitType:"gitlab",loading:s,onClick:()=>o("gitlab"),value:"gitlab",width:105,typeName:"button",children:"GitLab"})})}),(0,t.jsx)(R.default,{flex:"0 0 1",children:(0,t.jsx)(f.Skeleton,{show:!i||!n,children:(0,t.jsx)(eD,{disabled:!i,gitType:"bitbucket",loading:s,onClick:()=>o("bitbucket"),value:"bitbucket",width:124,typeName:"button",children:"Bitbucket"})})})]});return(0,t.jsx)(ef.Label,{value:"Git Providers",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[d,(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:(0,t.jsx)(D.Link,{external:!0,href:"/account/authentication",tab:!0,children:"Manage Login Connections"})})]})})}function eD(e){let{width:r,...i}=e,a=(0,et.useIsMobile)();return(0,t.jsx)(eG.GitButton,{style:{width:a?"100%":`${String(r)}px`},width:a?"100%":r,...i})}var eB=e.i(2064047),eF=e.i(4600551),eV=e.i(3433070);function eH(){let{team:e}=(0,d.useTeam)();return(0,t.jsx)(eB.Entity,{className:eV.default.selectedTeam,left:(0,t.jsx)($.Avatar,{size:16,teamId:e?.id}),padding:3,right:(0,t.jsx)(eF.PlanBadge,{subtle:!1,team:e}),children:(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium geist-ellipsis",children:e?.name})})}var ez=e.i(5680277),eJ=e.i(6425569),eQ=e.i(6198010),eW=e.i(9550268),eq=e.i(6881349),eY=e.i(3500331),eX=e.i(1906681),eK=e.i(6982071);let eZ=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M13.5 7V6C13.5 5.17157 12.8284 4.5 12 4.5C11.1716 4.5 10.5 5.17157 10.5 6V7H12V8.5V9V11.5C12 12.3284 11.3284 13 10.5 13H5.5C4.67157 13 4 12.3284 4 11.5V7H9V6C9 4.34315 10.3431 3 12 3C13.6569 3 15 4.34315 15 6V7H13.5Z" fill="currentColor"/>');var e0=e.i(7374478),e1=e.i(8210056);function e2(e){let{gitType:i,namespace:a,repo:n,template:s,disabled:l,dispatch:o,setRepoNameStates:u,loading:p,isPrivate:m,setIsPrivate:g}=e,{data:h,mutate:x,isLoading:y}=(0,U.default)({provider:i}),{dispatch:j}=(0,Q.useProjectCloneContext)(),{active:v}=(0,L.useCardContext)(),{isLoading:_}=(0,c.useUser)(),{isReady:T}=(0,d.useTeam)(),S=_||!T||y;r.useEffect(()=>{if(s&&i){let e=n??s;j({type:"SET_TARGET_REPO",name:e}),u(t=>({...t,[i]:[a,e]}))}},[s,o,j,i,a,u,n]);let w=r.useCallback(e=>{let{value:t}=e.currentTarget;o({type:"SET_REPO",gitType:i,namespace:a,repo:t}),j({type:"SET_TARGET_REPO",name:t})},[o,j,i,a]),E=r.useCallback(async e=>{let t=await x(),r=Array.isArray(t)&&t.length>0&&t.find(t=>t.installationId===e)||null;o({type:"SET_REPO",gitType:i,namespace:r?.name,repo:n}),r&&j({type:"SET_TARGET_NAMESPACE",namespace:r.slug,namespaceId:r.id,ownerType:r.ownerType})},[o,j,i,x,n]),{open:C}=(0,e1.default)({onSuccess:(0,eT.promiseToCallback)(E)}),b=r.useCallback(e=>{if("select-different-git-provider"===e)o({type:"SET_REPO",gitType:i,namespace:void 0,repo:null}),o({type:"SET_GIT_TYPE",gitType:void 0}),j({type:"SET_TARGET_NAMESPACE",namespace:"",namespaceId:"",ownerType:""}),j({type:"SET_TARGET_REPO",name:""}),j({type:"SET_GIT_TYPE",gitType:""});else if("install-github"===e)C();else if("string"==typeof e){let t=h?.find(t=>{let{slug:r}=t;return r===e});o({type:"SET_REPO",gitType:i,namespace:e,repo:n,ownerType:t?.ownerType}),j({type:"SET_TARGET_NAMESPACE",namespace:e,namespaceId:t?.id||"",ownerType:t?.ownerType||""})}},[o,j,i,C,n,h]),N=h&&[...h.map(e=>({value:e.slug||"",label:e.name||"",prefix:(0,t.jsx)(ed.default,{gitType:i}),isMenu:!1})),..."github"===i?[{value:"install-github",label:"Add GitHub Account",prefix:(0,t.jsx)(eQ.Plus,{}),isMenu:!0}]:[],{value:"select-different-git-provider",label:"Switch Git Provider",prefix:(0,t.jsx)(eW.ListUnordered,{}),isMenu:!0}];r.useEffect(()=>{!a&&h&&h.length>0&&(o({type:"SET_REPO",gitType:i,namespace:h[0].slug,repo:n,ownerType:h[0].ownerType}),j({type:"SET_TARGET_NAMESPACE",namespace:h[0].slug,namespaceId:h[0].id,ownerType:h[0].ownerType}))},[o,j,i,a,n,h]);let I=p||l||!Array.isArray(h)&&v;return(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-stretch justify-start gap-4 md:gap-0 flex-initial",children:[(0,t.jsx)(ef.Label,{id:"git-scope-select",style:{flex:1},value:"Git Scope",withInput:!0,children:S?(0,t.jsx)(f.Skeleton,{height:40,width:"100%"}):(0,t.jsxs)(eq.Combobox,{className:"select-git-scope",clearable:!1,disabled:I,onChange:b,placeholder:"Select Git Scope",value:a,children:[(0,t.jsx)(eq.Combobox.Input,{loading:!h}),(0,t.jsx)(eq.Combobox.List,{children:N?.map(e=>(0,t.jsx)(eq.Combobox.Option,{isMenu:e.isMenu,prefix:e.prefix,value:e.value,children:e.label},e.value))})]})}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial geist-hide-on-mobile translate-y-8",children:(0,t.jsx)(e0.SlashDivider,{})}),(0,t.jsx)(ef.Label,{id:"repo-name",style:{flex:1},value:`${m?"Private":"Public"} Repository Name`,withInput:!0,children:S?(0,t.jsx)(f.Skeleton,{height:40,width:"100%"}):(0,t.jsx)(eY.Input,{autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",className:"repository-name",disabled:I,id:"repo-name",maxLength:100,onChange:w,placeholder:"my-repository",spellCheck:!1,suffix:(0,t.jsx)(Y.Tooltip,{desktopOnly:!0,text:`This repository will be ${m?"private":"public"}.`,children:(0,t.jsx)(eX.Toggle,{checked:m,color:"amber-track-only",disabled:I,icon:{checked:(0,t.jsx)(eK.LockClosedSmall,{}),unchecked:(0,t.jsx)(eZ,{})},onChange:()=>g(!m),size:"large"})}),suffixStyling:!1,value:n||"",width:"100%"})})]})}var e6=e.i(5802506),e3=e.i(6178534),e4=e.i(5394280),e7=e.i(2138061),e9=e.i(9762045),e5=e.i(2280665),e8=e.i(693385);async function te(e){let{projectName:t,environmentVariables:r,teamId:i,projectSettings:a,gitRepository:n,version:s="v6",domains:l}=e,o=Object.entries(a).reduce((e,t)=>{let[r,i]=t;return void 0!==i&&(e[r]=i),e},{});try{let e=await (0,F.fetchAPI)(`${(0,I.API_PROJECTS_VERSION)(s)}${(0,B.encode)({teamId:i,withUserCredentials:1})}`,{method:"POST",body:JSON.stringify({name:t,environmentVariables:r,gitRepository:n,...o}),throwOnHTTPError:!0});if(l&&l.length>0)try{await Promise.all(l.map(t=>(0,e8.addProjectDomain)({domain:t,project:{id:e.id},team:i?{id:i}:null})))}catch(e){console.error("Failed to add domains to project:",e),C.toasts.error("Project created but failed to add some domains")}return e}catch(e){if((0,e5.isProjectsError)(e)){if("invalid_build_command"===e.code)throw tt(e,"buildSettings");else if("invalid_output_directory"===e.code)throw tt(e,"buildSettings");else if(e.key&&e.key.startsWith("environmentVariables"))throw tt(e,"envs");else if("invalid_project_name"===e.code||"name"===e.key)throw tt(e,"projectName")}throw e}}function tt(e,t){return Object.assign(Error(e.message),e,{step:t})}var tr=e.i(7691989);let ti={};async function ta(e){try{return await (0,F.fetchAPI)(`${I.API_INTEGRATION_CONTROLLER}/detect-framework${(0,B.encode)({url:e})}`)}catch(e){throw Error((0,tr.displayError)(e))}}async function tn(e){if(!e)return{framework:void 0};let t=ti[e];if(t){let e=await t;return e?.framework?e:{framework:void 0}}let r=ta(e);ti[e]=r;try{let t=await r;return ti[e]=t,t||{framework:void 0}}catch(t){throw ti[e]=null,t}}var ts=e.i(6913536),tl=e.i(5065835);let to={"hydrogen-2":"remix","vite-react":"vite","vercel-tutor":"nextjs","vibe-coding-platform":"nextjs"};var td=e.i(2251791),tc=e.i(5432439),tu=e.i(6161994),tp=e.i(8866953),tm=e.i(4597921);function tg(){let e=(0,tm.useServerFlag)("enable-monorepo-clone-flow",!1),[t]=(0,G.default)();return(0,r.useMemo)(()=>{let{monorepo:r,"root-directories":i,"project-names":a}=t,n=e&&"1"===r;if(!n)return{isMonorepo:!1,isValid:!0,errors:[],projects:[]};let s=[],l=[],o=[];if(!i)return{isMonorepo:!0,isValid:!1,errors:["The root-directories parameter is required"],projects:[]};if((l=(Array.isArray(i)?i.join(","):i).split(",").map(e=>e.trim()).filter(Boolean)).length<2)return{isMonorepo:!0,isValid:!1,errors:["At least two directories must be specified in root-directories"],projects:[]};if(l.length>3)return{isMonorepo:!0,isValid:!1,errors:["A maximum of 3 directories are allowed in root-directories"],projects:[]};if(a&&(o=(Array.isArray(a)?a.join(","):a).split(",").map(e=>e.trim()).filter(Boolean)).length!==l.length)return{isMonorepo:!0,isValid:!1,errors:["There must be a project name for each root directory specified"],projects:[]};let d=l.map((e,t)=>{let r=e.trim(),i=o[t];return i||s.push("projectNames must be provided for each root-directory"),{rootDirectory:r,projectName:i}});return{isMonorepo:n,isValid:0===s.length,errors:s,projects:d}},[e,t])}async function tf(e){let{project:t,teamId:r,gitType:i,repoFullPath:a,framework:n,dispatch:s,setLoading:l,setGitError:o}=e;try{s({type:"UPDATE_PROJECT_STATUS",projectName:t.projectName,status:"creating"});let e=await te({version:"v11",projectName:t.projectName,environmentVariables:[],teamId:r,projectSettings:{framework:n,rootDirectory:t.rootDirectory,outputDirectory:null,buildCommand:null,devCommand:null,installCommand:null,commandForIgnoringBuildStep:void 0,enableAffectedProjectsDeployments:void 0},gitRepository:{type:i,repo:a}});return s({type:"UPDATE_PROJECT_STATUS",projectName:t.projectName,projectId:e.id,status:"created"}),e}catch(e){throw s({type:"UPDATE_PROJECT_STATUS",projectName:t.projectName,status:"error"}),l(!1),o((0,S.normalizeError)(e)),e}}async function th(e,t,r){if("gitlab"===t||"bitbucket"===t)try{await (0,F.fetchAPI)(`${(0,I.API_PROJECTS_VERSION)("v9")}/${e}/branch${(0,B.encode)({teamId:r})}`,{method:"PATCH",body:JSON.stringify({branch:"main"}),throwOnHTTPError:!0})}catch(e){await (0,e6.captureError)(e)}}function tx(e){let{isMicrofrontends:t,microfrontendsGroupId:r,microfrontendsGroups:i,isMicrofrontendsGroupsLoading:a,setGitError:n,setLoading:s}=e;if(!t)return!0;if(!r&&(i?.groups.length??0)>=(i?.maxMicrofrontendsGroupsPerTeam??100))return n(Error("You have reached the maximum number of microfrontends groups for this team.")),s(!1),!1;if(r&&!a&&!i?.groups.find(e=>e.group.id===r))return n(Error(`Could not find microfrontends group ${r}.`)),s(!1),!1;if(r){let e=i?.groups.find(e=>e.group.id===r);if(e&&e.projects.length>=(i?.maxMicrofrontendsPerGroup??100))return n(Error(`Microfrontends group ${r} has reached the maximum number of projects.`)),s(!1),!1}return!0}var ty=e.i(1583207);function tj(e){let{initialGitType:i,hasAccess:a,disabled:n=!1,isVercelTutor:s}=e,{user:g,isLoading:h}=(0,c.useUser)(),{team:x}=(0,d.useTeam)(),{can:y}=(0,u.default)(),v=(0,w.useSearchParams)(),{account:_}=(0,ew.default)({account:g&&!g.limited?g:null}),T=(0,j.useRepoQuery)(),{setRepoNameStates:b,gitError:N,setGitError:P,isPrivate:k,setIsPrivate:A,gitType:R,setGitType:M,loading:O,reset:$,isTeamRepo:D}=(0,ez.useGitInputStore)((0,r.useCallback)(e=>e,[]),eg.shallow),[{"repository-name":B}]=(0,G.default)(),{data:V,isLoading:H}=(0,U.default)({provider:R}),W=(0,ez.useNewNamespace)(),{dispatch:q,repo:Y}=(0,Q.useProjectCloneContext)(),X=(0,r.useMemo)(()=>{let e=V?.find(e=>e.slug===W),t=Y.namespaceId,r=Y.namespace;return e&&(t||(t=e.id),r||(r=e.slug)),{gitProvider:R,gitNamespaceId:t,gitNamespaceSlug:r}},[V,R,W,Y]),{data:K,isLoading:Z}=(0,eE.useVerifyGitExclusivity)(X),{selectedTeamSlug:ee,isCreatingTeam:et,isSelectedTeamSlugReady:er,onTeamSlugChange:ei,selectedTeamError:ea}=(0,eO.useSelectedTeamSlug)({gitProvider:Y.gitType,gitNamespaceId:Y.namespaceId,gitNamespaceSlug:Y.namespace}),en=D&&k,es=x&&x.billing?.plan!=="hobby",{formRef:el,onKeyDown:eo}=(0,eS.useCmdEnterSubmit)(),{verifyMicrofrontendsAction:ed,totalRemainingFreeProjects:ec}=(0,ty.useMicrofrontendsBilling)(),eu=v?.get("microfrontends")==="1",ep=v?.get("project-names"),em=ep?.split(",").length||0,ej=eu?ed({action:"create-group",source:"clone-microfrontends-template"}):null,{showUpgradeCTA:ev,upgradeMessage:e_,setFreezeUpgradeUI:eC,disallowHobby:eI}=(0,eL.useUpgradeCTA)({isCreatingTeam:et,isTeamRepo:D,isPrivate:k,gitType:Y.gitType,selectedTeamSlug:ee}),eP=(0,ez.useNewRepo)(),ek=(0,r.useRef)(!1);(0,r.useEffect)(()=>()=>{$()},[$]),(0,r.useEffect)(()=>{let e=v?.get("repository-name"),t=(0,ex.getQueryParam)(e);t&&!ek.current&&R&&b(e=>{let r=e[R];return r?{...e,[R]:[r[0],t]}:e})},[R,v,b]),(0,r.useEffect)(()=>{M(i)},[]);let eA=y(p.Action.Create,p.Resource.Project),eR=y(p.Action.Update,p.Resource.BillingPlan),eG=!h&&!O&&!H&&!V&&!!v,{active:eU}=(0,L.useCardContext)();(0,r.useEffect)(()=>{W&&B&&R&&(b(e=>({...e,[R]:[W,B]})),q({type:"SET_TARGET_REPO",name:B}))},[R,W,B,q,b]);let eD=(0,r.useCallback)(e=>{P(null),M(e),q({type:"SET_GIT_TYPE",gitType:e})},[q,M,P]),eB=(0,r.useCallback)(e=>{if("SET_REPO"===e.type){if(P(null),e.gitType&&e.namespace){let t=e.gitType;ek.current=!0,b(r=>({...r,[t]:[e.namespace,e.repo]}))}}else"SET_GIT_TYPE"===e.type&&(M(e.gitType),q({type:"SET_GIT_TYPE",gitType:e.gitType}))},[q,P,M,b]),eF=function(){let{gitType:e,setLoading:t,setGitError:i}=(0,ez.useGitInputStore)((0,r.useCallback)(e=>{let{gitType:t,setLoading:r,setGitError:i}=e;return{gitType:t,setLoading:r,setGitError:i}},[]),eg.shallow),{url:a}=(0,j.useRepoQuery)()??{},n=(0,ez.useNewNamespace)(),s=(0,ez.useNewRepo)(),u=function(){let e=(0,ez.useNewRepo)(),t=(0,ez.useNewNamespace)(),{setLoading:i,gitType:a,isPrivate:n,setGitError:s}=(0,ez.useGitInputStore)((0,r.useCallback)(e=>{let{setLoading:t,gitType:r,isPrivate:i,setGitError:a}=e;return{setLoading:t,gitType:r,isPrivate:i,setGitError:a}},[]),eg.shallow),{dispatch:d}=(0,Q.useProjectCloneContext)();return async()=>{let r;try{r=await (0,F.fetchAPI)(`${I.API_INTEGRATION_CONTROLLER}/git-repo`,{method:"POST",body:JSON.stringify({provider:a,namespace:t,name:e,private:n}),throwOnHTTPError:!0}),d({type:"SET_CLONED_REPO",data:{id:r.id,slug:r.slug}}),l.analytics.track(o.AnalyticsEvent.PROJECT_CREATION_CREATED_GIT_REPOSITORY,{version:3})}catch(e){i(!1),s((0,S.normalizeError)(e));return}return r}}(),p=(0,tc.useGetProjectName)(),g=function(){let e=(0,j.useRepoQuery)(),{setLoading:t,gitType:i,setGitError:a}=(0,ez.useGitInputStore)((0,r.useCallback)(e=>{let{setLoading:t,gitType:r,setGitError:i}=e;return{setLoading:t,gitType:r,setGitError:i}},[]),eg.shallow),n=function(){let e=(0,j.useRepoQuery)(),t=(0,tl.useRepoIfGitVerified)({provider:e?.type,owner:e?.owner,name:e?.name,customGitHost:e?.host}),[{"root-directory":r}]=(0,G.default)();return async()=>{let i;if(!e?.template){let a=t.data;a||t.error||(a=await t.mutate()),i=(await tn((0,ts.default)(e,a?.defaultBranch,r)).then(e=>({framework:e.framework?.slug}))).framework}return i}}(),{dispatch:s}=(0,Q.useProjectCloneContext)(),[{"root-directory":l,"output-directory":o,"build-command":d,"dev-command":c,"install-command":u,"ignore-command":p,"skip-unaffected":m,domain:g}]=(0,G.default)();return async r=>{let f,{projectName:h,repoFullPath:x,teamId:y}=r,j=await n();if(!i)return;let v=to[e?.template||""]||e?.template||j;try{f=await te({version:"v11",projectName:h,environmentVariables:[],teamId:y,projectSettings:{framework:v,rootDirectory:l,outputDirectory:o,buildCommand:d,devCommand:c,installCommand:u,commandForIgnoringBuildStep:p,enableAffectedProjectsDeployments:["true","false"].some(e=>e===m)?"true"===m:void 0},gitRepository:{type:i,repo:x},domains:Array.isArray(g)?g:g?[g]:void 0}),s({type:"SET_PROJECT_ID",projectId:f.id}),s({type:"SET_PROJECT_NAME",projectName:f.name})}catch(e){t(!1),a((0,S.normalizeError)(e));return}return f}}(),f=function(){let e=(0,ez.useGitInputStore)((0,r.useCallback)(e=>{let{gitType:t}=e;return t},[])),t=(0,ez.useNewNamespace)(),{team:i}=(0,d.useTeam)(),{user:a}=(0,c.useUser)(),{data:n}=(0,U.default)({provider:e}),s=(0,C.useToasts)(),{dispatch:l}=(0,Q.useProjectCloneContext)(),{templateSlug:o,isTemplate:u}=(0,td.useCloneTrackBaseParams)(),p=(0,j.useRepoQuery)(),{data:m}=(0,tl.useRepoIfGitVerified)({provider:p?.type,owner:p?.owner,name:p?.name,customGitHost:p?.host});return async r=>{let{teamId:d,createdRepo:c,projectName:g}=r;if(e&&t)try{let r;u&&o&&(r={templateSlug:o}),p?.template&&m?.sha&&(r={...r??{},templateUrl:p.url,templateSha:m.sha});let f=await z({teamId:d,projectName:g,type:e,repoId:c.id,owner:t,repo:c.slug,meta:r,source:"clone/repo"});if(f.id){l({type:"SET_STATUS",status:"deploying"}),l({type:"SET_DEPLOYMENT_ID",deploymentId:f.id});try{await J({gitNamespaces:n,currentNamespace:t,scopeId:i?.id||a?.uid})}catch(e){s.error((0,S.errorToString)(e))}}}catch(e){s.error((0,S.errorToString)(e))}}}(),h=tg(),x=function(){let e=(0,j.useRepoQuery)(),{data:t}=(0,tl.useRepoIfGitVerified)({provider:e?.type,owner:e?.owner,name:e?.name,customGitHost:e?.host}),{setLoading:i,gitType:a,setGitError:n}=(0,ez.useGitInputStore)((0,r.useCallback)(e=>{let{setLoading:t,gitType:r,setGitError:i}=e;return{setLoading:t,gitType:r,setGitError:i}},[]),eg.shallow),[{microfrontends:s}]=(0,G.default)(),{dispatch:l}=(0,Q.useProjectCloneContext)();return async r=>{let{projects:o,repoFullPath:d,teamId:c}=r;if(!a)return[];l({type:"SET_PROJECTS",projects:o});let u=await Promise.all(o.map(async r=>{let{framework:s}=await tn((0,ts.default)(e,t?.defaultBranch,r.rootDirectory)).then(e=>({framework:e.framework?.slug}));return tf({project:r,teamId:c,gitType:a,repoFullPath:d,framework:s,dispatch:l,setLoading:i,setGitError:n})}));if(s&&c)try{await (0,e9.createMicrofrontendsGroup)({groupName:`Microfrontends Template ${Math.floor(1e3*Math.random())}`,defaultApp:{projectId:u[0].id},nonDefaultProjects:u.slice(1).map(e=>({projectId:e.id})),teamId:c})}catch(e){return i(!1),l({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"error"}),await (0,e6.captureError)(e),[]}return u}}(),y=function(){let e=(0,ez.useGitInputStore)((0,r.useCallback)(e=>{let{gitType:t}=e;return t},[])),t=(0,ez.useNewNamespace)(),{team:i}=(0,d.useTeam)(),{user:a}=(0,c.useUser)(),{data:n}=(0,U.default)({provider:e}),s=(0,C.useToasts)(),{dispatch:l}=(0,Q.useProjectCloneContext)(),o=(0,j.useRepoQuery)(),{data:u}=(0,tl.useRepoIfGitVerified)({provider:o?.type,owner:o?.owner,name:o?.name,customGitHost:o?.host});return async r=>{let{teamId:d,createdRepo:c,projects:p}=r;if(!e||!t)return;let m=o?.template&&u?.sha?{templateUrl:o.url,templateSha:u.sha}:void 0;for(let r=0;r<p.length;r++){let i=p[r];try{let r=await z({teamId:d,projectName:i.name,type:e,repoId:c.id,owner:t,repo:c.slug,meta:m});r.id&&l({type:"UPDATE_PROJECT_DEPLOYMENT_ID",projectName:i.name,deploymentId:r.id})}catch(e){l({type:"UPDATE_PROJECT_STATUS",projectName:i.name,status:"error",error:(0,S.errorToString)(e)}),s.error(`Failed to deploy ${i.name}: ${(0,S.errorToString)(e)}`)}}l({type:"SET_STATUS",status:"deploying"});try{await J({gitNamespaces:n,currentNamespace:t,scopeId:i?.id||a?.uid})}catch(e){s.error((0,S.errorToString)(e))}}}(),{dispatch:v}=(0,Q.useProjectCloneContext)(),[{"integration-ids":_,"production-deploy-hook":T,env:w,stores:E,products:b,microfrontends:N,microfrontendsGroupId:P}]=(0,G.default)(),k="1"===N,A="string"==typeof P?P:void 0,{data:R,isLoading:M}=(0,tu.useMicrofrontendsGroups)({enabled:k}),O=b??E,L=(0,r.useCallback)(async r=>{if(!n||!s)return;t(!0);let l=await p(r);if(!l)return;if(!(0,e7.isValidProjectName)(l)){i(Error(e7.PROJECT_NAME_ERROR_MESSAGE)),t(!1);return}if(!tx({isMicrofrontends:k,microfrontendsGroupId:A,microfrontendsGroups:R,isMicrofrontendsGroupsLoading:M,setGitError:i,setLoading:t}))return;let o=await u();if(!o)return;let d=n?`${n}/${o.slug}`:`${o.slug}`,c=await g({projectName:l,repoFullPath:d,teamId:r});if(c){k&&r&&(A?R?.groups.find(e=>e.group.id===A)&&await (0,tp.addProjectToMicrofrontendsGroup)({projectId:c.id,microfrontendsGroupId:A,teamSlug:r}):v({type:"SET_MICROFRONTENDS_GROUP_ID",microfrontendsGroupId:(await (0,e9.createMicrofrontendsGroup)({groupName:`Microfrontends Templates ${Math.floor(1e3*Math.random())}`,defaultApp:{projectId:c.id},nonDefaultProjects:[],teamId:r})).newMicrofrontendsGroup.id})),O&&v({type:"SET_STATUS",status:"add-storage-started"}),!O&&_&&v({type:"SET_STATUS",status:"installing-integrations-started"}),O||_||!w||v({type:"SET_STATUS",status:"configure-project"}),v({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"started"});try{await (0,e4.pushRepo)({type:e,source:a,target:d,teamId:r,branch:"main"})}catch(e){t(!1),v({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"error"}),(0,m.postToStatsigClient)({events:[{eventName:"clone_repo_error"}]}),await (0,e6.captureError)(e);return}T&&await (0,e3.createDeployHook)(c,r,T,"main"),e&&await th(c.id,e,r),t(!1),v({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"finished"}),_||w||O||!e||await f({teamId:r,createdRepo:o,projectName:l})}},[n,s,t,u,p,g,_,w,v,T,e,O,a,f,i,k,A,R,M]),$=(0,r.useCallback)(async r=>{if(!n||!s)return;if(t(!0),!h.isValid){i(Error(h.errors.join("; "))),t(!1);return}if(!tx({isMicrofrontends:k,microfrontendsGroupId:A,microfrontendsGroups:R,isMicrofrontendsGroupsLoading:M,setGitError:i,setLoading:t}))return;v({type:"SET_MONOREPO_MODE",isMonorepo:!0});let l=await u();if(!l)return;let o=n?`${n}/${l.slug}`:`${l.slug}`,d=await x({teamId:r,repoFullPath:o,projects:h.projects});if(d.length){v({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"started"});try{await (0,e4.pushRepo)({type:e,source:a,target:o,teamId:r,branch:"main"})}catch(e){t(!1),v({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"error"}),(0,m.postToStatsigClient)({events:[{eventName:"clone_repo_error"}]}),await (0,e6.captureError)(e);return}if(e)try{await Promise.all(d.map(t=>th(t.id,e,r)))}catch(e){t(!1),v({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"error"}),await (0,e6.captureError)(e);return}t(!1),v({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"finished"}),await y({teamId:r,createdRepo:l,projects:d})}},[x,y,n,s,t,u,v,e,a,i,h,k,A,R,M]);return h.isMonorepo?$:L}();(0,r.useEffect)(()=>{i&&(M(i),q({type:"SET_GIT_TYPE",gitType:i}))},[q,i,M]);let eV=ee&&ee===x?.slug?ea:null,eH=ee&&ee===x?.slug?e_:null,eJ=s&&R&&"github"!==R,eQ=!R||!V?.length||Z||!K?.hasAccess,eW=!eP,eq=(0,r.useCallback)(e=>{let{size:r="small"}=e;return er?(0,t.jsx)(E.Button,{"data-testid":(0,ey.tid)("git-input","submit"),disabled:!!(!eU||O||n||!x||!ee||!eA||en&&!es||eJ||eu&&!eR&&em>ec||ej),loading:O,size:r,children:O?"Creating…":"Create"}):(0,t.jsx)(f.Skeleton,{height:40,width:"100%"})},[eU,n,en,es,O,x,ee,eA,er,eJ,ej,ec,eu,em,eR]),eY=(0,r.useCallback)(()=>{eQ?P(Error("Choose a Git provider to continue.")):eW?P(Error("Please enter the repository name.")):(0,eT.promiseToCallback)(eF)(x?.id)},[eF,x?.id,eQ,eW,P]),eX=(0,r.useCallback)(e=>{e.preventDefault(),eY()},[eY]);return g?.limited?(0,t.jsx)(eb.default,{small:!0}):(0,t.jsx)("form",{autoComplete:"off","data-testid":(0,ey.tid)("git-input","loaded"),noValidate:!0,onKeyDown:eo,onSubmit:eX,ref:el,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14 text-inherit",children:"Create a Git repository to easily update your project after deploying it. Every push to that Git repository will be deployed automatically."}),eG?(0,t.jsx)(e$,{account:_,hasAccess:a,onConnect:eD}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e2,{disabled:n,dispatch:eB,gitType:R,isPrivate:k,loading:O,namespace:W??"",repo:eP,setIsPrivate:A,setRepoNameStates:b,template:T?.template}),eJ?(0,t.jsx)(eN,{}):null]}),N?(0,t.jsx)(eh.Note,{fill:!0,type:"error",children:N.message}):null,(0,t.jsx)("hr",{className:"geist-hr-reset"}),(0,t.jsx)(eM.AnimateChangeInHeight,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial min-h-10",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsx)(ef.Label,{value:"Vercel Team",children:(0,t.jsx)(eO.TeamSelector,{disabled:O||!eU,gitNamespaceId:Y.namespaceId,gitNamespaceSlug:Y.namespace,gitProvider:R,loading:!er,onChange:ei,value:ee})}),eV?(0,t.jsx)(eh.Note,{fill:!0,type:"secondary",children:eV}):null,eH&&x?.billing?.plan==="hobby"?(0,t.jsx)(eh.Note,{fill:!0,type:"secondary",children:eH}):null]}),eu?(0,t.jsx)(ty.MicrofrontendsBilling,{calculateTotal:!0,selectedProjectsCount:em}):null,ej,ev&&!es?(0,t.jsx)(eL.UpgradeCTA,{disallowHobby:eI,onSubmit:e=>eF(e?e.id:x?.id),selectedTeamSlug:ee,setFreezeUpgradeUI:eC}):null,!ev||es?(0,t.jsx)(eq,{size:"medium"}):null]})})]})})}function tv(e){let{frameworks:i}=e,{cloneRepoStatus:a}=(0,Q.useProjectCloneContext)(),{isLoggedIn:n,isLoading:s}=(0,ej.useIsLoggedIn)(),{user:l}=(0,c.useUser)(),o=(0,r.useMemo)(()=>l||n||s?"not-started"!==a?"collapsed":"input":"login",[a,l,n,s]),d=(0,r.useMemo)(()=>{if("collapsed"!==o)return"input"===o?"min-h-64":"min-h-80"},[o]);return(0,t.jsxs)("div",{className:"flex flex-col gap-y-6",children:[(0,t.jsx)(eC.GitRepositoryEntity,{action:"cloning",checkGitVerified:!0,frameworks:i}),(0,t.jsx)(eM.AnimateChangeInHeight,{className:d,disableAnimation:"not-started"===a,fixToBottom:"not-started"!==a,children:(0,t.jsxs)(ev.AnimatePresence,{children:["login"===o?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Vercel is the easiest way to deploy websites."}),(0,t.jsx)("p",{className:"text-copy-14",children:"Sign in to clone and deploy."})]}),(0,t.jsx)("hr",{className:"geist-hr-reset"}),(0,t.jsx)(eR,{className:eJ.default.login,eventLabel:"Clone Flow"})]}):null,"collapsed"===o?(0,t.jsx)(eH,{}):null,"input"===o?(0,t.jsx)(e_.motion.div,{animate:{opacity:1},exit:{opacity:0,position:"absolute",top:0,zIndex:-1},transition:{duration:.3},children:(0,t.jsx)(tj,{...e})},"git-input-form"):null]})})]})}var t_=e.i(2226996);function tT(e){let{framework:a,children:n}=e,{active:s}=(0,L.useCardContext)(),l=(0,j.useRepoQuery)(),o=(0,r.useMemo)(()=>a?.logo?(0,t.jsx)($.Avatar,{className:t_.default.frameworkAvatar,placeholder:!a,size:16,url:a.logo}):l?.type?(0,t.jsx)(ed.default,{gitType:l.type,height:16,width:16}):null,[a,l]);return(0,t.jsxs)("span",{className:(0,i.default)("text-[14px] leading-[20px] font-medium",s?"text-gray-1000":"text-gray-900"),style:{display:"inline-flex",alignItems:"center",verticalAlign:"bottom"},children:[o," ",n]})}var tS=e.i(5927860),tw=e.i(9512272),tE=e.i(8313680),tC=e.i(198667),tb=e.i(9334091),tN=e.i(8464864),tI=e.i(762945),tP=e.i(5323212),tk=e.i(8735244),tA=e.i(1475672),tR=e.i(6641571),tM=e.i(2843591),tO=e.i(4714146),tL=e.i(1758334),tG=e.i(5919007);function tU(e){let{selectedEdgeConfigId:r,edgeConfigData:i,edgeConfigItems:a,mode:n}=e;if("select"===n&&""!==r&&!a.data)return(0,t.jsx)("div",{className:"flex flex-col items-center justify-start flex-initial",children:(0,t.jsx)(tk.Spinner,{})});let s="select"===n&&""!==r&&a.data?a.data.map(e=>e.key):[],{added:l,overwritten:o}=(i?Object.keys(i):[]).reduce((e,t)=>(s.includes(t)?e.overwritten.push(t):e.added.push(t),e),{added:[],overwritten:[]});return(0,t.jsxs)("div",{children:[o.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"These keys will be overwritten in your Edge Config:"}),(0,t.jsx)(tR.UL,{children:o.map(e=>(0,t.jsx)(tR.LI,{children:(0,t.jsx)("span",{className:"text-copy-13-mono text-gray-900",children:e})},e))})]}):null,l.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"These keys will be added to your Edge Config:"}),(0,t.jsx)(tR.UL,{children:l.map(e=>(0,t.jsx)(tR.LI,{children:(0,t.jsx)("span",{className:"text-copy-13-mono text-gray-900",children:e})},e))})]}):null]})}function t$(e){let{active:i,envValue:a,onClickOutside:n,projectName:s,setEnvValue:l,onAnimationDone:o,edgeConfigData:d}=e,{team:c,user:u}=(0,K.useAccount)(),{data:p}=(0,tM.useEdgeConfigs)(),m=c||u,g=!!m&&!!p&&p.length>=(0,tG.getMaxEdgeConfigs)(m),f=p?.length,[h,x]=(0,r.useState)(a?.type==="new-edge-config"?a.edgeConfigName:""),[y,j]=(0,r.useState)(a?.type==="existing-edge-config"?a.edgeConfigId:""),[v,_]=(0,r.useState)(a?.type==="existing-edge-config"?"select":"create"),[T,S]=(0,r.useState)(!1),[w,E]=(0,r.useState)(null),C=(0,tM.useEdgeConfigItems)(""===y?void 0:y);(0,r.useEffect)(()=>{"number"==typeof f&&f>0&&i&&a?.type!=="new-edge-config"&&_("select")},[f,i,a?.type]),(0,r.useEffect)(()=>{s.length>0&&x(e=>""===e?`${s.replaceAll("_","-").substr(0,(0,tL.getStoreNameLengthByType)("edge-config")-6)}-store`:e)},[s]),(0,r.useEffect)(()=>{E(null)},[v]);let N=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),S(!0);let t=h.trim();if(0===t.length){E("Missing value"),S(!1);return}if(t.length>(0,tL.getStoreNameLengthByType)("edge-config")){E(`May not exceed ${(0,tL.getStoreNameLengthByType)("edge-config")} characters`),S(!1);return}if(!/^[\w-]+$/.test(t)){E('Slug may contain alphanumeric letters, "_" and "-" only'),S(!1);return}l({type:"new-edge-config",edgeConfigId:null,edgeConfigName:t,error:!1}),S(!1),n()},[l,h,n]),I=(0,r.useCallback)(e=>{if(e.preventDefault(),e.stopPropagation(),""===y)return;S(!0);let t=p?.find(e=>e.id===y);t?(l({type:"existing-edge-config",edgeConfigId:t.id,edgeConfigName:t.slug,error:!1}),S(!1),n()):E("Could not find selected Edge Config")},[p,n,y,l]),P=(0,r.useRef)(null);(0,r.useEffect)(()=>{setTimeout(()=>{i&&(P.current?.focus(),P.current?.select())},0)},[i]);let k=!!p&&""!==y&&p.every(e=>e.id!==y);return(0,t.jsx)(ee.Modal.Modal,{active:i,allowOverflow:!0,onAnimationDone:o,onClickOutside:T?()=>void 0:n,width:480,children:(0,t.jsxs)("form",{onSubmit:"create"===v?N:I,children:[(0,t.jsx)(ee.Modal.Body,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)(ee.Modal.Title,{center:!0,children:"Connect Edge Config Store"}),(0,t.jsx)(ee.Modal.Inset,{last:!0,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)(R.default,{center:!0,children:(0,t.jsx)(tA.default,{active:v,items:[{name:"Create new",value:"create",width:110},{name:"Select existing",value:"select",width:136}],onChange:e=>{_(e)}})}),"create"===v?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsx)(eY.Input,{"aria-label":"Edge Config name",disabled:T||g,error:w,label:"Edge Config name",onChange:e=>{x(e.currentTarget.value),E(null)},placeholder:"my-edge-config-store",ref:P,value:h,width:"100%"}),g?(0,t.jsx)(eh.Note,{className:tO.default["warning-note"],fill:!0,label:!1,type:"warning",variant:"contrast",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-4 flex-initial",style:{padding:1},children:[(0,t.jsx)(tI.Warning,{style:{flexShrink:0}}),(0,t.jsxs)("div",{className:"flex flex-col items-start justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14 text-inherit",children:"You reached the maximum number of Edge Configs for your plan."}),(0,t.jsxs)("p",{className:"text-copy-14 text-inherit",children:["Select an existing Edge Config, upgrade your plan or"," ",(0,t.jsx)(D.Link,{external:!0,href:"https://vercel.com/contact/sales?p=1",variant:"blend",children:"contact our sales team"})," ","to request a higher limit."]})]})]})}):null]}):(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsxs)(tP.Select,{label:"Select Edge Config",onChange:e=>{j(e.target.value)},value:y,children:[(0,t.jsx)("option",{disabled:!0,value:"",children:"Select an Edge Config"}),p?.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.slug," (",e.id,")"]},e.id))]}),w?(0,t.jsx)(b.Error,{error:w}):null,k?(0,t.jsx)(b.Error,{error:"This Edge Config no longer exists"}):null]}),("select"===v?""===y||k:g)?null:(0,t.jsx)(tU,{edgeConfigData:d,edgeConfigItems:C,mode:v,selectedEdgeConfigId:y})]})})]})}),(0,t.jsxs)(ee.Modal.Actions,{children:[(0,t.jsx)(ee.Modal.Action,{onClick:T?()=>void 0:n,type:"secondary",children:"Cancel"}),(0,t.jsx)(ee.Modal.Action,{buttonType:"submit",disabled:"create"===v?""===h.trim()||g||T:""===y||T||!C.data,loading:T,children:"create"===v?"Create":"Select"})]})]})})}var tD=e.i(5888315);function tB(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;return btoa(String.fromCharCode(...crypto.getRandomValues(new Uint8Array(e))))}function tF(e){let{children:r,hideLabel:i,...a}=e;return i?(0,t.jsx)(t.Fragment,{children:r}):(0,t.jsx)(ef.Label,{...a,children:r})}function tV(e){let{setEnvValue:i,disabled:a}=e,n="Generate a random secret to use for authentication",s=(0,r.useRef)(!1);(0,r.useEffect)(()=>{s.current||(i({type:"text",value:tB(),error:!1}),s.current=!0)},[i]);let l=(0,t.jsx)(E.Button,{"aria-label":n,shape:"square",svgOnly:!0,type:"secondary",typeName:"button",disabled:a,onClick:()=>{i({type:"text",value:tB(),error:!1})},children:(0,t.jsx)(tC.RefreshClockwise,{})});return a?l:(0,t.jsx)(Y.Tooltip,{text:n,children:l})}function tH(e){let{envName:a,envValue:n,setEnvValue:s,error:l,hideLabels:o,disabled:d,disableEnvName:c=!1,edgeConfigData:u,projectName:p,showAuthSecretHelper:m}=e,g=(0,r.useMemo)(()=>(0,tw.isSystemEnv)(a),[a]),[f,h]=(0,r.useState)([]),[x,y]=function(e){let{edgeConfigData:t,envName:i,envValue:a,projectName:n,setEnvValue:s,createdEdgeConfigs:l,setCreatedEdgeConfigs:o}=e,[d,c]=(0,r.useState)(!1),u=(0,r.useCallback)(()=>{c(!1)},[]),p=(0,r.useCallback)(()=>{c(!0)},[]),[m,g]=(0,r.useState)(0),f=(0,r.useCallback)(()=>{g(e=>e+1)},[g]);return[p,{active:d,envName:i,envValue:a,projectName:n,setEnvValue:s,onClickOutside:u,key:String(m),onAnimationDone:f,edgeConfigData:t,createdEdgeConfigs:l,setCreatedEdgeConfigs:o}]}({envName:a,envValue:n,projectName:p,setEnvValue:s,edgeConfigData:u,createdEdgeConfigs:f,setCreatedEdgeConfigs:h});return(0,t.jsxs)(t.Fragment,{children:[(0,r.createElement)(t$,{...y,key:y.key}),(0,t.jsx)(R.default,{direction:["column","row","row"],children:(0,t.jsxs)(R.default,{direction:"row",gap:.5,children:[(0,t.jsx)(R.default,{children:(0,t.jsx)(tF,{hideLabel:o,id:`env-name-${a}`,value:"Name",withInput:!0,children:(0,t.jsx)(eY.Input,{disabled:c||d,height:40,id:`env-name-${a}`,placeholder:"EXAMPLE_NAME",prefix:u?(0,t.jsx)(tE.EdgeConfig,{}):void 0,prefixStyling:!u&&void 0,value:a,width:"100%"})})}),(0,t.jsx)(R.default,{children:(0,t.jsx)(tF,{hideLabel:o,id:`env-value-${a}`,value:"Value",withInput:!0,children:g?(0,t.jsx)(tN.default,{disabled:!0,height:40,id:`env-value-${a}`,placeholder:"Populated by System",value:"",width:"100%"}):u?(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)("div",{children:(0,t.jsx)(E.Button,{disabled:d,onClick:()=>{x()},type:"secondary",typeName:"button",children:"Select"})}),l?(0,t.jsx)("p",{className:"text-copy-14 text-red-900",children:"Missing"}):null,(0,t.jsx)("p",{className:"text-copy-14 truncate",children:n?.type==="existing-edge-config"||n?.type==="new-edge-config"?n.edgeConfigName:""})]}):(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:(0,t.jsxs)("div",{className:"flex flex-row items-start justify-start gap-2 flex-1",children:[(0,t.jsx)(tb.Textarea,{wrapperClassName:"w-full",className:(0,i.clsx)(tD.default.valueTextarea,"whitespace-nowrap leading-[24px] md:whitespace-pre md:leading-[20px]"),disabled:d,error:l?"Missing":void 0,id:`env-value-${a}`,onChange:e=>{s({type:"text",value:e.target.value,error:!1})},spellCheck:"false",value:n?.value||"",width:"100%"}),m?(0,t.jsx)(tV,{disabled:d,setEnvValue:s}):null]})})})})]})}),"string"==typeof l&&(0,t.jsx)(R.default,{style:{paddingTop:"var(--geist-gap-half)"},children:(0,t.jsx)(b.Error,{children:l})})]})}var tz=e.i(929107),tJ=e.i(134877);async function tQ(e,t,r){try{await (0,tw.addEnvs)(e,t,r)}catch(i){if((0,tJ.isAPIError)(i)&&("ENV_ALREADY_EXISTS"===i.code||i.failed?.some(e=>"ENV_CONFLICT"===e.error.code))){let i=await tW(e,r),a=new Set(t.map(e=>e.name));await Promise.all(i.filter(e=>a.has(e.key)).map(t=>tq(e,t.id,r))),await (0,tw.addEnvs)(e,t,r)}else throw i}}async function tW(e,t){let{envs:r}=await (0,F.fetchAPI)(`${(0,I.API_PROJECTS_VERSION)("v8")}/${encodeURIComponent(e)}/env${(0,B.encode)({teamId:t})}`,{throwOnHTTPError:!0});return r}async function tq(e,t,r){await (0,F.fetchAPI)(`${(0,I.API_PROJECTS_VERSION)("v8")}/${encodeURIComponent(e)}/env/${encodeURIComponent(t)}${(0,B.encode)({teamId:r})}`,{method:"DELETE",throwOnHTTPError:!0})}let tY={github:{"vercel/ai-chatbot":["AUTH_SECRET"],"nextjs/saas-starter":["AUTH_SECRET"],"vercel/v0-sdk":["AUTH_SECRET"]}};function tX(e){return null!=e}function tK(){let e,[{env:i,envDescription:a,envLink:n,envDefaults:l,"edge-config-stores":o}]=(0,G.default)(),{projectName:c,status:u,dispatch:p}=(0,Q.useProjectCloneContext)(),{team:m}=(0,d.useTeam)(),g=(0,C.useToasts)(),[f,h]=(0,r.useState)(!1),{active:x}=(0,L.useCardContext)(),[y,v]=(0,r.useState)(!1),{shouldShowAuthSecretHelper:_}=(e=(0,j.useRepoQuery)(),{shouldShowAuthSecretHelper:(0,r.useCallback)(t=>{if(e?.type&&e.fullName){let r=tY[e.type]?.[e.fullName];return!!r?.includes(t)}return!1},[e])}),T=(0,r.useMemo)(()=>{try{return JSON.parse(o)}catch{return null}},[o]),w=(0,r.useMemo)(()=>{try{return JSON.parse(l)}catch{return null}},[l]),[b,N]=(0,r.useState)({}),P=(0,r.useMemo)(()=>(Array.isArray(i)?i:[i]).filter(e=>"string"==typeof e).flatMap(e=>e.split(",")),[i]),k=P.filter(e=>{if((0,tw.isSystemEnv)(e))return!1;let t=b[e];return void 0===t||"text"===t.type&&""===t.value.trim()}),A=(0,r.useRef)(!1);(0,r.useEffect)(()=>{if(A.current||!k.includes("FLAGS_SECRET"))return;let e=new Uint8Array(32);crypto.getRandomValues(e);let t=btoa(String.fromCharCode.apply(null,Array.from(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");(0,r.startTransition)(()=>{N(e=>({...e,FLAGS_SECRET:{value:t,type:"text",error:!1}})),A.current=!0})},[A,b,N,k]);let R=(0,r.useRef)(!1);async function M(e){if(e.preventDefault(),v(!0),k.length>0)return;h(!0);let t=await Promise.all(P.map(async e=>{let t=b[e];if((0,tw.isSystemEnv)(e))return{key:e,value:"",target:tS.EnvTarget.Production};if(!t){h(!1),g.error({text:`Missing value for environment variable "${e}"`});return}switch(t.type){case"text":return{key:e,value:t.value,target:tS.EnvTarget.Production};case"existing-edge-config":{let r=T?T[e]:void 0;try{let i=await (0,F.fetchAPI)(`${I.API_EDGE_CONFIG}/${t.edgeConfigId}/token${(0,B.encode)({teamId:m?.id})}`,{method:"POST",throwOnHTTPError:!0,body:{label:"web-app-token"}});r&&await (0,F.fetchAPI)(`${I.API_EDGE_CONFIG}/${t.edgeConfigId}/items${(0,B.encode)({teamId:m?.id})}`,{method:"PATCH",throwOnHTTPError:!0,body:{items:Object.entries(r).map(e=>{let[t,r]=e;return{operation:"upsert",key:t,value:r}})}});let a=`https://edge-config.vercel.com/${t.edgeConfigId}?token=${i.token}`;return{key:e,value:a,target:tS.EnvTarget.Production}}catch(r){let t=(0,S.normalizeError)(r);h(!1),"Not Found"===t.message?g.error({text:`Check the ${e} environment variable. It looks like it's connected to a deleted Edge Config.`,timeout:1e4}):g.error((0,S.errorToString)(r))}return}case"new-edge-config":{let r=T?T[e]:void 0;try{let i=await (0,F.fetchAPI)(`${I.API_EDGE_CONFIG}${(0,B.encode)({teamId:m?.id})}`,{method:"POST",throwOnHTTPError:!0,body:JSON.stringify({slug:t.edgeConfigName,items:r})}),a=await (0,F.fetchAPI)(`${I.API_EDGE_CONFIG}/${i.id}/token${(0,B.encode)({teamId:m?.id})}`,{method:"POST",throwOnHTTPError:!0,body:{label:"web-app-token"}}),n=`https://edge-config.vercel.com/${i.id}?token=${a.token}`;return{key:e,value:n,target:tS.EnvTarget.Production}}catch(e){h(!1),g.error((0,S.errorToString)(e));return}}default:return}}));if(!t.some(e=>void 0===e)){try{await tQ(c,t.filter(tX).map(e=>({...e,name:e.key,target:[tS.EnvTarget.Production,tS.EnvTarget.Preview,tS.EnvTarget.Development]})),m?.id)}catch(e){h(!1),g.error((0,S.errorToString)(e));return}p({type:"SET_STATUS",status:"configure-project-finished"}),h(!1)}}(0,r.useEffect)(()=>{R.current||w&&(0,r.startTransition)(()=>{N(e=>{let t={...e};for(let[e,r]of Object.entries(w))!t[e]&&P.includes(e)&&(t[e]={value:r,type:"text",error:!1});return t}),R.current=!0})},[R,w,N,P]);let O="deploying"===u||"configure-project-finished"===u,U=(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:P.map((e,i)=>(0,t.jsx)(r.default.Fragment,{children:(0,t.jsx)(tH,{showAuthSecretHelper:_(e),disableEnvName:!0,disabled:f||!x||O,edgeConfigData:T?T[e]:void 0,envName:e,envValue:b[e]??void 0,error:!!(y&&k.includes(e)),hideLabels:0!==i,projectName:c,setEnvValue:t=>{N(r=>({...r,[e]:t}))}},e)},e))}),$=f||O;return(0,t.jsxs)("form",{onSubmit:(0,eT.promiseToCallback)(M),children:[(0,t.jsxs)(t.Fragment,{children:[U,a?(0,t.jsxs)("p",{className:`text-copy-14 text-gray-900 ${tz.default.envDescription}`,style:{marginTop:"var(--geist-gap-half)"},children:[a," ",n?(0,t.jsx)(D.Link,{external:!0,href:n,type:"highlight",children:"Learn More"}):null]}):null]}),(0,t.jsx)(s.Spacer,{}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,t.jsx)(E.Button,{disabled:!x||$,loading:$,children:$?"Deploying…":"Deploy"})})]})}var tZ=e.i(9187364),t0=e.i(3495961),t1=e.i(1402674);e.i(2886798);var t2=e.i(7512194),t6=e.i(8922739),t3=e.i(5074599),t4=e.i(4325157);e.i(6887680);var t7=e.i(6810699);function t9(e){return"integration"===e.type?`${e.integration.id}_${e.product.id}`:e.type}function t5(e){let{integrations:t,config:r}=e,i=t.find(e=>e.slug===r.integrationSlug);if(!i)throw new t1.ProductsQueryValidationError(`Integration "${r.integrationSlug}" not found`);let a=i.products.find(e=>e.slug===r.productSlug);if(!a)throw new t1.ProductsQueryValidationError(`Product "${r.productSlug}" not found`);let n={...r,product:a,integration:i};return{...n,id:t9(n)}}function t8(e){return null!=e}let re=Symbol("all");var rt=e.i(6318858),rr=e.i(7429602),ri=e.i(3798983);e.i(5463680);var ra=e.i(7897830),rn=e.i(3703009),rs=e.i(9243747);e.i(553769);var rl=e.i(3758860);e.i(7037808);var ro=e.i(5098510);function rd(e){let{active:r,description:a,isBeta:n,config:s,Badge:l,Action:o,buttonType:d,onResourceCreated:c,onModalSucceeded:u,onClick:p}=e,{openCreateResource:m,openConnectProject:g}=(0,ra.useResourceModals)({onSuccess:u}),{store:f}=s;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(eB.Entity,{left:(0,t.jsx)("div",{className:"flex flex-col items-center justify-start flex-initial",children:(0,t.jsx)(rn.StoreIconOrAvatar,{color:r?"var(--ds-gray-900)":"var(--ds-gray-700)",disabled:s.isDisabled,icon:"integration"===s.type?s.product.iconUrl:void 0,size:"large",type:s.type,useColor:r})}),right:o??(s.isConnected?(0,t.jsx)(X.CheckCircle,{color:"gray-700",size:20}):(0,t.jsx)(E.Button,{"data-testid":(0,ey.tid)(`add-${s.type}`,"storage-clone"),disabled:!r||s.isDisabled,onClick:()=>{p?p():f?g(f):m(s,c)},type:d,size:"small",children:f?"Connect":"Add"})),children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsxs)("p",{className:(0,i.default)("text-heading-14",r?void 0:"text-gray-700"),children:[f?.name??("integration"===s.type?s.product.name:void 0)??`${ri.storeTitleFull[s.type]}`,(0,t.jsxs)("span",{className:"relative -top-px -mb-px ml-1 inline-flex",children:[n?(0,t.jsx)(rr.default,{muted:!r,size:"sm"}):null,l]})]}),a]})})})}function rc(e){let{config:i}=e,a=i.allowConnectExistingProduct,[n,s]=(0,r.useState)(!1),{openCreateResource:l,openConnectProject:o}=(0,ra.useResourceModals)({onSuccess:e.onModalSucceeded}),d=(0,rs.getIntegrationOps)({integration:i.integration}).isSingleProductLayout(),{data:c}=(0,t7.useResourceList)({integrationIdOrSlug:i.integrationSlug,skip:!a&&!d});d&&c?.stores.length&&(i.store=c.stores[0]);let u=!i.store&&c?.stores.length&&!d,p=(0,rl.getPrimaryProtocolByProduct)(e.config.product),[m,g]=(0,r.useState)(null),f=(0,t3.getResourceTitleByProduct)(e.config.product);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(rd,{Action:u?(0,t.jsx)(E.Button,{onClick:()=>s(!0),size:"small",typeName:"button",children:"Add"}):void 0,Badge:u?(0,t.jsxs)(q.Badge,{size:"sm",variant:"gray-subtle",children:["Existing ",t3.resourceTitlePlural[p]]}):void 0,...e}),(0,t.jsx)(ee.Modal.Modal,{active:n,onClickOutside:()=>{s(!1)},onAnimationDone:()=>g(null),children:m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ee.Modal.Body,{children:(0,t.jsxs)(ee.Modal.Header,{children:[(0,t.jsxs)(ee.Modal.Title,{children:["Connect existing ",f]}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsx)(ee.Modal.Subtitle,{children:t3.templates.getExistingResourceAcknowledgeMessage({product:e.config.product,name:m.name})}),m.projectsMetadata.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"text-copy-14",children:["The ",f," is already connected to the following projects"]}),(0,t.jsx)(ro.ProjectConnectionsListInModal,{className:"border-x-0 border-t-0",connections:m.projectsMetadata})]}):null,(0,t.jsx)(eh.Note,{fill:!0,size:"small",type:"warning",children:t3.templates.getExistingResourceAcknowledgeWarning({product:e.config.product,name:m.name})})]})]})}),(0,t.jsxs)(ee.Modal.Actions,{children:[(0,t.jsx)(ee.Modal.Action,{onClick:()=>g(null),type:"secondary",children:"Back"}),(0,t.jsx)(ee.Modal.Action,{onClick:()=>{s(!1),o(m)},children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-1.5 flex-initial",children:[(0,t.jsx)(rt.Check,{size:16})," Acknowledge and Continue"]})})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(ee.Modal.Body,{children:[(0,t.jsxs)(ee.Modal.Header,{children:[(0,t.jsxs)(ee.Modal.Title,{children:["Add ",f]}),(0,t.jsx)(ee.Modal.Subtitle,{children:(0,t.jsx)("p",{className:"text-copy-14",children:t3.templates.getExistingResourceModalSubtitle(e.config.product)})})]}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:(0,t.jsxs)(eB.Entity.List,{className:"[box-shadow:var(--ds-shadow-border)]",children:[(0,t.jsx)(rd,{...e,onClick:()=>{s(!1),l(i,e.onResourceCreated)}}),c?.stores.map(a=>{let n=t3.templates.getExistingResourceWarning(e.config.product);return(0,r.createElement)(rd,{...e,Badge:n?(0,t.jsx)(Y.Tooltip,{center:!1,text:n,children:(0,t.jsxs)(q.Badge,{variant:"amber-subtle",size:"sm",children:[(0,t.jsx)(tI.Warning,{size:12})," Existing ",f]})}):void 0,buttonType:"secondary",config:{...i,store:a},key:a.id,onClick:()=>{g(a)}})})]})})]}),(0,t.jsx)(ee.Modal.Actions,{children:(0,t.jsx)(ee.Modal.Action,{onClick:()=>s(!1),type:"secondary",children:"Cancel"})})]})})]})}function ru(){return(0,t.jsx)(eB.Entity,{left:(0,t.jsx)("div",{className:"flex flex-col items-center justify-start flex-initial",children:(0,t.jsx)(f.Skeleton,{height:36,rounded:!0,width:36})}),right:(0,t.jsx)(f.Skeleton,{height:20,width:100}),children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsx)(f.Skeleton,{height:20,width:170}),(0,t.jsx)(f.Skeleton,{height:20,width:190})]})})}function rp(e){let{hasIntegrations:i}=e,{hasEnvs:a,products:n}=function(){let[{stores:e,products:t,env:r}]=(0,G.default)(),i=(0,t1.parseTemplateProductsQuery)(t??e),a=new Map;return{hasEnvs:!!r,products:i?.reduce((e,t)=>{if("integration"===t.type){let r=t.protocol??"storage",i=e.get(r);return i?e.set(r,[...i,t]):e.set(r,[t])}return e.set("storage",[...e.get("storage")??[],t]),e},a)??a}}(),[s,l]=(0,r.useState)([]),{dispatch:o}=(0,Q.useProjectCloneContext)();return(0,r.useEffect)(()=>{s.length&&s.length===n.size&&(i?o({type:"SET_STATUS",status:"installing-integrations-started"}):a?o({type:"SET_STATUS",status:"configure-project"}):o({type:"SET_STATUS",status:"add-storage-finished"}))},[o,a,i,s.length,n.size]),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-8 flex-initial w-full",children:Array.from(n.entries()).map(e=>{let[r,i]=e;return(0,t.jsx)(rm,{onInstalled:()=>l(Array.from(new Set([...s,r]))),products:i,protocol:r},r)})})}function rm(e){let{protocol:a,products:n,onInstalled:s}=e,{updateStore:l,groupedStoreConfigs:o}=function(e,t,i){let a=(0,C.useToasts)(),{team:n}=(0,d.useTeam)(),{data:s}=(0,t4.useMarketplaceIntegrations)({protocolType:t}),{data:l}=(0,t7.useResourceList)({protocolType:t,skip:"storage"!==t}),[o,c]=(0,r.useState)(null),[u,p]=(0,r.useState)({}),m=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(e&&s&&(l??"storage"!==t)&&n&&m.current!==n.slug)try{let t=e?.flatMap(e=>{let t=e.type;switch(t){case"integration":if("integrationSlug"in e&&"productSlug"in e)return t5({integrations:s,config:e});return s.flatMap(t=>t.products.filter(t=>t.tags.includes(e.group)).map(r=>({type:"integration",group:e.group,integrationSlug:t.slug,productSlug:r.slug,product:r,integration:t,id:t9({type:"integration",product:r,integration:t})})));case"postgres":return t5({integrations:s,config:{type:"integration",integrationSlug:"neon",productSlug:"neon"}});case"kv":return t5({integrations:s,config:{type:"integration",integrationSlug:"upstash",productSlug:"upstash-kv"}});case"blob":return{...e,type:"blob",id:"blob"};default:throw new t1.ProductsQueryValidationError(`Config type "${t}" not valid`)}}).filter(t8)??[];c(t),m.current=n.slug}catch(e){e instanceof t1.ProductsQueryValidationError&&(a.error(e.message),c([]),m.current=n.slug)}},[e,s,l,n,a,t]);let g=(0,r.useCallback)(e=>t=>{var r,a;if(!o||"edge-config"===t.type)return;let n={configs:o.map(r=>{let i=t9(r);return i===("integration"===t.type?`${t.product.integration.id}_${t.product.id}`:t.type)?(r.group&&(u[r.group]=i),{...r,store:t,isConnected:e}):r}).map(e=>({...e,isDisabled:e.isDisabled||!!(e.group&&u[e.group]&&u[e.group]!==t9(e))})),groups:u};c(n.configs),p(n.groups),r=n.configs,a=n.groups,r&&r.every(e=>!!e.group&&!!a[e.group]&&a[e.group]!==t9(e)||!!e.isConnected)&&i()},[o,u,i]),f=(0,r.useMemo)(()=>{let e=o?.reduce((e,t)=>{let r=t.group??re,i=e.get(r);return i?i.push(t):e.set(r,[t]),e},new Map);return e?Array.from(e.entries()):null},[o]);return{storeConfigurations:o,isReady:!!o,updateStore:g,groupedStoreConfigs:f,neonIntegration:s?.find(e=>"neon"===e.slug)}}(n,a,s),c=(0,r.useRef)({}),u=(0,r.useCallback)(e=>{c.current[e.id]||(c.current[e.id]=!0,l(!0)(e))},[l]),{active:p}=(0,L.useCardContext)(),{title:m,description:g}=t3.templates.addProduct(a);return(0,t.jsx)(t2.ResourceModalsProviderBase,{Modal:(0,t.jsx)(t6.CreateStoreModal,{}),protocolType:a,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("p",{className:"text-[20px] leading-[24px] tracking-[-0.33px] font-medium",children:m}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:g}),o?o.map(e=>{let[r,a]=e;return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[r===re?(0,t.jsx)("p",{className:(0,i.default)("text-copy-14",p?"text-gray-1000":"text-gray-700"),children:"Install all the mandatory products"}):(0,t.jsx)("p",{className:(0,i.default)("text-copy-14",p?"text-gray-1000":"text-gray-700"),children:`Install one "${r}" store`}),(0,t.jsx)(eB.Entity.List,{className:"[box-shadow:var(--ds-shadow-border)]",children:a.map(e=>{let r=`AddProductEntity_${e.id}`;switch(e.type){case"blob":return(0,t.jsx)(rd,{active:p,config:e,description:(0,t.jsx)("p",{className:(0,i.default)("text-copy-14",p?"text-gray-1000":"text-gray-700"),children:"Powered by Vercel."}),onModalSucceeded:l(!0),onResourceCreated:l(!1)},r);case"integration":return(0,t.jsx)(rc,{active:p,config:e,description:(0,t.jsx)("p",{className:(0,i.default)("text-copy-14",p?"text-gray-1000":"text-gray-700"),children:e.product.shortDescription}),onModalSucceeded:u,onResourceCreated:l(!1)},r);default:return null}})})]},r===re?"all":r)}):(0,t.jsx)(ru,{})]})})}var rg=e.i(1315623),rf=e.i(6979900);function rh(){let{cloneRepoStatus:e}=(0,Q.useProjectCloneContext)(),t="started"===e,i="finished"===e,a="error"===e;return(0,r.useMemo)(()=>({isCloningStarted:t,isCloningFinished:i,isCloningError:a}),[a,i,t])}var rx=e.i(3207250);function ry(){let{"integration-ids":e}=(0,n.useRouter)().query;return(0,r.useMemo)(()=>"string"==typeof e?e.split(","):[],[e])}var rj=e.i(9171423),rv=e.i(316263),r_=e.i(7780974),rT=e.i(2573600),rS=e.i(8761240),rw=e.i(5044530),rE=e.i(9668517),rC=e.i(7218483),rb=e.i(7712782),rN=e.i(4787991),rI=e.i(6625227),rP=e.i(2695633),rk=e.i(6060673),rA=e.i(2689512),rR=e.i(8490110);function rM(e){let{active:i}=e,a=(0,n.useRouter)(),s=(0,rN.useNewProjectLink)(),{projects:d,repo:c}=(0,Q.useProjectCloneContext)(),{isMonorepo:u}=tg(),[p,m]=(0,r.useState)([]),g=(0,r.useCallback)(()=>{let e=(0,rT.stringify)({"flow-id":"clone",deploymentIds:d?.map(e=>e.deploymentId).join(","),projectNames:d?.map(e=>e.name).join(","),..."1"===a.query.microfrontends?{microfrontends:"1"}:{}});a.push(`${s}/success/monorepo?${e}`)},[a,s,d]),f=(0,r.useCallback)(e=>{if(p.includes(e))return;l.analytics.track(o.AnalyticsEvent.PROJECT_CREATION_SUCCESS,{version:3,flow:"clone"});let t=[...p,e];m(t=>[...t,e]),d?.length&&d.every(e=>e.id&&t.includes(e.id))&&g()},[l.analytics,d,p,m,g]);if(!u||!d?.length)return null;let h=d[0]?.deploymentId;return(0,t.jsx)(L.default,{active:i,title:"Cloning Projects",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 h-[96px] relative",children:[(0,t.jsx)("div",{className:rR.default.pulse}),(0,t.jsx)("div",{className:rR.default.pulse}),(0,t.jsx)("div",{className:rR.default.pulse}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("div",{className:"relative w-16 h-16 bg-white rounded-full border border-gray-200 drop-shadow-md flex items-center justify-center",children:(0,t.jsx)(r$,{provider:c.gitType})})})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:["Creating ",d.length," project",d.length>1?"s":""," ","from this repository..."]}),(0,t.jsx)(eB.Entity.List,{children:d.map(e=>(0,t.jsx)(rO,{clonedProject:e,setProjectComplete:f},e.id??e.name))})]}),(0,t.jsx)(rG,{deploymentId:h})]})})}function rO(e){let{clonedProject:r,setProjectComplete:i}=e,{deploymentId:a,id:n,name:s,error:l,directory:o}=r,d=(0,rE.useTeamSlug)(),{data:c}=(0,rk.useProject)(n);return(0,t.jsx)(eB.Entity,{left:c?(0,t.jsx)(rA.ProjectAvatar,{project:c,size:32}):null,right:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(rL,{deploymentId:a,projectName:s,setProjectComplete:i,teamSlug:d})}),children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[n?(0,t.jsx)(D.Link,{className:"self-start font-semibold",href:`/${d}/${s}`,tab:!0,variant:"underline",children:(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:s})}):s,l?null:(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:o}),l?(0,t.jsx)("p",{className:"text-label-12 text-red-900",children:l}):null]})},`${s}`)}function rL(e){let{deploymentId:i,projectName:a,setProjectComplete:n,teamSlug:s}=e,{data:l}=(0,rI.default)(i,{refreshInterval:1e3}),o=(0,rC.useAgo)(l?.buildingAt,{justNowThreshold:0,suffix:""}),d=l?.ready?(0,rb.ago)(l.ready-l.buildingAt,{justNowThreshold:0,suffix:""}):null;(0,r.useEffect)(()=>{l?.readyState==="READY"&&n(l.projectId)},[l,n]);let c=(0,r.useMemo)(()=>{let e=(0,t.jsx)(rU,{className:"text-gray-900",size:20});if(!l)return e;switch(l.readyState){case"QUEUED":default:return e;case"READY":return(0,t.jsx)(rS.CheckCircleFill,{color:"blue-900",size:20});case"ERROR":return(0,t.jsx)(eo.Cross,{size:20,color:"red-700"});case"CANCELED":return(0,t.jsx)(rw.StopCircle,{size:20});case"BUILDING":return(0,t.jsx)(tk.Spinner,{size:20})}},[l]);return(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-4 flex-initial",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[l?.buildingAt&&"QUEUED"!==l.readyState?(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:d||o}):null,c]}),(0,t.jsx)(D.ButtonLink,{href:`/${s}/${a}/${i}`,size:"small",tab:!0,type:"secondary",children:"Inspect"})]})}function rG(e){let r,{deploymentId:i}=e,{data:a}=(0,rI.default)(i);return a&&(a?.meta?.githubDeployment?r=(0,rP.getGithubMetaInfo)(a.meta):a?.meta?.gitlabDeployment?r=(0,rP.getGitlabMetaInfo)(a.meta):a?.meta?.bitbucketDeployment&&(r=(0,rP.getBitbucketMetaInfo)(a.meta)),r)?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(D.Link,{external:!0,href:r.commitUrl}),(0,t.jsxs)("span",{className:"text-copy-14 text-gray-900",title:r.commitMessage,children:[r.commitMessage.split("\n")[0]," - ",r.sha.slice(0,6)]})]}):null}function rU(e){let{size:r=16,className:i}=e;return(0,t.jsx)("svg",{className:i,fill:"none",height:r,viewBox:"0 0 16 16",width:r,xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("circle",{cx:"8",cy:"8",r:"7",stroke:"currentColor",strokeWidth:"1"})})}function r$(e){return"github"===e.provider||"gitlab"===e.provider||"bitbucket"===e.provider?(0,t.jsx)(ed.default,{gitType:e.provider,height:26,width:26}):null}function rD(e){let a,{hasAccess:s,frameworks:l}=e;(0,t0.useShouldRedirectToNew)();let{user:o}=(0,c.useUser)(),u=!!o,{team:p}=(0,d.useTeam)(),[m,g]=(0,r.useState)([]),T=(0,n.useRouter)(),{"integration-ids":E,"skippable-integrations":b,env:N,stores:I,products:P}=T.query,k=P??I,{status:A,repo:R,projectId:M,deploymentId:O,dispatch:G,cloneRepoStatus:$,deploymentReset:D,flowId:B,microfrontendsGroupId:F,isMonorepo:V}=(0,Q.useProjectCloneContext)(),H=(0,ez.useGitInputStore)(e=>e.setIsTeamRepo),W=(0,j.useRepoQuery)(),[q,Y]=(0,r.useState)(null),X=(0,r.useRef)(null),K=(0,r.useRef)(null),Z=(0,r.useRef)(null),ee=(0,r.useRef)(null);(0,r.useEffect)(()=>()=>{G({type:"RESET"})},[G]),(0,r.useEffect)(()=>{H("team"===R.ownerType)},[R.ownerType,H]);let et=ry(),er=et.length>0,ei=(a=(0,w.useSearchParams)(),a?.get("external-id")??void 0),ea=(0,r.useRef)(!1),{isCloningError:en,isCloningFinished:es,isCloningStarted:eo}=rh(),ed=(0,r.useMemo)(()=>{if(en)return"An unexpected error occurred. Our team has already been notified and are working to resolve the issue, please try again shortly."},[en]),ec=(0,r.useMemo)(()=>[eo,es,en].some(e=>e),[en,es,eo]),{isVercelTutor:ep,clonedFrom:em}=(0,td.useCloneTrackBaseParams)();(0,rv.useTrackPageViewCustomActivityIgnoreQueryParams)(!!B,r_.VercelActivityAction.NewProjectCloneViewed,{isVercelTutor:ep,clonedFrom:em,flowId:B,hasStorage:!!k,hasIntegrations:!!er,hasEnvironmentVariables:!!N}),(0,td.useCloneTrackStatusChanges)(),(0,r.useEffect)(()=>{let e=R.gitType??"github",t=R.namespace&&(eo||es)?`${R.namespace}/${R.name}`:null;e&&em&&t&&!ea.current&&((0,x.runStreamInternal)(y.Topic.VercelTemplatesV0TemplateClonedSimple,{user_id:o?.uid,from:em,to:t,is_successful:!ed}).catch(()=>null),ea.current=!0)},[em,ed,es,eo,W,R,o?.uid]);let eg=(0,t.jsxs)(f.Skeleton,{show:!T.isReady||!s,children:["Integrations let you connect your ",h.PRODUCT," Project with third-party services."," ",b?(0,t.jsx)(t.Fragment,{children:"One of the following can be used with"}):(0,t.jsx)(t.Fragment,{children:"The following are required for"})," ",(0,t.jsx)(tT,{framework:q,children:W?.fullName}),":"]}),ef=N||er||k;!function(e){let t=(0,j.useRepoQuery)(),i=(0,w.useSearchParams)(),{data:a}=(0,tl.useRepoIfGitVerified)({provider:t?.type,owner:t?.owner,name:t?.name,customGitHost:t?.host}),n=i?.get("root-directory")??void 0,{data:s}=(0,rx.default)((0,ts.default)(t,a?.defaultBranch,n));(0,r.useEffect)(()=>{s&&e(s.framework)},[s])}(Y),function(){let{isCloningFinished:e}=rh(),t=ry(),i=(0,n.useRouter)(),{team:a}=(0,d.useTeam)(),{status:s,repo:l,projectName:o,clonedRepo:u,dispatch:p}=(0,Q.useProjectCloneContext)(),{env:m}=i.query,g=(0,C.useToasts)(),{data:f}=(0,U.default)({provider:l.gitType}),{user:h}=(0,c.useUser)(),{templateSlug:x,isTemplate:y}=(0,td.useCloneTrackBaseParams)(),v=(0,j.useRepoQuery)(),{data:_}=(0,tl.useRepoIfGitVerified)({provider:v?.type,owner:v?.owner,name:v?.name,customGitHost:v?.host});(0,r.useEffect)(()=>{("add-storage-finished"===s&&e&&!m&&!t.length||"installing-integrations-finished"===s&&e&&!m||"configure-project-finished"===s&&e)&&(0,eT.promiseToCallback)(async()=>{let e;if(!l.gitType)return void g.error("Could not find repository type.");p({type:"SET_DEPLOYMENT_RESET",deploymentReset:!1}),p({type:"SET_STATUS",status:"deploying"}),y&&x&&(e={templateSlug:x}),v?.template&&_?.sha&&(e={...e??{},templateUrl:v.url,templateSha:_.sha});try{let t=await z({teamId:a?.id,projectName:o,type:l.gitType,repoId:u.id,owner:l.namespace,repo:l.name,source:"clone/repo",meta:e});t.id&&(p({type:"SET_DEPLOYMENT_ID",deploymentId:t.id}),(0,eT.promiseToCallback)(J)({gitNamespaces:f,currentNamespace:l.namespace,scopeId:a?.id||h?.uid}))}catch(e){g.error((0,S.errorToString)(e))}})()},[s,e,p,l,g,a,o,u,m,f,h,t.length,x,y,v,_?.sha])}();let eh=!!(s&&ec&&("deploying"===A||!ef)),ex="not-started"!==$,[ey,ej]=(0,r.useState)(void 0);!function(e){let{deploymentId:t,isVercelTutor:i,projectId:a,teamId:n,setVercelTutorPrUrl:s}=e,[l,o]=(0,r.useState)(!1);(0,r.useEffect)(()=>{i&&!l&&a&&n&&t&&(0,rj.fetchApi)(`/api/v1/integrations/github/update-vercel-tutor-template/${a}?teamId=${n}`,{method:"POST",body:{stepName:"smaller-triangle"}}).then(e=>{"string"!=typeof e&&e?.prUrl&&s(e.prUrl)}).finally(()=>{o(!0)})},[a,n,t,i,l,s])}({deploymentId:O,isVercelTutor:ep,projectId:M,teamId:p?.id,setVercelTutorPrUrl:ej}),(0,_.useTrackStatsigEvent)({eventName:`new_clone_${A.replaceAll("-","_")}`,...W?.template?{metadata:{template:W.template,...ep?{is_vercel_tutor:"true"}:{}}}:{}});let ev=(0,r.useCallback)(()=>{N&&(G({type:"SET_DEPLOYMENT_RESET",deploymentReset:!0}),G({type:"SET_STATUS",status:"configure-project"}))},[N,G]),e_="deploying"===A||"configure-project"===A&&D,eS=V&&ex,ew=eS&&"deploying"===A,eE=(0,r.useMemo)(()=>(0,t.jsx)(eu,{error:ed,from:W?`${W.owner}/${W.name}${W.subdir?`/${W.subdir}`:""}`:null,provider:R.gitType||"github",to:R.namespace&&(eo||es)?`${R.namespace}/${R.name}`:null}),[ed,W,R.gitType,R.namespace,R.name,eo,es]);return(0,t.jsxs)("div",{className:"flex flex-col gap-y-6 md:gap-y-12",children:[(0,t.jsx)(L.default,{active:!0,className:"create-git-repository",compressCardOnMobile:!0,title:"New Project",titleDisabled:"Please Log in or Sign up to continue.",children:(0,t.jsx)(tv,{frameworks:l,hasAccess:s,initialGitType:o?.importFlowGitProvider==="github-limited"?void 0:o?.importFlowGitProvider,isVercelTutor:ep})}),u?(0,t.jsx)(L.default,{active:!!(s&&("add-storage-started"===A||"add-storage-finished"===A||"deploying"===A)),className:(0,i.clsx)(v.default.addStorage,{[v.default.showAddStorage]:!!k&&ex,[v.default.maybeShowAddStorage]:!T.isReady}),compressCardOnMobile:!0,ref:X,title:"Add Products",titleDisabled:"Complete the Create a Repository step to continue.",children:(0,t.jsx)(rp,{hasIntegrations:!!et.length})}):null,(0,t.jsx)(L.default,{active:!!(s&&("installing-integrations-started"===A||b&&("installing-integrations-finished"===A||"deploying"===A))),className:(0,i.clsx)(v.default.integrations,{[v.default.showIntegrations]:!!E&&ex,[v.default.maybeShowIntegrations]:!T.isReady}),compressCardOnMobile:!0,ref:K,subtitle:eg,title:"Add Integrations",titleDisabled:"Complete the Create a Repository step to continue.",children:(0,t.jsx)(el,{deploymentId:O,externalId:ei,installationIds:m,integrationIds:et,onInstall:e=>{g(t=>[...t,e])},projectId:M})}),u?(0,t.jsx)(L.default,{active:!!(s&&("configure-project"===A||"configure-project-finished"===A||"deploying"===A)),className:(0,i.clsx)(v.default.configureProject,{[v.default.showConfigureProject]:!!N&&ex,[v.default.maybeShowConfigureProject]:!T.isReady}),compressCardOnMobile:!0,ref:Z,subtitle:"Provide values for the required Environment Variables.",title:"Add Environment Variables",titleDisabled:0===et.length?k?"Complete the Add Products step to continue.":"Complete the Create a Repository step to continue.":"Complete the Integrations step to continue.",children:(0,t.jsx)(tK,{})}):null,eS&&!ew?(0,t.jsx)(L.default,{active:!0,subtitle:"Preparing Git Repository…",title:"Cloning Projects",children:eE}):null,ew?(0,t.jsx)(rM,{active:s}):null,e_||!ex||V?null:(0,t.jsx)(t.Fragment,{children:eh?(0,t.jsx)(L.default,{active:eh,ref:ee,subtitle:"Preparing Git Repository…",title:"Deployment",children:eE}):(0,t.jsx)(rg.DeploymentPlaceholderCard,{})}),e_&&!V?(0,t.jsx)(tZ.default,{active:s,deploymentId:O,flow:"clone",isVercelTutor:ep,vercelTutorPrUrl:ey,clonedFrom:em,resetDeploying:ev,flowId:B,microfrontendsGroupId:F}):null,(0,t.jsx)(rf.ImportFooter,{})]})}var rB=e.i(7526087);function rF(e,i){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=e.map(e=>`url.searchParams.get('${e}')`).join(" && "),l=(0,n.useRouter)();return(0,r.useEffect)(()=>{if(l.isReady&&a.monitorChanges)try{e.every(e=>!!l.query[e])?document.documentElement.classList.add(i):document.documentElement.classList.remove(i)}catch(e){}},[a.monitorChanges,l.query,l.isReady]),(0,r.useMemo)(()=>(0,t.jsx)(rB.default,{children:(0,t.jsx)("script",{dangerouslySetInnerHTML:{__html:`;(function(){
            try{
              var url = new URL(window.location.href)
              if(${s}) { document.documentElement.classList.add("${i}") }
            }catch(err){}
          })()`}})}),[s,i])}var rV=e.i(6016088),rH=e.i(1459027),rz=e.i(426021);function rJ(e){let{frameworks:i}=e,[s,f]=(0,Q.useProjectCloneReducer)(),h=(0,n.useRouter)(),{isLoading:x,isLoggedOut:y,user:j}=(0,c.useUser)(),{team:v}=(0,d.useTeam)(),{can:_,isLoading:T}=(0,u.default)();(0,r.useEffect)(()=>{(0,g.isAuthenticationRequired)(j)&&(0,g.requireAuthentication)({slug:j?.username,push:e=>h.push(e)})},[j,h]);let S=_(p.Action.Create,p.Resource.Project),{template:w}=h.query,E=!!(!x&&!y&&!T)&&!S,C=(0,r.useRef)(!1);(0,r.useEffect)(()=>{!s.projectId||C.current||(C.current=!0,a.default.get("visitor-id")&&(0,m.postToStatsigClient)({events:[{eventName:"project_created"}]}))},[s.projectId,v?.billing?.plan,v?.id,j?.uid]),(0,r.useEffect)(()=>{"deploying"===s.status&&w&&l.analytics.track(o.AnalyticsEvent.TEMPLATE_CLONE,{template_slug:w.toString()})},[s.status,w]);let b=function(e,i){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,r.useMemo)(()=>(0,t.jsx)(rB.default,{children:(0,t.jsx)("script",{dangerouslySetInnerHTML:{__html:`;(function(){try{
if(document.cookie && document.cookie.indexOf('${e}=${a}') > -1) {
document.documentElement.classList.add("${i}") }
}catch(err){}})()`}})}),[e,i,a])}("isLoggedIn","hide-get-started","1"),N=rF(["integration-ids"],"show-integrations"),I=rF(["storage"],"show-add-storage"),P=rF(["env"],"show-configure-project"),k=rF(["skippable-integrations"],"show-skippable-integrations"),[A,R]=(0,rV.useMultiSwitcherState)(),M=(0,r.useMemo)(()=>s.projectId?{openModalSwitchConfirm:A}:null,[A,s.projectId]),O=(0,r.useMemo)(()=>({...s,dispatch:f}),[f,s]);return(0,t.jsxs)(rV.CloneContext.Provider,{value:M,children:[(0,t.jsx)(rV.MultiSwitcherConfirmModal,{active:R.active,callback:R.callback,onAnimationDone:R.onAnimationDone,onClickOutside:R.onClickOutside,teamName:v?.name},R.key),b,N,I,P,k,(0,t.jsx)(rH.TrackStatsigPageView,{name:"new_clone"}),(0,t.jsx)(Q.ProjectCloneContext.Provider,{value:O,children:(0,t.jsx)(rQ,{frameworks:i,shouldDenyAccess:E})})]})}function rQ(e){let{shouldDenyAccess:r,frameworks:a}=e;return(0,t.jsxs)("div",{className:(0,i.clsx)(rz.default.cloneMain,rz.default.newMain),children:[(0,t.jsx)("div",{className:(0,i.clsx)("flex flex-col lg:flex-row items-stretch justify-start gap-9 lg:gap-[72px] flex-initial geist-wrapper",rz.default.newMainWrapper),children:(0,t.jsx)("div",{className:(0,i.clsx)(rz.default.mainContent,rz.default.newMainContent),children:(0,t.jsx)(rD,{frameworks:a,hasAccess:!r})})}),(0,t.jsx)(s.Spacer,{className:"geist-show-on-tablet",y:2}),(0,t.jsx)(s.Spacer,{className:"geist-hide-on-tablet",y:4})]})}e.s(["DynamicPage",()=>rJ,"StaticPageContent",()=>rQ],3706649)}]);

//# debugId=ae8710a8-1eb1-b520-5e59-922feccc6c4e
//# sourceMappingURL=c3ff5ffc304d2b51.js.map
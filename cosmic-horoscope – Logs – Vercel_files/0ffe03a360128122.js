;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="eaec803b-eb7c-cf42-d971-fc16debbe493")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3245331,e=>{"use strict";var t=e.i(8711407);e.s(["default",0,function(e){return(0,t.jsx)("form",{...e,onKeyDown:e=>{if("Enter"===e.key&&e.metaKey){let t=e.target;t.form&&t.form.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))}},onSubmit:t=>{t.preventDefault(),e.onSubmit?.(t)}})}])},4089015,e=>{"use strict";var t=e.i(8042625),n=e.i(277234),a=e.i(4244280),r=e.i(5927860);async function i(e){let{projectId:i,kvs:s,target:l,type:o=r.EnvType.Encrypted,teamId:d,applyToAllCustomEnvironments:c}=e;return(0,n.fetchAPI)(`${a.API_SHARED_ENV_VARIABLES}${(0,t.encode)({teamId:d})}`,{method:"POST",body:JSON.stringify({evs:s,projectId:i,target:l,type:o,applyToAllCustomEnvironments:c}),throwOnHTTPError:!0})}e.s(["addSharedEnvs",()=>i])},4171299,e=>{"use strict";var t=e.i(8042625),n=e.i(277234),a=e.i(4244280),r=e.i(1080700);async function i(e){let{envVar:i,teamId:s,payload:l,applyToAllCustomEnvironments:o}=e,d={};return i.key!==l.key&&(d.key=l.key),i.value!==l.value&&(d.value=l.value),(0,r.arraysEqual)(i.target.sort(),l.target.sort())||(d.target=[...l.target]),l.projectIdUpdates&&(d.projectIdUpdates=l.projectIdUpdates),void 0!==l.comment&&(d.comment=l.comment),void 0!==o&&(d.applyToAllCustomEnvironments=o),(0,n.fetchAPI)(`${a.API_SHARED_ENV_VARIABLES}${(0,t.encode)({teamId:s})}`,{method:"PATCH",body:JSON.stringify({updates:{[i.id]:d}}),throwOnHTTPError:!0})}async function s(e){let{envVar:r,projectId:i,teamId:s}=e,l=`${a.API_SHARED_ENV_VARIABLES}/${r.id}/unlink/${i}${(0,t.encode)({teamId:s})}`;await (0,n.fetchAPI)(l,{method:"PATCH",throwOnHTTPError:!0,body:{}})}async function l(e){let{envVars:r,projectId:i,teamId:s}=e,l={};r.forEach(e=>{if(e.projectId.includes(i))throw Error("Project already added to env var");l[e.id]={projectIdUpdates:{link:[i],unlink:[]}},e.applyToAllCustomEnvironments&&(l[e.id].applyToAllCustomEnvironments=e.applyToAllCustomEnvironments)}),await (0,n.fetchAPI)(`${a.API_SHARED_ENV_VARIABLES}${(0,t.encode)({teamId:s})}`,{method:"PATCH",body:JSON.stringify({updates:l}),throwOnHTTPError:!0})}e.s(["addProjectToSharedEnvVars",()=>l,"removeProjectFromSharedEnvVar",()=>s,"updateSharedEnvVar",()=>i])},5601055,e=>{"use strict";var t=e.i(8711407),n=e.i(1176592),a=e.i(1821888),r=e.i(2504781),i=e.i(3869281),s=e.i(8735244),l=e.i(5468328),o=e.i(3753138),d=e.i(4482823),c=e.i(2560270),u=e.i(4345845),m=e.i(2634426),v=e.i(5756088),p=e.i(6107899),h=e.i(3394346),x=e.i(9722978),f=e.i(1114103),y=e.i(8436238),g=e.i(5166685),j=e.i(7713873),b=e.i(5927860),E=e.i(4004502),_=e.i(1138941),S=e.i(7957424),C=e.i(1516738),k=e.i(2928617),w=e.i(6060673);let T=(0,j.brandCustomEnvId)("applyToAllCustomEnvironments");function N(e){let{canCreateProductionEnvVars:n,disabled:l=!1,onChange:o,selectedEnvironmentIds:u=new Set([j.PreviewEnvironment.id,j.DevelopmentEnvironment.id]),isPreviewEnvironment:m,disableDevelopmentEnvironment:v}=e,p=(0,_.useProjectIdOrName)(),h=""===p,{isLoading:x,isAllPreProductionEnvironmentsIndeterminate:f,isAllPreProductionEnvironmentsSelected:y,preProductionEnvironmentIds:g,hasCustomEnvironments:b,customEnvironments:E,label:S,icon:C}=A({selectedEnvironmentIds:u,isPreviewEnvironment:m}),{data:N}=(0,w.useProject)(m?p:void 0),{data:L=[]}=(0,k.useProjectBranches)(m?N?.id:void 0),V=e=>t=>{if(m)o([e]);else{let n=new Set(u);return t?n.add(e):n.delete(e),o(Array.from(n)),n}};return(0,t.jsxs)(a.Root,{children:[(0,t.jsx)(a.Trigger,{asChild:!0,children:(0,t.jsx)(r.Button,{className:"group !justify-between !pl-0 !font-normal",disabled:l,name:"add-form-environments-picker",suffix:(0,t.jsx)(c.ChevronDown,{}),type:"secondary",typeName:"button",width:"100%",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial -ml-1.5 h-10",children:[(0,t.jsx)("span",{className:"-my-4 grid size-10 shrink-0 place-items-center rounded-l border-r bg-background-200 group-disabled:bg-gray-100",children:x?(0,t.jsx)(s.Spinner,{}):C}),(0,t.jsx)("span",{className:"block w-full gap-2 overflow-hidden text-ellipsis text-gray-1000 ",children:S})]})})}),(0,t.jsx)(a.Portal,{children:(0,t.jsx)("div",{className:"tailwind-preflight",children:(0,t.jsxs)(a.Content,{className:"flex max-h-[calc(var(--radix-popover-content-available-height)-32px)] w-[var(--radix-popover-trigger-width)] flex-col gap-px overflow-auto rounded-lg bg-background-100 p-2 shadow-md",sideOffset:5,children:[!m&&(0,t.jsx)(I,{enabled:u.has(j.ProductionEnvironment.id),env:j.ProductionEnvironment,disabled:n?void 0:"missingPermission",name:"add-form-production",onChange:e=>{V(j.ProductionEnvironment.id)(e)},testId:"production-checkbox"}),(b||h)&&!m?(0,t.jsxs)("label",{className:"group flex h-9 shrink-0 select-none items-center justify-between rounded bg-background-100 px-2 py-[6px] text-gray-1000 transition-colors hover:cursor-pointer hover:bg-gray-alpha-300 focus-visible:bg-gray-alpha-300",children:[(0,t.jsx)("span",{className:"text-[12px] leading-[16px] font-medium text-gray-900 transition-colors group-hover:!text-gray-1000",children:"Pre-Production Environments"}),(0,t.jsx)(i.Checkbox,{checked:f?y:void 0,indeterminate:!f||void 0,onChange:e=>{let t=new Set(u);g.forEach(n=>{e.target.checked?t.add(n):t.delete(n)}),o(Array.from(t))}})]}):null,(0,t.jsx)(I,{customLabel:"Preview",enabled:u.has(j.PreviewEnvironment.id),env:j.PreviewEnvironment,hideCheckbox:m,name:"add-form-preview",onChange:e=>{V(j.PreviewEnvironment.id)(e)},testId:"preview-checkbox"}),h||m?null:(0,t.jsx)(t.Fragment,{children:E.sort((e,t)=>e.slug.localeCompare(t.slug)).map(e=>(0,t.jsx)(I,{enabled:u.has(e.id),env:e,name:`add-form-custom-environment-${e.slug}`,onChange:t=>{V(e.id)(t)},testId:e.slug},e.id))}),m?(0,t.jsx)(t.Fragment,{children:L.sort((e,t)=>e.ref.localeCompare(t.ref)).filter(e=>e.ref!==N?.link?.productionBranch).map(e=>(0,t.jsx)(P,{branch:e,enabled:u.has((0,j.brandCustomEnvId)(e.ref)),onChange:t=>{V((0,j.brandCustomEnvId)(e.ref))(t)}},e.ref))}):null,!m&&(0,t.jsx)(I,{enabled:u.has(j.DevelopmentEnvironment.id),env:j.DevelopmentEnvironment,disabled:v?"sensitive":void 0,name:"add-form-development",onChange:e=>{V(j.DevelopmentEnvironment.id)(e)},testId:"development-checkbox"}),h?(0,t.jsxs)("label",{className:"flex h-9 shrink-0 select-none items-center justify-between rounded bg-background-100 px-2 py-[6px] text-gray-1000 transition-colors hover:cursor-pointer hover:bg-gray-alpha-300 focus-visible:bg-gray-alpha-300",children:[(0,t.jsxs)("span",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("span",{className:"text-gray-900",children:(0,t.jsx)(d.Asterisk,{})}),(0,t.jsx)("span",{className:"flex gap-1",children:(0,t.jsx)("span",{children:"Include all custom environments"})})]}),(0,t.jsx)(i.Checkbox,{checked:u.has(T),onChange:e=>{V(T)(e.target.checked)}})]}):null]})})})]})}function I(e){let{env:n,onChange:a,enabled:r,hideCheckbox:s,customLabel:o,name:d,testId:c,disabled:u}=e,m=(0,j.isCustomEnvironment)(n),p="missingPermission"===u?`Additional permissions are required to create ${(0,j.envName)(n)} environment variables.`:"Sensitive environment variables cannot be created in the Development environment";return(0,t.jsx)(l.Tooltip,{className:"block",disableTriggers:!u,text:p,children:(0,t.jsxs)("label",{className:`flex h-9 shrink-0 select-none items-center justify-between rounded bg-background-100 px-2 py-[6px] text-gray-1000 transition-colors hover:bg-gray-alpha-300 focus-visible:bg-gray-alpha-300 ${u?"hover:cursor-not-allowed":"hover:cursor-pointer"}`,"data-testid":(0,E.tid)("env-variables","label",o||(0,j.envName)(n)),children:[(0,t.jsxs)("span",{className:"flex w-[calc(100%-16px)] items-center gap-2 text-sm",children:[(0,t.jsx)("span",{className:"text-gray-900",children:(0,t.jsx)(C.EnvironmentIcon,{id:n.id})}),(0,t.jsxs)("span",{className:"flex w-[calc(100%-36px)] gap-1",children:[(0,t.jsx)("span",{className:"overflow-hidden text-ellipsis text-nowrap",children:o||(0,j.envName)(n)}),n.slug&&m?(0,t.jsx)("span",{className:"hidden max-w-[38ch] cursor-pointer truncate rounded-sm bg-gray-100 px-[6px] font-mono text-[13px] leading-5 text-gray-900 outline-0 transition-colors hover:bg-gray-200 focus-visible:shadow-focus-ring active:bg-gray-300 md:inline",children:n.slug}):null]})]}),u?(0,t.jsx)(v.LockClosed,{}):(0,t.jsx)(i.Checkbox,{checked:r,className:(0,x.clsx)(s&&"opacity-0"),"data-testid":(0,E.tid)("env-variables",c),name:d,onChange:e=>{a(e.target.checked)}}),s?(0,t.jsx)(L,{enabled:r}):null]})})}function P(e){let{branch:n,onChange:a,enabled:r}=e;return(0,t.jsxs)("label",{className:(0,x.clsx)("flex h-9 shrink-0 select-none items-center justify-between rounded bg-background-100 px-2 py-[6px] text-gray-1000 transition-colors hover:cursor-pointer hover:bg-gray-alpha-300 focus-visible:bg-gray-alpha-300"),children:[(0,t.jsxs)("span",{className:"flex w-[calc(100%-16px)] items-center gap-2 text-sm",children:[(0,t.jsx)("span",{className:"text-gray-900",children:(0,t.jsx)(u.GitBranch,{})}),(0,t.jsx)("span",{className:"flex w-[calc(100%-36px)] gap-1",children:(0,t.jsx)("span",{className:"overflow-hidden text-ellipsis text-nowrap",children:n.ref})})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(i.Checkbox,{checked:r,className:"pointer-events-none absolute inset-0 opacity-0",onChange:e=>{a(e.target.checked)}}),(0,t.jsx)(L,{enabled:r})]})]})}function L(e){let{enabled:n}=e;return(0,t.jsx)(f.AnimatePresence,{initial:!1,children:n?(0,t.jsx)(y.motion.span,{children:(0,t.jsx)(y.motion.svg,{fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)(y.motion.path,{animate:{strokeDashoffset:0,opacity:1,transition:{duration:.15,ease:"easeIn"}},d:"M1.5 10L4.29289 12.7929C4.68342 13.1834 5.31658 13.1834 5.70711 12.7929L14.5 4",exit:{strokeDashoffset:0,opacity:0,transition:{duration:.2}},initial:{strokeDashoffset:1},pathLength:"1",stroke:"currentColor",strokeLinecap:"butt",strokeLinejoin:"round",strokeWidth:"1.5px",style:{strokeDasharray:"1"}})})}):null})}function A(e){let{selectedEnvironmentIds:t,isPreviewEnvironment:a=!1}=e,r=(0,_.useProjectIdOrName)(),{data:{environments:i},isLoading:s}=(0,S.useAllEnvironments)(r),l=""===r,o=i.filter(j.isCustomEnvironment),d=(0,n.useMemo)(()=>l?[j.PreviewEnvironment.id,j.DevelopmentEnvironment.id,T]:[j.PreviewEnvironment.id,j.DevelopmentEnvironment.id,...o.map(e=>e.id)],[o,l]),c=(0,n.useMemo)(()=>d.every(e=>t.has(e)),[d,t]),u=(0,n.useMemo)(()=>d.some(e=>t.has(e))?d.every(e=>t.has(e)):d.every(e=>!t.has(e)),[d,t]),m=o.length>0,{label:v,icon:p,environmentNamesList:h}=(0,n.useMemo)(()=>V({selectedEnvironmentIds:t,environments:i,isAllPreProductionEnvironmentsSelected:c,isPreviewEnvironment:a}),[t,i,a,c]);return{isLoading:s,isAllPreProductionEnvironmentsSelected:c,isAllPreProductionEnvironmentsIndeterminate:u,hasCustomEnvironments:m,preProductionEnvironmentIds:d,customEnvironments:o,label:v,environmentNamesList:h,icon:p}}let V=e=>{var n;let a,{selectedEnvironmentIds:r,environments:i,isPreviewEnvironment:s,isAllPreProductionEnvironmentsSelected:l}=e;if(s&&1===r.size){let e=Array.from(r),n=i.find(t=>t.id===e[0]);return n&&n.id===(0,j.brandCustomEnvId)(b.EnvTarget.Preview)?{environmentNamesList:["Preview"],label:"Preview",icon:(0,t.jsx)(p.PreviewEye,{color:"gray-900"})}:{environmentNamesList:[e[0]],label:e[0],icon:(0,t.jsx)(u.GitBranch,{color:"gray-900"})}}if(0===r.size)return{environmentNamesList:[],label:"No Environments",icon:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(m.Layers,{color:"gray-900"}),(0,t.jsx)("div",{className:"absolute left-px top-0 box-content h-[1.5px] w-[131%] origin-top-left rotate-[44deg] bg-gray-900",style:{borderBottom:"1.5px solid var(--ds-background-200)"}})]})};if(r.has(j.ProductionEnvironment.id)&&l)return{environmentNamesList:["Production","Preview","Development","All Custom Environments"],label:"All Environments",icon:(0,t.jsx)(m.Layers,{color:"gray-900"})};if(l)return{environmentNamesList:["All Pre-Production Environments"],label:"All Pre-Production Environments",icon:(0,t.jsx)(m.Layers,{color:"gray-900"})};if(1===r.size){if(r.has(T))return{environmentNamesList:["All Custom Environments"],label:"All Custom Environments",icon:(0,t.jsx)(m.Layers,{color:"gray-900"})};let e=i.find(e=>e.id===Array.from(r)[0]);if(void 0===e)return{environmentNamesList:["All Custom Environments"],label:"All Custom Environments",icon:(0,t.jsx)(m.Layers,{color:"gray-900"})};if(e.id===(0,j.brandCustomEnvId)(b.EnvTarget.Production))return{environmentNamesList:["Production"],label:"Production",icon:(0,t.jsx)(o.ArrowCircleUp,{color:"gray-900"})};if(e.id===(0,j.brandCustomEnvId)(b.EnvTarget.Preview))return{environmentNamesList:["Preview"],label:"Preview",icon:(0,t.jsx)(p.PreviewEye,{color:"gray-900"})};if(e.id===(0,j.brandCustomEnvId)(b.EnvTarget.Development))return{environmentNamesList:["Development"],label:"Development",icon:(0,t.jsx)(h.Wrench,{color:"gray-900"})}}let d=(n=Array.from(r).flatMap(e=>{let t=i.find(t=>t.id===e);return t?[(0,j.envName)(t)]:[]}),a={Production:1,Preview:2,Development:4,"All Custom Environments":5},n.sort((e,t)=>{let n=a[e]||3,r=a[t]||3;return n!==r?n-r:3===n&&3===r?e.localeCompare(t):0}));if(r.has(T)&&d.push("All Custom Environments"),d.length>3){let e=d.slice(0,3),n=d.slice(3),a=[...e,`${n.length} more`];return{environmentNamesList:d,label:`${(0,g.toListSentence)(a)}`,icon:(0,t.jsx)(m.Layers,{color:"gray-900"})}}return{environmentNamesList:d,label:`${(0,g.toListSentence)(d)}`,icon:(0,t.jsx)(m.Layers,{color:"gray-900"})}};e.s(["CustomEnvironmentEnvVarPicker",()=>N,"INCLUDE_ALL_CUSTOM_ENVIRONMENTS_ID",0,T,"useCustomEnvironmentsPrettyLabel",()=>A])},1642786,e=>{e.v({bold:"tev-environments-selector-module__yCytCa__bold",selectGitBranch:"tev-environments-selector-module__yCytCa__selectGitBranch",truncate:"tev-environments-selector-module__yCytCa__truncate"})},1847448,4805353,e=>{"use strict";var t=e.i(8230165),n=e.i(8128646),a=e.i(5927860),r=e.i(187815),i=e.i(8711407),s=e.i(1176592),l=e.i(1875382),o=e.i(2504781),d=e.i(6881349),c=e.i(3671642),u=e.i(5338940),m=e.i(3322724),v=e.i(7713873),p=e.i(57106),h=e.i(1717203),x=e.i(7557283),f=e.i(6060673),y=e.i(2928617),g=e.i(5601055),j=e.i(7401972),b=e.i(1642786),E=e.i(9722978);function _(e){let{dispatch:t,state:n,mustBeSensitive:a,teamId:r,variant:l,gitBranch:d,restrictToEnvironmentIds:u,disableEnvironmentPicker:p,disableDevelopmentEnvironment:f}=e,{can:y,isLoading:j}=(0,h.default)({teamId:r}),b=(0,m.useIsTablet)()||"project"===l,_=n.target,S=_.production||_.preview,C=y(x.Action.Create,"project"===l?x.Resource.ProjectEnvVarsProduction:x.Resource.SharedEnvVarsProduction);(0,s.useEffect)(()=>{!j&&(C||t({type:"update_target",payload:{target:{production:!1}}}),(n.sensitive||a)&&S&&t({type:"update_target",payload:{target:{development:!1}}}))},[C,j,a,n.sensitive,S,_.production,t]);let w=!!u?.length,T=u?.length===1&&u[0]===v.PreviewEnvironment.id;(0,s.useEffect)(()=>{if(u?.length)if(T)t({type:"update_custom_environment_target",payload:{target:{customEnvironmentIds:[],development:!1,preview:!0,production:!1}}});else{let e=[],n=[];u.forEach(t=>{["production","development","preview"].includes(t)?e.push(t):n.push(t)}),t({type:"update_custom_environment_target",payload:{target:{customEnvironmentIds:n,applyToAllCustomEnvironments:n.includes(g.INCLUDE_ALL_CUSTOM_ENVIRONMENTS_ID),development:e.includes("development"),preview:e.includes("preview"),production:e.includes("production")}}})}},[t,T,u]);let N=w?T&&!p:!p;return(0,i.jsxs)("div",{className:(0,E.default)("flex flex-col items-stretch justify-start flex-initial",b?"gap-1":""),children:[(0,i.jsx)(c.Label,{value:"Environments"}),(0,i.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,i.jsx)(g.CustomEnvironmentEnvVarPicker,{canCreateProductionEnvVars:C,disabled:w||p,disableDevelopmentEnvironment:f,isPreviewEnvironment:T,onChange:e=>{if(u?.length&&!T)return;if(T&&1===e.length){let n="preview"===e[0]?void 0:e[0];n&&t({type:"set_git_branch_name",payload:{branchName:n}}),t({type:"update_custom_environment_target",payload:{target:{customEnvironmentIds:[],development:!1,preview:!0,production:!1,gitBranch:!!n}}});return}let n=[],a=[];e.forEach(e=>{["production","development","preview"].includes(e)?n.push(e):a.push(e)}),t({type:"update_custom_environment_target",payload:{target:{customEnvironmentIds:a,development:n.includes("development"),preview:n.includes("preview"),production:n.includes("production"),gitBranch:!1,applyToAllCustomEnvironments:a.includes(g.INCLUDE_ALL_CUSTOM_ENVIRONMENTS_ID)}}})},selectedEnvironmentIds:new Set(u?.length?u:[...n.target.customEnvironmentIds,n.target.production&&"production",n.target.development&&"development",n.target.preview&&"preview",n.target.applyToAllCustomEnvironments&&g.INCLUDE_ALL_CUSTOM_ENVIRONMENTS_ID].filter(Boolean))}),"project"===l&&N?(0,i.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-3 flex-1",children:[(0,i.jsx)(o.Button,{onClick:()=>{t({type:"update_target",payload:{target:{customEnvironmentIds:[],production:!1,development:!1,preview:!0,gitBranch:!_.gitBranch}}})},size:"small",type:"secondary",typeName:"button",variant:"invert",children:_.gitBranch?"Cancel":"Select a custom Preview branch"}),_.gitBranch?(0,i.jsx)(k,{checkedState:_,dispatch:t,gitBranch:d}):null]}):null]})]})}function S(e){let t=[];return e.development&&t.push(a.EnvTarget.Development),e.preview&&t.push(a.EnvTarget.Preview),e.production&&t.push(a.EnvTarget.Production),t}function C(e){return{production:e.target.includes(a.EnvTarget.Production),preview:e.target.includes(a.EnvTarget.Preview),development:e.target.includes(a.EnvTarget.Development),gitBranch:!!e.gitBranch,customEnvironmentIds:e.applyToAllCustomEnvironments?[g.INCLUDE_ALL_CUSTOM_ENVIRONMENTS_ID]:[],applyToAllCustomEnvironments:e.applyToAllCustomEnvironments}}function k(e){let{gitBranch:t,checkedState:n,dispatch:a}=e,r=(0,l.useParams)()?.project,{data:o}=(0,f.useProject)(r),{teamSlug:c}=(0,u.useTeam)(),m=o?.id,{data:v}=(0,y.useProjectBranches)(m),[,{branches:h}]=(0,j.useProjectDeployedBranches)({project:o,query:t}),x=(0,s.useMemo)(()=>Array.from(new Set([...h||[],...(v||[]).filter(Boolean).map(e=>e.ref)])),[v,h]);return n.gitBranch?o?.link?(0,i.jsx)("div",{className:"flex flex-row items-stretch justify-start gap-4 flex-initial",children:(0,i.jsxs)(d.Combobox,{className:b.default.selectGitBranch,onChange:e=>a({type:"set_git_branch_name",payload:{branchName:e||void 0}}),placeholder:"All Preview Branches",size:"small",value:t||null,children:[(0,i.jsx)(d.Combobox.Input,{onChange:e=>{a({type:"set_git_branch_name",payload:{branchName:e.target.value.trim()||void 0}})},trimValue:!0}),(0,i.jsxs)(d.Combobox.List,{emptyMessage:"No preview branches",maxWidth:450,children:[(0,i.jsx)(i.Fragment,{children:t&&!x.find(e=>e===t)?(0,i.jsx)(d.Combobox.Option,{displayValue:!0,value:t||"",children:`Use "${t}"`}):null}),(0,i.jsx)(i.Fragment,{children:x.map(e=>{let t=String(o.link?.productionBranch)===e;return t?null:(0,i.jsx)(d.Combobox.Option,{disabled:t,value:e,children:e},e)})})]})]})}):(0,i.jsx)("div",{className:"flex flex-row items-stretch justify-start gap-4 flex-initial",children:(0,i.jsx)(p.ButtonLink,{as:`/${c}/${o?.name}/settings/git`,href:"/[teamSlug]/[project]/settings/git",size:"small",type:"secondary",children:"Connect Git Repository"})}):null}e.s(["TEVEnvironmentSelector",()=>_,"getEnvironmentTargets",()=>S,"getEnvironmentTargetsStateFromEnv",()=>C],4805353);let w={kvs:[{key:"",value:"",tempId:(0,t.default)("env_"),comment:""}],projects:[],target:{development:!0,production:!0,preview:!0,gitBranch:!1,customEnvironmentIds:[]},error:void 0,isProcessing:!1,gitBranch:""};e.s(["EnvironmentVariablesReducer",0,(e,i)=>(0,n.produce)(e,e=>{switch(i.type){case"add_new_kv":return e.kvs=[...e.kvs,{key:"",value:"",tempId:(0,t.default)("env_")}],e;case"remove_kv":return e.kvs=e.kvs.filter(e=>e.tempId!==i.payload.id),0===e.kvs.length&&(e.kvs=[{key:"",value:"",tempId:(0,t.default)("env_")}]),e;case"update_kv":return e.kvs[i.payload.index]={...e.kvs[i.payload.index],...i.payload.update},e.error&&(e.error.envVarIds=e.error.envVarIds.filter(t=>t!==e.kvs[i.payload.index].tempId)),e;case"prefill_form":{let{envVar:t}=i.payload;return e.kvs=[{key:t.key,value:t.value,tempId:t.id}],e.target=C(t),e.gitBranch=t.gitBranch||"",e.projects=t.projects??[],e.sensitive=t.type===a.EnvType.Sensitive,e}case"update_target":return e.target={...e.target,...i.payload.target},e.target.preview||(e.gitBranch=void 0,e.target.gitBranch=!1),e;case"update_custom_environment_target":return e.target={...e.target,...i.payload.target},e;case"add_project":{let{project:t}=i.payload;return e.projects.find(e=>e.id===t.id)||(e.projects=[...e.projects,t]),e}case"remove_project":{let{id:t}=i.payload;return e.projects=e.projects.filter(e=>e.id!==t),e}case"error":return e.error={errorObject:i.payload.error,envVarIds:e.kvs.map(e=>e.tempId)},e;case"processing":return e.isProcessing=i.payload.isProcessing,e;case"sensitive":return e.sensitive=i.payload.sensitive,e;case"reset":return e.kvs=w.kvs,e.projects=w.projects,e.error=w.error,e.sensitive=w.sensitive,e;case"import_file":{let{fileData:n,insertAtIndex:a}=i.payload,s=Object.entries((0,r.parseEnv)(n));if(0===s.length)return e;return e.kvs=[...e.kvs.slice(0,a),...s.map(e=>{let[n,a]=e;return{key:n,value:a,tempId:(0,t.default)("env_")}}),...e.kvs.slice(a+1)],e}case"set_git_branch_name":{let{branchName:t}=i.payload;return e.gitBranch=t,e}case"form_submitted":{let{response:t}=i.payload;if(0===t.failed.length)return e.kvs=w.kvs,e.projects=w.projects,e.error=w.error,e;let n=e.kvs.filter(e=>!t.created.find(t=>t.key===e.key));return e.kvs=n,e.error={errorObject:t.failed[0].error,envVarIds:n.map(e=>e.tempId)},e}default:return e}}),"initialEnvVariableFormState",0,w],1847448)},8916169,e=>{"use strict";var t=e.i(8711407),n=e.i(2504781),a=e.i(119294),r=e.i(6352514),i=e.i(9544652);e.s(["default",0,e=>{let s=(0,i.useDisabled)(e.disabled),l=e.loading??e.swr?.isLoadingMore,o="Load More";return!e.swr?.initialDataLoaded||e.swr?.isReachingEnd?null:(0,t.jsx)(n.Button,{type:"secondary",width:"100%",...e,disabled:s,loading:l,onClick:t=>{let n=e.onClick??e.swr?.loadMore;n?.(t),a.analytics.track(r.AnalyticsEvent.CLICK_EVENT,{click_name:"dashboard_cta",click_value:o})},children:o})}])},1728195,e=>{e.v({container:"input-module__1EzHua__container",error:"input-module__1EzHua__error",input:"input-module__1EzHua__input",keyboardFocus:"input-module__1EzHua__keyboardFocus",large:"input-module__1EzHua__large",mediumSmall:"input-module__1EzHua__mediumSmall",noPrefixStyle:"input-module__1EzHua__noPrefixStyle",noSuffixStyle:"input-module__1EzHua__noSuffixStyle",prefix:"input-module__1EzHua__prefix",small:"input-module__1EzHua__small",suffix:"input-module__1EzHua__suffix",xSmall:"input-module__1EzHua__xSmall"})},538090,e=>{e.v({bold:"tev-add-form-module__PZYaGG__bold",button:"tev-add-form-module__PZYaGG__button",commentField:"tev-add-form-module__PZYaGG__commentField",container:"tev-add-form-module__PZYaGG__container "+e.i(1728195).container,dragEffectBackground:"tev-add-form-module__PZYaGG__dragEffectBackground",envVarsForm:"tev-add-form-module__PZYaGG__envVarsForm",error:"tev-add-form-module__PZYaGG__error "+e.i(1728195).error,keyboardFocus:"tev-add-form-module__PZYaGG__keyboardFocus",label:"tev-add-form-module__PZYaGG__label",large:"tev-add-form-module__PZYaGG__large",projectList:"tev-add-form-module__PZYaGG__projectList",projectName:"tev-add-form-module__PZYaGG__projectName",selectedProjectEntity:"tev-add-form-module__PZYaGG__selectedProjectEntity",small:"tev-add-form-module__PZYaGG__small",textAreaHeight:"tev-add-form-module__PZYaGG__textAreaHeight",textarea:"tev-add-form-module__PZYaGG__textarea "+e.i(1728195).input,textareaInput:"tev-add-form-module__PZYaGG__textareaInput",textareaStack:"tev-add-form-module__PZYaGG__textareaStack",textareaWrapper:"tev-add-form-module__PZYaGG__textareaWrapper",viewValueButton:"tev-add-form-module__PZYaGG__viewValueButton"})},7332807,e=>{e.v({popoverBottom:"styled-combobox-module__rI3xva__popoverBottom",popoverShadow:"styled-combobox-module__rI3xva__popoverShadow",projectOptionList:"styled-combobox-module__rI3xva__projectOptionList",themeBorder:"styled-combobox-module__rI3xva__themeBorder"})},3845686,e=>{"use strict";var t=e.i(8711407),n=e.i(1176592),a=e.i(9722978),r=e.i(6881349),i=e.i(7332807);function s(e){let{items:s,selectedItems:l,hideSelectedItems:o,placeholderText:d,OptionComponent:c,search:u,setSearch:m,onChange:v,ListFooterComponent:p,disabled:h,size:x,classNames:f}=e,[y,g]=(0,n.useState)(!1),j=(0,n.useMemo)(()=>o?s.filter(e=>!l.find(t=>e.id===t.id)):s,[o,s,l]);return(0,t.jsxs)(r.Combobox,{className:(0,a.clsx)(i.default.portal,f?.combobox),disabled:h,onChange:v,onChangeOpen:g,placeholder:d,size:x,value:u,children:[(0,t.jsx)(r.Combobox.Input,{className:(0,a.clsx)(i.default.themeBorder,i.default.inputBox,{[i.default.popoverShadow]:y},f?.input),onChange:e=>{m(e.target.value)}}),(0,t.jsx)(r.Combobox.List,{ListFooterComponent:p,avoidCollisions:!1,className:(0,a.clsx)(i.default.projectOptionList,i.default.themeBorder,i.default.popoverBottom,i.default.popoverShadow,f?.list),children:j.map(e=>(0,t.jsx)(c,{item:e},e.id))})]})}e.s(["StyledCombobox",()=>s])},7280270,e=>{"use strict";var t=e.i(8711407),n=e.i(1176592),a=e.i(2504781),r=e.i(6881349),i=e.i(3671642),s=e.i(5255926),l=e.i(7917902),o=e.i(7957251),d=e.i(2107254),c=e.i(5819220),u=e.i(979715),m=e.i(4712634),v=e.i(8916169),p=e.i(7710663),h=e.i(6319736),x=e.i(6509836),f=e.i(1138941),y=e.i(538090),g=e.i(3845686);function j(e){let{dispatch:n,selectedProjects:a,SWRDataToWaitFor:r}=e,{data:o}=(0,p.useFrameworks)(),{account:d}=(0,l.useAccount)();return(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,t.jsx)(i.Label,{value:"Link to Projects",children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-1",children:(0,t.jsxs)(h.EnsureSWRData,{data:[d,o,...r],fallback:(0,t.jsx)(s.Skeleton,{height:40,width:"100%"}),children:[(0,t.jsx)(E,{selectProject:e=>{n({type:"add_project",payload:{project:e}})},selectedProjects:a}),!!a.length&&(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-1",children:a.map(e=>(0,t.jsx)(b,{project:e,removeProject:()=>{n({type:"remove_project",payload:{id:e.id}})}},e.id))})]})})})})}function b(e){let{project:n,removeProject:r}=e,i=(0,f.useFramework)(n);return(0,t.jsxs)(c.Entity,{actions:(0,t.jsx)(a.Button,{"aria-label":"remove row",className:y.default.button,onClick:()=>{r(n)},style:{"--themed-bg":"var(--ds-gray-1000)"},svgOnly:!0,type:"tertiary",children:(0,t.jsx)(o.MinusCircle,{})}),className:y.default.selectedProjectEntity,thumbnail:(0,t.jsx)(m.EntityThumbnail,{size:20,wrap:!0,children:i?(0,t.jsx)(x.FrameworkIcon,{framework:i,size:20}):null}),children:[(0,t.jsx)(u.EntityField,{className:y.default.bold,title:n.name}),n.targets?.production?.alias?.[0]?(0,t.jsx)(u.EntityField,{description:n.targets.production.alias[0]}):null]},n.id)}function E(e){let{selectedProjects:a,selectProject:r}=e,[i,l]=(0,n.useState)(""),[o,c]=(0,d.useProjectListInfinite)({limit:20,latestDeployments:0,search:i},{},!1,!0);if(void 0===o.data)return(0,t.jsx)(s.Skeleton,{height:40,width:"100%"});let{projects:u}=c;return(0,t.jsx)(g.StyledCombobox,{ListFooterComponent:(0,t.jsx)(v.default,{swr:c}),OptionComponent:_,classNames:{list:y.default.projectList},hideSelectedItems:!0,items:u,onChange:e=>{let t=u.find(t=>t.name===e)??null;t&&r(t)},placeholderText:"Search for a Project to link to…",search:i,selectedItems:a,setSearch:l})}function _(e){let{item:n}=e,a=(0,f.useFramework)(n);return(0,t.jsx)(r.Combobox.Option,{prefix:a?(0,t.jsx)(x.FrameworkIcon,{framework:a,size:24}):void 0,suffix:n.targets?.production?.alias?.[0]??void 0,truncateSuffix:!0,value:n.name,children:(0,t.jsx)("span",{className:y.default.projectName,children:n.name})})}e.s(["TEVProjectSelectComponent",()=>j])},2183562,e=>{e.v({amber:"index-module__G9ddHW__amber",hidden:"index-module__G9ddHW__hidden",muted:"index-module__G9ddHW__muted",overlay:"index-module__G9ddHW__overlay",symbol:"index-module__G9ddHW__symbol",tooltipContainer:"index-module__G9ddHW__tooltipContainer",tooltipContainerContainer:"index-module__G9ddHW__tooltipContainerContainer",tooltipContent:"index-module__G9ddHW__tooltipContent"})},6024244,e=>{e.v({container:"tev-key-input-module__L-kdSa__container",inputSpacer:"tev-key-input-module__L-kdSa__inputSpacer",monoInput:"tev-key-input-module__L-kdSa__monoInput",overlay:"tev-key-input-module__L-kdSa__overlay",tooltipContainer:"tev-key-input-module__L-kdSa__tooltipContainer",tooltipContainerContainer:"tev-key-input-module__L-kdSa__tooltipContainerContainer",tooltipContent:"tev-key-input-module__L-kdSa__tooltipContent",warn:"tev-key-input-module__L-kdSa__warn"})},5451849,1081769,e=>{"use strict";var t=e.i(8711407),n=e.i(1176592),a=e.i(9722978),r=e.i(5468328),i=e.i(762945),s=e.i(1114103),l=e.i(8436238),o=e.i(6380887),d=e.i(2183562);function c(e){let{value:c,width:m,id:v,className:p}=e,[h,x]=(0,n.useState)(!1),f=0===c.length,y=f?" ":c.replace(/\n$/,"\n "),g=f?[]:y.split(""),j=!f&&/^\s+/gm.exec(y),b=!f&&/\s+$/gm.exec(y),E=y.includes("\r")||y.includes("\n"),_=y.includes("\0"),S=[];return j&&b?S.push("starts and ends with whitespace"):j?S.push("starts with whitespace"):b&&S.push("ends with whitespace"),E&&S.push("has return characters"),_&&S.push("contains null characters"),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("pre",{"aria-hidden":"true",className:(0,a.clsx)(d.default.overlay,p),style:{width:m??"100%"},children:u(g).map((e,n)=>e.class?(0,t.jsx)("span",{className:(0,a.clsx)(d.default.symbol,e.class),children:e.symbol},n):(0,t.jsx)("span",{className:d.default.hidden,children:e.symbol},n))}),(0,t.jsx)(s.AnimatePresence,{children:S.length>0&&!h?(0,t.jsx)(l.motion.div,{animate:{opacity:1},"aria-label":`This value ${S.join(" and ")}.`,className:d.default.tooltipContainerContainer,exit:{opacity:0},id:v,initial:{opacity:0},transition:{duration:0},children:(0,t.jsx)(l.motion.div,{animate:{opacity:1},className:d.default.tooltipContainer,exit:{opacity:0,transition:{duration:0}},initial:{opacity:0},children:!h&&(0,t.jsx)(r.Tooltip,{"aria-label":"Hide warning",as:"button",delay:!1,htmlType:"button",onClick:()=>{x(!0)},sticky:!0,text:(0,t.jsx)("div",{onClick:e=>{e.stopPropagation()},className:(0,a.clsx)("flex flex-row items-center justify-between gap-2 flex-initial",d.default.tooltipContent),children:(0,t.jsxs)(o.Balancer,{children:["This value ",S.join(" and "),"."]})}),children:(0,t.jsx)(i.Warning,{size:14})})})},"tooltip"):null})]})}let u=e=>{let t=m(e),n=m([...e].reverse()),a=e.slice(0,t),r=e.slice(t,e.length-n),i=e.slice(e.length-n,e.length);return[...a.map(e=>({symbol:v[e].symbol||v[" "].symbol,class:d.default.amber})),...r.map(e=>{let t=v[e];return t?{symbol:t.symbol,class:t.class||d.default.muted}:{symbol:e}}),...i.map((e,t)=>t===i.length-1&&"\n"===i[t-1]&&" "===i[t]?{symbol:e}:{symbol:v[e].symbol||v[" "].symbol,class:d.default.amber})]};function m(e){let t=/^\s+$/;for(let n=0;n<e.length;n++)if(!t.test(e[n]))return n;return -1}let v={"\n":{symbol:"↵\n",class:d.default.amber},"\r":{symbol:"↵\n",class:d.default.amber},"	":{symbol:"⇥",class:d.default.amber},"\v":{symbol:"␋",class:d.default.amber}," ":{symbol:"␣"},"\f":{symbol:"␌",class:d.default.amber}," ":{symbol:"␣"}," ":{symbol:"␣"},"​":{symbol:"␣"},"‌":{symbol:"␣"},"‍":{symbol:"␣"},"\u2028":{symbol:"␣"},"\u2029":{symbol:"␣"}," ":{symbol:"␣"}," ":{symbol:"␣"},"　":{symbol:"␣"},"\uFEFF":{symbol:"␣"}};e.s(["EnvVariableValueOverlay",()=>c],5451849);var p=e.i(3500331),h=e.i(361349),x=e.i(1875382),f=e.i(6060673),y=e.i(1138941),g=e.i(4551858),j=e.i(6024244);function b(e){let{inputRef:n,isErrorState:r,disabled:i,testId:s,onChange:l,id:o,placeholder:d,value:c,onPaste:u}=e,m=S(c);return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-1",children:[(0,t.jsxs)("div",{className:(0,a.clsx)("flex flex-col items-stretch justify-start flex-initial",j.default.container),children:[(0,t.jsx)(p.Input,{"aria-label":"environment variable key",className:j.default.monoInput,"data-testid":s,disabled:i,id:o,label:n?"key":null,maxLength:256,onChange:l,onPaste:u,placeholder:d,ref:n,style:{paddingRight:m?"36px":"12px"},type:r?"error":"default",value:c}),(0,t.jsx)(C,{inputRef:n,keyValue:c})]}),(0,t.jsx)("div",{className:j.default.inputSpacer})]})}let E=["NEXT_PUBLIC_","VUE_APP_","REACT_APP_","GATSBY_","GRIDSOME_","NUXT_PUBLIC_","STORYBOOK_","VITE_","PUBLIC_"],_=["password","key","private","access_token","access","auth","secret","jwt","signature"],S=e=>{let t=k();return(t?[...E,t]:E).find(t=>e.toLowerCase().startsWith(t.toLowerCase()))};function C(e){let o,{keyValue:d,inputRef:c}=e,[u,m]=(0,n.useState)(d),[v,p]=(0,n.useState)(!1),[x,f]=(0,n.useState)(!1),y=S(d),g=`${y||""} exposes this value to the browser. Verify it is safe to share publicly`,b=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"font-mono text-[12px] leading-[16px] font-medium",children:y})," ","exposes this value to the browser. Verify it is safe to share publicly."]}),E=!!y,C=(o=RegExp(_.join("|"),"i").exec(d))?o[0]:null;return null!==C&&(g=`This key, which is prefixed with ${y||""} and includes the term ${C}, might expose sensitive information to the browser. Verify it is safe to share publicly.`,b=(0,t.jsxs)(t.Fragment,{children:["This key, which is prefixed with"," ",(0,t.jsx)("span",{className:"font-mono text-[12px] leading-[16px] font-medium",children:y})," ","and includes the term"," ",(0,t.jsx)("span",{className:"font-mono text-[12px] leading-[16px] font-medium",children:C}),", might expose sensitive information to the browser. Verify it is safe to share publicly."]})),(0,n.useEffect)(()=>{v&&d!==u&&p(!1)},[v,d,u]),(0,h.useInterval)(()=>{c?.current&&f(c.current.scrollWidth>c.current.clientWidth+4&&0===c.current.scrollLeft)},50),(0,t.jsx)(s.AnimatePresence,{children:E&&y&&!v?(0,t.jsxs)(l.motion.div,{animate:{opacity:1},"aria-label":g,className:j.default.tooltipContainerContainer,exit:{opacity:0},initial:{opacity:0},transition:{duration:0},children:[(0,t.jsx)(l.motion.div,{animate:{opacity:+!!x},className:j.default.overlay,style:{pointerEvents:"none"},transition:{duration:0}}),(0,t.jsx)(l.motion.div,{animate:{opacity:1},className:(0,a.clsx)(j.default.tooltipContainer,{[j.default.warn]:C}),exit:{opacity:0,transition:{duration:0}},initial:{opacity:0},children:(0,t.jsx)(r.Tooltip,{"aria-label":"Hide warning",as:"button",delay:!1,htmlType:"button",onClick:()=>{p(!0),m(d)},sticky:!0,text:(0,t.jsx)("div",{onClick:e=>{e.stopPropagation()},className:(0,a.clsx)("flex flex-row items-center justify-between gap-2 flex-initial",j.default.tooltipContent),children:(0,t.jsx)("span",{children:b})}),children:(0,t.jsx)(i.Warning,{size:14})})})]},"tooltip"):null})}let k=()=>{var e;let t,{data:n}=(0,f.useProject)((0,y.useProjectIdOrName)()),{data:a}=(0,f.useProject)(n?.id),r=(0,x.useParams)()?.teamSlug,i=a?.framework,s=!1;(void 0===i||"sveltekit-1"!==i&&"sveltekit-2"!==i)&&(s=!0);let l=a?.targets?.production?.id;void 0===l&&(s=!0);let o=new URL(`/api/v7/deployments/${l||""}/files/get`,"https://vercel.com");o.searchParams.append("path","svelte.config.js");let{data:d}=(0,g.useFileContent)(s?null:{type:"file",name:"svelte.config.js",link:o.toString(),mime:"application/javascript"},r);return void 0!==d&&"string"==typeof d?(e=d,(t=/publicPrefix:\s*'(?<value>[^']*)'/.exec(e))?t[1]:null):null};e.s(["EnvVariableKeyInput",()=>b],1081769)},4981189,e=>{"use strict";var t=e.i(8711407),n=e.i(1176592),a=e.i(2879936),r=e.i(9722978),i=e.i(9318197),s=e.i(3671642),l=e.i(2504781),o=e.i(3500331),d=e.i(4030453),c=e.i(6300206),u=e.i(7957251),m=e.i(5883567),v=e.i(1933683),p=e.i(3973638),h=e.i(5756088),x=e.i(4004502),f=e.i(5927860),y=e.i(9544652),g=e.i(692265),j=e.i(2446691),b=e.i(5451849),E=e.i(1081769),_=e.i(187815),S=e.i(538090);let C=(0,n.forwardRef)((e,a)=>{let{disabled:u,label:m,resize:f,width:E,error:_,type:C,size:w,className:T,wrapperClassName:N,spellCheck:I=!1,autoCapitalize:P="off",autoComplete:L="off",autoCorrect:A="off",isEditing:V=!1,isSensitive:R=!1,inputType:B,...F}=e,O=(0,g.useId)("aria"),D=m?s.Label:"label",{focusProps:M,isFocusVisible:G}=(0,c.useFocusRing)({isTextInput:!0}),$={...m?{value:m,withInput:!0,className:(0,r.clsx)(N,S.default.label)}:{className:N}},H=(0,y.useDisabled)()||u,z=(0,g.useId)("textarea-"),W=(0,j.useType)(_?"error":C),[U,Y]=(0,n.useState)(!!R);(0,n.useEffect)(()=>{Y(!!R)},[R]);let Z=U||R&&V,q=!!(R&&!V)&&(0,t.jsx)(l.Button,{"aria-label":"Toggle sensitive value visibility",className:(0,r.clsx)(S.default.button,S.default.viewValueButton,"!-mr-1 !ml-3"),onClick:()=>Y(!U),svgOnly:!0,title:"Toggle sensitive value visibility",type:"secondary",typeName:"button",children:U?(0,t.jsx)(v.Eye,{size:16,style:{flexShrink:0}}):(0,t.jsx)(p.EyeOff,{size:16,style:{flexShrink:0}})});return(0,t.jsxs)(D,{"data-version":"v1",...$,children:[(0,t.jsxs)("div",{className:`flex flex-row items-stretch justify-start flex-initial ${(0,r.clsx)(S.default.textareaStack,Z?S.default.textAreaHeight:"")}`,children:[(0,t.jsx)("div",{className:(0,r.clsx)(S.default.container,W,S.default.textareaWrapper),children:Z?(0,t.jsx)(o.Input,{...F,autoCapitalize:P,autoComplete:L,autoCorrect:A,className:(0,r.clsx)(S.default.textarea,W,{[S.default.large]:"large"===w,[S.default.small]:"small"===w},T,S.default.textareaInput),"data-testid":(0,x.tid)("env-variables","add-form","value-input"),disabled:H,innerWrapperClassName:"!shadow-none",prefix:R&&V?(0,t.jsx)(h.LockClosed,{size:16}):null,prefixStyling:!1,ref:a,spellCheck:I,typeName:B,width:E??"100%"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("textarea",{"aria-describedby":O,...F,autoCapitalize:P,autoComplete:L,autoCorrect:A,className:(0,r.clsx)(S.default.textarea,W,{[S.default.large]:"large"===w,[S.default.small]:"small"===w,[String(S.default.keyboardFocus)]:G},T,S.default.textareaInput),"data-testid":(0,x.tid)("env-variables","add-form","value-input"),disabled:H,ref:a,spellCheck:I,style:{resize:f,width:E},...M}),(0,t.jsx)(b.EnvVariableValueOverlay,{id:O,value:F.value,width:E})]})}),q]}),_?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Spacer,{y:.5}),(0,t.jsx)(d.Error,{"data-testid":F["data-testid"]?(0,x.tid)(F["data-testid"],"error"):void 0,error:_,id:`${z}-error`,size:k[w||"small"],style:{width:E}})]}):null]})}),k={xSmall:"small",small:"small",mediumSmall:"small",large:"large"};function w(e){let{kvs:r,dispatch:i,enableBulk:s=!1,isEditing:o=!1,firstInputRef:d,error:c,isSensitive:u}=e,[v,p]=(0,a.useQueryState)("new",a.parseAsString),h=(0,n.useRef)(null);return(0,n.useEffect)(()=>{v&&v&&r.length>0&&""===r[0].key&&(i({type:"update_kv",payload:{index:0,update:{key:v}}}),h.current&&h.current.focus(),p(null))},[v,r,i,p]),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[r.map((e,n,a)=>(0,t.jsx)(T,{dispatch:i,enableBulk:s,index:n,inputRef:0===n?d:void 0,valueInputRef:0===n?h:void 0,isEditing:o,isErrorState:c?.envVarIds.includes(e.tempId),isSensitive:u,kv:e},e.tempId)),s?(0,t.jsx)("div",{className:"flex flex-row items-stretch justify-start gap-3 flex-1",children:(0,t.jsx)(l.Button,{onClick:()=>i({type:"add_new_kv"}),prefix:(0,t.jsx)(m.PlusCircle,{}),size:"small",type:"secondary",typeName:"button",children:"Add Another"})}):null]})}function T(e){let{inputRef:a,valueInputRef:r,dispatch:i,index:s,kv:d,enableBulk:c=!1,isEditing:m=!1,isErrorState:v,isSensitive:p}=e,[h,y]=(0,n.useState)(!!p),g=(0,n.useRef)(null);return(0,n.useEffect)(()=>{y(!!p)},[p]),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-evenly gap-3 flex-1",children:[(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-evenly gap-3 flex-1",children:[(0,t.jsx)(E.EnvVariableKeyInput,{disabled:!!p&&m,inputRef:a,isErrorState:v,onChange:e=>{i({type:"update_kv",payload:{index:s,update:{key:e.target.value}}})},onPaste:e=>{c&&0!==Object.entries((0,_.parseEnv)(e.clipboardData.getData("text"))).length&&(e.preventDefault(),i({type:"import_file",payload:{fileData:e.clipboardData.getData("text"),insertAtIndex:s}}))},placeholder:"CLIENT_KEY…",testId:(0,x.tid)("env-variables","add-form","name-input"),value:d.key}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-1",children:(0,t.jsx)(C,{"aria-label":"shared environment variable value",autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",inputType:h&&!m?"password":"text",isEditing:m,isSensitive:p,label:a?"value":null,onChange:e=>i({type:"update_kv",payload:{index:s,update:{value:e.target.value}}}),ref:r,type:v?"error":"default",placeholder:p&&m?"This value is sensitive":void 0,value:d.value})}),(0,t.jsx)("div",{className:"flex flex-row items-end justify-start gap-2 flex-initial",children:c?(0,t.jsx)(l.Button,{"aria-label":"remove row",className:S.default.button,onClick:()=>i({type:"remove_kv",payload:{id:d.tempId}}),svgOnly:!0,title:"Delete row",type:"secondary",typeName:"button",children:(0,t.jsx)(u.MinusCircle,{size:16,style:{flexShrink:0}})}):(0,t.jsx)("div",{"aria-hidden":!0,style:{width:40}})})]}),(0,t.jsx)(o.Input,{"aria-label":"shared environment variable comment",id:"comment",innerWrapperClassName:a?void 0:S.default.commentField,label:a?"Note":null,maxLength:f.ENV_VAR_COMMENT_MAX_LENGTH,onChange:e=>i({type:"update_kv",payload:{index:s,update:{comment:e.target.value}}}),placeholder:"Describe how you created this environment variable and how it is used",ref:g,value:d.comment,wrapperClassName:a?S.default.commentField:void 0})]})}C.displayName="Textarea",e.s(["TEVInputSection",()=>w])},9307140,e=>{e.v({fullWidthHR:"full-width-hr-module__8ZqTOq__fullWidthHR"})},809476,e=>{"use strict";var t=e.i(8711407),n=e.i(8206804),a=e.i(9307140);function r(){return(0,t.jsx)("div",{"aria-hidden":!0,children:(0,t.jsx)(n.default,{className:a.default.fullWidthHR,margin:0})})}e.s(["FullWidthHR",()=>r])},2215529,e=>{"use strict";var t=e.i(8711407),n=e.i(1176592),a=e.i(6073689),r=e.i(8248823),i=e.i(134877),s=e.i(1875382),l=e.i(3993360),o=e.i(2504781),d=e.i(455575),c=e.i(4030453),u=e.i(4004502),m=e.i(9722978),v=e.i(5433449),p=e.i(5927860),h=e.i(1717203),x=e.i(7557283),f=e.i(3245331),y=e.i(8432052),g=e.i(4089015),j=e.i(4171299),b=e.i(6060673),E=e.i(9512272),_=e.i(5601055),S=e.i(6949145),C=e.i(1847448),k=e.i(4805353),w=e.i(7280270),T=e.i(4981189),N=e.i(809476),I=e.i(538090),P=e.i(3671642),L=e.i(1906681),A=e.i(5468328),V=e.i(57106);function R(e){let{dispatch:a,state:r}=e,i=!!r.target.development;return(0,n.useEffect)(()=>{a({type:"sensitive",payload:{sensitive:!r.target.development&&!!r.sensitive}})},[r.target.development]),(0,t.jsxs)("div",{className:"flex flex-col items-start justify-start gap-0 flex-initial",children:[(0,t.jsx)(P.Label,{value:"Sensitive"}),(0,t.jsxs)("div",{className:"flex flex-col items-start justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:["If enabled, you and your team will not be able to read the values after creation."," ",(0,t.jsx)(V.Link,{external:!0,href:"/docs/environment-variables/sensitive-environment-variables",type:"highlight",children:"Learn more"})]}),(0,t.jsx)(A.Tooltip,{disableTriggers:!r.target.development,text:"Sensitive environment variables cannot be created in the Development environment.",children:(0,t.jsx)(L.Toggle,{"aria-labelledby":"label-for-sensitive-toggle",checked:!!r.sensitive,direction:"switch-first",disabled:i,name:"add-form-sensitive",onChange:()=>{a({type:"sensitive",payload:{sensitive:!r.sensitive}}),!1===r.sensitive&&a({type:"update_target",payload:{target:{development:!1}}})},size:"large",children:(0,t.jsx)("p",{className:"text-copy-14",id:"label-for-sensitive-toggle",children:r.sensitive?"Enabled":"Disabled"})})})]})]})}function B(e){let{isEditing:a,envVar:r,teamId:i,onSave:s,onCancel:l,disableEnvironmentPicker:c,containerClassName:u}=e,{can:m,isLoading:v}=(0,h.default)({teamId:i}),f=m(x.Action.Update,x.Resource.SharedEnvVars),y=(0,d.useToasts)(),{data:g,isLoading:E}=(0,b.useProjects)(r.projectId,{config:{revalidateOnFocus:!1}}),[S,C]=(0,n.useState)(null);(0,n.useEffect)(()=>{!E&&(r.type===p.EnvType.Sensitive||r.decrypted)&&C({...r,projects:g})},[g,r,E]);let w=(0,n.useCallback)(e=>{let t=new Set(e.projects.map(e=>e.id)),n=new Set(r.projectId),a=[...t].filter(e=>!n.has(e)),s=[...n].filter(e=>!t.has(e));return(0,j.updateSharedEnvVar)({envVar:r,payload:{...e.kvs[0],target:(0,k.getEnvironmentTargets)(e.target),projectIdUpdates:{link:a,unlink:s}},teamId:i,applyToAllCustomEnvironments:e.target.customEnvironmentIds.includes(_.INCLUDE_ALL_CUSTOM_ENVIRONMENTS_ID)})},[r,i]);return(0,t.jsx)(D,{arePermissionsLoading:v,bulkEnvVarEnabled:!1,canCreateSharedEnvVars:f,containerClassName:u,disableEnvironmentPicker:c,envVar:r,envVarWithProjects:S,formSubmit:w,isEditing:a,onSave:e=>{y.success("Updated Shared Environment Variable successfully."),s(e)},secondaryAction:(0,t.jsx)(o.Button,{onClick:l,size:"small",type:"secondary",children:"Cancel"}),teamId:i,variant:"shared"})}function F(e){let{teamId:a,onSave:r}=e,{can:i,isLoading:s}=(0,h.default)({teamId:a}),c=i(x.Action.Create,x.Resource.SharedEnvVars),u=(0,d.useToasts)(),m=(0,n.useRef)(null),v=(0,n.useCallback)(e=>(0,g.addSharedEnvs)({kvs:e.kvs,projectId:e.projects.map(e=>e.id),target:(0,k.getEnvironmentTargets)(e.target),teamId:a,type:e.sensitive?p.EnvType.Sensitive:p.EnvType.Encrypted,applyToAllCustomEnvironments:e.target.customEnvironmentIds.includes(_.INCLUDE_ALL_CUSTOM_ENVIRONMENTS_ID)}),[a]);return(0,t.jsx)(D,{arePermissionsLoading:s,bulkEnvVarEnabled:!0,canCreateSharedEnvVars:c,destructiveAction:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{accept:"env","aria-hidden":!0,multiple:!1,ref:m,style:{display:"none"},type:"file"}),(0,t.jsx)(o.Button,{disabled:!m.current,onClick:()=>m.current?.click(),prefix:(0,t.jsx)(l.Download,{}),size:"small",type:"secondary",typeName:"button",children:"Import"})]}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"or paste the .env contents above"})]}),fileUploadRef:m,formSubmit:v,onSave:e=>{u.success("Added Shared Environment Variable successfully."),r?.(e)},teamId:a,variant:"shared"})}function O(e){let{teamId:a,onSave:r,formClassName:i,containerClassName:l,restrictToEnvironmentIds:d}=e,{project:c}=(0,s.useParams)()??{project:""},{data:u}=(0,b.useProject)(c),m=u?.id,{can:f,isLoading:y}=(0,h.default)({teamId:a}),g=f(x.Action.Create,x.Resource.ProjectEnvVars),j=(0,n.useRef)(null),_=(0,n.useCallback)(e=>{let t=(0,k.getEnvironmentTargets)(e.target);if(void 0===m)throw Error("Couldn't find project");return(0,E.addEnvs)(m,e.kvs.map(n=>{let a={name:n.key,value:n.value,target:t,type:e.sensitive?p.EnvType.Sensitive:p.EnvType.Encrypted,gitBranch:e.target.gitBranch&&e.gitBranch?e.gitBranch:void 0,comment:n.comment};return a.customEnvironmentIds=e.target.customEnvironmentIds,a}),a)},[m,a]);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(D,{arePermissionsLoading:y,bulkEnvVarEnabled:!0,canCreateSharedEnvVars:g,containerClassName:l,destructiveAction:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{accept:"env","aria-hidden":!0,multiple:!1,ref:j,style:{display:"none"},type:"file"}),(0,t.jsx)(o.Button,{disabled:!j.current,onClick:()=>j.current?.click(),prefix:(0,t.jsx)(v.FileText,{}),size:"small",type:"secondary",typeName:"button",children:"Import .env"})]}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"or paste the .env contents above"})]}),fileUploadRef:j,formClassName:i,formSubmit:_,onSave:e=>{r?.(e)},restrictToEnvironmentIds:d,teamId:a,variant:"project"})})}function D(e){var s;let{formSubmit:l,onSave:v,isEditing:h,canCreateSharedEnvVars:x,arePermissionsLoading:g,bulkEnvVarEnabled:j,envVar:b,envVarWithProjects:E,secondaryAction:_,destructiveAction:P,teamId:L,fileUploadRef:A,variant:V,formClassName:B,containerClassName:F,restrictToEnvironmentIds:O,disableEnvironmentPicker:D}=e,M=b?{gitBranch:(s=b).gitBranch||"",isProcessing:!1,kvs:[],projects:[],sensitive:s.type===p.EnvType.Sensitive,target:(0,k.getEnvironmentTargetsStateFromEnv)(s)}:C.initialEnvVariableFormState,[G,$]=(0,n.useReducer)(C.EnvironmentVariablesReducer,M),{team:H,isTeamReady:z,isLoading:W}=(0,S.useSensitiveEnvironmentVariablePolicy)(),U=z&&!W&&(0,S.getBooleanValueFromOnOffDefault)(H?.sensitiveEnvironmentVariablePolicy),Y=(0,n.useRef)(null),Z=(0,n.useRef)(null),q=(0,d.useToasts)();(0,n.useEffect)(()=>{let e=A?.current;if(e)return document.addEventListener("dragenter",t),document.addEventListener("dragover",n),document.addEventListener("dragleave",a),document.addEventListener("drop",s),e.addEventListener("change",i),()=>{document.removeEventListener("dragenter",t),document.removeEventListener("dragover",n),document.removeEventListener("dragleave",a),document.removeEventListener("drop",s),e.removeEventListener("change",i)};function t(e){Z.current&&e.dataTransfer?.items[0].kind==="file"&&Z.current.classList.add("drag-enter")}function n(e){Z.current&&e.target===Z.current&&(e.preventDefault(),Z.current.classList.add("drag-over"))}function a(e){Z.current&&e.target===Z.current&&(Z.current.classList.remove("drag-over"),Z.current.classList.remove("drag-enter"))}function r(e){if(!e||"text/plain"!==e.type&&""!==e.type)return void q.error("Please upload a valid env file");let t=new FileReader;t.onload=e=>{let t=e.target?.result;t&&$({type:"import_file",payload:{fileData:t.toString(),insertAtIndex:G.kvs.length-1}})},t.readAsText(e)}function i(e){r(e.target.files?.[0])}function s(e){Z.current&&(e.target===Z.current&&(e.preventDefault(),r(e.dataTransfer?.files[0])),Z.current.classList.remove("drag-over"),Z.current.classList.remove("drag-enter"))}},[A,G.kvs.length,q]),(0,n.useEffect)(()=>{(E?.type===p.EnvType.Sensitive||E?.decrypted)&&$({type:"prefill_form",payload:{envVar:E}})},[E]);let K=(0,n.useCallback)(async()=>{$({type:"processing",payload:{isProcessing:!0}});try{let e,t=await l(G);if($({type:"form_submitted",payload:{response:t}}),E?.id){let t=new Set(E.projectId),n=new Set(G.projects.map(e=>e.id)),a=[...t].filter(e=>n.has(e)).concat([...n].filter(e=>!t.has(e)));e={id:E.id,key:G.kvs[0].key,value:G.sensitive?"":G.kvs[0].value,target:(0,k.getEnvironmentTargets)(G.target),projectId:a,type:G.sensitive?p.EnvType.Sensitive:p.EnvType.Encrypted,updatedAt:(E.updatedAt??0)+1}}v(e),$({type:"reset"})}catch(e){$({type:"error",payload:{error:(0,i.isAPIError)(e)&&"envs_size_too_large"===e.code?Error("Unable to save environment variables. Insufficient space. Consider deleting some variables."):(0,r.normalizeError)(e)}})}$({type:"processing",payload:{isProcessing:!1}}),Y.current?.focus()},[E?.id,E?.updatedAt,E?.projectId,l,v,G]),X=G.error?(0,t.jsx)(c.Error,{"data-testid":(0,u.tid)("env-variables","error-message"),error:G.error.errorObject}):null;return(0,t.jsxs)(f.default,{className:(0,m.clsx)(I.default.envVarsForm,"tailwind"),"data-testid":(0,u.tid)("env-variables","add-form"),onSubmit:()=>void K(),children:[(0,t.jsx)("div",{className:I.default.dragEffectBackground,ref:Z}),(0,t.jsx)(y.EntityForm,{className:(0,m.clsx)("bg-background-100 p-0",B),destructiveAction:P,disabled:g||!x,footerClassName:"p-4 bg-background-200 rounded-bl-[var(--geist-radius)] rounded-br-[var(--geist-radius)] env-vars-footer",footerNote:null,footerSeparator:!1,primaryAction:(0,t.jsx)(o.Button,{loading:G.isProcessing,size:"small",typeName:"submit",children:"Save"}),secondaryAction:_,title:null,children:(0,t.jsxs)("div",{className:(0,m.clsx)("flex flex-col items-stretch justify-start gap-4 flex-initial p-4 pb-0",F),children:[h||U?null:(0,t.jsx)(R,{dispatch:$,state:G}),(0,t.jsx)(N.FullWidthHR,{}),(0,t.jsx)(k.TEVEnvironmentSelector,{disableEnvironmentPicker:D,disableDevelopmentEnvironment:!!G.sensitive,dispatch:$,gitBranch:G.gitBranch,mustBeSensitive:U,restrictToEnvironmentIds:O,state:G,teamId:L,variant:V}),(0,t.jsx)(N.FullWidthHR,{}),(0,t.jsx)(a.NuqsAdapter,{children:(0,t.jsx)(T.TEVInputSection,{dispatch:$,enableBulk:j,error:G.error,firstInputRef:Y,isEditing:h,isLoading:null===E,isSensitive:G.sensitive,kvs:G.kvs})}),X,"shared"===V&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.FullWidthHR,{}),(0,t.jsx)(w.TEVProjectSelectComponent,{SWRDataToWaitFor:[null===E?void 0:null],dispatch:$,selectedProjects:G.projects})]}),(0,t.jsx)(N.FullWidthHR,{})]})})]})}e.s(["ProjectEnvVariablesAddForm",()=>O,"TeamEnvVariablesAddForm",()=>F,"TeamEnvVariablesEditForm",()=>B],2215529)},1558786,e=>{e.v({iconContainer:"env-variables-icon-module__0YD5da__iconContainer"})},42012,7855500,3225137,e=>{"use strict";var t=e.i(8711407),n=e.i(9722978),a=e.i(3627160),r=e.i(5756088),i=e.i(4585051),s=e.i(4450569),l=e.i(5328446),o=e.i(7743427),d=e.i(6417808);let c=()=>(0,t.jsxs)("svg",{fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)("path",{d:"M2.66675 4.66675V2.66675H13.3334V4.66675",stroke:"#666666",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,t.jsx)("path",{d:"M6 13.3333H10",stroke:"#666666",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,t.jsx)("path",{d:"M8 2.66675V13.3334",stroke:"#666666",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})]});var u=e.i(1558786);function m(e){let{env:m}=e,{data:v}=(0,l.default)(m?.configurationId),{data:p}=(0,o.useIntegration)(v?.integrationId);if(!m.configurationId)if("plain"===m.type)return(0,t.jsx)(s.default,{center:!0,className:(0,n.clsx)(u.default.iconContainer,"plaintextIconContainer"),children:(0,t.jsx)(c,{})});else if("system"===m.type)return(0,t.jsx)(s.default,{center:!0,className:(0,n.clsx)(u.default.iconContainer,"systemIconContainer"),children:(0,t.jsx)(d.default,{color:"var(--accents-5)",width:16})});else if("encrypted"===m.type)return(0,t.jsx)(s.default,{center:!0,className:(0,n.clsx)(u.default.iconContainer,"encryptedIconContainer"),children:(0,t.jsx)(a.Code,{color:"gray-700"})});else if("sensitive"===m.type)return(0,t.jsx)(s.default,{center:!0,className:(0,n.clsx)(u.default.iconContainer,"sensitiveIconContainer"),children:(0,t.jsx)(r.LockClosed,{color:"gray-700"})});else return(0,t.jsx)(s.default,{center:!0,className:(0,n.clsx)(u.default.iconContainer,"secretIconContainer"),children:(0,t.jsx)(r.LockClosed,{color:"gray-700"})});return(0,t.jsx)(i.Avatar,{className:"integrationIcon",hash:p?.icon,placeholder:!v||!p,size:30})}e.s(["default",()=>m],42012);var v=e.i(1176592),p=e.i(5858269),h=e.i(57106),x=e.i(9318197),f=e.i(9334091),y=e.i(3500331),g=e.i(4030453),j=e.i(3671642),b=e.i(2455417),E=e.i(6891161),_=e.i(455575),S=e.i(8042625),C=e.i(277234),k=e.i(4244280),w=e.i(5338940),T=e.i(7909933),N=e.i(1717203),I=e.i(7557283);function P(){let{config:e,id:t,noRequest:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{isReady:a,team:r}=(0,w.useTeam)(),{can:i,isLoading:s}=(0,N.default)(),l=i(I.Action.Read,I.Resource.Secrets),o=a&&!s&&!n&&l;return(0,T.default)(()=>o?`${k.API_SECRETS}${(0,S.encode)({teamId:r?.id,id:t})}`:null,e=>(0,C.fetchAPI)(e,{throwOnHTTPError:!0}),e)}e.s(["useSecrets",()=>P],7855500);var L=e.i(1138941),A=e.i(6060673);let V=e=>e.startsWith("-----BEGIN PRIVATE KEY-----\\n")&&e.endsWith("\\n-----END PRIVATE KEY-----\\n")?e.replace(/\\n/g,"\n"):e;e.s(["default",0,e=>{let{active:n,initialSecretName:a,onCancel:r,onAdd:i}=e,[l,o]=(0,v.useState)(""),[d,c]=(0,v.useState)(""),[u,m]=(0,v.useState)(void 0),[T,N]=(0,v.useState)(!1),{team:I}=(0,w.useTeam)(),R=(0,_.useToasts)(),{data:B}=P(),{data:F}=(0,A.useProject)((0,L.useProjectIdOrName)());(0,v.useEffect)(()=>{n&&o(e=>{if(e)return e;let t=(0,p.default)(a||F?.name||"");return B?.secrets.find(e=>e.name.toLowerCase()===t.toLowerCase())?`${t}-${Math.random().toString(36).substring(9)}`:t})},[a,n,F,B]);let O=async()=>{N(!0);let e=await (0,C.fetchAPI)(`${k.API_SECRETS}${(0,S.encode)({teamId:I?.id})}`,{method:"POST",body:JSON.stringify({name:l,value:d}),throwOnHTTPError:!1});N(!1),e.error?m(e.error):(i(e.uid),R.success("Created Secret successfully."))},D=(0,v.useCallback)(()=>{m(void 0),c(""),o("")},[]);return(0,t.jsxs)(E.Modal.Modal,{active:n,onAnimationDone:D,onClickOutside:r,width:"420px",children:[(0,t.jsxs)(E.Modal.Body,{children:[(0,t.jsxs)(s.default,{center:!0,children:[(0,t.jsx)("h4",{className:"text-copy-16",style:{fontWeight:500,margin:0},children:"Add Secret"}),(0,t.jsx)("p",{className:"text-copy-14 text-center",style:{color:"var(--accents-5)"},children:"Secrets contain sensitive information, are encrypted and also available across all projects."})]}),(0,t.jsx)("main",{children:(0,t.jsxs)("form",{className:"form",onSubmit:async e=>{e?.preventDefault(),await O()},children:[(0,t.jsx)(s.default,{children:(0,t.jsx)(j.Label,{value:"Value",children:(0,t.jsx)(f.Textarea,{"aria-label":"Value",autoFocus:!0,disabled:T,name:"add-secret-value",onChange:e=>{c(V(e.target.value))},placeholder:"i9ju23nf39nunu3asn",rows:2,value:d,width:"100%"})})}),(0,t.jsx)(x.Spacer,{y:1}),(0,t.jsx)(s.default,{children:(0,t.jsx)(j.Label,{id:"add-secret-name",value:"Name",withInput:!0,children:(0,t.jsx)(y.Input,{disabled:T,id:"add-secret-name",name:"add-secret-name",onChange:e=>{o(e.target.value)},placeholder:"secret-name",prefix:"@",style:{height:40},value:l,width:"100%"})})}),(0,t.jsx)(x.Spacer,{}),(0,t.jsxs)("span",{children:[(0,t.jsxs)("span",{style:{color:"var(--accents-5)"},children:["You will be able to reuse this Secret in multiple Projects using this name."," "]}),(0,t.jsx)(h.Link,{external:!0,href:"/docs/environment-variables#secrets",type:"highlight",children:"Learn More"})]}),u?(0,t.jsxs)(t.Fragment,{children:[" ",(0,t.jsx)(x.Spacer,{y:.5})," ",(0,t.jsx)(g.Error,{error:u})," "]}):null]})})]}),(0,t.jsxs)(E.Modal.Actions,{children:[(0,t.jsx)(E.Modal.Action,{onClick:r,type:"secondary",children:"Cancel"}),(0,t.jsxs)(E.Modal.Action,{disabled:T,onClick:O,children:[T?(0,t.jsx)(b.LoadingDots,{}):null,!T&&"Create Secret"]})]})]})},"formatEnvValueWithNewline",0,V],3225137)},1961840,e=>{"use strict";var t=e.i(7909933),n=e.i(8042625),a=e.i(277234),r=e.i(4244280),i=e.i(5338940);function s(e,s){let{isReady:l,team:o}=(0,i.useTeam)();return(0,t.default)(()=>e&&l?`${(0,r.API_PROJECTS_VERSION)("v7")}/${encodeURIComponent(e)}/system-env-values${(0,n.encode)({teamId:o?.id})}`:"",e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),s)}e.s(["default",()=>s])},1839393,e=>{e.v({envVarValueSensitive:"env-variables-edit-form-module__FkdT-q__envVarValueSensitive",envVarValueSensitiveText:"env-variables-edit-form-module__FkdT-q__envVarValueSensitiveText",mono:"env-variables-edit-form-module__FkdT-q__mono",overlay:"env-variables-edit-form-module__FkdT-q__overlay",textarea:"env-variables-edit-form-module__FkdT-q__textarea"})},8764444,e=>{"use strict";var t=e.i(8711407),n=e.i(1176592),a=e.i(8248823),r=e.i(2504781),i=e.i(3869281),s=e.i(6881349),l=e.i(4030453),o=e.i(3500331),d=e.i(3671642),c=e.i(8522580),u=e.i(1848296),m=e.i(5255926),v=e.i(9318197),p=e.i(9334091),h=e.i(4004502),x=e.i(8042625),f=e.i(277234),y=e.i(4244280),g=e.i(5927860),j=e.i(5338940),b=e.i(5140444),E=e.i(1875382),_=e.i(8432052),S=e.i(4450569),C=e.i(3225137),k=e.i(187815),w=e.i(7855500),T=e.i(6060673),N=e.i(7482607),I=e.i(1961840),P=e.i(5451849),L=e.i(1081769),A=e.i(1991452),V=e.i(57106),R=e.i(1717203),B=e.i(7557283),F=e.i(2928617),O=e.i(5601055),D=e.i(7401972);function M(e){let{selectedGitBranch:a,checkedProduction:i,checkedPreview:l,checkedDevelopment:o,setCheckedProduction:c,setCheckedPreview:u,setCheckedDevelopment:m,setSelectedGitBranch:p,onChangeSelectedCustomEnvironmentIds:h,selectedCustomEnvironmentIds:x,disableEnvironmentPicker:f,disableDevelopmentEnvironment:y,hideGitBranchSelector:b}=e,[E,_]=(0,n.useState)(""),[S,C]=(0,n.useState)(!!a),{project:k}=(0,A.useRouter)().query,{data:w}=(0,T.useProject)(k),{teamSlug:N}=(0,j.useTeam)(),{can:I}=(0,R.default)(),P=w?.id,{data:L}=(0,F.useProjectBranches)(P),[,{branches:M}]=(0,D.useProjectDeployedBranches)({project:w,query:E}),G=(0,n.useMemo)(()=>Array.from(new Set([...M||[],...(L||[]).filter(Boolean).map(e=>e.ref)])),[L,M]),$=I(B.Action.Create,B.Resource.ProjectEnvVarsProduction),H=[...x];return i&&H.push(g.EnvTarget.Production),l&&H.push(g.EnvTarget.Preview),o&&H.push(g.EnvTarget.Development),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[(0,t.jsx)(d.Label,{value:"Environments"}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)(O.CustomEnvironmentEnvVarPicker,{canCreateProductionEnvVars:$,disabled:f,disableDevelopmentEnvironment:y,onChange:e=>{let t=[],n=[];e.forEach(e=>{(0,g.isSystemEnvTarget)(e)?t.push(e):n.push(e)}),c(t.includes(g.EnvTarget.Production)),u(t.includes(g.EnvTarget.Preview)),m(t.includes(g.EnvTarget.Development)),C(!!(1===t.length&&t.includes(g.EnvTarget.Preview))),h(n)},selectedEnvironmentIds:new Set(H)}),b?null:(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-3 flex-1",children:[(0,t.jsx)(r.Button,{onClick:()=>{c(!1),u(!0),h([]),m(!1),C(e=>!e),S&&p(null)},size:"small",type:"secondary",typeName:"button",variant:"invert",children:S?"Cancel":"Select a custom Preview branch"}),S?w?.link?(0,t.jsxs)(s.Combobox,{onChange:e=>p(e||""),placeholder:"All Preview Branches",size:"small",value:a||null,children:[(0,t.jsx)(s.Combobox.Input,{onChange:e=>_(e.target.value.trim()),trimValue:!0}),(0,t.jsxs)(s.Combobox.List,{emptyMessage:"No preview branches",children:[(0,t.jsx)(t.Fragment,{children:E&&!G.find(e=>e===E)?(0,t.jsx)(s.Combobox.Option,{displayValue:!0,value:E||"",children:`Use "${E}"`}):null}),(0,t.jsx)(t.Fragment,{children:G.map(e=>{let n=String(w.link?.productionBranch)===e;return n?null:(0,t.jsx)(s.Combobox.Option,{disabled:n,value:e,children:e},e)})})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Spacer,{y:.5}),(0,t.jsx)(V.ButtonLink,{as:`/${N}/${w?.name}/settings/git`,href:"/[teamSlug]/[project]/settings/git",type:"secondary",children:"Connect Git Repository"})]}):null]})]})]})}var G=e.i(1839393);function $(e){let{envVariable:A,onDiscard:V,onSave:R,onSecretAdd:B,disableEnvironmentPicker:F,disableNameInput:O,disableComment:D,disableEnvironmentInput:$,customSave:H,editTextareaValueProps:z}=e,[W,U]=(0,n.useState)(A.type),[Y,Z]=(0,n.useState)({value:A.key,edited:!1}),[q,K]=(0,n.useState)({value:A.comment,edited:!1}),[X,J]=(0,n.useState)(()=>W===g.EnvType.Plain?A.value:""),[Q,ee]=(0,n.useState)(()=>W===g.EnvType.Encrypted&&A.decrypted?A.value:""),[et,en]=(0,n.useState)(!1),ea=(0,n.useId)(),er=Array.isArray(A.target)?A.target:[A.target],ei=A.type===g.EnvType.Secret&&er.includes(g.EnvTarget.Development),[es,el]=(0,n.useState)(er.includes(g.EnvTarget.Production)),[eo,ed]=(0,n.useState)(er.includes(g.EnvTarget.Preview)),[ec,eu]=(0,n.useState)(er.includes(g.EnvTarget.Development)),[em,ev]=(0,n.useState)(A.customEnvironmentIds||[]),{data:ep}=(0,w.useSecrets)(),{team:eh}=(0,j.useTeam)(),{user:ex}=(0,b.useUser)(),{project:ef,envIdOrSlug:ey}=(0,E.useParams)()||{},{data:eg}=(0,T.useProject)(ef),[ej,eb]=(0,n.useState)(void 0),eE=eh?.id;(0,n.useEffect)(()=>{A.decrypted&&ee(A.value)},[A.decrypted,A.value]);let e_=(0,n.useMemo)(()=>ep?.secrets.map(e=>({label:`@${e.name}`,value:e.uid}))??[],[ep]),[eS,eC]=(0,n.useState)(A.gitBranch),{data:ek}=(0,I.default)(ef),[ew,eT]=(0,n.useState)(!1),[eN,eI]=(0,n.useState)(""),[eP,eL]=(0,n.useState)(()=>W===g.EnvType.Secret?A.value:null),[eA,eV]=(0,n.useState)(()=>W===g.EnvType.System?A.value:null),eR=(0,n.useCallback)(e=>{"create-new-secret"===e?eT(!0):(null===e&&eI(""),eL(e))},[eT,eL,eI]),eB=(0,n.useCallback)(e=>{if((eV(e),null!==e)&&(!Y.value||!Y.edited))switch(eg?.framework){case"nextjs":Z({edited:!1,value:`NEXT_PUBLIC_${e}`});break;case"create-react-app":Z({edited:!1,value:`REACT_APP_${e}`})}},[Y,eg]),{open:eF}=(0,N.useSaveAndRedeploy)(),eO=(0,n.useCallback)(async()=>{en(!0);let e="";switch(W){case g.EnvType.Plain:e=X;break;case g.EnvType.Secret:e=eP;break;case g.EnvType.System:e=eA;break;case g.EnvType.Encrypted:case g.EnvType.Sensitive:e=Q}let t=[];es&&t.push(g.EnvTarget.Production),eo&&t.push(g.EnvTarget.Preview),ec&&t.push(g.EnvTarget.Development);try{let n=eS||null,a=W===g.EnvType.Sensitive?{value:e||void 0,target:t,gitBranch:n,comment:q.value}:{key:Y.value,value:e,target:t,type:W,gitBranch:n,comment:q.value};if(a.customEnvironmentIds=em,H)await H(a);else{let e=await (0,f.fetchAPI)(`${(0,y.API_PROJECTS_VERSION)("v7")}/${ef}/env/${A.id}${(0,x.encode)({teamId:eE})}`,{method:"PATCH",body:JSON.stringify(a),throwOnHTTPError:!0});R(e),eF("Updated Environment Variable successfully.")}}catch(e){eb((0,a.normalizeError)(e))}en(!1)},[R,H,Y,q,X,eP,eA,Q,ef,eE,ec,eo,es,A,W,eS,em,eF]);(0,n.useEffect)(()=>{let e=e=>{(e.metaKey||e.ctrlKey)&&13===e.keyCode&&"TEXTAREA"===e.target.tagName&&eO()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[eO]);let eD=(0,n.useMemo)(()=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Label,{value:"Type"}),(0,t.jsx)(u.RadioGroup,{label:"Environment Variable Type",onChange:e=>{U(e),ei||e!==g.EnvType.Secret||eu(!1)},value:W,children:(0,t.jsxs)(S.default,{direction:["column","row","row"],gap:0,style:{fontSize:"14px"},children:[(0,t.jsx)(u.RadioGroup.Item,{value:g.EnvType.Plain,children:"Plaintext"}),(0,t.jsx)(v.Spacer,{x:1,y:.5}),(0,t.jsx)(u.RadioGroup.Item,{value:g.EnvType.Secret,children:"Secret"}),(0,t.jsx)(v.Spacer,{x:1,y:.5}),(0,t.jsx)(u.RadioGroup.Item,{value:g.EnvType.System,children:"Provided by System"})]})})]}),[W,eu,ei]),eM=(0,n.useMemo)(()=>(0,t.jsx)(S.default,{flex:.5,children:(0,t.jsx)(d.Label,{value:"Value",children:(0,t.jsxs)(s.Combobox,{disabled:ei,onChange:eR,placeholder:"Select Secret…",value:eP,children:[(0,t.jsx)(s.Combobox.Input,{className:"edit-var-select-secret",onChange:e=>eI(e.target.value)}),(0,t.jsxs)(s.Combobox.List,{children:[(0,t.jsx)(s.Combobox.Option,{value:"create-new-secret",children:eN?`Create new Secret "${eN}" for ${eh?.name??ex?.name??ex?.username}`:`Create a new Secret for ${eh?.name??ex?.name??ex?.username}`}),(0,t.jsx)(t.Fragment,{children:e_.map(e=>(0,t.jsx)(s.Combobox.Option,{value:e.value,children:e.label},e.value))})]})]})})}),[eI,eR,e_,ei,eN,eP,eh,ex]),eG=(0,n.useMemo)(()=>(0,t.jsx)(S.default,{flex:.5,children:(0,t.jsx)(d.Label,{value:"Value",children:(0,t.jsxs)(s.Combobox,{onChange:eB,placeholder:"Select System Environment Variable…",value:eA,children:[(0,t.jsx)(s.Combobox.Input,{}),(0,t.jsx)(s.Combobox.List,{children:ek?.systemEnvValues.map(e=>(0,t.jsx)(s.Combobox.Option,{value:e,children:e},e))})]})})}),[ek,eB,eA]),e$=(0,n.useMemo)(()=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Spacer,{y:.5}),(0,t.jsx)(d.Label,{value:"Value",children:(0,t.jsx)(p.Textarea,{onChange:e=>J((0,C.formatEnvValueWithNewline)(e.target.value)),placeholder:"i9ju23nf39nunu3asn",rows:3,value:X,width:"100%"})})]}),[X,J]),eH=!A.decrypted;return(0,t.jsxs)(_.EntityForm,{footerNote:(()=>{if(!F)return!1;let e=er.length>1,t=em.length>1;return e||t||er.length>0&&em.length>0})()?(0,t.jsx)(c.Note,{type:"warning",children:"Editing this environment variable will affect multiple environments."}):null,primaryAction:(0,t.jsx)(r.Button,{"data-testid":(0,h.tid)("env-variables-edit-form","save-button"),loading:et,onClick:eO,size:"small",children:"Save"}),secondaryAction:(0,t.jsx)(r.Button,{onClick:V,size:"small",type:"secondary",children:"Cancel"}),children:[(0,t.jsxs)(S.default,{direction:"column",children:[(0,t.jsxs)(S.default,{flex:3,gap:0,children:[ei?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(c.Note,{size:"small",children:["Secrets can no longer be used in the Development Environment. ",'Please switch this Environment Variable to the "Plaintext" type in order to edit its value.']}),(0,t.jsx)(v.Spacer,{y:.5})]}):null,![g.EnvType.Encrypted,g.EnvType.Sensitive].includes(W)&&(0,t.jsxs)(t.Fragment,{children:[eD,(0,t.jsx)(v.Spacer,{y:.5})]}),(0,t.jsx)(S.default,{children:(0,t.jsxs)(S.default,{direction:["column","row","row"],gap:.5,children:[(0,t.jsx)(S.default,{flex:[g.EnvType.Plain,g.EnvType.Encrypted,g.EnvType.Sensitive].includes(W)?1:.5,children:(0,t.jsx)(d.Label,{value:"Name",children:(0,t.jsx)(L.EnvVariableKeyInput,{disabled:W===g.EnvType.Sensitive||O,id:"edit-env-name",onChange:e=>Z({edited:!0,value:e.target.value}),onPaste:e=>{if(X||Q)return;let t=Object.entries((0,k.parseEnv)(e.clipboardData.getData("text")));if(0===t.length||t.length>1)return;e.preventDefault();let n=t[0],a=n[0],r=n[1];Z({edited:!0,value:a}),W===g.EnvType.Plain?J((0,C.formatEnvValueWithNewline)(r)):[g.EnvType.Encrypted,g.EnvType.Sensitive].includes(W)&&ee((0,C.formatEnvValueWithNewline)(r))},placeholder:"EXAMPLE_NAME",value:Y.value})})}),W===g.EnvType.Secret?eM:null,W===g.EnvType.System?eG:null]})}),W===g.EnvType.Plain?e$:null,[g.EnvType.Encrypted,g.EnvType.Sensitive].includes(W)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Spacer,{y:.5}),(0,t.jsx)(d.Label,{value:"Value",children:(0,t.jsxs)(m.Skeleton,{show:W===g.EnvType.Encrypted&&eH,style:{position:"relative"},children:[(0,t.jsx)(p.Textarea,{"aria-describedby":ea,onChange:e=>ee((0,C.formatEnvValueWithNewline)(e.target.value)),placeholder:"YOUR_SECRET_VALUE_GOES_HERE",rows:6,value:Q,width:"100%",wrapperClassName:G.default.textarea,...z}),(0,t.jsx)(P.EnvVariableValueOverlay,{className:G.default.overlay,id:ea,value:Q,width:"100%",...z})]})})]}),[g.EnvType.Encrypted,g.EnvType.Sensitive].includes(W)?null:(0,t.jsx)(()=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Spacer,{y:.5}),(0,t.jsx)("span",{className:"text-copy-16",style:{textTransform:"uppercase",fontSize:"0.75rem",fontWeight:500,color:"var(--geist-secondary)"},children:"Environments"}),(0,t.jsx)(v.Spacer,{y:.5}),(0,t.jsxs)(S.default,{direction:["column","row","row"],gap:0,children:[(0,t.jsx)(i.Checkbox,{checked:es,name:"edit-form-production",onChange:()=>el(!es),children:"Production"}),(0,t.jsx)(v.Spacer,{x:1,y:.5}),(0,t.jsx)(i.Checkbox,{checked:eo,name:"edit-form-preview",onChange:()=>ed(!eo),children:"Preview"}),(0,t.jsx)(v.Spacer,{x:1,y:.5}),(0,t.jsx)(i.Checkbox,{checked:ec,disabled:W===g.EnvType.Secret&&!ei||W===g.EnvType.Sensitive,name:"edit-form-development",onChange:()=>eu(!ec),children:"Development"})]})]}),{}),(0,t.jsx)(v.Spacer,{y:.5}),(0,t.jsxs)(S.default,{direction:["column","row","row"],gap:.5,children:[D?null:(0,t.jsx)(S.default,{flex:[g.EnvType.Plain,g.EnvType.Encrypted,g.EnvType.Sensitive].includes(W)?1:.5,children:(0,t.jsx)(d.Label,{value:"Comment",children:(0,t.jsx)(o.Input,{id:"edit-env-comment",maxLength:g.ENV_VAR_COMMENT_MAX_LENGTH,onChange:e=>K({edited:!0,value:e.target.value}),placeholder:"Describe how you created this environment variable and how it is used",value:q.value,width:"100%"})})}),W===g.EnvType.Secret?eM:null,W===g.EnvType.System?eG:null]})]}),[g.EnvType.Encrypted,g.EnvType.Sensitive].includes(W)&&!$?(0,t.jsx)(S.default,{flex:2,children:(0,t.jsx)(M,{checkedDevelopment:ec,checkedPreview:eo,checkedProduction:es,disableEnvironmentPicker:F,disableDevelopmentEnvironment:W===g.EnvType.Sensitive,hideGitBranchSelector:!!(F&&ey!==g.EnvTarget.Preview),onChangeSelectedCustomEnvironmentIds:ev,selectedCustomEnvironmentIds:em,selectedGitBranch:eS,setCheckedDevelopment:eu,setCheckedPreview:ed,setCheckedProduction:el,setSelectedGitBranch:eC})}):null]}),ej?(0,t.jsxs)(t.Fragment,{children:[" ",(0,t.jsx)(v.Spacer,{y:1})," ",(0,t.jsx)(l.Error,{error:ej})," "]}):null,(0,t.jsx)(C.default,{active:ew,initialSecretName:eN||Y.value,onAdd:e=>{eT(!1),eI(""),eL(e),B()},onCancel:()=>{eT(!1),eI("")}})]})}e.s(["EnvVariablesEditForm",()=>$],8764444)},4251055,e=>{e.v({bullets:"env-variables-table-module__L-jLVG__bullets",commentWrapper:"env-variables-table-module__L-jLVG__commentWrapper",dataStoreIconWrapperStyles:"env-variables-table-module__L-jLVG__dataStoreIconWrapperStyles",editing:"env-variables-table-module__L-jLVG__editing",empty:"env-variables-table-module__L-jLVG__empty",entity:"env-variables-table-module__L-jLVG__entity",iconsContainer:"env-variables-table-module__L-jLVG__iconsContainer",key:"env-variables-table-module__L-jLVG__key",overriddenEnvVar:"env-variables-table-module__L-jLVG__overriddenEnvVar",plaintextEnvValue:"env-variables-table-module__L-jLVG__plaintextEnvValue",resultRow:"env-variables-table-module__L-jLVG__resultRow",reveal:"env-variables-table-module__L-jLVG__reveal",section:"env-variables-table-module__L-jLVG__section",suggestionHighlight:"env-variables-table-module__L-jLVG__suggestionHighlight",time:"env-variables-table-module__L-jLVG__time",timeAgoText:"env-variables-table-module__L-jLVG__timeAgoText",varName:"env-variables-table-module__L-jLVG__varName",varNameContainer:"env-variables-table-module__L-jLVG__varNameContainer",virtuosoRowOverflowAnchor:"env-variables-table-module__L-jLVG__virtuosoRowOverflowAnchor"})},6899807,e=>{"use strict";var t=e.i(8711407),n=e.i(1176592),a=e.i(6199768),r=e.i(9722978),i=e.i(8248823),s=e.i(57106),l=e.i(4585051),o=e.i(3306538),d=e.i(2504781),c=e.i(4030453),u=e.i(8459493),m=e.i(7448864),v=e.i(6891161),p=e.i(6850581),h=e.i(5255926),x=e.i(9318197),f=e.i(5468328),y=e.i(455575),g=e.i(5433449),j=e.i(3973638),b=e.i(1933683),E=e.i(762945),_=e.i(1000031),S=e.i(4345845),C=e.i(2065543),k=e.i(4004502),w=e.i(5927860),T=e.i(7713873),N=e.i(5338940),I=e.i(3322724),P=e.i(4272098),L=e.i(7218483),A=e.i(5166685),V=e.i(5819220),R=e.i(4712634),B=e.i(979715),F=e.i(4450569),O=e.i(7808943),D=e.i(42012),M=e.i(8764444),G=e.i(6060673),$=e.i(7482607),H=e.i(2729296);e.i(6887680);var z=e.i(6810699),W=e.i(1138941),U=e.i(7743427),Y=e.i(3850869),Z=e.i(5601055),q=e.i(7188996),K=e.i(3756284),X=e.i(3703009),J=e.i(8525850),Q=e.i(2215529),ee=e.i(4251055);function et(e){let{env:a,secretsMappedById:i,revealType:s,onViewEnvironmentVariable:l}=e,[o,c]=(0,n.useState)("hidden");if((0,n.useEffect)(()=>{void 0!==a.decrypted&&(a.decrypted&&"loading"===o?c("revealed"):a.decrypted||"revealed"!==o||c("hidden"))},[a.decrypted,o,a]),2===s)return(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start flex-initial",children:[(0,t.jsxs)(f.Tooltip,{text:"Additional permissions are required to reveal production environment variables values.",children:[(0,t.jsx)(x.Spacer,{x:.1}),(0,t.jsx)(b.Eye,{size:16})]}),(0,t.jsx)(x.Spacer,{x:.5}),(0,t.jsx)("p",{className:`text-copy-14 text-gray-900 ${ee.default.bullets}`,children:"•".repeat(15)})]});if(1===s)return(0,t.jsx)(q.CopyInlineCode,{value:a.value});if(a.type===w.EnvType.Secret&&i){let e=i[a.value]?.name;return e?(0,t.jsx)("i",{title:`@${e}`,children:`@${e}`}):(0,t.jsx)("i",{title:a.value,children:a.value||"-"})}if(a.type===w.EnvType.Plain)return(0,t.jsx)(O.default,{className:(0,r.clsx)(ee.default.plaintextEnvValue,"env-var-value","geist-ellipsis"),title:a.value,children:a.value});if(a.type===w.EnvType.Encrypted){if(a.decrypted&&!a.value)return(0,t.jsx)("i",{title:"This Environment Variable has no value",children:"Empty"});switch(o){case"revealed":return(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[(0,t.jsx)(d.Button,{"aria-label":"Click to hide",className:ee.default.reveal,onClick:()=>c("hidden"),svgOnly:!0,title:"Click to hide",variant:"unstyled",children:(0,t.jsx)(j.EyeOff,{size:16})}),(0,t.jsx)(q.CopyInlineCode,{value:a.value})]});case"hidden":case"loading":return(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[(0,t.jsx)(d.Button,{"aria-label":"Click to reveal",className:ee.default.reveal,loading:"loading"===o,onClick:()=>{a.decrypted?c("revealed"):c("loading"),l?.(a)},size:"small",svgOnly:!0,title:"Click to reveal",variant:"unstyled",children:"loading"!==o&&(0,t.jsx)(b.Eye,{size:16})}),(0,t.jsx)("p",{className:`text-copy-14 text-gray-900 ${ee.default.bullets}`,children:"•".repeat(15)})]})}}return a.type===w.EnvType.Sensitive?null:(0,t.jsx)("i",{title:a.value,children:a.value})}function en(e){let{env:n,team:a,projectName:r,resource:i}=e;switch(n.contentHint?.type){case"blob-read-write-token":return(0,t.jsx)(s.Link,{href:a&&r?`/${a.slug}/${r}/stores/blob/${n.contentHint.storeId}`:a?`/${a.slug}/~/stores/blob/${n.contentHint.storeId}`:`/dashboard/stores/blob/${n.contentHint.storeId}`,style:{color:"var(--geist-secondary)"},children:(0,t.jsx)("div",{className:ee.default.dataStoreIconWrapperStyles,children:(0,t.jsx)(X.DataStore,{size:"small",type:"blob"})})});case"integration-store-secret":return i&&a?(0,t.jsx)(f.Tooltip,{text:"Open linked integration",children:(0,t.jsx)(s.Link,{href:(0,J.getResourceDetailsPath)(i,a.slug,r),style:{color:"var(--geist-secondary)"},children:(0,t.jsx)(ea,{...n.contentHint})})}):null;case"flags-connection-string":return(0,t.jsx)(f.Tooltip,{text:"Open flags",children:(0,t.jsx)(s.Link,{href:`/${a.slug}/${r}/flags`,style:{color:"var(--geist-secondary)"},children:(0,t.jsx)("div",{className:ee.default.dataStoreIconWrapperStyles,children:(0,t.jsx)(f.Tooltip,{text:"This environment variable connects this project with flags",children:(0,t.jsx)(C.ToggleOnAlt,{size:16})})})})})}return n.edgeConfigId?(0,t.jsx)(f.Tooltip,{desktopOnly:!0,text:"This environment variable connects this project to an Edge Config",children:(0,t.jsx)(s.Link,{href:a&&r?`/${a.slug}/${r}/stores/edge-config/${n.edgeConfigId}`:a?`/${a.slug}/~/stores/edge-config/${n.edgeConfigId}`:`/dashboard/stores/edge-config/${n.edgeConfigId}`,style:{color:"var(--geist-secondary)"},children:(0,t.jsx)("div",{className:ee.default.dataStoreIconWrapperStyles,children:(0,t.jsx)(X.DataStore,{size:"small",type:"edge-config"})})})}):null}function ea(e){let{integrationId:n,integrationProductId:a}=e,{product:r}=(0,U.useIntegrationAndProduct)({integrationIdOrSlug:n,productIdOrSlug:a});return r?(0,t.jsx)(l.Avatar,{hash:r.iconUrl,size:20,title:r.name}):(0,t.jsx)(_.Linked,{size:12})}function er(e){let{env:a,className:i,hasConnectedStore:s,onRemove:d,onSave:c,onDetach:v,onSecretAdd:h,secretsMappedById:x,isEditing:y,setIsEditing:j,search:b,canReadProductionValues:E,canUnlinkSharedEnvVariable:_,disableDeleteEnvVariable:S,disableEditEnvVariable:C,onViewEnvironmentVariable:N,team:P,projectId:A,projectName:F,getOverriddenTargetsForSharedEnvVar:O=e=>[],virtuosoIndexData:G,disableMoreMenuProps:$,environment:z,disableNameInput:W,disableComment:U,disableEnvironmentInput:Y,customSave:Z,editTextareaValueProps:q,resource:X}=e,ea=(0,I.useIsMobile)(),er=(0,n.useRef)(null),es=(0,H.isSharedEnv)(a),el=(0,L.useAgo)(a.updatedAt||a.createdAt,{justNowLabel:"just now"}),eo=(0,n.useMemo)(()=>es?O(a):[],[a,O,es]);(0,n.useEffect)(()=>{y&&er.current?.scrollIntoView({behavior:"smooth",block:"nearest"})},[y]);let ed=(0,n.useMemo)(()=>{var e;return a?(0,t.jsxs)("span",{className:ee.default.varNameContainer,children:[(0,t.jsx)(K.CopyText,{value:a.key,children:(0,t.jsx)("span",{className:(0,r.clsx)(eo.length?ee.default.overriddenEnvVar:void 0,ee.default.varName),style:{fontFamily:"var(--font-mono)",fontWeight:500},title:a.key,children:b?(e=a.key,e.split(RegExp("("+b+")","gi")).map((e,n)=>e.toLowerCase()===b.toLowerCase()?(0,t.jsx)("span",{className:ee.default.suggestionHighlight,children:e},n):e)):a.key},a.id)}),(0,t.jsxs)("div",{className:(0,r.clsx)("flex flex-row items-stretch justify-start gap-2 flex-initial",ee.default.iconsContainer),children:[(0,t.jsx)(en,{env:a,projectName:F,resource:X,team:P}),void 0!==a.comment&&""!==a.comment&&(0,t.jsx)(f.Tooltip,{text:a.comment,children:(0,t.jsx)("div",{className:ee.default.commentWrapper,children:(0,t.jsx)(g.FileText,{size:14})})})]}),"sensitive"===a.type?(0,t.jsx)(o.Badge,{size:"sm",style:{marginLeft:"8px",backgroundColor:"var(--geist-secondary-lighter)",color:"var(--geist-secondary-dark)"},children:"Sensitive"}):null]}):null},[a,eo.length,A,F,X,b,P]),ec=a.target===w.EnvTarget.Production||Array.isArray(a.target)&&1===a.target.length&&a.target[0]===w.EnvTarget.Production,eu=(0,n.useMemo)(()=>{if(!a.contentHint)return null;switch(a.contentHint.type){case"blob-read-write-token":return(0,t.jsx)(u.MenuItem,{href:P&&F?`/${P.slug}/${F}/stores/blob/${a.contentHint.storeId}/projects`:P?`/${P.slug}/~/stores/blob/${a.contentHint.storeId}/projects`:`/dashboard/stores/blob/${a.contentHint.storeId}/projects`,isLink:!0,children:"Manage Blob Connection"});case"integration-store-secret":return X&&P?(0,t.jsx)(u.MenuItem,{href:(0,J.getResourceDetailsPath)(X,P.slug,F),isLink:!0,children:"Manage Connection"}):null;default:return null}},[a.contentHint,F,X,P]),em=(0,n.useMemo)(()=>es?F?"Unlink from this Project":"Delete":"Remove",[es,F]);return(0,n.createElement)(V.Entity,{...G,className:(0,r.clsx)(i,ee.default.resultRow,{[ee.default.editing]:y},y&&"pb-0"),disabledDotMenuTooltip:void 0!==$?(0,t.jsx)(t.Fragment,{children:$.tooltip}):(0,t.jsx)(t.Fragment,{children:"Additional permissions are required to manage production environment variables."}),editing:y,footer:y?P&&es?(0,t.jsx)("div",{className:"-mx-4 -mt-4",children:(0,t.jsx)(Q.TeamEnvVariablesEditForm,{containerClassName:"pt-0",disableEnvironmentPicker:!!z,envVar:a,isEditing:y,onCancel:()=>j(!1),onRemove:()=>{d?.(a)},onSave:e=>{j(!1),c?.(e)},teamId:P.id})}):(0,t.jsx)("div",{className:"pb-4",children:(0,t.jsx)(M.EnvVariablesEditForm,{customSave:Z,disableComment:U,disableEnvironmentInput:Y,disableEnvironmentPicker:!!z,disableNameInput:W,editTextareaValueProps:q,envVariable:a,onDiscard:()=>j(!1),onSave:e=>{j(!1),c?.(e)},onSecretAdd:()=>{h?.()}},a.id)}):null,footerClassName:y?"border-t-0":void 0,indent:!1,isDotMenuDisabled:!E&&ec||$?.disabled,key:a.id,menuItems:eu?(0,t.jsxs)(t.Fragment,{children:[eu,!1===s&&(!es||_)?(0,t.jsx)(u.MenuItem,{onClick:()=>{d?.(a)},style:{color:"var(--geist-error)"},children:em}):(0,t.jsx)(f.Tooltip,{desktopOnly:!0,disableTriggers:!s,text:"You can remove this environment variable by disconnecting the project from the connected store.",children:(0,t.jsx)(m.MenuItemLocked,{children:em})})]}):(0,t.jsxs)(t.Fragment,{children:[!(es&&A)&&(C?(0,t.jsx)(m.MenuItemLocked,{children:"Edit"}):(0,t.jsx)(u.MenuItem,{"data-testid":(0,k.tid)("env-vars-table","menu-item","edit",a.key),onClick:()=>j(!0),children:"Edit"})),z&&a.type===w.EnvType.Encrypted&&(()=>{if(es||!z)return!1;let e=0;return a.customEnvironmentIds&&(e+=a.customEnvironmentIds.length),Array.isArray(a.target)?e+=a.target.length:e+=1,e>1})()?(0,t.jsx)(f.Tooltip,{desktopOnly:!0,style:{width:"100%"},text:`Detach this environment variable and create a new copy just for the ${z?(0,T.envName)(z):""} environment.`,children:(0,t.jsx)(u.MenuItem,{onClick:()=>{v?.(a)},children:"Detach"})}):null,(es?_:!S)?(0,t.jsx)(u.MenuItem,{onClick:()=>{d?.(a)},style:{color:"var(--geist-error)"},children:em}):(0,t.jsx)(m.MenuItemLocked,{children:em})]}),ref:er,thumbnail:(0,t.jsx)(R.EntityThumbnail,{size:24,children:(0,t.jsx)(D.default,{env:a})}),children:[(0,t.jsx)(B.EntityField,{className:ee.default.key,description:(0,t.jsx)(ei,{env:a,overriddenTargets:eo}),title:ed}),a.type===w.EnvType.Sensitive&&ea?null:(0,t.jsx)(B.EntityField,{children:(0,t.jsx)(et,{env:a,onViewEnvironmentVariable:N,revealType:!ec||E?0:2,secretsMappedById:x})}),(0,t.jsx)(B.EntityField,{avatar:a.updatedBy||a.createdBy?(0,t.jsx)(f.Tooltip,{text:a.lastEditedByDisplayName,children:(0,t.jsx)(l.Avatar,{size:24,uid:a.updatedBy||a.createdBy})}):null,className:ee.default.time,description:a.updatedAt?(0,t.jsxs)(p.RelativeTimeCard,{date:a.updatedAt,side:"left",children:[(0,t.jsxs)("span",{className:ee.default.timeAgoText,children:[a.updatedBy?"Updated":"Added"," "]}),el]}):null,right:!0})]})}function ei(e){let{overriddenTargets:n,env:a}=e;return(0,t.jsx)(es,{env:a,overriddenTargets:n})}function es(e){let{overriddenTargets:n,env:a}=e,r=[...Array.isArray(a.target)?a.target:[a.target],...a.customEnvironmentIds||[]].filter(e=>!!e);a.applyToAllCustomEnvironments&&r.push(Z.INCLUDE_ALL_CUSTOM_ENVIRONMENTS_ID);let{label:i,isLoading:s,environmentNamesList:l}=(0,Z.useCustomEnvironmentsPrettyLabel)({selectedEnvironmentIds:new Set(r)});return(0,t.jsx)(h.Skeleton,{className:"truncate",show:s,children:(0,t.jsx)(f.Tooltip,{center:!1,delay:!0,desktopOnly:!0,disableTriggers:l.length<1,maxWidth:"300px",padding:"var(--geist-gap-quarter)",position:"top",style:{minWidth:"0",display:"block"},text:l.join(",\n"),children:n.length?(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-1",children:[(0,t.jsx)(E.Warning,{align:"bottom",size:16}),(0,t.jsx)("span",{children:"Overridden by Project"})]}):a.gitBranch?(0,t.jsxs)("span",{className:"flex flex-wrap gap-1",children:[i,(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(S.GitBranch,{}),(0,t.jsx)("span",{className:"font-mono",children:a.gitBranch})]})]}):(0,t.jsx)("span",{className:"block w-full truncate",children:i})})})}function el(e){let n=e.context,a=e.item,{open:r}=(0,$.useSaveAndRedeploy)();if(!a||!n)return null;let{canReadProductionValues:i,canUnlinkSharedEnvVariable:s,getOverriddenTargetsForSharedEnvVar:l,isStoreDeleted:o,currentEditingEnv:d,onRemove:c,onSave:u,onDetach:m,onSecretAdd:v,onViewEnvironmentVariable:p,project:h,search:x,secretsMappedById:f,setCurrentEditingEnv:y,team:g,shouldDisableEnvRow:j,environment:b,resources:E}=n,_={"data-index":e["data-index"],"data-item-index":e["data-item-index"],"data-known-size":e["data-known-size"]},S=a.contentHint,C=S?.type==="integration-store-secret"?E?.find(e=>e.id===S.storeId):void 0;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(er,{canReadProductionValues:i,canUnlinkSharedEnvVariable:s,className:ee.default.virtuosoRowOverflowAnchor,disableMoreMenuProps:j?.(a),env:a,environment:b,getOverriddenTargetsForSharedEnvVar:l,hasConnectedStore:!!a.contentHint&&"storeId"in a.contentHint&&!o(a.contentHint.storeId),isEditing:a.id===d,onDetach:m,onRemove:c,onSave:e=>{r("Updated Environment Variable successfully."),u?.(e)},onSecretAdd:v,onViewEnvironmentVariable:p,projectId:h?.id,projectName:h?.name,resource:C?.type==="integration"?C:void 0,search:x,secretsMappedById:f,setIsEditing:e=>{p?.(a),y(e?a.id:null)},team:g,virtuosoIndexData:_},a.id)})}function eo(e){let{envVariables:r,onRemove:i,onSave:s,onDetach:o,secretsData:d,onSecretAdd:c,search:m,isLoading:v,withSecrets:p,withEnvs:h,projectId:f,canReadProductionValues:y,canUnlinkSharedEnvVariable:g,disabled:j,onViewEnvironmentVariable:b,textConfig:E,getOverriddenTargetsForSharedEnvVar:_=e=>[],shouldDisableEnvRow:S,environment:C,currentEditingEnv:w,setCurrentEditingEnv:T}=e,{isStoreDeleted:I,data:P}=(0,z.useResourceList)({resourceIds:r?.map(e=>e.contentHint&&"storeId"in e.contentHint?e.contentHint.storeId:void 0).filter(e=>!!e)??[]}),L=(0,W.useProjectIdOrName)()||f,{data:A}=(0,G.useProject)(f),{isReady:O,team:D}=(0,N.useTeam)(),M=(0,n.useMemo)(()=>d?.secrets.reduce((e,t)=>(e[t.uid]=t,e),{})??{},[d?.secrets]),$=!O||v||h&&!Array.isArray(r)||p&&!d,H=(0,n.useMemo)(()=>({canReadProductionValues:y,canUnlinkSharedEnvVariable:g,getOverriddenTargetsForSharedEnvVar:_,isStoreDeleted:I,currentEditingEnv:w,onRemove:i,onSave:s,onDetach:o,onSecretAdd:c,onViewEnvironmentVariable:b,project:A,search:m,secretsMappedById:M,setCurrentEditingEnv:T,team:D,shouldDisableEnvRow:S,environment:C,resources:P?.stores}),[y,g,_,I,w,i,s,o,c,b,A,m,M,T,D,S,C,P?.stores]);return $?(0,t.jsx)("div",{children:["p1","p2"].map(e=>(0,t.jsxs)(V.Entity,{className:ee.default.resultRow,menuItems:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.MenuItem,{children:"Edit"}),(0,t.jsx)(u.MenuItem,{children:"Remove"})]}),placeholder:!0,thumbnail:(0,t.jsx)(R.EntityThumbnail,{size:30}),children:[(0,t.jsx)(B.EntityField,{description:"",descriptionSkeletonWidth:"50%",title:"",titleSkeletonWidth:"40%",width:"40%"}),(0,t.jsx)(B.EntityField,{description:"",descriptionSkeletonWidth:"80%",title:"",titleSkeletonWidth:"20%",width:"27%"}),(0,t.jsx)(B.EntityField,{avatar:(0,t.jsx)(l.Avatar,{size:24}),description:"",descriptionSkeletonWidth:"60%",right:!0})]},e))}):j?(0,t.jsx)(Y.AdditionalPermissionsRequired,{resource:L?"Environment Variables of this project":"Environment Variables",team:L?null:D}):m&&r?.length===0?(0,t.jsxs)(F.default,{center:!0,className:ee.default.empty,"data-testid":(0,k.tid)("env-vars-table","container","empty"),children:[(0,t.jsx)("h6",{className:"m-0 text-center text-copy-16",children:"No Results Found"}),(0,t.jsx)(x.Spacer,{y:.5}),(0,t.jsxs)("p",{className:"m-0 text-center text-copy-14",style:{color:"var(--accents-6)",wordBreak:"break-word"},children:['Your search for "',m,'" did not return any results.']})]}):r?.length===0?(0,t.jsxs)(F.default,{center:!0,className:ee.default.empty,children:[(0,t.jsx)("h6",{className:"m-0 text-center text-copy-16",children:E?.emptyState.title??"No Environment Variables Added"}),(0,t.jsx)(x.Spacer,{y:.5}),(0,t.jsx)("p",{className:"m-0 text-center text-copy-14",children:E?.emptyState.description??"Add Environment Variables to Production, Preview, and Development environments, including branches in Preview."})]}):(0,t.jsx)("div",{"data-testid":(0,k.tid)("env-vars-table","container"),children:(0,t.jsx)(a.Virtuoso,{components:{Item:el},context:H,data:r,initialItemCount:Math.min(r?.length??0,10),overscan:1e3,style:{minHeight:r?78*r.length:"auto"},useWindowScroll:!0})})}function ed(e,a){let[r,s]=(0,n.useState)(!1),[l,o]=(0,n.useState)(null),[d,u]=(0,n.useState)(!1),[m,p]=(0,n.useState)(null),{data:h}=(0,G.useProject)(e),f=(0,y.useToasts)(),{team:g}=(0,N.useTeam)(),j=(0,n.useCallback)(e=>{p(e),s(!0)},[]),b=(0,n.useCallback)(()=>{s(!1)},[]),E=(0,n.useCallback)(()=>{u(!1),o(null),p(null)},[]),_=(0,n.useCallback)(async()=>{if(m){u(!0);try{await (0,H.deleteEnvVar)({envVars:[m],projectId:e,teamId:g?.id}),b(),f.success("Removed Environment Variable successfully."),await a?.()}catch(e){o((0,i.normalizeError)(e))}finally{u(!1)}}},[m,f,g,e,b,a]),S=[];m?.customEnvironmentIds&&S.push(...m.customEnvironmentIds),m?.target&&((0,P.default)(m.target)?S.push(...m.target):S.push(m.target)),m?.applyToAllCustomEnvironments&&S.push(Z.INCLUDE_ALL_CUSTOM_ENVIRONMENTS_ID);let{environmentNamesList:C}=(0,Z.useCustomEnvironmentsPrettyLabel)({selectedEnvironmentIds:new Set(S.filter(e=>!!e))});return{modal:(0,n.useMemo)(()=>(0,t.jsxs)(v.Modal.Modal,{active:r,onAnimationDone:E,onClickOutside:b,children:[(0,t.jsxs)(v.Modal.Body,{children:[(0,t.jsx)(v.Modal.Header,{children:(0,t.jsx)(v.Modal.Title,{children:"Remove Environment Variable"})}),(0,t.jsxs)("p",{className:"text-copy-14",children:["You are about to remove an environment variable from your project"," ",(0,t.jsx)("span",{className:"font-medium",children:h?.name}),". This action cannot be undone."]}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-6",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-2",children:[(0,t.jsx)("p",{className:"text-copy-14",children:"Environment Variable:"}),(0,t.jsx)("p",{className:"px-4 py-3 m-0 truncate rounded bg-background-200 text-gray-1000 shadow-border",title:m?.key,children:m?m.key:""})]}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-2",children:[(0,t.jsx)("p",{className:"text-copy-14",children:"Affected Environments:"}),(0,t.jsx)("p",{className:"px-4 py-3 m-0 rounded bg-background-200 text-gray-1000 shadow-border",children:(0,A.toListSentence)(C)})]})]}),l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Spacer,{y:1}),(0,t.jsx)(c.Error,{error:l})]}):null]}),(0,t.jsxs)(v.Modal.Actions,{children:[(0,t.jsx)(v.Modal.Action,{onClick:b,type:"secondary",children:"Cancel"}),(0,t.jsx)(v.Modal.Action,{loading:d,onClick:_,type:"error",children:"Remove"})]})]}),[r,E,b,h?.name,m,l,d,C,_]),open:j,close:b}}e.s(["default",()=>eo,"useRemoveEnvModal",()=>ed])},6116602,e=>{e.v({optionBranch:"env-variables-filter-module__XqclKW__optionBranch"})},1411137,e=>{"use strict";var t=e.i(8711407),n=e.i(5323212),a=e.i(6881349),r=e.i(5255926),i=e.i(4004502),s=e.i(5927860),l=e.i(7713873),o=e.i(8835183),d=e.i(4345845),c=e.i(8249095),u=e.i(7957424),m=e.i(6116602);function v(e){let{envs:v,search:p,setSearch:h,envOrBranchFilter:x,setEnvOrBranchFilter:f,sortTarget:y,setSortTarget:g,disabled:j,disableEnvironmentSelector:b,isLoading:E,project:_}=e,S=Array.from(new Set((v||[]).map(e=>e.gitBranch??null).filter(Boolean))).sort((e,t)=>e.localeCompare(t)),{isLoading:C,data:{environments:k}}=(0,u.useAllEnvironments)(_);return(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-[50%]",children:(0,t.jsx)(o.SearchInput,{"data-testid":(0,i.tid)("env-variables-filter","search-input"),disabled:j,maxLength:256,onChange:e=>h(e.target.value),placeholder:"Search…",value:p,width:"100%"})}),f?(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-[25%]",children:(0,t.jsxs)(a.Combobox,{clearable:!1,"data-testid":(0,i.tid)("env-variables-filter","select"),disabled:j||b,noInputPrefix:!0,onChange:e=>f(e||l.allEnvironmentsFilter),value:x,children:[(0,t.jsx)(r.Skeleton,{show:!!(C||E),children:(0,t.jsx)(a.Combobox.Input,{})}),(0,t.jsx)(a.Combobox.List,{maxWidth:450,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Combobox.Option,{value:l.allEnvironmentsFilter,children:"All Environments"}),void 0===_&&(0,t.jsx)(a.Combobox.Option,{value:l.allCustomEnvironmentsFilter,children:"All Custom Environments"}),(0,t.jsx)(a.Combobox.Option,{value:(0,l.mapToEnvFilter)(s.EnvTarget.Production),children:"Production"}),(0,t.jsx)(a.Combobox.Option,{value:(0,l.mapToEnvFilter)(s.EnvTarget.Development),children:"Development"}),(0,t.jsx)(a.Combobox.Option,{value:(0,l.mapToEnvFilter)(s.EnvTarget.Preview),children:"Preview"}),k.filter(e=>(0,l.isCustomEnvId)(e.id)).sort((e,t)=>e.slug.localeCompare(t.slug)).map(e=>(0,t.jsx)(a.Combobox.Option,{className:m.default.optionBranch,value:e.id,children:e.slug},e.id)),S.map(e=>(0,t.jsx)(a.Combobox.Option,{prefix:(0,t.jsx)(d.GitBranch,{}),value:e,children:(0,t.jsx)("span",{className:`text-copy-14-mono ${m.default.optionBranch}`,children:e})},e))]})})]})}):null,(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start max-w-[184px] flex-[25%]",children:(0,t.jsxs)(n.Select,{disabled:j,onChange:e=>g(e.target.value),placeholder:"Sort by…",prefix:(0,t.jsx)(c.SortDescending,{}),value:y,children:[(0,t.jsx)("option",{value:"createdAt",children:"Last Updated"}),(0,t.jsx)("option",{value:"key",children:"Name"}),(0,t.jsx)("option",{value:"type",children:"Type"})]})})]})}e.s(["EnvVariablesFilter",()=>v])},996802,6506227,e=>{"use strict";var t=e.i(8711407),n=e.i(1176592),a=e.i(5757634),r=e.i(8248823),i=e.i(455575),s=e.i(7713873),l=e.i(1717203),o=e.i(7557283),d=e.i(6899807),c=e.i(1411137),u=e.i(5927860);function m(e,t){return Array.isArray(e)?e.includes(t):e===t}function v(e){let{envsInput:t,search:a,envOrBranchFilter:r,sortTarget:i}=e,l=(0,n.useMemo)(()=>{if(!t)return[];let e=a?t.filter(e=>e.key.toLowerCase().includes(a.toLowerCase())):t;if((0,s.isEnvFilter)(r)){if(r===s.allEnvironmentsFilter)return e;if(r===s.allCustomEnvironmentsFilter)return e.filter(e=>!!e.applyToAllCustomEnvironments);if(r===(0,s.mapToEnvFilter)(u.EnvTarget.Production))return e.filter(e=>m(e.target,u.EnvTarget.Production));if(r===(0,s.mapToEnvFilter)(u.EnvTarget.Development))return e.filter(e=>m(e.target,u.EnvTarget.Development));if(r===(0,s.mapToEnvFilter)(u.EnvTarget.Preview))return e.filter(e=>m(e.target,u.EnvTarget.Preview));if((0,s.isCustomEnvId)(r))return e.filter(e=>e.applyToAllCustomEnvironments||e.customEnvironmentIds?.includes(r))}return e.filter(e=>e.gitBranch===r)},[t,a,r]);return(0,n.useMemo)(()=>i&&"contentHint"!==i?"createdAt"===i?l.sort((e,t)=>(t.updatedAt??t.createdAt)-(e.updatedAt??e.createdAt)):l.sort((e,t)=>(e[i]?.toString()??"").localeCompare(t[i]?.toString()??"")):l,[l,i])}e.s(["useFilteredEnvs",()=>v],6506227);var p=e.i(4171299),h=e.i(5119716);function x(e){let{teamId:u,project:m,withFilters:x=!0,sharedEnvs:f,projectEnvs:y,mutateSharedEnvVarData:g,isLoading:j,SWRCacheKey:b,envOrBranchFilter:E,sortTarget:_,setEnvOrBranchFilter:S,setSortTarget:C,search:k,setSearch:w,currentEditingEnv:T,setCurrentEditingEnv:N}=e,I=(0,i.useToasts)(),{cache:P}=(0,a.useSWRConfig)(),[L,A]=(0,n.useState)(""),[V,R]=(0,n.useState)(E??s.allEnvironmentsFilter),[B,F]=(0,n.useState)("createdAt");!x&&(k&&w&&(L=k,A=w),E&&S&&(V=E,R=S),_&&C&&(B=_,F=C));let O=m?.id,{can:D,isLoading:M}=(0,l.default)(O?{projectIdOrName:O}:void 0),G=D(o.Action.Read,O?o.Resource.ProjectEnvVars:o.Resource.SharedEnvVars),$=D(o.Action.Read,O?o.Resource.ProjectEnvVarsProduction:o.Resource.SharedEnvVarsProduction),H=D(o.Action.Delete,o.Resource.SharedEnvVarConnection),z=(0,d.useRemoveEnvModal)(void 0,g),{decryptEnvVar:W}=(0,h.useDecryptEnvVar)(b,g,{teamId:u,projectId:O}),U=G||$,Y=v({envsInput:f,search:L,envOrBranchFilter:V,sortTarget:B}),Z=(0,n.useCallback)(async(e,t)=>{try{await (0,p.removeProjectFromSharedEnvVar)({envVar:e,projectId:t,teamId:u}),g(),I.success("Successfully unlinked Shared Environment Variable")}catch(e){I.error((0,r.normalizeError)(e).message)}},[g,u,I]),q=(0,n.useCallback)(e=>y?y.filter(t=>t.key===e.key).reduce((t,n)=>((Array.isArray(n.target)?n.target:[n.target]).forEach(n=>{e.target.includes(n)&&t.push(n)}),t),[]):[],[y]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[x?(0,t.jsx)(c.EnvVariablesFilter,{disabled:!1,envOrBranchFilter:V,envs:f,project:O,search:L,setEnvOrBranchFilter:R,setSearch:A,setSortTarget:F,sortTarget:B}):null,(0,t.jsx)(d.default,{canReadProductionValues:$,canUnlinkSharedEnvVariable:H,currentEditingEnv:T,disabled:j||M||!U,envVariables:Y,getOverriddenTargetsForSharedEnvVar:q,isLoading:j||M,onRemove:e=>{void 0!==O?Z(e,O):z.open(e)},onSave:e=>{let t=P.get(b)?.data;if(t.envs.length>0){let n=[...t.envs],a=n.findIndex(t=>t.id===e.id),r={...n[a],...e,decrypted:!1};n[a]=r,g({envs:n},!1),W(r)}},onViewEnvironmentVariable:W,projectId:O,search:L,setCurrentEditingEnv:N,teamId:u,textConfig:{emptyState:{title:O?"No Shared Environment Variables are linked to this app.":"No Shared Environment Variables are set.",description:O?`Shared Environment Variables are set at the ${u?"Team":"Account"} level
              and are inherited by this Project.`:"Shared Environment Variables are set at the Team level."}},withEnvs:!0,withSecrets:!1})]}),z.modal]})}e.s(["TEVTable",()=>x],996802)},2383382,e=>{"use strict";var t=e.i(7909933),n=e.i(3924999),a=e.i(1176592),r=e.i(8042625),i=e.i(277234),s=e.i(4244280),l=e.i(1717203),o=e.i(7557283);function d(e){let{teamId:l,projectId:o,ids:d,excludeIds:c,excludeProjectId:u}=e,{limit:m=8,search:v,revalidateFirstPage:p=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},x=arguments.length>3&&void 0!==arguments[3]&&arguments[3],f=arguments.length>4&&void 0!==arguments[4]&&arguments[4],y=(0,n.default)((e,t)=>{if(!e)return`${s.API_SHARED_ENV_VARIABLES}${(0,r.encode)({limit:m,search:v,teamId:l,projectId:o,ids:d,exclude:{ids:c??null,projectId:u??null}})}`;if(t&&t.length>=m){let e=t[t.length-1];return`${s.API_SHARED_ENV_VARIABLES}${(0,r.encode)({until:e.updatedAt||e.createdAt-1,limit:m,search:v,teamId:l,projectId:o,ids:d,exclude:{ids:c??null,projectId:u??null}})}`}return null},async e=>(await (0,i.fetchAPI)(e,{throwOnHTTPError:!0})).data,{...h,keepPreviousData:f,revalidateFirstPage:p,persistSize:!0}),g=!!y.data,j=g&&y.data[y.data.length-1]?.length<m,b=(0,a.useMemo)(()=>y.data?y.data.flat():[],[y.data]),E=g&&0===b.length,_=g&&y.size>y.data.length;return(0,t.default)(()=>{if(!x||!y.data||j)return null;let e=y.data[y.data.length-1];return`${s.API_SHARED_ENV_VARIABLES}${(0,r.encode)({until:(e[e.length-1].updatedAt??e[e.length-1].createdAt)-1,limit:m,search:v,teamId:l,projectId:o,ids:d,exclude:{ids:c??null,projectId:u??null}})}`},e=>(0,i.fetchAPI)(e,{throwOnHTTPError:!0})),[y,{envVars:b,initialDataLoaded:g,isEmpty:E,loadMore:()=>y.setSize(e=>e+1),isLoadingMore:_,isReachingEnd:j,isValidating:y.isValidating}]}function c(e,n,a,r){let{can:s,isLoading:d}=(0,l.default)(n?{projectIdOrName:n}:void 0),c=s(o.Action.List,o.Resource.ProjectEnvVars),m=e&&!d&&c;return(0,t.default)(()=>m?u({teamId:e,ids:a,projectId:n}):"",async e=>{let{data:t}=await (0,i.fetchAPI)(e,{throwOnHTTPError:!0});return{envs:t}},r)}function u(e){let{teamId:t,projectId:n,ids:a}=e;return`${s.API_SHARED_ENV_VARIABLES}/all${(0,r.encode)({teamId:t,projectId:n,ids:a})}`}e.s(["getUseSharedEnvsSWRKey",()=>u,"useSharedEnvVarsInfinite",()=>d,"useTeamSharedEnvs",()=>c])}]);

//# debugId=eaec803b-eb7c-cf42-d971-fc16debbe493
//# sourceMappingURL=0472b15ec8ea2657.js.map
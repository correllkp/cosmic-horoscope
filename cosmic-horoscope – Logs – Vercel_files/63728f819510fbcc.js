;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="40c3be17-b370-db67-5d51-8cedcacbb1a9")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,131102,e=>{"use strict";var t=e.i(1875382),i=e.i(818351),n=e.i(134877),l=e.i(7952834),a=e.i(7101053);function s(e){let{teamSlug:s}=(0,t.useParams)()??{},r=(0,a.useDefaultProjectParams)();return(0,i.useIsomorphicSWR)(e?(0,l.getProjectKey)(e,{teamId:s,...r}):null,async(e,t)=>{try{let i=await t(e);return(0,l.transformDeploymentOverviewProject)(i)}catch(e){if((0,n.isAPIErrorForbidden)(e)||(0,n.isAPIErrorNotFound)(e))return null;throw e}})}e.s(["useDeploymentOverviewProject",()=>s])},8382149,9148684,e=>{"use strict";var t=e.i(8711407),i=e.i(1176592),n=e.i(8159863),l=e.i(3212616),a=e.i(5129431),s=e.i(2645806),r=e.i(7629673),o=e.i(9365163),c=e.i(6619197),d=e.i(57106),u=e.i(4030453),p=e.i(6891161),m=e.i(9318197),x=e.i(455575),h=e.i(4004502),y=e.i(277234),f=e.i(4244280),j=e.i(5338940),g=e.i(609109),b=e.i(2695633),v=e.i(1875382),C=e.i(131102);let w=(0,i.memo)(function(e){let{active:n,onClose:l,deployment:a,teamId:s}=e,[r,o]=(0,i.useState)(!1),c=(0,v.useRouter)(),{teamSlug:d,project:u}=(0,v.useParams)()??{},{data:m}=(0,C.useDeploymentOverviewProject)(u),x=(0,i.useCallback)(async()=>{o(!0);let e=s?`?teamId=${s}`:"";await (0,y.fetchAPI)(`${(0,f.API_DEPLOYMENTS)("v2")}/${a.id}${e}`,{throwOnHTTPError:!0,method:"DELETE"}),c.replace(`/${d??""}/${encodeURIComponent(m?.name||"")}?deploymentDeleted=1`),o(!1)},[a,s,c,m,d]);return(0,t.jsxs)(p.Modal.Modal,{active:n,onClickOutside:l,width:"500px",children:[(0,t.jsxs)(p.Modal.Body,{children:[(0,t.jsx)(p.Modal.Header,{children:(0,t.jsx)(p.Modal.Title,{children:"Delete Deployment"})}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:[(0,t.jsx)("b",{children:"NOTE:"})," Deployments that are not actively receiving any traffic do not generate any costs nor count towards any limits."]}),(0,t.jsx)("p",{className:"text-copy-14",children:"Deleting this deployment will prevent you from instantly reverting and might break links used in integrations, such as the ones in the pull requests of your Git provider."}),(0,t.jsx)("p",{className:"text-copy-14",style:{marginBottom:0},children:"Are you sure you want to continue?"})]})]}),(0,t.jsxs)(p.Modal.Actions,{children:[(0,t.jsx)(p.Modal.Action,{loading:!1,onClick:l,type:"secondary",children:"Cancel"}),(0,t.jsx)(p.Modal.Action,{disabled:r,loading:r,onClick:x,children:"Delete"})]})]})});var k=e.i(1857939),N=e.i(1717203),A=e.i(7557283);function I(e){let{project:t,deployment:i}=e,{can:n,isLoading:l}=(0,N.default)({projectIdOrName:t?.name}),{isLoggedOut:a}=(0,k.useIsLoggedIn)(),s=i?.target==="production"?A.Resource.DeploymentFromProductionBranch:A.Resource.DeploymentPreview,r=n(A.Action.Create,s),o=n(A.Action.Update,s),c=n(A.Action.Read,s)||!!(a&&i?.public),d=n(A.Action.Delete,s),u=n(A.Action.Create,A.Resource.Deployment),p=n(A.Action.Update,A.Resource.SkewProtection),m=n(A.Action.Create,A.Resource.DeploymentFromProductionBranch)&&u;return{isLoading:l,permissions:{canCreateDeployment:r,canUpdateDeployment:o,canReadDeployment:c,canDeleteDeployment:d,canPromoteToProduction:u,canUpdateSkewProtection:p,canRedeployProduction:m}}}e.s(["useDeploymentPermissions",()=>I],9148684);let E=(0,i.createContext)(void 0);function D(e){let{children:n}=e,[l,a]=(0,i.useState)(!0),[s,r]=(0,i.useState)({openRedeployModal:()=>{},openCancelDeploymentModal:()=>{},openPromoteToProductionModal:()=>{},openInstantRollbackModal:()=>{},openSkewProtectionModal:()=>{},openDeleteDeploymentModal:()=>{},canRollbackDeployment:!1,isLoadingModals:l});return(0,t.jsxs)(E.Provider,{value:s,children:[n,(0,t.jsx)(i.Suspense,{fallback:null,children:(0,t.jsx)(M,{setIsLoadingModals:a,setModalsContext:r})})]})}function M(e){let{setIsLoadingModals:i,setModalsContext:n}=e,{data:a}=(0,l.useCurrentDashboardDeploymentOverviewProject)();return a?(0,t.jsx)(P,{project:a,setIsLoadingModals:i,setModalsContext:n}):null}function P(e){let{setIsLoadingModals:l,setModalsContext:v,project:C}=e,{data:k,mutate:N}=(0,n.useCurrentDashboardDeploymentInterval)(),{permissions:A}=I({project:C,deployment:k}),E=(0,r.useIsCurrentProductionDeployment)(),{modal:D,open:M}=(0,a.default)(C),{canRollbackDeployment:P,rollbackModal:S,openRollbackModal:T}=(0,o.useInstantRollbackModal)(C),{modal:L,open:R}=function(e){let[n,l]=(0,i.useState)(!1),[a,s]=(0,i.useState)(!1),[r,o]=(0,i.useState)(null),[c,v]=(0,i.useState)(null),C=(0,x.useToasts)(),{team:w}=(0,j.useTeam)(),k=w?.id,N=(0,b.getGitMeta)(r?.meta),A=(0,i.useCallback)(e=>{o(e),l(!0)},[]),I=(0,i.useCallback)(()=>{l(!1)},[]),E=(0,i.useCallback)(()=>{s(!1),o(null),v(null)},[]),D=(0,i.useCallback)(()=>{if(!e)throw v({message:"projectIdOrName is required to save skew protection"}),Error("projectIdOrName is required to save skew protection");if(!r)throw v({message:"deployment is required to save skew protection"}),Error("deployment is required to save skew protection");s(!0),v(null),(0,y.fetchAPI)(`${(0,f.API_PROJECTS_VERSION)("v9")}/${encodeURIComponent(e)}${k?`?teamId=${k}`:""}`,{method:"PATCH",body:JSON.stringify({skewProtectionBoundaryAt:r.createdAt}),throwOnHTTPError:!0}).then(e=>{e&&(C.success("Successfully configured Skew Protection."),I())}).catch(e=>{v(e)}).finally(()=>{s(!1)})},[e,r,k,C,I]);return{modal:(0,i.useMemo)(()=>(0,t.jsxs)(p.Modal.Modal,{active:n,"data-testid":(0,h.tid)("skew-protection-modal","modal"),onAnimationDone:E,onClickOutside:I,width:"500px",children:[(0,t.jsxs)(p.Modal.Body,{children:[(0,t.jsx)(p.Modal.Header,{children:(0,t.jsx)(p.Modal.Title,{children:"Skew Protection Threshold"})}),(0,t.jsx)(m.Spacer,{y:1}),(0,t.jsxs)("p",{className:"text-copy-14",children:["Deployments created before"," ",N?(0,t.jsx)(d.Link,{external:!0,href:N.commitUrl,title:"Open git commit in a new window",type:"highlight",children:N.sha.slice(0,7)}):"the selected deployment"," ","(",(0,t.jsx)("em",{children:(0,g.formatDateAndTime)(new Date(r?.createdAt??0))}),")"," ","will no longer use Skew Protection."]}),(0,t.jsx)(m.Spacer,{y:1}),(0,t.jsx)("p",{className:"text-copy-14",children:"This overrides the maximum age set in your project settings to define a specific deployment as the cutoff."}),(0,t.jsx)(m.Spacer,{y:1}),(0,t.jsx)("p",{className:"text-copy-14",children:"While uncommon, this may be necessary if there is a specific problematic deployment you want to ensure no longer resolves requests from any other active clients."}),(0,t.jsx)(m.Spacer,{y:1}),c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Error,{error:c}),(0,t.jsx)(m.Spacer,{y:1})]}):null,(0,t.jsxs)("p",{className:"text-copy-14",children:["Learn more about"," ",(0,t.jsx)(d.Link,{external:!0,href:"https://vercel.com/docs/skew-protection",type:"highlight",children:"Skew Protection"})]})]}),(0,t.jsxs)(p.Modal.Actions,{children:[(0,t.jsx)(p.Modal.Action,{loading:!1,onClick:I,type:"secondary",children:"Cancel"}),(0,t.jsx)(p.Modal.Action,{"data-testid":(0,h.tid)("skew-protection-modal","save-button"),loading:a,onClick:D,children:"Set"})]})]}),[I,E,n,a,c,D,r,N]),close:I,open:A}}(C.id),O=(0,i.useCallback)(()=>{N()},[N]),{modal:B,open:_}=(0,c.default)(k.projectId,C,{onDeploymentPromoted:O}),[F,U]=(0,i.useState)(!1),[H,V]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{l(!1),v({openRedeployModal:()=>M(k),openCancelDeploymentModal:()=>U(!0),openPromoteToProductionModal:()=>_(k),openInstantRollbackModal:()=>T(k),openSkewProtectionModal:()=>R(k),openDeleteDeploymentModal:()=>V(!0),canRollbackDeployment:P,isLoadingModals:!1})},[P,k,E,T,_,M,R,v,l]),(0,t.jsxs)(t.Fragment,{children:[S,L,B,D,(0,t.jsx)(s.default,{active:F,deployment:k,onClose:()=>U(!1),teamId:k.team?k.team.id:null}),A.canDeleteDeployment?(0,t.jsx)(w,{active:H,deployment:k,onClose:()=>V(!1),teamId:k.team?.id}):null]})}E.displayName="DeploymentModalsContext",e.s(["DeploymentModalsProvider",()=>D,"useDeploymentModals",0,()=>{let e=(0,i.useContext)(E);if(!e)throw Error("useDeploymentRedeployModal must be used within a DeploymentModalsProvider");return e}],8382149)},3872400,e=>{"use strict";var t=e.i(8711407),i=e.i(1176592),n=e.i(1875382),l=e.i(4004502),a=e.i(8893913),s=e.i(3753138),r=e.i(8876434),o=e.i(5255926),c=e.i(2504781),d=e.i(5468328),u=e.i(8674454),p=e.i(4991687),m=e.i(6694387),x=e.i(8459493),h=e.i(7448864),y=e.i(5326905),f=e.i(455575),j=e.i(119294),g=e.i(6352514),b=e.i(3981247),v=e.i(1857939),C=e.i(57106),w=e.i(545405),k=e.i(475038),N=e.i(8382149),A=e.i(380513),I=e.i(9148684),E=e.i(472117),D=e.i(4443312),M=e.i(6619197),P=e.i(9365163);function S(e){let{project:o,deployment:c}=e,{permissions:C,isLoading:S}=(0,I.useDeploymentPermissions)({project:o,deployment:c}),{data:R}=(0,b.useRollingRelease)({teamIdOrSlug:o?.accountId,projectSlug:o?.name}),O=(0,E.useChecksPrivateBetaFlag)(),B=(0,E.useCiChecksAndPoliciesFlagV2)(),_=O||B,{data:F}=(0,A.useFeatureFlag)("enable-team-deployments-page"),{isLoggedOut:U}=(0,v.useIsLoggedIn)(),H=(0,k.useIsViewingPublicDeployment)(),V=(0,f.useToasts)(),{openRedeployModal:z,openPromoteToProductionModal:q,openSkewProtectionModal:$,openInstantRollbackModal:Y,openDeleteDeploymentModal:G,canRollbackDeployment:W,isLoadingModals:K}=(0,N.useDeploymentModals)(),Q=(0,i.useCallback)(e=>{(0,w.copyToClipboard)(e),V.message("Copied to clipboard!"),j.analytics.track(g.AnalyticsEvent.DEPLOYMENT_OVERVIEW_COPIED_DEPLOYMENT_URL,{projectId:c.projectId,deploymentId:c.id,deploymentTarget:c.target})},[c,V]),X=Object.values(C).every(e=>!e),J=Object.values(C).every(e=>e),{teamSlug:Z,project:ee}=(0,n.useParams)()??{},et=(0,i.useMemo)(()=>{if(!Z||!ee)return null;let e=new URLSearchParams,t=c.gitSource?.ref;return t?(e.set("filterBranch",t),`/${Z}/${ee}/deployments?${e.toString()}`):null},[Z,ee,c]),ei=(0,i.useMemo)(()=>{if(!Z)return null;let e=new URLSearchParams,t=c.gitSource?.ref;return t?(e.set("filterBranch",t),`/${Z}/~/deployments?${e.toString()}`):null},[Z,c]),en=F&&ei?ei:et,el=!!(o?.link?.type==="github"&&o.link.org&&o.link.repo&&c.meta?.githubCommitSha),{data:ea}=(0,D.useProjectCheckRuns)({deploymentId:c.id,enableCiChecksAndPolicies:_}),es=!!el&&!!ea&&!ea.runs.every(e=>"succeeded"===e.conclusion&&"completed"===e.status),er=(0,M.usePromoteTooltip)(c),eo=(0,P.useRollbackTooltip)(c);if(X)return(0,t.jsx)(L,{});if(!H&&S&&!U)return(0,t.jsx)(T,{});let ec=null;W&&(ec=eo?(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,t.jsx)(d.Tooltip,{position:"top",boxAlign:"center",style:{width:"100%"},text:eo,children:(0,t.jsx)(x.MenuItem,{disabled:!0,style:{width:"100%"},suffix:(0,t.jsx)(a.RotateCounterClockwise,{color:"gray-600"}),children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:(0,t.jsx)("span",{className:"text-copy-14",style:{fontSize:"inherit",color:"inherit"},children:"Instant Rollback"})})})})}):(0,t.jsx)(x.MenuItem,{onClick:Y,suffix:(0,t.jsx)(a.RotateCounterClockwise,{color:"gray-900"}),title:eo,children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:(0,t.jsx)("span",{className:"text-copy-14",style:{fontSize:"inherit",color:"inherit"},children:"Instant Rollback"})})}));let ed=null;if(C.canPromoteToProduction){let e=!!er,i="production"===c.target,n=e?"Promote":R?.rollingRelease?.state==="ACTIVE"?"Queue for Promotion":i&&es&&_?"Force Promote":i?"Promote":es?"Force Promote to Production":"Promote to Production";ed=e?(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,t.jsx)(d.Tooltip,{boxAlign:"center",position:"top",style:{width:"100%"},text:er,children:(0,t.jsx)(x.MenuItem,{disabled:!0,style:{width:"100%"},suffix:(0,t.jsx)(s.ArrowCircleUp,{color:"gray-600"}),children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:(0,t.jsx)("span",{className:"text-copy-14",style:{fontSize:"inherit",color:"inherit"},children:n})})})})}):(0,t.jsx)(x.MenuItem,{disabled:K,onClick:q,suffix:(0,t.jsx)(s.ArrowCircleUp,{color:"gray-900"}),children:n})}let eu="production"===c.target?C.canRedeployProduction:C.canCreateDeployment;return(0,t.jsxs)(p.MenuContainer,{position:"bottom-end",children:[(0,t.jsx)(m.MenuButton,{"aria-label":"Deployment Actions","data-testid":(0,l.tid)("deployment-actions","more-button"),disabled:!c,shape:"square",svgOnly:!0,type:"secondary",children:(0,t.jsx)(r.MoreHorizontal,{})}),(0,t.jsxs)(u.Menu,{width:"auto",children:[H?null:(0,t.jsxs)(t.Fragment,{children:[ec,ed,eu?(0,t.jsx)(x.MenuItem,{disabled:H||K,onClick:z,children:"Redeploy"}):null]}),C.canReadDeployment?(0,t.jsx)(x.MenuItem,{onClick:()=>Q(`https://${c.host}`),children:"Copy URL"}):null,!H&&en?(0,t.jsx)(x.MenuItem,{href:en,isLink:!0,children:"View All Branch Deployments"}):null,!H&&C.canUpdateSkewProtection?(0,t.jsx)(x.MenuItem,{disabled:K||!o?.skewProtectionMaxAge,onClick:$,children:"Skew Protection Threshold"}):null,!H&&C.canDeleteDeployment?(0,t.jsx)(x.MenuItem,{disabled:!function(e){let{readyState:t}=e;return"QUEUED"!==t&&"BUILDING"!==t}(c)||K,onClick:G,type:"error",children:"Delete"}):null,!J&&!U&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.MenuDivider,{}),H?null:(0,t.jsxs)(t.Fragment,{children:[W?null:(0,t.jsx)(h.MenuItemLocked,{children:"Instant Rollback"}),C.canPromoteToProduction?null:(0,t.jsx)(h.MenuItemLocked,{children:"Promote"}),eu?null:(0,t.jsx)(h.MenuItemLocked,{children:"Redeploy"})]}),C.canReadDeployment?null:(0,t.jsx)(h.MenuItemLocked,{children:"Copy URL"}),H||C.canUpdateSkewProtection?null:(0,t.jsx)(h.MenuItemLocked,{children:"Skew Protection Threshold"}),H||C.canDeleteDeployment?null:(0,t.jsx)(h.MenuItemLocked,{children:"Delete"})]})]})]})}function T(){return(0,t.jsx)(o.Skeleton,{children:(0,t.jsx)(L,{})})}function L(){return(0,t.jsx)(d.Tooltip,{position:"bottom",text:(0,t.jsxs)(t.Fragment,{children:["Additional permissions are required to manage Deployment."," ",(0,t.jsx)(C.Link,{href:"/docs/deployments",variant:"highlight",children:"Learn More →"})]}),children:(0,t.jsx)(c.Button,{"aria-label":"Deployment Actions","data-testid":(0,l.tid)("deployment-actions","more-button"),disabled:!0,shape:"square",svgOnly:!0,type:"secondary",children:(0,t.jsx)(r.MoreHorizontal,{})})})}e.s(["DeploymentMetadataMenuSkeleton",()=>T,"DeploymentMoreMenu",()=>S])},310143,e=>{"use strict";var t=e.i(8711407),i=e.i(9722978),n=e.i(2504781),l=e.i(5468328),a=e.i(7917902),s=e.i(5044530),r=e.i(8893913),o=e.i(475038),c=e.i(100247),d=e.i(1176592),u=e.i(9166951),p=e.i(5585544),m=e.i(3353711),x=e.i(8735244),h=e.i(5255926),y=e.i(6891161),f=e.i(9668517),j=e.i(2695633),g=e.i(3089600),b=e.i(5229375),v=e.i(4896636),C=e.i(1585391),w=e.i(243249);let k=e=>{let{team:t,user:i,projectName:n}=e,l=t?.slug||i?.username;return l&&n?`/${l}/${n}/settings/deployment-protection`:""};var N=e.i(3306538),A=e.i(8674454),I=e.i(6694387),E=e.i(4991687),D=e.i(8459493),M=e.i(8522580),P=e.i(7087273),S=e.i(455575),T=e.i(57106),L=e.i(1438473),R=e.i(6318858),O=e.i(2560270),B=e.i(4345845),_=e.i(5479400),F=e.i(3228096),U=e.i(9138164),H=e.i(2375916),V=e.i(2563635),z=e.i(3814652),q=e.i(119294),$=e.i(6352514),Y=e.i(7780974),G=e.i(7837522),W=e.i(3322724),K=e.i(1717203),Q=e.i(7557283),X=e.i(1875382),J=e.i(2882012);e.i(6483798);var Z=e.i(8287059),ee=e.i(1475969),et=e.i(4595422),ei=e.i(9481787),en=e.i(1136434),el=e.i(5756088);let ea=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M14 6V4.5C14 3.39543 13.1046 2.5 12 2.5C10.8954 2.5 10 3.39543 10 4.5V6H10.5H12V7.5V12.5C12 13.8807 10.8807 15 9.5 15H2.5C1.11929 15 0 13.8807 0 12.5V7.5V6H1.5H8.5V4.5C8.5 2.567 10.067 1 12 1C13.933 1 15.5 2.567 15.5 4.5V6H14ZM10.5 7.5H10H8.5H1.5V12.5C1.5 13.0523 1.94772 13.5 2.5 13.5H9.5C10.0523 13.5 10.5 13.0523 10.5 12.5V7.5Z" fill="currentColor"/>');var es=e.i(198667),er=e.i(5326905),eo=e.i(4670733),ec=e.i(1138941),ed=e.i(8529990),eu=e.i(1114103),ep=e.i(9021722),em=e.i(8436238),ex=e.i(1201436);let eh={visible:{opacity:1,scale:1,filter:"blur(0px)"},hidden:{opacity:0,scale:.6,filter:"blur(2px)"}};function ey(e){let{"aria-label":l,classNameSuccess:a,textToCopy:s,onClick:r,label:o,isLoading:c,...u}=e,p=(0,S.useToasts)(),[m,h]=(0,d.useState)(!1),[y,f]=(0,d.useState)(!1),j=(0,d.useRef)(null);return(0,d.useEffect)(()=>{m&&s&&(h(!1),j.current&&clearTimeout(j.current),f(!0),navigator.clipboard.writeText(s).catch(()=>p.error("Failed to copy to clipboard")),j.current=setTimeout(()=>{f(!1)},1e3))},[p,s,m]),(0,t.jsx)(n.Button,{"aria-label":l,disabled:u.disabled||m,onClick:()=>{h(!0),r?.()},...u,className:(0,i.clsx)(u.className,{[a||""]:y}),children:(0,t.jsx)("div",{className:"flex items-center gap-1.5",children:(0,t.jsxs)(ep.MotionConfig,{transition:{duration:.1},children:[(0,t.jsx)(eu.AnimatePresence,{initial:!1,mode:"wait",children:c?(0,t.jsx)(x.Spinner,{}):y?(0,t.jsx)(em.motion.div,{animate:"visible",exit:"hidden",initial:"hidden",variants:eh,children:(0,t.jsx)(R.Check,{})},"check"):(0,t.jsx)(em.motion.div,{animate:"visible",exit:"hidden",initial:"hidden",variants:eh,children:(0,t.jsx)(ex.Copy,{})},"copy")}),o]})})})}var ef=e.i(1681029);function ej(e){let{alias:t,protectionBypass:i,protectionEnabledForDeployment:n}=e;if(!t)return;let l=(0,ef.domainToUrl)(t);return i&&n?(0,et.createShareableLink)(l,i):l}var eg=e.i(4123527);function eb(e){let{alias:l,deployment:s,isLoading:r,previewCommentsEnabledForDeployment:o,protectionBypass:c,protectionEnabledForDeployment:u,git:p,onCreateShareableLink:m,onDeleteShareableLink:x,onRegenerateShareableLink:h,openUpgradeModal:y,canUpdateShareableLink:f,viewAndCommentDescription:j}=e,g=(0,W.useIsMobile)(),b=(0,W.useMediaQuery)(430),{team:v,account:C}=(0,a.useAccount)(),w=(0,ec.useProjectIdOrName)(),k=C?.billing?.plan==="hobby",[N,I]=(0,d.useState)(c?"anyone":"team"),[M,P]=(0,d.useState)(!1),S=l&&ej({alias:l,protectionBypass:c,protectionEnabledForDeployment:u||!!c}),L=!u&&!o,O=(0,t.jsx)(ey,{"aria-label":"Copy Link",className:"!h-8 !w-auto !justify-start !px-1",disabled:r||!l||M,onClick:()=>q.analytics.track($.AnalyticsEvent.DEPLOYMENT_SHARE_COPY_LINK,{projectId:w,deploymentType:"alias"}),textToCopy:S||"",type:"secondary",label:b?"Link":"Copy Link",isLoading:r||M}),B=(0,ed.getGitInfoFromDeployment)(s),_=(0,eo.useNewFeedbackSharingModal)().value||!1,F=B&&!B.isPublic,U=!!(_&&F&&k),H=(0,d.useCallback)(()=>{q.analytics.track($.AnalyticsEvent.DEPLOYMENT_SHARE_UPGRADE_TO_PRO_CLICKED,{projectId:w,isHobbyPrivate:U}),y()},[U,y,w]),V=(0,d.useCallback)(e=>{if("anyone"===e&&k||I(e),"anyone"!==e||c)c&&x();else{if(k)return void P(!0);m()}},[k,c,m,x]);(0,d.useEffect)(()=>{M&&c&&P(!1)},[M,P,c,N]),(0,d.useEffect)(()=>{r||I(c?"anyone":"team")},[c,r]);let z=_&&U&&!!v&&(0,t.jsxs)(t.Fragment,{children:["To allow external collaborators to comment on the Hobby plan, the repository"," ",(0,t.jsx)("span",{style:{display:"inline-block",transform:"scale(0.85) translateY(2px)"},children:p?.logo})," ",B?.repoName," ",(0,t.jsx)(el.LockClosed,{size:12})," visibility must be public."]}),Y=(0,d.useMemo)(()=>{if(!f)return"You need additional permissions to manage sharing"},[f]),G="Only people with access",K=u?"Anyone with the link":"Publicly accessible",Q=(c||r)&&u;return L?(0,t.jsxs)(ev,{notActionable:!0,children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2.5 flex-initial",children:(0,t.jsx)("p",{className:(0,i.clsx)("text-copy-14 text-left text-pretty [&_svg]:align-text-top"),children:"Publicly accessible"})}),O]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(E.MenuContainer,{children:["team"===N?(0,t.jsxs)(ev,{disabled:r||M,notActionable:!!Y,children:[(0,t.jsx)(ew,{disabled:r||M,isActionable:!Y,children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2.5 flex-initial",children:(0,t.jsx)(eC,{forceHide:!Y,text:Y,children:(0,t.jsxs)("p",{className:"text-copy-14 text-left flex flex-nowrap items-center gap-1 text-pretty",children:[G,b?null:` can ${j}`,Y?null:(0,t.jsx)(en.ChevronDownSmall,{})]})})})}),O]}):(0,t.jsxs)(ev,{disabled:r,notActionable:!!Y,children:[(0,t.jsx)(ew,{disabled:r,isActionable:!Y,children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2.5 flex-initial",children:(0,t.jsx)(eC,{forceHide:!Y,text:Y,children:(0,t.jsxs)("div",{className:"flex flex-col items-start justify-start flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:[(0,t.jsxs)("p",{className:(0,i.clsx)("text-copy-14 text-left text-pretty [&_svg]:align-text-top",Y?"text-gray-800":void 0),children:[K,u&&!b?` can ${j}`:null]}),Y?null:(0,t.jsx)(en.ChevronDownSmall,{})]}),o?(0,t.jsxs)("p",{className:(0,i.clsx)("text-copy-13",Y?"text-gray-800":"text-gray-900"),children:["Visitors must"," ",(0,t.jsx)("span",{className:"geist-hide-on-mobile",children:"be logged in"})," ",(0,t.jsx)("span",{className:"geist-show-on-mobile",children:"log in"})," to comment"]}):null]})})})}),O]}),(0,t.jsxs)(A.Menu,{width:300,children:[(0,t.jsx)(eC,{forceHide:!Y,text:Y,children:(0,t.jsx)(D.MenuItem,{disabled:r||!!Y,onClick:()=>V("team"),prefix:(0,t.jsx)(el.LockClosed,{}),style:{width:"100%"},suffix:"team"===N?(0,t.jsx)(R.Check,{}):null,children:G})}),(0,t.jsx)(eC,{forceHide:!(Y||z),text:Y||z,children:(0,t.jsx)(D.MenuItem,{disabled:r||U||!!Y||M,innerMenuItemClassName:"!pointer-events-auto",onClick:()=>{V("anyone")},prefix:(0,t.jsx)(ea,{}),style:{width:"100%"},suffix:"anyone"===N?(0,t.jsx)(R.Check,{}):null,children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial w-full",children:[K,U?(0,t.jsx)(n.Button,{onClick:H,size:"small",style:{cursor:"pointer",background:"var(--geist-foreground)",color:"var(--geist-background)"},children:"Upgrade"}):null]})})}),Q?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(er.MenuDivider,{}),(0,t.jsx)(eC,{text:"Regenerate shareable link",children:(0,t.jsx)(D.MenuItem,{onClick:h,prefix:(0,t.jsx)(es.RefreshClockwise,{}),style:{width:"100%"},children:"Reset link"})})]}):null]})]}),(0,t.jsx)(eg.ToastMobileAware,{actionText:"Confirm",active:M,cancelActionText:"Cancel",onAction:()=>{I("anyone"),m()},onCancelAction:()=>{P(!1)},preserve:!0,toastKey:"create-shareable-link-hobby-confirmation",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:["You can only have 1 shareable link at a time on Hobby."," ",(0,t.jsx)(T.Link,{external:!0,icon:!1,onClick:()=>{P(!1),H()},underline:!g||void 0,variant:g?"highlight":void 0,children:"Upgrade to Pro"})," ","for unlimited shareable links."]}),(0,t.jsx)("p",{className:"text-copy-14",children:"Continuing will revoke any existing shareable links."})]})})]})}function ev(e){let{disabled:n=!1,children:l,notActionable:a}=e;return(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial w-full",children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial w-full",children:(0,t.jsx)("div",{className:(0,i.clsx)("flex flex-col items-stretch justify-start flex-initial w-full py-0 pl-0.5",{"cursor-not-allowed":n,"cursor-default":a&&!n}),children:(0,t.jsx)("div",{className:"flex flex-row items-stretch justify-between flex-initial w-full",children:l})})})})}function eC(e){let{children:i,forceHide:n,text:a}=e;return(0,t.jsx)(l.Tooltip,{desktopOnly:!0,forceHide:n,maxWidth:350,padding:10,style:{width:"100%"},text:a,children:i})}function ew(e){let{isActionable:i,children:n,disabled:l}=e;return i?(0,t.jsx)(I.MenuButton,{disabled:l,variant:"unstyled",className:"hover:bg-gray-100 rounded-md",children:n}):(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial pl-1.5",children:n})}var ek=e.i(4585051),eN=e.i(6942035),eA=e.i(2988836),eI=e.i(1867722),eE=e.i(681883),eD=e.i(7898658),eM=e.i(9523111);function eP(){return(0,t.jsx)("div",{className:"flex flex-col items-center justify-center flex-initial max-w-max overflow-hidden rounded-full border border-gray-400 bg-gray-700 p-2 font-bold text-white",children:(0,t.jsx)(eM.Email,{size:16})})}var eS=e.i(7901966);function eT(e){let{target:i,canUpdateProtectionBypass:n=!0,hideStaticTeamMembersBanner:l=!1,onUpgradeClick:a,project:s,revalidateAlias:r,branchAliasId:o,branchName:c}=e;return i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eL,{branchAliasId:o,branchName:c,canUpdateProtectionBypass:n,filter:"requests",onUpgradeClick:a,project:s,revalidateAlias:r,target:i}),(0,t.jsx)(eL,{canUpdateProtectionBypass:n,filter:"granted",hideStaticTeamMembersBanner:l,onUpgradeClick:a,project:s,revalidateAlias:r,target:i})]}):null}function eL(e){let{target:i,canUpdateProtectionBypass:n=!0,filter:s,hideStaticTeamMembersBanner:r=!1,onUpgradeClick:o,project:c,revalidateAlias:u,branchAliasId:p,branchName:m}=e,{team:x,user:h}=(0,a.useAccount)(),{data:y}=(0,eE.default)({limit:1},{revalidateIfStale:!1,revalidateOnFocus:!1}),f=(0,d.useMemo)(()=>Object.entries(i.protectionBypass??{}).map(e=>{let[t,i]=e;return"user"===i.scope?{...i,userId:t}:"email_invite"===i.scope?{...i,email:t}:void 0}).filter(e=>void 0!==e).sort((e,t)=>t.createdAt>e.createdAt?1:-1),[i.protectionBypass]),j=s?f.filter(e=>("user"===e.scope&&"requested"===e.access)==("requests"===s)):f,g=(0,d.useCallback)(async e=>{await (0,J.updateAliasProtectionBypass)({aliasId:i.id,teamId:x?.id,body:e}),await u()},[i.id,x?.id,u]),b=(0,d.useMemo)(()=>{if(p&&i.id.startsWith("dpl_"))return async e=>{await (0,J.insertInviteToAliasProtectionBypass)({aliasId:p,teamId:x?.id,inviteeEmails:[e],message:""}),await u()}},[p,u,i.id,x?.id]);if(0===j.length&&!("granted"===s&&!r))return null;let v=y?.members.length;return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14 font-medium",children:"requests"===s?"Access requests":"People with access"}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:(0,t.jsxs)("div",{className:"space-y-2",children:[r||"granted"!==s?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eO,{thumbnail:(0,t.jsx)(ek.Avatar,{size:20,teamId:x?.id,username:x?void 0:h?.username}),title:(0,t.jsxs)("span",{className:"flex flex-row items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",children:x?.name||"You"}),x?(0,t.jsx)(t.Fragment,{children:/\bteam\b/i.test(x.name)?" members":" team members"}):null,v?(0,t.jsx)(l.Tooltip,{text:"Excluding contributors without access to this project.",children:(0,t.jsx)(eA.InformationFillSmall,{})}):null]})}),v?(0,t.jsx)(eO,{thumbnail:(0,t.jsx)(eU,{project:c}),title:(0,t.jsxs)("span",{className:"text-copy-14",children:[(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",children:c.name})," ",(0,t.jsx)("span",{className:"text-copy-14",children:"project contributors"})]})}):null]}),j.map(e=>(0,t.jsx)(eR,{branchName:m,canUpdateProtectionBypass:n,onUpgradeClick:o,targetUrl:i.url,updateBranchAccess:b,updateUserAccess:g,user:e},"user"===e.scope?e.userId:e.email))]})})]})}function eR(e){let{canUpdateProtectionBypass:i,onUpgradeClick:n,user:l,updateUserAccess:s,updateBranchAccess:r,branchName:o,targetUrl:c}=e,u=(0,S.useToasts)(),{account:p}=(0,a.useAccount)(),[m,x]=(0,d.useState)(void 0),h=p?.billing?.plan==="hobby",[y,f]=(0,d.useState)(!1),j="user"===l.scope,g=async(e,t)=>{x(e);try{let i=j?{scope:{userId:l.userId,access:e}}:{scope:{email:l.email,access:"denied"}};await Promise.all([s(i),l.email&&t&&r&&"granted"===e?r(l.email):void 0])}catch{u.error("An error occured, please try again later.")}finally{x(void 0)}},b=async e=>{h?f(!0):await g("granted",e)},v=void 0!==m;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eO,{actions:(0,t.jsx)(eB,{branchName:o,canUpdateProtectionBypass:i,isAccessRequested:!!j&&"requested"===l.access,isInvitationFlagEnabled:!0,isLoading:v,isUpdating:m,onAccessGranted:b,showBranchOption:!!(r&&l.email)&&!h,showHobbyLimitAction:y,targetUrl:c,updateAccess:g}),description:j?l.email:void 0,thumbnail:"user"===l.scope?(0,t.jsx)(ek.Avatar,{size:20,username:j?l.username:void 0}):(0,t.jsx)(eP,{}),title:j?l.username??l.userId:l.email}),(0,t.jsx)(e_,{isInvitationFlagEnabled:!0,isLoading:v,onUpgradeClick:n,setShowHobbyLimitAction:f,showHobbyLimitAction:y,updateAccess:g})]})}function eO(e){let{actions:i,description:n,thumbnail:l,title:a}=e;return(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[l,(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14",children:a}),(0,t.jsx)("p",{className:"text-copy-13 text-gray-900",children:n})]})]}),i]})}function eB(e){let{canUpdateProtectionBypass:i=!0,isAccessRequested:a,isInvitationFlagEnabled:s,isLoading:r,isUpdating:o,onAccessGranted:c,showHobbyLimitAction:d,updateAccess:u,showBranchOption:p,branchName:m,targetUrl:h}=e,y=(0,t.jsx)(eN.Cross,{}),f=(0,t.jsx)(R.Check,{}),j=i?void 0:"You need additional permissions to manage access requests",g=d||!i,b=p?(0,t.jsxs)(E.MenuContainer,{children:[(0,t.jsx)(I.MenuButton,{"aria-label":"Approve",disabled:g,shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:f}),(0,t.jsxs)(A.Menu,{width:"auto",children:[(0,t.jsx)(D.MenuItem,{innerMenuItemClassName:"h-auto py-2",onClick:()=>void c(),prefix:(0,t.jsx)(_.GitCommit,{}),children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14",children:"Approve for Deployment"}),(0,t.jsx)("p",{className:"text-copy-13 text-gray-900",children:h})]})}),(0,t.jsx)(D.MenuItem,{innerMenuItemClassName:"h-auto py-2",onClick:()=>void c(!0),prefix:(0,t.jsx)(B.GitBranch,{}),children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14",children:"Approve for Deployment and Branch"}),(0,t.jsx)("p",{className:"text-copy-13 text-gray-900",children:m})]})})]})]}):(0,t.jsx)(n.Button,{"aria-label":"Approve",disabled:g,onClick:()=>void c(),shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:f});return(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:[(0,t.jsx)(l.Tooltip,{desktopOnly:!0,text:j??(a?"Decline":"Revoke"),children:r?(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial mx-2",children:"denied"===o?(0,t.jsx)(x.Spinner,{size:16}):y}):(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.Button,{"aria-label":"Decline",disabled:!i,onClick:()=>void u("denied"),shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:y})})}),a?(0,t.jsx)(l.Tooltip,{desktopOnly:!0,text:j??"Approve",children:r?(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial mx-2",children:"granted"===o?(0,t.jsx)(x.Spinner,{size:16}):f}):b}):null]})}function e_(e){let{isInvitationFlagEnabled:i,isLoading:n,onUpgradeClick:l,setShowHobbyLimitAction:a,showHobbyLimitAction:s,updateAccess:r}=e;return i&&l?(0,t.jsx)(eS.HobbyLimitAction,{onUpgradeClick:l,setShowHobbyLimitAction:a,showHobbyLimitAction:s,updateAccess:r}):(0,t.jsx)(eF,{isLoading:n,setShowHobbyLimitAction:a,showHobbyLimitAction:s,updateAccess:r})}function eF(e){let{isLoading:i,setShowHobbyLimitAction:a,showHobbyLimitAction:s,updateAccess:r}=e;return(0,t.jsx)(eu.AnimatePresence,{children:s&&!i?(0,t.jsx)(eI.m.div,{animate:{height:"auto"},className:"relative box-border rounded border border-gray-400 bg-gray-100 dark:bg-gray-100",exit:{height:0},initial:{height:0},style:{padding:0},transition:{ease:"easeInOut"},children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial px-4",children:[(0,t.jsx)("p",{className:"text-copy-13 text-gray-900",children:"Hobby plans have a limit of 1 external collaborator at a time. Confirm to remove any existing user access."}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:[(0,t.jsx)(l.Tooltip,{desktopOnly:!0,text:"Cancel",children:(0,t.jsx)(n.Button,{"aria-label":"Cancel",onClick:()=>{a(!1)},shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(eN.Cross,{})})}),(0,t.jsx)(l.Tooltip,{desktopOnly:!0,text:"Confirm",children:(0,t.jsx)(n.Button,{"aria-label":"Confirm",onClick:()=>{a(!1),r("granted")},shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(R.Check,{})})})]})]})},"hobby-limit-actions"):null})}function eU(e){let{size:i=20,style:n,project:l,title:a}=e,{data:s,isLoading:r}=(0,eD.default)({project:l}),o=(0,ec.useFramework)(l);return!r&&(o||s)?(0,t.jsx)(ek.Avatar,{size:i,src:s?.src||o?.logo,style:n,title:a??o?.name}):(0,t.jsx)(h.Skeleton,{height:i,rounded:!0,style:{flexShrink:0},width:i})}var eH=e.i(8248823),eV=e.i(4030453),ez=e.i(9334091),eq=e.i(8384463),e$=e.i(6734680),eY=e.i(8587921),eG=e.i(5071474);function eW(e){let{inputText:i,navIndex:n,onPicked:l,setNavIndex:a,suggestions:s}=e;return i?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsx)(eK,{index:-1,isSelected:-1===n,onClick:()=>{l({label:i,value:i})},onMouseMove:()=>{a(-1)},option:{label:i,value:i}}),s?.map((e,i)=>(0,t.jsx)(eK,{index:i,isSelected:i===n,onClick:()=>{l(e)},onMouseMove:()=>{a(i)},option:e},e.value))]}):null}function eK(e){let{index:n,isSelected:l,onClick:a,onMouseMove:s,option:r}=e,{member:o}=r,c=(0,d.useRef)(null);(0,d.useEffect)(()=>{c.current&&l&&c.current.scrollIntoView({behavior:"smooth",block:-1===n?"end":"nearest"})},[n,l]);let u=o?.name||o?.username,p=u||r.value;return(0,t.jsxs)("div",{onClick:a,onMouseMove:s,ref:c,className:(0,i.clsx)("flex flex-row items-center justify-start gap-2 flex-initial relative cursor-default rounded-md transition-colors duration-150 hover:bg-gray-100",{'after:content-["_"] after:box-content after:absolute after:-left-2 after:bg-gray-alpha-100 after:w-full after:h-full after:rounded after:p-2':l}),children:[o?(0,t.jsx)(ek.Avatar,{size:32,username:o.username}):(0,t.jsx)(eP,{}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial overflow-hidden",children:[(0,t.jsx)("p",{className:"text-copy-14 truncate",children:p}),u?(0,t.jsx)("p",{className:"text-copy-13 text-gray-900",children:r.value}):null]})]})}var eQ=e.i(4948266),eX=e.i(5592888),eJ=e.i(2860397),eZ=e.i(1614852),e0=e.i(2203852),e1=e.i(712031),e5=e.i(7033292),e4=e.i(7539817),e2=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],e3=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,n=String(e).toLowerCase(),l=String(i.getOptionValue(t)).toLowerCase(),a=String(i.getOptionLabel(t)).toLowerCase();return l===n||a===n},e8=function(e){return'Create "'.concat(e,'"')},e9=function(e,t,i,n){return!(!e||t.some(function(t){return e3(e,t,n)})||i.some(function(t){return e3(e,t,n)}))},e6=function(e,t){return{label:t,value:e,__isNew__:!0}};e.i(7828999),e.i(643180),e.i(7966790),e.i(5653849),e.i(7909138),e.i(6623660),e.i(9404324),e.i(7792275),e.i(2762599),e.i(1091145);var e7=(0,d.forwardRef)(function(e,t){var i,n,l,a,s,r,o,c,u,p,m,x,h,y,f,j,g,b,v,C,w,k,N,A,I,E,D,M,P=(l=void 0!==(n=(i=(0,eZ.u)(e)).allowCreateWhileLoading)&&n,s=void 0===(a=i.createOptionPosition)?"last":a,o=void 0===(r=i.formatCreateLabel)?e8:r,u=void 0===(c=i.isValidNewOption)?e9:c,m=void 0===(p=i.getNewOptionData)?e6:p,x=i.onCreateOption,y=void 0===(h=i.options)?[]:h,f=i.onChange,b=void 0===(g=(j=(0,e5.default)(i,e2)).getOptionValue)?eJ.g:g,C=void 0===(v=j.getOptionLabel)?eJ.b:v,w=j.inputValue,k=j.isLoading,N=j.isMulti,A=j.value,I=j.name,E=(0,d.useMemo)(function(){return u(w,(0,e4.H)(A),y,{getOptionValue:b,getOptionLabel:C})?m(w,o(w)):void 0},[o,m,C,b,w,u,y,A]),D=(0,d.useMemo)(function(){return(l||!k)&&E?"first"===s?[E].concat((0,e1.default)(y)):[].concat((0,e1.default)(y),[E]):y},[l,s,k,E,y]),M=(0,d.useCallback)(function(e,t){if("select-option"!==t.action)return f(e,t);var i=Array.isArray(e)?e:[e];if(i[i.length-1]===E){if(x)x(w);else{var n=m(w,w);f((0,e4.D)(N,[].concat((0,e1.default)((0,e4.H)(A)),[n]),n),{action:"create-option",name:I,option:n})}return}f(e,t)},[m,w,N,I,E,x,f,A]),(0,e0.default)((0,e0.default)({},j),{},{options:D,onChange:M}));return d.createElement(eJ.S,(0,eX.default)({ref:t},P))}),te=e.i(6401841),tt=e.i(9096446),ti=e.i(6143247);let tn={control:e=>(0,ti.cn)("w-full border border-solid border-gray-alpha-400 bg-white rounded min-h-10 transition-colors duration-200",e.isFocused&&"hover:border-gray-alpha-600 bg-white shadow-focus-border",e.isDisabled&&"bg-gray-100"),valueContainer:()=>"px-2 py-1.5",input:()=>"py-0.5 m-0.5 text-gray-1000 text-base lg:text-sm",placeholder:()=>"mx-0.5 text-gray-600",indicatorsContainer:()=>"flex items-center px-2",indicatorSeparator:()=>"hidden",dropdownIndicator:()=>"text-gray-600 hover:text-gray-800 transition-colors duration-150",clearIndicator:()=>"text-gray-600 hover:text-gray-800 transition-colors duration-150 cursor-pointer",menu:()=>"bg-white border border-gray-alpha-400 rounded-md shadow-lg mt-1 z-50",menuList:()=>"py-1 max-h-60 overflow-auto",option:e=>(0,ti.cn)("px-3 py-2 text-sm cursor-pointer transition-colors duration-150 text-gray-1000 hover:bg-gray-100",e.isFocused&&"bg-gray-alpha-100",e.isSelected&&"bg-blue-500 text-white"),multiValue:()=>"inline-flex items-center bg-gray-200 rounded text-sm",multiValueLabel:()=>"pl-1 pr-0 py-1 flex font-medium text-xs",multiValueRemove:()=>"pl-0.5 pr-1 cursor-pointer rounded-xs flex items-center text-inherit box-border hover:bg-transparent hover:text-inherit"},tl=(0,d.forwardRef)(function(e,i){let{disabled:n,disabledText:a,inputText:s,invitationFocused:r,invitees:o,onInputBlur:c,onInputChangeHandler:u,onInputFocused:p,onKeyDown:m,placeholder:x,setInvitees:h}=e,y=(0,d.useCallback)((e,t)=>{e&&Array.isArray(e)&&h(e)},[h]),f=(0,t.jsx)(e7,{autoFocus:r,classNames:tn,components:{MultiValue:ta,MultiValueRemove:tr,Option:to,NoOptionsMessage:tu,DropdownIndicator:()=>null},formatCreateLabel:e=>e,inputValue:s,isClearable:!1,isDisabled:n,isLoading:!1,isMulti:!0,isSearchable:!0,menuIsOpen:!1,onBlur:()=>c(),onChange:y,onFocus:()=>p(),onInputChange:u,onKeyDown:m,openMenuOnClick:!1,placeholder:x,ref:i,value:o,unstyled:!0});return n?(0,t.jsx)(l.Tooltip,{desktopOnly:!0,style:{width:"100%",display:"block"},text:a,children:f}):f});function ta(e){let n=e.data,l=!(0,e$.default)(n.value),a={...{innerProps:{className:(0,i.clsx)(e.className,"m-0.5 flex min-h-6 items-center overflow-hidden rounded-full leading-none",{"bg-red-300 hover:bg-red-400 text-red-900 [&_span>div>svg]:hover:stroke-red-500":l,"bg-gray-300 text-gray-1000 hover:bg-gray-400":!l})}},...e};return(0,t.jsx)(eQ.components.MultiValue,{...a,children:(0,t.jsx)(ts,{isEmailInvalid:l,option:n})})}function ts(e){let{isEmailInvalid:n,option:a}=e;return n?(0,t.jsx)(l.Tooltip,{text:"Not a valid email address",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-0.5 flex-initial",children:[(0,t.jsx)(td,{}),a.value]})}):(0,t.jsxs)("div",{className:`flex flex-row items-center justify-start gap-1 flex-initial ${(0,i.clsx)({"ml-0.5":!a.member})}`,children:[a.member?(0,t.jsx)(ek.Avatar,{className:"border-none",size:16,username:a.member.username}):null,a.value]})}function tr(e){let{innerProps:i}=e;return(0,t.jsx)("div",{...i,children:(0,t.jsx)(tt.CrossSmall,{})})}function to(e){let i=e.data;return(0,t.jsx)(eQ.components.Option,{...e,children:(0,t.jsx)(tc,{text:i.label})})}function tc(e){let{text:i}=e;return(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(eP,{}),(0,t.jsx)("p",{className:"text-copy-14",children:i})]})}function td(){return(0,t.jsx)(te.Stop,{"aria-hidden":!0,className:"fill-red-900 stroke-red-300",size:19})}function tu(){return(0,t.jsx)("div",{className:"flex flex-col items-center justify-center flex-initial min-h-[70px] text-sm text-gray-600",children:(0,t.jsx)("p",{className:"text-copy-14 text-gray-700",children:"No options …"})})}function tp(e){let{canUpdateProtectionBypass:i,git:s,header:r,branchAliasId:o,selectedTarget:c,invitationFocused:u,onCancel:p,onFinished:m,onFocus:h,openUpgradeModal:f,previewCommentsEnabledForDeployment:j,revalidateAlias:g,teamId:b,viewAndCommentDescription:v,deployment:C}=e,{track:w}=(0,G.useTrackActivity)(),k=(0,S.useToasts)(),N=(0,W.useIsMobile)(),{account:A}=(0,a.useAccount)(),I=(0,ec.useProjectIdOrName)(),E=A?.billing?.plan==="hobby",[D,P]=(0,d.useState)(!1),R=(0,d.useRef)(null),[O,U]=(0,d.useState)(!1),[H,V]=(0,d.useState)(""),[z,K]=(0,d.useState)([]),[Q,X]=(0,d.useState)(""),[Z,ee]=(0,d.useState)(null),et=E&&z.length>1,ei=z.some(e=>!(0,e$.default)(e.value)),en=Q.length>250,el=(0,d.useMemo)(()=>en||ei?"Please correct the form input errors to continue":z.length?et?"Upgrade your plan to invite multiple external collaborators":void 0:"Input must not be empty",[ei,z.length,et,en]),ea=(0,d.useCallback)(()=>{q.analytics.track($.AnalyticsEvent.DEPLOYMENT_SHARE_UPGRADE_TO_PRO_CLICKED,{projectId:I}),f()},[f,I]),es=()=>{R.current&&R.current.focus()},er=(0,d.useCallback)(async()=>{w(Y.VercelActivityAction.DeploymentInviteSent,{count:z.length,teamMemberCount:z.filter(e=>void 0!==e.member).length}),ee(null),U(!0);try{await (0,J.insertInviteToAliasProtectionBypass)({aliasId:c.id,teamId:b,inviteeEmails:z.map(e=>e.value),message:Q});let e=1===z.length?"Invite was sent":"Invites were sent";k.message({text:e}),K([]),X(""),m(),await g()}catch(e){ee((0,eH.normalizeError)(e))}U(!1)},[c.id,z,Q,m,g,b,k,w]),[,{isLagging:eo,members:ed}]=(0,eY.useMembersInfinite)({revalidateIfStale:!1},{search:H},!0),ep=(0,d.useMemo)(()=>ed.map(e=>({label:e.name,value:e.email,member:e})).filter(e=>!z.some(t=>t.value===e.value)),[z,ed]),em=function(e){let[t,i]=(0,d.useState)(-1);return{lowBorder:-1,highBorder:e-1,navIndex:t,resetNavIndex:()=>i(-1),setNavIndex:i}}(ep.length),{navIndex:ex,resetNavIndex:eh,setNavIndex:ey}=em,ef=(0,d.useCallback)((e,t)=>{"input-change"!==t.action||e.length>320||z.length>50||(V(e),ee(null))},[z.length]),ej=(0,d.useCallback)(()=>{H||z.length||p()},[H,z.length,p]),eb=(0,d.useCallback)(()=>{H||z.length?(V(""),es(),eh()):p()},[H,z.length,p,eh]),ev=(0,d.useCallback)(e=>{z.some(t=>t.value===e.value)||(K([...z,e.member?e:ep.find(t=>t.value===e.value)||e]),V(""),es(),eh())},[z,eh,ep]),{onInputKeyDownHandler:eC}=function(e){let{inputText:t,navIndexState:i,onEscape:n,onPicked:l,suggestions:a}=e,{lowBorder:s,highBorder:r,navIndex:o,setNavIndex:c}=i;return{onInputKeyDownHandler:e=>{switch(e.key){case"Escape":e.stopPropagation(),n();break;case"Enter":case"Tab":if(!t)break;e.preventDefault(),-1===o?l({label:t,value:t}):l(a[o]);break;case"ArrowUp":e.preventDefault(),c(o>s?o-1:r);break;case"ArrowDown":e.preventDefault(),c(o<r?o+1:s)}}}}({inputText:H,navIndexState:em,onEscape:eb,onPicked:ev,suggestions:ep});(0,d.useEffect)(()=>{H||eh()},[H,eh]);let ew=c.url===C.url?(0,eG.default)(C).hash:void 0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(tm,{header:r,invitationFocused:u,children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsxs)("span",{className:"text-copy-14",children:[i?"Choose":"People"," who can"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",children:v}),j?" on ":" ",c.id===o&&s?.branchName?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.GitBranch,{color:"gray-900",className:"inline-block align-sub"})," ",(0,t.jsx)("span",{className:"font-medium align-middle text-copy-13-mono",children:(0,t.jsx)(T.Link,{href:s.branchUrl,title:"Git Branch",children:s.branchName})})]}):ew?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(_.GitCommit,{color:"gray-900",className:"inline-block align-sub"})," ",(0,t.jsx)("span",{className:"font-medium align-middle text-copy-13-mono",children:(0,t.jsx)(T.Link,{href:C.url,title:"Deployment URL",children:ew})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(F.Globe,{color:"gray-900",className:"inline-block align-sub"})," ",(0,t.jsx)("span",{className:"font-medium align-middle text-copy-13-mono",children:(0,t.jsx)(T.Link,{href:c.url,title:"URL",children:c.url})})]})]}),(0,t.jsx)("form",{className:"mt-2",children:(0,t.jsx)(tl,{disabled:!i,disabledText:"You need additional permissions to invite collaborators",inputText:H,invitationFocused:u,invitees:z,onInputBlur:ej,onInputChangeHandler:ef,onInputFocused:h,onKeyDown:eC,placeholder:"Add team members or emails…",ref:R,setInvitees:K})}),(0,t.jsx)(eu.AnimatePresence,{children:et?(0,t.jsx)(eI.m.div,{animate:{height:"auto"},exit:{height:0},initial:{height:0},style:{padding:0},transition:{ease:"easeInOut"},children:(0,t.jsx)(M.Note,{action:(0,t.jsx)(n.Button,{"aria-label":"Upgrade your plan to invite multiple external collaborators.",onClick:()=>{P(!1),ea()},shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(L.ArrowRight,{})}),className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,label:!1,size:"small",type:"secondary",children:"Upgrade your plan to invite multiple external collaborators."})},"hobby-limit-actions"):null})]}),u?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial h-[132px]",children:[(0,t.jsx)(eW,{inputText:H,navIndex:ex,onPicked:ev,setNavIndex:ey,suggestions:ep}),H||z.length?null:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-start gap-4 flex-initial px-6 py-8 text-gray-600",children:[(0,t.jsx)("div",{className:"flex flex-col items-center justify-center flex-initial overflow-hidden font-bold text-gray-600 border border-gray-300 border-solid rounded-sm size-8",children:(0,t.jsx)(eq.UserPlus,{})}),(0,t.jsx)("p",{className:"text-copy-14 text-inherit",children:"Search team members or enter an email to invite collaborators."})]}),H&&eo?(0,t.jsx)("div",{className:"flex flex-col items-center justify-start flex-initial",children:(0,t.jsx)(x.Spinner,{})}):null,!H&&z.length?(0,t.jsx)(ez.Textarea,{onChange:e=>{X(e.target.value)},placeholder:"Add an optional message",resize:"vertical",rows:3,value:Q}):null,en?(0,t.jsx)(eV.Error,{error:`The message should be 250 characters or less (current length: ${Q.length})`,size:"small"}):null,Z?(0,t.jsx)(eV.Error,{error:Z}):null]}):null,(0,t.jsx)(eg.ToastMobileAware,{actionText:"Confirm",active:D,cancelActionText:"Cancel",onAction:()=>{er(),P(!1)},onCancelAction:()=>{P(!1)},preserve:!0,toastKey:"invite-hobby-confirmation",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:["You can only share with 1 external collaborator at a time on Hobby."," ",(0,t.jsx)(T.Link,{external:!0,icon:!1,onClick:()=>{P(!1),ea()},underline:!N||void 0,variant:N?"highlight":void 0,children:"Upgrade to Pro"})," ","for unlimited external collaborators."]}),(0,t.jsx)("p",{className:"text-copy-14",children:"Continuing will remove any existing user access."})]})})]}),u?(0,t.jsxs)(y.Modal.Actions,{children:[(0,t.jsx)(y.Modal.Action,{onClick:()=>{D?P(!1):(ee(null),K([]),X(""),p())},type:"secondary",children:"Cancel"}),(0,t.jsx)(y.Modal.Action,{disabled:et||D||O||ei||en||!z.length,loading:O||D,onClick:()=>{E?P(!0):er()},children:(0,t.jsx)(l.Tooltip,{text:el,children:"Invite"})})]}):null]})}function tm(e){let{children:i,header:n,invitationFocused:l}=e;return l?(0,t.jsx)(y.Modal.Body,{className:"px-0 py-3.5",padding:!1,children:(0,t.jsx)(P.Scroller,{overflow:"y",scrollerClassName:"px-1 py-2.5",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial min-h-[285px] px-5",children:[n,i]})})}):(0,t.jsx)(t.Fragment,{children:i})}var tx=e.i(545405);function th(e){let{targets:i,branchAliasId:n,deployment:l,git:a,isLoading:s,isPreviewDeployment:r,modalClose:o,previewCommentsEnabledForBranch:c,previewCommentsEnabledForDeployment:u,productionProtectionEnabled:p,project:m,protectionEnabledForDeployment:x,protectionEnabledForProject:h,revalidateAlias:f,setIsLoading:j,team:g,user:b,branchAlias:v}=e,{track:C}=(0,G.useTrackActivity)(),{teamSlug:w,project:N}=(0,X.useParams)()??{},[A,I]=(0,d.useState)(()=>i.find(e=>e.pendingRequests>0)?.id??i.find(e=>!(e.url.endsWith("vercel.app")||g?.previewDeploymentSuffix&&e.url.endsWith(g.previewDeploymentSuffix)))?.id??(n?i.find(e=>e.id===n)?.id:void 0)??i.find(e=>e.url!==l.url)?.id??l.id),E=i.find(e=>e.id===A),D=(0,et.getShareableLinkBypass)(E??{});(0,d.useEffect)(()=>{C(Y.VercelActivityAction.DeploymentShareOpened,{})},[C]);let[R,O]=(0,d.useState)(!1);(0,d.useEffect)(()=>{R&&C(Y.VercelActivityAction.DeploymentInviteScreenOpened,{})},[R,C]);let _=(0,d.useMemo)(()=>(e=>{let{previewCommentsEnabledForDeployment:t,protectionEnabledForDeployment:i}=e;return!t&&i?"view":t&&!i?"comment":"view and comment"})({previewCommentsEnabledForDeployment:u,protectionEnabledForDeployment:!!x}),[u,x]),F=(0,S.useToasts)(),H=(0,d.useCallback)(async e=>{if(!s&&E&&("create"===e||D)){switch(e){case"create":q.analytics.track($.AnalyticsEvent.DEPLOYMENT_SHARE_GENERATE_EXTERNAL_LINK,{projectId:m.id});break;case"delete":q.analytics.track($.AnalyticsEvent.DEPLOYMENT_SHARE_DISABLE_EXTERNAL_LINK,{projectId:m.id});break;case"regenerate":q.analytics.track($.AnalyticsEvent.DEPLOYMENT_SHARE_REGENERATE_EXTERNAL_LINK,{projectId:m.id})}j(!0);try{let t=await (0,J.updateAliasProtectionBypass)({teamId:g?.id,aliasId:E.id,body:"create"!==e?{revoke:{secret:D||"",regenerate:"regenerate"===e}}:{}});if("create"===e){let e=ej({alias:E.url,protectionBypass:(0,et.getShareableLinkBypass)(t),protectionEnabledForDeployment:!0});e&&(0,tx.copyToClipboard)(e),F.success("A shareable link was generated and copied to your clipboard.")}}catch{F.error("An error occured, please try again later.")}await f(),j(!1)}},[E,s,m.id,D,f,F,g?.id,j]),{can:V}=(0,K.default)(),z=V(Q.Action.Update,"production"===l.target?Q.Resource.ProductionAliasProtectionBypass:Q.Resource.AliasProtectionBypass),W=(0,Z.useOpenUpgradeModal)(),en=(0,ee.getAliasDeploymentProtectionException)(E?.protectionBypass),el=(0,t.jsx)(ty,{branchAliasId:n,canUpdateProtectionBypass:z,getLinkToProtectionSettingsInner:()=>k({team:g,user:b,projectName:m.name}),isPreviewDeployment:r,productionProtectionEnabled:p,protectionBypass:D,protectionEnabledForDeployment:x,selectedTargetId:A,setSelectedTargetId:I,targets:i,deployment:l}),ea=w&&N&&v?.deploymentId?(0,ei.getDashboardHref)(`/${N}/${v.deploymentId.replace("dpl_","")}`,w):void 0,es=A===l.id&&v?.deploymentId&&v.deploymentId!==l.id&&ea?(0,t.jsxs)(M.Note,{action:(0,t.jsx)(T.ButtonLink,{"aria-label":"Go to latest branch deployment",href:ea,shape:"square",size:"small",svgOnly:!0,children:(0,t.jsx)(L.ArrowRight,{})}),className:"!text-gray-1000",fill:!0,type:"secondary",children:["There is a newer deployment for"," ",a?.branchName?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.GitBranch,{className:"mr-0.5 align-middle",size:14}),(0,t.jsx)("span",{className:"text-copy-14-mono",children:a.branchName})]}):"this branch",". To share it go to the latest."]}):null;return R&&(u||x)&&E?(0,t.jsx)(tp,{branchAliasId:n,canUpdateProtectionBypass:z,deployment:l,git:a,header:el,invitationFocused:R,onCancel:()=>O(!1),onFinished:()=>O(!1),onFocus:()=>void 0,openUpgradeModal:()=>{o(),W({source:"Hobby account email invite limit call to upgrade",trialBehavior:"choose"})},previewCommentsEnabledForDeployment:u,revalidateAlias:f,selectedTarget:E,teamId:g?.id,viewAndCommentDescription:_}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.Modal.Body,{className:"px-5 py-6",padding:!1,children:(0,t.jsx)(P.Scroller,{overflow:"y",scrollerClassName:"px-1 max-h-[80vh]",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial gap-6",children:[el,es,en?(0,t.jsxs)(M.Note,{fill:!0,type:"warning",variant:"contrast",children:["This domain is listed in"," ",(0,t.jsx)(T.Link,{href:`${k({team:g,user:b,projectName:m.name})}#deployment-protection-exceptions`,variant:"underline",children:"Deployment Protection Exceptions"}),", making it is currently"," ",(0,t.jsx)("span",{className:"text-heading-14 text-inherit",children:"unprotected"})," ","and"," ",(0,t.jsx)("span",{className:"text-heading-14 text-inherit",children:"publicly available"}),"."]}):null,u||x?E&&(0,t.jsx)(tp,{branchAliasId:n,canUpdateProtectionBypass:z,deployment:l,git:a,header:el,invitationFocused:R,onCancel:()=>void 0,onFinished:()=>void 0,onFocus:()=>O(!0),openUpgradeModal:()=>{o(),W({source:"Hobby account email invite limit call to upgrade",trialBehavior:"choose"})},previewCommentsEnabledForDeployment:u,revalidateAlias:f,selectedTarget:E,teamId:g?.id,viewAndCommentDescription:_}):null,(0,t.jsx)(eT,{branchAliasId:n,branchName:a?.branchName,canUpdateProtectionBypass:z,hideStaticTeamMembersBanner:!x&&!u,onUpgradeClick:()=>{o(),q.analytics.track($.AnalyticsEvent.DEPLOYMENT_SHARE_UPGRADE_TO_PRO_CLICKED,{projectId:m.id}),W({source:"Hobby account approve request limit call to upgrade",trialBehavior:"choose"})},project:m,revalidateAlias:f,target:E}),!u&&r?(0,t.jsx)(t.Fragment,{children:c?(0,t.jsx)(M.Note,{className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,size:"small",type:"secondary",children:"Comments will be available for new builds."}):(0,t.jsx)(M.Note,{action:(0,t.jsx)(T.ButtonLink,{"aria-label":"Enable Comments",href:(e=>{let{team:t}=e;return t?`/${t.slug}/~/settings/general#toolbar`:"/account/general#toolbar"})({team:g}),onClick:()=>{q.analytics.track($.AnalyticsEvent.DEPLOYMENT_SHARE_CLICK_ON_ENABLE_PREVIEW_COMMENTS,{projectId:m.id})},shape:"square",size:"tiny",svgOnly:!0,tab:!0,type:"tertiary",children:(0,t.jsx)(U.SettingsGear,{})}),className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,label:!1,size:"small",type:"secondary",children:"Enable comments for this deployment."})}):null,h?null:(0,t.jsx)(M.Note,{action:(0,t.jsx)(T.ButtonLink,{"aria-label":"Enable Deployment Protection",href:k({team:g,user:b,projectName:m.name}),onClick:()=>{q.analytics.track($.AnalyticsEvent.DEPLOYMENT_SHARE_CLICK_ON_ENABLE_VERCEL_AUTHENTICATION,{projectId:m.id})},shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(L.ArrowRight,{})}),className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,label:!1,size:"small",type:"secondary",children:"Enable Deployment Protection for this project."})]})})}),(0,t.jsx)(y.Modal.Actions,{children:(0,t.jsx)(eb,{alias:E?.url,canUpdateShareableLink:z,deployment:l,git:a,isLoading:s,onCreateShareableLink:()=>void H("create"),onDeleteShareableLink:()=>void H("delete"),onRegenerateShareableLink:()=>void H("regenerate"),openUpgradeModal:()=>{o(),W({source:"Hobby account shareable link limit call to upgrade",trialBehavior:"choose"})},previewCommentsEnabledForDeployment:u??!1,protectionBypass:D,protectionEnabledForDeployment:x,viewAndCommentDescription:_})})]})}function ty(e){let{canUpdateProtectionBypass:i,getLinkToProtectionSettingsInner:n,isPreviewDeployment:l,productionProtectionEnabled:a,protectionBypass:s,protectionEnabledForDeployment:r,targets:o,selectedTargetId:c,setSelectedTargetId:d,branchAliasId:u,deployment:p}=e,m=o.some(e=>e.pendingRequests>0&&e.id!==c);return(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[(0,t.jsx)("p",{className:"text-heading-24",children:"Share"}),o.length>1?(0,t.jsxs)(E.MenuContainer,{children:[(0,t.jsxs)(I.MenuButton,{"aria-label":"Select URL",shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:[(0,t.jsx)(O.ChevronDown,{}),m?(0,t.jsx)("div",{className:"absolute -right-0.5 -top-0.5 size-2 rounded-full bg-green-500"}):null]}),(0,t.jsx)(A.Menu,{width:"auto",children:o.map(e=>{var i,n,l;let a=(i=e,n=u,l=p,i.id===n?B.GitBranch:i.url===l.url?_.GitCommit:F.Globe);return(0,t.jsx)(D.MenuItem,{onClick:()=>{d(e.id)},prefix:(0,t.jsx)(a,{}),suffix:e.id===c?(0,t.jsx)(R.Check,{}):null,children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial gap-2",children:[e.url,e.pendingRequests>0?(0,t.jsx)(N.Badge,{className:"min-w-5",size:"sm",variant:"blue",children:e.pendingRequests}):null]})},e.id)})})]}):null]}),i&&(l||r)?(0,t.jsx)(tf,{getLinkToProtectionSettingsInner:n,isProtectionBypassShareableLink:!!s,productionProtectionEnabled:a,protectionEnabledForDeployment:r}):null]})}function tf(e){let{getLinkToProtectionSettingsInner:i,productionProtectionEnabled:n,isProtectionBypassShareableLink:a,protectionEnabledForDeployment:s}=e,r=(0,W.useIsMobile)(),o=a?"Deployment Protection can be bypassed with the Shareable Link":`${n?"All":"Preview"} deployments ${!r?"in this project ":""}are protected`,c=a?(0,t.jsx)(V.ShieldGlobe,{}):(0,t.jsx)(H.Shield,{}),d=s?c:(0,t.jsx)(z.ShieldOff,{});return(0,t.jsx)(l.Tooltip,{desktopOnly:!0,text:s?o:"Deployment Protection is not enabled and deployments are publicly accessible",children:(0,t.jsx)(T.ButtonLink,{align:"center","aria-label":"Settings",href:i(),label:"Settings",shape:"circle",size:"small",svgOnly:!0,type:"tertiary",children:d})})}function tj(e){let{deployment:i,project:l,mutateDeployment:s,...r}=e,{user:o,team:c,account:k}=(0,a.useAccount)(),N=k?.billing?.plan==="hobby",A=!!i.buildSkipped,{targets:I,branchAliasId:E,branchAlias:D,isLoading:M,mutate:P}=function(e){let{data:t}=(0,C.useCurrentDashboardDeploymentDomains)({revalidateIfStale:!1,revalidateOnFocus:!1}),i=(0,f.useTeamSlug)(),{data:n,mutate:l,isLoading:a}=(0,b.useAliasesV2)({deploymentId:e?.id,teamId:i??void 0}),s=t.branch??e?.meta.branchAlias??(e?.alias?e.alias[e.alias.length-1]:void 0),r=(0,d.useMemo)(()=>{let i,l=e?[{id:e.id,url:e.url,protectionBypass:e.protectionBypass,pendingRequests:tg(e)}]:[];if(!n)return{targets:l};for(let t of n.aliases){if(t.redirect)continue;t.alias===s&&(i=t.uid);let n={id:t.uid,url:t.alias,protectionBypass:t.protectionBypass,pendingRequests:tg(t)};if(e&&n.url===e.url){let t=l.findIndex(t=>t.id===e.id);-1!==t&&(l[t]=n)}else l.push(n)}let a=[t.commit,t.branch??"",...t.aliases].filter(Boolean);return l.sort((e,t)=>a.indexOf(e.url)-a.indexOf(t.url)),{targets:l,branchAliasId:i}},[s,n,e,t]),o=s&&!r.branchAliasId,{data:c,mutate:u,isLoading:p}=(0,v.default)({domain:o?s:void 0});return{isLoading:a||p,mutate:async()=>{await l(),await u()},targets:r.targets,branchAliasId:r.branchAliasId||c?.uid,branchAlias:c}}(i),S=(0,j.getGitMeta)(i.meta),T=(0,d.useMemo)(()=>I.some(e=>e.pendingRequests>0),[I]),L="production"!==i.target,{value:R}=(0,w.useArePreviewCommentsEnabled)({target:L?"preview":"production",branch:S?.branchName}),[O,B]=(0,d.useState)(!1),{protectionEnabledForDeployment:_,protectionEnabledForProject:F,isLoading:U,productionProtectionEnabled:H}=(e=>{let{deployment:t,project:i,isProjectLoading:n=!1}=e;if(!t||!i)return n?{isLoading:!0,protectionEnabledForDeployment:null,protectionEnabledForProject:null,productionProtectionEnabled:null}:{isLoading:!1,protectionEnabledForDeployment:!1,protectionEnabledForProject:!1,productionProtectionEnabled:!1};let{passwordProtection:l,ssoProtection:a,trustedIps:s}=i,r="production"!==t.target,o=["preview","prod_deployment_urls_and_all_previews","all_except_custom_domains"],c=l?.deploymentType==="all"||r&&l?.deploymentType&&o.includes(l.deploymentType),d=a?.deploymentType==="all"||r&&a?.deploymentType&&o.includes(a.deploymentType),u=s?.deploymentType==="all"||!r&&s?.deploymentType==="production"||r&&s?.deploymentType&&o.includes(s.deploymentType);return{productionProtectionEnabled:l?.deploymentType==="all"||a?.deploymentType==="all"||s?.deploymentType==="all",protectionEnabledForProject:!!(l||a||s),protectionEnabledForDeployment:!!(c||d||u),isLoading:!1}})({deployment:i,project:l}),V=(0,w.useCommentsEnabledForDeployment)(i),z=(0,d.useMemo)(()=>O?(0,t.jsx)(x.Spinner,{}):_?N?(0,t.jsx)(u.User,{}):(0,t.jsx)(p.Users,{}):(0,t.jsx)(m.Share,{}),[_,N,O]),[q,$,Y]=(()=>{let[e,t]=(0,d.useState)(!1);return[e,(0,d.useCallback)(()=>t(!0),[]),(0,d.useCallback)(()=>t(!1),[])]})();return((0,g.default)("openSharing",()=>{$()}),M||U)?L||V?(0,t.jsx)(h.Skeleton,{className:r.className,height:40,width:"100%"}):null:V||_?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.Button,{disabled:A||0===I.length,onClick:$,prefix:z,style:{color:A||0===I.length?void 0:"gray-900"},type:"secondary",typeName:"button",...r,children:["Share",T?(0,t.jsx)("div",{className:"absolute -right-0.5 -top-0.5 size-2 rounded-full bg-geist-success"}):null]}),(0,t.jsx)(y.Modal.Modal,{active:q,disableFocusTrap:!0,onClickOutside:Y,children:(0,t.jsx)(th,{branchAlias:D,branchAliasId:E,deployment:i,git:S,isLoading:O,isPreviewDeployment:L,modalClose:Y,previewCommentsEnabledForBranch:R??V,previewCommentsEnabledForDeployment:V,productionProtectionEnabled:H,project:l,protectionEnabledForDeployment:_,protectionEnabledForProject:F,revalidateAlias:async()=>{await P(),await s()},setIsLoading:B,targets:I,team:c,user:o})})]}):null}function tg(e){return Object.values(e?.protectionBypass??{}).filter(e=>"user"===e.scope&&"requested"===e.access).length}var tb=e.i(8382149),tv=e.i(6613731),tC=e.i(4478191),tw=e.i(9267266),tk=e.i(9148684);function tN(e){let{className:n,...l}=e;return(0,t.jsx)(T.ButtonLink,{className:(0,i.clsx)(n,"min-w-[80px] flex-1"),...l})}function tA(e){let{className:l,...a}=e;return(0,t.jsx)(n.Button,{className:(0,i.clsx)(l,"min-w-[96px] flex-1"),...a})}function tI(e){let{deployment:i,project:n}=e,{user:l,team:s}=(0,a.useAccount)(),{areChecksRunning:r,areDomainsAssigning:d}=(0,c.getDeploymentStatus)(i),u=(0,tw.useShouldVisitWithTheToolbar)(i),{permissions:p}=(0,tk.useDeploymentPermissions)({project:n,deployment:i}),m=i.readyState,x=(0,o.useIsViewingPublicDeployment)(),{onClick:h,...y}=(0,tv.useWrappedToolbarAuthLinkHandler)({via:"deployment-visit-button",deployment:x?void 0:i});return r?(0,t.jsx)(tA,{disabled:!0,children:"Waiting for Checks"}):d?(0,t.jsx)(tA,{disabled:!0,children:"Waiting for Domains"}):(l||s)&&p.canUpdateDeployment&&!["READY","ERROR","CANCELED"].includes(i.readyState)?null:"READY"===m?u&&"production"===i.target?(0,t.jsx)(tw.VisitWithToolbarButton,{Component:tN,buttonProps:{href:(0,tC.withDefaultRoute)((0,ef.domainToUrl)(i.url),i.defaultRoute),onClick:()=>{q.analytics.track($.AnalyticsEvent.DEPLOYMENT_OVERVIEW_CLICKED_VISIT_BUTTON,{projectId:i.projectId||n?.id,deploymentId:i.id,deploymentTarget:i.target})},passthroughOnClick:h,...y,target:"_blank"},className:"flex-1",page:i.defaultRoute?.startsWith("/")?i.defaultRoute:`/${i.defaultRoute??""}`,url:(0,tC.withDefaultRoute)((0,ef.domainToUrl)(i.url),i.defaultRoute),via:"deployment-visit-button",children:"Visit"}):(0,t.jsx)(tN,{href:(0,tC.withDefaultRoute)((0,ef.domainToUrl)(i.url),i.defaultRoute),onClick:()=>{q.analytics.track($.AnalyticsEvent.DEPLOYMENT_OVERVIEW_CLICKED_VISIT_BUTTON,{projectId:i.projectId||n?.id,deploymentId:i.id,deploymentTarget:i.target})},passthroughOnClick:h,...y,target:"_blank",children:"Visit"}):(0,t.jsx)(tN,{disabled:!0,href:`https://${i.host}`,...y,children:"Visit"})}let tE="min-w-[96px] flex-1 px-[10px]";function tD(e){let{className:l,...a}=e;return(0,t.jsx)(n.Button,{className:(0,i.clsx)(tE,l),...a})}function tM(e){let{deployment:i,project:n,mutateDeployment:d}=e,{user:u,team:p}=(0,a.useAccount)(),{areChecksRunning:m,areDomainsAssigning:x}=(0,c.getDeploymentStatus)(i),{permissions:h}=(0,tk.useDeploymentPermissions)({project:n,deployment:i}),{openRedeployModal:y,openCancelDeploymentModal:f,isLoadingModals:j}=(0,tb.useDeploymentModals)(),g=i.readyState,b=(0,o.useIsViewingPublicDeployment)();if(m)return(0,t.jsx)(tD,{disabled:!0,children:"Waiting for Checks"});if(x)return(0,t.jsx)(tD,{disabled:!0,children:"Waiting for Domains"});if("ERROR"===g){let e="production"===i.target?h.canRedeployProduction:h.canCreateDeployment;return b||!e?(0,t.jsx)(l.Tooltip,{className:"min-w-x[96px] flex-1",position:"top",text:"You are not the owner of this deployment. In turn, you cannot re-deploy it.",children:(0,t.jsx)(tD,{disabled:!0,prefix:(0,t.jsx)(r.RotateCounterClockwise,{}),type:"secondary",children:"Redeploy"})}):(0,t.jsx)(tD,{disabled:j,onClick:y,prefix:(0,t.jsx)(r.RotateCounterClockwise,{}),type:"secondary",children:"Redeploy"})}return(u||p)&&h.canUpdateDeployment&&!["READY","ERROR","CANCELED"].includes(i.readyState)?(0,t.jsx)(tD,{onClick:f,prefix:(0,t.jsx)(s.StopCircle,{}),style:{paddingInline:6},type:"secondary",children:"Cancel"}):(0,t.jsxs)(t.Fragment,{children:[n?(0,t.jsx)(tj,{className:tE,deployment:i,mutateDeployment:d,project:n}):null,(0,t.jsx)(tI,{deployment:i,project:n})]})}e.s(["DeploymentActionButton",()=>tM],310143)}]);

//# debugId=40c3be17-b370-db67-5d51-8cedcacbb1a9
//# sourceMappingURL=55c893645f47033a.js.map
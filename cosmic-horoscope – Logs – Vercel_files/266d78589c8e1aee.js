;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="334dc647-b1cf-2c35-1944-57a47c428a27")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4558711,4758698,e=>{"use strict";var t=e.i(8711407),a=e.i(3306538),r=e.i(6990755),i=e.i(57106),l=e.i(6143247),n=e.i(4286681);function s(e){let{title:a,id:r}=e;return(0,t.jsxs)("h3",{className:"text-heading-16",children:[(0,t.jsx)("span",{className:n.default.headingScrollTarget,id:r}),a]})}var o=e.i(1176592),c=e.i(6621419),u=e.i(7719608);function d(e){let{teamSlug:a,chartKey:r,title:l,...n}=e,s=f(a,r);return(0,t.jsx)(i.ButtonLink,{"aria-label":`View details for ${l}`,...n,href:s})}function f(e,t){let[a]=(0,c.useUsageQueryState)();return(0,o.useMemo)(()=>{let r=(0,u.getSearchParamsFromState)(a);return`/${e}/~/usage/${t}${r.size>0?`?${r.toString()}`:""}`},[e,t,a])}e.s(["ChartLinkButton",()=>d,"useChartLink",()=>f],4758698);var h=e.i(4038339),p=e.i(472163),m=e.i(4070420);function x(e){let a=(0,m.linkFromKeys)(e);return(0,t.jsx)(o.Suspense,{fallback:a?.includes("observability")?(0,t.jsx)(h.OpenObservability,{href:a,size:e.large?"medium":"small",type:"full"}):null,children:(0,t.jsx)(p.AsyncButton,{...e})})}var g=e.i(9722978);function y(e){let{children:a,className:r="",classNameHeader:i="",header:l,footer:s,style:o}=e;return(0,t.jsxs)("div",{className:(0,g.default)("flex flex-col items-stretch justify-start flex-initial",n.default.card),style:o,children:[l?(0,t.jsx)("div",{className:(0,g.default)("flex flex-col items-stretch justify-start flex-initial p-6",n.default.cardHeaderContainer,i),children:l}):null,(0,t.jsx)("div",{className:(0,g.default)("flex flex-col items-stretch justify-start flex-initial p-6",r),children:a}),s]})}function v(e){let{title:n,chartKey:o,sectionKey:u,description:f,additionalDescription:h,learnMoreHref:p,accessory:g,teamSlug:y,badge:v}=e,j=`${u}-${o}`,[b]=(0,c.useUsageQueryState)(),w=!!(0,m.linkFromKeys)({sectionKey:u,chartKey:o,teamSlug:y,queryState:b});return(0,t.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,t.jsxs)("div",{className:(0,l.cn)("flex gap-5",w?"flex-col md:flex-row":"flex-row"),children:[(0,t.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,t.jsx)(s,{id:j,title:n}),v?(0,t.jsx)(a.Badge,{variant:"amber-subtle",children:v}):null]}),f?(0,t.jsxs)("p",{className:"text-copy-14",children:[f," ",p?(0,t.jsx)(i.Link,{external:!0,href:p,target:"_blank",variant:"highlight",children:"Learn More"}):null]}):null,h]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(x,{chartKey:o,queryState:b,sectionKey:u,teamSlug:y}),(0,t.jsx)(d,{chartKey:j,shape:"square",size:"small",svgOnly:!0,prefetch:!1,teamSlug:y,title:n,type:"secondary",children:(0,t.jsx)(r.ArrowUpDiagonalScale,{})})]})]}),g?(0,t.jsx)("div",{className:"grid grid-flow-col items-center",children:g}):null]})}e.s(["UsageCard",()=>y,"UsageCardHeader",()=>v],4558711)},9995129,2913410,e=>{"use strict";var t=e.i(5723590),a=e.i(1176592),r=e.i(7917902),i=e.i(6621419),l=e.i(1683927),n=e.i(3585271);let s=n.defaultPresets["last-30-days"].start;async function o(e){let{queryState:{range:t,to:a,from:r,projectId:i},getBillingCycles:l}=e;if(t){let e=n.defaultPresets[t];if(e)return{projectId:i,from:e.start,to:e.end??n.endOfCurrentHour};if(["current-billing-cycle","previous-billing-cycle"].includes(t)){let e=await l(),a=e?.["current-billing-cycle"===t?"current":"previous"];return a?{from:new Date(a.start),to:new Date(a.end),projectId:i,billingCycles:e,isCurrentBillingCycle:"current-billing-cycle"===t}:{projectId:i,from:s,to:n.endOfCurrentHour,billingCycles:e}}}if(!t&&r&&a)return{from:r,to:a,projectId:i};let o=await l();return o?.current?{from:new Date(o.current.start),to:new Date(o.current.end),projectId:i,billingCycles:o,isCurrentBillingCycle:!0}:{projectId:i,from:s,to:n.endOfCurrentHour,billingCycles:o,isCurrentBillingCycle:!0}}function c(e,n){let[s,c]=(0,a.useState)(e),{account:u,isLoading:d}=(0,r.useAccount)(),f=!!u?.billing?.period,[h]=(0,i.useUsageQueryState)(),{data:p,isLoading:m}=(0,l.useBillingCycles)(void 0,e?{revalidateOnMount:!e.billingCycles,fallbackData:e.billingCycles}:void 0);return(0,a.useEffect)(()=>{if(d||f&&m&&s&&!s.billingCycles)return;let e=n??h.projectId;o({queryState:{...h,projectId:e},getBillingCycles:()=>Promise.resolve(f?p??s?.billingCycles:void 0)}).then(e=>{(0,t.default)(e,s)||c(e)})},[h,p,m,s?.billingCycles,f,d,n]),s}e.s(["useUsageFilters",()=>c],9995129);var u=e.i(7909933),d=e.i(1875382);let f=new Map,h=new Set;function p(e){return h.add(e),()=>{h.delete(e)}}function m(e,t){for(let a of(f.set(e,t),h))a()}function x(e,t){let a=f.get(e);if(a&&g(a.key,t))return a}function g(e,t){return e.teamSlug===t.teamSlug&&(0,u.unstable_serialize)({to:e.filters.to,from:e.filters.from,projectId:e.filters.projectId})===(0,u.unstable_serialize)({to:t.filters.to,from:t.filters.from,projectId:t.filters.projectId})}function y(e){let t={};for(let[a,r]of f)g(r.key,e)&&(t[a]=r);return t}function v(e,t){let[r,i]=(0,a.useState)(y(e)[t]);return(0,a.useEffect)(()=>p(()=>{i(y(e)[t])}),[t,e]),r}function j(e,t){let r=(0,d.useParams)(),i=c(e,t),l=r?.teamSlug??"",[n,s]=(0,a.useState)(y({filters:i,teamSlug:l}));return(0,a.useEffect)(()=>p(()=>{s(y({filters:i,teamSlug:l}))}),[i,l]),{isInitialFilters:(0,a.useMemo)(()=>g({filters:e,teamSlug:l},{filters:i,teamSlug:l}),[e,i,l]),cacheData:n,filters:i}}e.s(["getChartDataCache",()=>x,"setChartDataCache",()=>m,"useChartCache",()=>v,"useChartDataCache",()=>j],2913410)},2908202,e=>{e.v({hideMeterInfoMobile:"index-module__u8DDsa__hideMeterInfoMobile",hideMeterInfoTablet:"index-module__u8DDsa__hideMeterInfoTablet",valuesContainer:"index-module__u8DDsa__valuesContainer"})},8515934,e=>{e.v({"auto-visibility":"styles-module__lFBDKW__auto-visibility",bar:"styles-module__lFBDKW__bar","bar-overlay":"styles-module__lFBDKW__bar-overlay","empty-chart":"styles-module__lFBDKW__empty-chart","empty-description":"styles-module__lFBDKW__empty-description",figure:"styles-module__lFBDKW__figure"})},1075510,e=>{e.v({locked:"index-module__Y4EwDa__locked",tooltip:"index-module__Y4EwDa__tooltip"})},1530400,e=>{e.v({detailViewButton:"usage-tooltip-module__ZmBylG__detailViewButton",dimensionsContainer:"usage-tooltip-module__ZmBylG__dimensionsContainer",link:"usage-tooltip-module__ZmBylG__link",tooltipDate:"usage-tooltip-module__ZmBylG__tooltipDate",tooltipDateWarning:"usage-tooltip-module__ZmBylG__tooltipDateWarning"})},5605106,e=>{e.v({container:"chart-legend-module___0dxEa__container",hasMore:"chart-legend-module___0dxEa__hasMore",legendRow:"chart-legend-module___0dxEa__legendRow",viewAll:"chart-legend-module___0dxEa__viewAll"})},4588576,e=>{e.v({"animated-container":"styles-module__-hP3BW__animated-container",disabled:"styles-module__-hP3BW__disabled",open:"styles-module__-hP3BW__open",row:"styles-module__-hP3BW__row",rowHeader:"styles-module__-hP3BW__rowHeader",skeleton:"styles-module__-hP3BW__skeleton","src-images-container":"styles-module__-hP3BW__src-images-container"})},5574083,e=>{e.v({expanded:"paths-module__z5rLEG__expanded",filtersDescription:"paths-module__z5rLEG__filtersDescription",noData:"paths-module__z5rLEG__noData",odd:"paths-module__z5rLEG__odd",path:"paths-module__z5rLEG__path",pathsContainer:"paths-module__z5rLEG__pathsContainer",pathsRow:"paths-module__z5rLEG__pathsRow",rowContainer:"paths-module__z5rLEG__rowContainer",rowsContainer:"paths-module__z5rLEG__rowsContainer",switchControl:"paths-module__z5rLEG__switchControl",textMatch:"paths-module__z5rLEG__textMatch",value:"paths-module__z5rLEG__value",viewAll:"paths-module__z5rLEG__viewAll"})},360858,9939117,e=>{"use strict";var t=e.i(8711407),a=e.i(9722978),r=e.i(4004502),i=e.i(8515934);function l(e){let{title:l,description:n,children:s,className:o=""}=e;return(0,t.jsx)("div",{className:(0,a.clsx)(i.default["empty-chart"],o),"data-testid":(0,r.tid)("usage","metric","empty-state"),children:s||(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-copy-16 font-medium",children:l||"No Data"}),(0,t.jsx)("p",{className:`text-copy-16 ${i.default["empty-description"]}`,children:n||"There's no data available for your selection."})]})})}e.s(["Empty",()=>l],360858);var n=e.i(5255926),s=e.i(8835183),o=e.i(8522580),c=e.i(1176592),u=e.i(199192),d=e.i(6199768),f=e.i(57106),h=e.i(6774523),p=e.i(1875382),m=e.i(1947138),x=e.i(7087273),g=e.i(8923565),y=e.i(5574083);function v(e){let{filters:r=[],selectedFilter:i,onFilterChange:l,subFilters:n=[],selectedSubFilter:s,onSubFilterChange:o,filtersClassName:u,children:d}=e,f=r.find(e=>e.value===i),h=f?{text:f.description,icon:f.icon}:void 0;return r.length?(0,t.jsxs)("div",{className:(0,a.default)("flex flex-col items-stretch justify-start gap-4 flex-initial pb-6",u),children:[(0,t.jsx)("div",{style:{margin:-4},children:(0,t.jsx)(x.Scroller,{overflow:"x",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-1",style:{padding:4},children:[(0,t.jsx)(g.Switch,{children:r.map(e=>(0,t.jsx)(g.Switch.Control,{checked:e.value===i,label:e.label,onChange:()=>(0,c.startTransition)(()=>l?.(e.value)),value:e.value},e.value))}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[d,n.length?(0,t.jsx)(g.Switch,{children:n.map(e=>(0,t.jsx)(g.Switch.Control,{checked:e.value===s,className:y.default.switchControl,label:e.label,onChange:()=>(0,c.startTransition)(()=>o?.(e.value)),value:e.value},e.value))}):null]})]})})}),h?(0,t.jsxs)("div",{className:(0,a.default)("flex flex-row items-center justify-start gap-1.5 flex-initial px-1",y.default.filtersDescription),children:[h.icon,(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:h.text})]}):null]}):null}function j(){let e=(0,p.useParams)();return(0,t.jsxs)(o.Note,{type:"secondary",children:["Top paths have moved to"," ",(0,t.jsx)(f.Link,{href:`/${e?.teamSlug}/~/observability/edge-requests`,children:"Observability"})," ","inside each project."]})}function b(e){let{data:r,formatter:i,getRowHref:s,showSkeleton:o,expanded:h,viewAllHref:p,footerNote:m,noDataMessage:x,...g}=e,[j,b]=(0,c.useState)(""),{rows:S=[],hasMore:N}=(0,c.useMemo)(()=>{if(!h)return{rows:r?.slice(0,6).map((e,t)=>({...e,index:t,parts:[_(e)]})),hasMore:r?.length&&r.length>6};let e=j.toLowerCase(),t=j&&"."!==j?r?.filter(t=>_(t).toLowerCase().includes(e)):r;return{rows:t?.map((e,t)=>({...e,index:t})),hasMore:!1}},[h,r,j]),C=r?.length&&j&&x?(0,t.jsx)(l,{className:y.default.noData,description:x(j),title:"No Results Found"}):(0,t.jsx)(l,{className:y.default.noData});return(0,t.jsxs)("div",{"data-expanded":h?"":void 0,className:(0,a.clsx)("flex flex-col items-stretch justify-start flex-initial",y.default.pathsContainer),children:[(0,t.jsx)(v,{...g,children:h?(0,t.jsx)(k,{search:j,setSearch:b}):null}),o?(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial px-1.5",children:Array(h?50:6).fill(null).map((e,a)=>(0,t.jsx)(n.Skeleton,{boxHeight:40,height:28,vcenter:!0,width:"100%"},a))}):(0,t.jsxs)("div",{"data-has-more":N?"":void 0,className:(0,a.clsx)("flex flex-col items-stretch justify-start flex-initial",y.default.rowsContainer,{[String(y.default.expanded)]:h}),children:[h?(0,t.jsx)(d.Virtuoso,{data:S,itemContent:(e,a)=>(0,t.jsx)(w,{formatter:i,getRowHref:s,row:a,search:j}),overscan:100,useWindowScroll:!0}):S.map(e=>(0,t.jsx)(w,{formatter:i,getRowHref:s,row:e,search:j},_(e))),S.length?null:C]}),h&&m&&!o&&S.length?(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial pt-4",children:"string"==typeof m?(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:m}):m}):null,N&&p&&!o?(0,t.jsx)(f.ButtonLink,{className:y.default.viewAll,href:p,type:"secondary",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-0.5 flex-initial",children:[(0,t.jsx)("p",{className:"text-label-12",children:"View All"}),(0,t.jsx)(u.ChevronRightSmall,{})]})}):null]})}let w=(0,c.memo)(function(e){let{row:r,search:i,formatter:l,getRowHref:n}=e,s=_(r),o=(0,c.useMemo)(()=>{if(!i||"."===i)return[s];let e=RegExp(`(${i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return s.split(e)},[s,i]),u=(0,c.useMemo)(()=>n?n(r):void 0,[n,r]),d=(0,t.jsxs)("div",{className:(0,a.clsx)("flex flex-row items-center justify-start gap-2 flex-initial px-2",y.default.pathsRow,{[String(y.default.rowContainer)]:!u,[String(y.default.odd)]:(r.index??0)%2}),style:{"--row-percent":r.percentage},children:[(0,t.jsx)("p",{className:`text-copy-14 truncate whitespace-nowrap ${y.default.path}`,title:s,children:o.map((e,a)=>(0,t.jsx)("span",{className:a%2?y.default.textMatch:void 0,children:e},(0,h.getUnsafeKey)(a,e)))}),(0,t.jsx)("p",{className:`text-copy-14 text-right ${y.default.value}`,style:{minWidth:120},children:l?l(r.value,"display"):r.value})]});return u?(0,t.jsx)(f.Link,{className:y.default.rowContainer,href:u,prefetch:!1,target:"_blank",children:d}):d});function _(e){return e.host?`${e.host}${!e.host||e.path.startsWith("/")?"":"/"}${e.path}`:e.path}function k(e){let{search:a,setSearch:r}=e,[i,l,{currentValue:n}]=(0,m.useDebounceState)(a,100);return(0,c.useEffect)(()=>{(0,c.startTransition)(()=>r(i))},[r,i]),(0,t.jsx)(s.SearchInput,{onChange:e=>l(e.target.value),placeholder:"Filter Top Paths",value:n})}e.s(["PathsChart",()=>b,"PathsMigratedToObservability",()=>j],9939117)},6527262,6990379,e=>{"use strict";var t=e.i(8711407),a=e.i(1176592),r=e.i(2689376),i=e.i(7917902),l=e.i(9722978),n=e.i(9318197),s=e.i(5468328),o=e.i(3306538),c=e.i(57106),u=e.i(2466450),d=e.i(8826496),f=e.i(2908202);function h(e){let{used:a,increment:i,limit:o,hideOnMobile:u=!0,className:h,formatter:p,value:x,buttonCopy:g,buttonHref:y,pricePerIncrement:v,currency:j,nextTier:b,hidePrices:w}=e,{isActive:_}=(0,d.useUpgradeContext)(),k=o??0,S=_&&b?b:k;return(0,t.jsx)("div",{className:(0,l.clsx)("flex flex-row items-stretch justify-start flex-initial",{[f.default.hideMeterInfoMobile]:u},h),children:(0,t.jsx)(s.Tooltip,{className:(0,l.clsx)(f.default.hideMeterInfoMobile,"tooltip-container"),position:"bottom",text:(0,t.jsxs)("div",{style:{paddingTop:4,paddingBottom:4},children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:(0,t.jsx)(m,{currency:j,formatter:p,hidePrices:w,increment:i,limit:k,pricePerIncrement:v,value:x})}),(0,t.jsx)(n.Spacer,{y:.5}),(0,t.jsx)(c.ButtonLink,{href:y??"/docs/limits",type:"secondary",children:g??"View Docs"})]}),wrap:!1,children:(0,t.jsx)(r.Gauge,{colors:{primary:"var(--ds-blue-700)"},size:"tiny",value:a/S*100})})})}function p(e){let{value:a,formatter:r,limit:i,nextTier:n,hideOnTablet:s=!0,hideLimit:c=!1}=e,{isActive:u}=(0,d.useUpgradeContext)(),h=n&&u;return(0,t.jsxs)("p",{className:`text-copy-14 text-gray-900 ${(0,l.clsx)("meter-values-container",f.default.valuesContainer,{[f.default.hideMeterInfoTablet]:s})}`,children:[r(a,"display"),c?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:" / "}),(0,t.jsxs)("span",{className:"relative",children:[(0,t.jsx)("span",{className:"relative transition-colors",style:{color:h?"var(--ds-gray-700)":void 0},children:i?r(i,"display"):"-"}),(0,t.jsx)("span",{className:"absolute inset-x-0 top-[calc(50%-1px)] block h-[2px] bg-gray-500 transition-transform duration-500",style:{transformOrigin:"left",transform:h?"scaleX(1)":"scaleX(0)"}})]}),n?(0,t.jsxs)("span",{"aria-hidden":!h,className:"ml-2 inline-flex items-center gap-1.5 text-blue-900 transition-all duration-500",style:{transform:h?"translateX(0)":"translateX(8px)",opacity:+!!h},children:[r(n,"display"),(0,t.jsx)(o.Badge,{size:"sm",variant:"blue-subtle",children:"Pro"})]}):null]})]})}function m(e){let{limit:a,value:r,formatter:i,increment:l,pricePerIncrement:n,currency:s,hidePrices:o}=e,c=null!==l&&null!==n&&!o;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(t.Fragment,{children:["You have used"," ",a?Math.floor(r/a*100).toLocaleString():"-","% of the ",a?i(a,"long"):"-"," included in your plan."]}),c?(0,t.jsxs)(t.Fragment,{children:[" ","Once this limit has been reached, you will be charged"," ",(0,u.formatCurrency)(n,s)," per additional"," ",i(l,"long"),"."]}):null]})}var x=e.i(9995129),g=e.i(4558711),y=e.i(4496450);function v(e){let{children:a,card:r,sectionKey:i,accessory:l,teamSlug:n,additionalDescription:s,planIteration:o,plan:c,footer:u}=e,d=r.isNew&&o&&(0,y.isLegacyPlanIteration)(o)&&"hobby"!==c,f=["description"in r?r.description:void 0,d?"This usage metric will soon be part of your plan.":void 0].filter(Boolean).join(" ");return(0,t.jsx)(g.UsageCard,{footer:u,header:(0,t.jsx)(g.UsageCardHeader,{accessory:l,additionalDescription:s,badge:d?"Coming Soon":void 0,chartKey:r.key,description:f,learnMoreHref:r.learnMoreHref,sectionKey:i,teamSlug:n,title:r.title}),children:a},r.key)}var j=e.i(4286681),b=e.i(8264458);function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function _(e){var t=e.className,r=e.innerRef,i=function(e,t){if(null==e)return{};var a,r,i={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(a=l[r])>=0||(i[a]=e[a]);return i}(e,["className","innerRef"]);return a.default.createElement("rect",w({ref:r,className:(0,b.default)("visx-bar",t)},i))}var k=e.i(1377254),S=e.i(2304153);function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function C(e){var t=e.top,r=e.left,i=e.transform,l=e.className,n=e.children,s=e.innerRef,o=function(e,t){if(null==e)return{};var a,r,i={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(a=l[r])>=0||(i[a]=e[a]);return i}(e,["top","left","transform","className","children","innerRef"]);return a.default.createElement("g",N({ref:s,className:(0,b.default)("visx-group",l),transform:i||"translate("+(void 0===r?0:r)+", "+(void 0===t?0:t)+")"},o),n)}function O(e){return null==e?void 0:e[0]}function D(e){return null==e?void 0:e[1]}C.propTypes={top:S.default.number,left:S.default.number,transform:S.default.string,className:S.default.string,children:S.default.node,innerRef:S.default.oneOfType([S.default.string,S.default.func,S.default.object])};var T=e.i(6469467),M=e.i(7448903),P=e.i(2004754),I=e.i(1219720),E=e.i(9824722),A={ascending:T.stackOrderAscending,descending:M.stackOrderDescending,insideout:P.stackOrderInsideOut,none:I.stackOrderNone,reverse:E.stackOrderReverse};Object.keys(A);var L=e.i(1089043),F=e.i(1360520),B=e.i(3729955),R=e.i(9422769),$=e.i(5141407),z={expand:L.stackOffsetExpand,diverging:F.stackOffsetDiverging,none:B.stackOffsetNone,silhouette:R.stackOffsetSilhouette,wiggle:$.stackOffsetWiggle};function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function G(e){var t,r=e.data,i=e.className,l=e.top,n=e.left,s=e.x,o=e.y0,c=void 0===o?O:o,u=e.y1,d=void 0===u?D:u,f=e.xScale,h=e.yScale,p=e.color,m=e.keys,x=e.value,g=e.order,y=e.offset,v=e.children,j=function(e,t){if(null==e)return{};var a,r,i={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(a=l[r])>=0||(i[a]=e[a]);return i}(e,["data","className","top","left","x","y0","y1","xScale","yScale","color","keys","value","order","offset","children"]),w=(0,k.stack)();m&&w.keys(m),x&&(t=w.value,t(x)),g&&w.order(g&&A[g]||A.none),y&&w.offset(y&&z[y]||z.none);var S=w(r),N=function(e){if("bandwidth"in e)return e.bandwidth();var t=e.range(),a=e.domain();return Math.abs(t[t.length-1]-t[0])/a.length}(f),T=S.map(function(e,t){var a=e.key;return{index:t,key:a,bars:e.map(function(t,r){var i=(h(c(t))||0)-(h(d(t))||0),l=h(d(t)),n="bandwidth"in f?f(s(t.data)):Math.max((f(s(t.data))||0)-N/2);return{bar:t,key:a,index:r,height:i,width:N,x:n||0,y:l||0,color:p(e.key,r)}})}});return v?a.default.createElement(a.default.Fragment,null,v(T)):a.default.createElement(C,{className:(0,b.default)("visx-bar-stack",i),top:l,left:n},T.map(function(e){return e.bars.map(function(t){return a.default.createElement(_,U({key:"bar-stack-"+e.index+"-"+t.index,x:t.x,y:t.y,height:t.height,width:t.width,fill:t.color},j))})}))}function W(){return(W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function H(e){var t=e.from,r=void 0===t?{x:0,y:0}:t,i=e.to,l=void 0===i?{x:1,y:1}:i,n=e.fill,s=e.className,o=e.innerRef,c=function(e,t){if(null==e)return{};var a,r,i={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(a=l[r])>=0||(i[a]=e[a]);return i}(e,["from","to","fill","className","innerRef"]);return a.default.createElement("line",W({ref:o,className:(0,b.default)("visx-line",s),x1:r.x,y1:r.y,x2:l.x,y2:l.y,fill:void 0===n?"transparent":n},c))}Object.keys(z);var K=e.i(6854195);function q(){return(q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function V(e){var t,r,i,l,n,s,o,c,u=e.children,d=e.data,f=e.x,h=e.y,p=e.fill,m=e.className,x=e.curve,g=e.innerRef,y=e.defined,v=function(e,t){if(null==e)return{};var a,r,i={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(a=l[r])>=0||(i[a]=e[a]);return i}(e,["children","data","x","y","fill","className","curve","innerRef","defined"]),j=(l=(i={x:f,y:h,defined:void 0===y?function(){return!0}:y,curve:x}).x,n=i.y,s=i.defined,o=i.curve,c=(0,K.line)(),l&&(t=c.x,t(l)),n&&(r=c.y,r(n)),s&&c.defined(s),o&&c.curve(o),c);return u?a.default.createElement(a.default.Fragment,null,u({path:j})):a.default.createElement("path",q({ref:g,className:(0,b.default)("visx-linepath",m),d:j(void 0===d?[]:d)||"",fill:void 0===p?"transparent":p},v))}var Y=e.i(3518484),X=e.i(9134700),Z=e.i(1777823),Q=e.i(6578653),J=e.i(8545185),ee=e.i(5158601),et=e.i(8522445),ea=e.i(8125826),er=e.i(6493958),ei=e.i(360858),el=e.i(8515934),en=e.i(9129382),es=e.i(1230902);function eo(){return(eo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var ec=e.i(2504781),eu=e.i(7385039),ed=e.i(9982408),ef=e.i(1075510);let eh=e=>{let{left:a,containerWidth:r,children:i}=e,l="-50%",n="0",s="0";if(void 0!==a){let{innerWidth:e}=window,t=a+(e<741?-150:0)+(e-r)/2,i=e-t-300;t<0&&(l=-t/3-50+"%",n=`calc(${t/3+50}% - 8px)`,s="unset"),i<0&&(l=i/3-50+"%",n="unset",s=`calc(${i/3+50}% - 8px)`)}let o=(0,ed.useSpring)({left:a,bottom:0,translateX:l,config:{mass:.05,tension:400,friction:30}});return(0,t.jsx)(eu.animated.div,{className:ef.default.tooltip,style:{...o,"--arrow-left":n,"--arrow-right":s},children:i})};var ep=e.i(1530400);let em=(0,a.memo)(function(e){let{isOpen:a,width:r,left:i,data:n,hide:s,date:o,openDetailModal:c,dataAvailableSince:u}=e;return a&&n?(0,t.jsx)(eh,{containerWidth:r,left:i,children:(0,t.jsxs)("div",{className:(0,l.default)("flex flex-col items-center justify-start flex-initial",ep.default.dimensionsContainer),children:[(0,t.jsx)("div",{className:ep.default.tooltipDate,children:o}),u&&new Date(n.data.date)<new Date(u)?(0,t.jsxs)("div",{className:ep.default.tooltipDateWarning,children:["Started collecting on"," ",(0,es.format)(new Date(u),"MMM d, y HH:mm")]}):null,c&&n.data.resources?(0,t.jsx)(ec.Button,{className:ep.default.detailViewButton,onClick:()=>{s(),c()},size:"small",type:"secondary",children:"Detail View"}):null]})}):null});function ex(e){var t,r,i,l,n,s;let{from:o,to:c,granularity:u,showPercentage:d=!1}=e,{tooltipOpen:f,tooltipLeft:h,tooltipData:p,hideTooltip:m,showTooltip:x}=(r=(t=(0,a.useState)(eo({tooltipOpen:!1},void 0)))[0],i=t[1],l=(0,a.useCallback)(function(e){var t=e.tooltipOpen,a=e.tooltipLeft,r=e.tooltipTop,l=e.tooltipData;return i(function(e){return eo({},e,{tooltipOpen:t,tooltipLeft:a,tooltipTop:r,tooltipData:l})})},[]),n=(0,a.useCallback)(function(e){return l({tooltipOpen:!0,tooltipLeft:e.tooltipLeft,tooltipTop:e.tooltipTop,tooltipData:e.tooltipData})},[l]),s=(0,a.useCallback)(function(){return l({tooltipOpen:!1,tooltipLeft:void 0,tooltipTop:void 0,tooltipData:void 0})},[l]),{tooltipOpen:r.tooltipOpen,tooltipLeft:r.tooltipLeft,tooltipTop:r.tooltipTop,tooltipData:r.tooltipData,updateTooltip:l,showTooltip:n,hideTooltip:s}),g=!!(p?.data.resources&&p.data.resources.length>0),y=(0,a.useRef)(null),v=(0,a.useCallback)(()=>{y.current=window.setTimeout(()=>{m()},200)},[m]),j=(0,a.useCallback)(()=>{y.current&&(clearTimeout(y.current),y.current=null)},[]),b=(0,a.useMemo)(()=>{if(!p?.data)return;let{data:e,value:t}=p.data;return Object.fromEntries(Object.entries(e).map(e=>{let[a,r]=e,i=r||0;return d&&(i={total:i,percent:(0,en.formatPercentage)(i,t)}),[a,i]}))},[p,d]);return{tooltipData:p,tooltipDimension:b,showTooltip:x,hideTooltip:v,cancelHideTooltip:j,usageTooltipProps:{isOpen:f,left:h,data:p,hide:v,shouldShowBreakdown:g,date:p&&(0,en.formatFullDateWithRange)(p.data.date,u,o,c)}}}var eg=e.i(4405391),ey=e.i(6621419);function ev(e){let{defaultGroupingType:t,expanded:r=!1}=e,[{view:i},l]=(0,ey.useUsageQueryState)(),[n,s]=(0,a.useState)(i||t);return((0,a.useEffect)(()=>{r&&!i&&l({view:t})},[r]),r)?{groupingType:i||t,setGroupingType:e=>l({view:e})}:{groupingType:n,setGroupingType:e=>{s(e)}}}var ej=e.i(8295952),eb=e.i(3489437),ew=e.i(2480776),e_=e.i(157972);function ek(e){let{data:t=[],width:r,range:i,keys:l,colors:n,granularity:s}=e,o=t.map(e=>{let{date:t}=e;return t}),{valueScale:c,tickXValues:u,tickYValues:d}=(0,a.useMemo)(()=>{let e=Math.round(o.length/(r<480?3:r<720||"hour"===s?4:8));return{valueScale:(0,eb.scaleLinear)({domain:[0,i],range:[200,0],clamp:!0}),tickXValues:o.length<=3?o:o.filter((t,a)=>a%e==e>>1),tickYValues:0===i?[0]:[0,i/5,2*i/5,3*i/5,4*i/5,i]}},[o,s,i,r]);return{valueScale:c,colorScale:(0,a.useMemo)(()=>(0,ew.scaleOrdinal)({domain:l,range:n}),[n,l]),tickYValues:d,tickXValues:u}}var eS=e.i(8522580),eN=e.i(8923565),eC=e.i(4004502),eO=e.i(9031150),eD=e.i(7218483),eT=e.i(5605106);let eM=(0,a.memo)(function(e){let{groupingType:a,groupingTypeOptions:r,setGroupingType:i,disableGroupBy:n,lastUpdate:o,noteText:c,selectedProjectId:u}=e,d=(0,eD.useAgo)(o,{justNowLabel:"just now"});return(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-stretch md:items-center justify-between gap-4 flex-initial",children:[(0,t.jsxs)("div",{className:(0,l.default)("flex flex-col md:flex-row items-stretch md:items-center justify-start flex-initial",eT.default.groupingFilterWrapper),children:[(0,t.jsx)(eN.Switch,{children:r.map(e=>(0,t.jsx)(s.Tooltip,{desktopOnly:!0,style:{flexGrow:1},text:`Group by ${e}`,children:(0,t.jsx)(eN.Switch.Control,{checked:e===a,disabled:n||"Projects"===e&&!!u,label:e,onChange:(0,eO.withAwaitPaint)(()=>i(e)),value:e,width:110})},e))}),c?(0,t.jsx)(eS.Note,{className:eT.default.note,label:!1,size:"small",children:c}):null]}),(0,t.jsx)("div",{className:(0,l.default)("flex flex-col items-stretch justify-start",eT.default.updatedTimestamp),style:{flex:"0 0 auto"},children:(0,t.jsxs)("p",{className:"text-label-14 text-gray-600","data-testid":(0,eC.tid)("usage","metric","updated-text"),children:["Updated ",d||"just now"]})})]})});var eP=e.i(199192),eI=e.i(8626589),eE=e.i(3675495),eA=e.i(1288475),eL=e.i(6685186),eF=e.i(3322724),eB=e.i(9482244),eR=e.i(4038339),e$=e.i(1712262);let ez=[{Icon:eI.Hash,accessor:"total"},{Icon:eE.Percentage,accessor:"percent"}],eU=(e,t,a)=>{if(null===e||null===t)return 0;let r=e||0;return Math.max(0,r+(t-r)*a)},eG=(0,a.memo)(function(e){let{keys:r,truncatedKeys:i,chartData:n,colorScale:s,dimension:o,formatter:u,lastUpdate:d,expanded:f=!1,isHovered:h=!1,groupingType:p,linkStyle:m,viewAllHref:x="",emptyValueTitle:g}=e,[y,v]=(0,a.useState)(ez[0].accessor),[j,b]=(0,a.useState)(!1),w=(0,eF.useIsMobile)(),_=(0,eD.useAgo)(d,{justNowLabel:"just now"}),{showPercentage:k,columns:S,data:N}=(0,a.useMemo)(()=>{let[e={}]=Object.values(o),a=1!==r.length&&"object"==typeof e&&"percent"in e&&null!==e.percent,l=[{Header:"Name",accessor:"name"},{Header:"Total",accessor:"total",align:"right"}];a&&l.push({Header:"Percent",accessor:"percent",align:"right"}),w&&l.length>2&&l.splice(l.findIndex(e=>"name"!==e.accessor&&e.accessor!==y),1);let s={},u={};for(let{resources:e=[],regions:t=[],logDrains:a=[]}of n)for(let{title:r,subtitle:i,link:l}of[...e,...t,...a])r&&(i||l)&&(s[r]=i,u[r]=l);return{showPercentage:a,columns:l,data:r.map(e=>{let a=o[e]??0,r=0,l=null;"number"!=typeof a?{total:r,percent:l}=a:r=a;let n=s[e],d=u[e],f=e||(g??"Unknown");return{key:e,groupedInOther:!!i&&!i.includes(e),link:d,name:(0,t.jsxs)(t.Fragment,{children:[d&&"external"===m?(0,t.jsx)(c.Link,{external:!0,href:d,children:f}):f,n?(0,t.jsxs)(t.Fragment,{children:[" ",(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:n})]}):null]}),total:r,percent:Number.parseFloat(l??"0")}})}},[o,r,w,y,n,p,i,m,g]),C=function(e,t){let[r,i]=(0,a.useState)(e),l=(0,a.useRef)(e),n=(0,eB.usePrefersReducedMotion)();return(0,a.useEffect)(()=>{l.current=e},[t]),(0,a.useEffect)(()=>{let t=performance.now(),a=l.current,r=a.length===e.length;n&&(r=!1);let s=0,o=function(){let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now(),n=Math.sin(Math.min((l-t)/100,1)*Math.PI*.5);if(!r||1===n){i(e),Object.assign(a,e);return}s=requestAnimationFrame(o);let c=Array(e.length);for(let t=e.length;t--;){let r=e[t],i=a[t];c[t]={key:r.key,groupedInOther:r.groupedInOther,name:r.name,link:r.link,total:eU(i.total,r.total,n),percent:eU(i.percent,r.percent,n)}}i(c)};return o(),()=>{cancelAnimationFrame(s),i(e=>(Object.assign(a,e),e))}},[e,n]),r}(N,p),O=f?30:6,D=!j&&C.length>O,T=(0,a.useMemo)(()=>{let e=new URL(x,location.origin);return e.searchParams.set("view",p),e.toString()},[x,p]),M=(0,a.useMemo)(()=>D?f?(0,t.jsx)(ec.Button,{className:eT.default.viewAll,onClick:()=>void(0,eL.awaitPaint)().then(()=>b(!0)),type:"secondary",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-0.5 flex-initial",children:[(0,t.jsx)("p",{className:"text-label-12",children:"View All"}),(0,t.jsx)(eP.ChevronRightSmall,{})]})}):(0,t.jsx)(c.ButtonLink,{className:eT.default.viewAll,href:T,type:"secondary",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-0.5 flex-initial",children:[(0,t.jsx)("p",{className:"text-label-12",children:"View All"}),(0,t.jsx)(eP.ChevronRightSmall,{})]})}):null,[D,T,f]),P=(0,a.useMemo)(()=>"none"===m||"external"===m?null:"o11y"===m?function(e){let{link:a}=e;return a?(0,t.jsx)(eR.OpenObservability,{href:a}):null}:function(e){let{link:a}=e;return a?(0,t.jsx)(e$.OpenButton,{href:a}):null},[m]);return(0,t.jsxs)("div",{className:(0,l.clsx)("flex flex-col items-stretch justify-start gap-2 flex-initial pt-4",eT.default.container,D&&eT.default.hasMore),children:[(0,t.jsx)("div",{className:"geist-show-on-mobile",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between flex-initial mt-2 mb-1",children:[k?(0,t.jsx)(eN.Switch,{children:ez.map(e=>(0,t.jsx)(eN.Switch.Control,{checked:e.accessor===y,label:(0,t.jsx)(e.Icon,{size:16}),onChange:()=>v(e.accessor),value:e.accessor},e.accessor))}):(0,t.jsx)("div",{}),(0,t.jsxs)("p",{className:"text-label-14 text-gray-600","data-testid":(0,eC.tid)("usage","metric","updated-text"),children:["Updated ",_||"just now"]})]})}),(0,t.jsx)("div",{className:(0,l.clsx)("grid",P?"grid-cols-[44px_1fr_auto_auto]":"grid-cols-[1fr_auto_auto]"),children:C.map((e,a)=>!j&&a>=O?null:(0,t.jsxs)("div",{className:"col-span-full grid grid-cols-subgrid items-center odd:bg-background-200",children:[P?(0,t.jsx)("span",{className:"p-2",children:P(e)}):null,S.map((a,r)=>{let i,n=r===S.length-1;if(0===r){let r=e[a.accessor];return(0,t.jsxs)("span",{className:"flex flex-row items-center gap-3 p-2 font-medium text-gray-1000",children:[(0,t.jsx)(eA.Status,{style:{color:s(e.groupedInOther?"other":e.key)}}),r]},a.accessor)}let o=e[a.accessor];return i="total"===a.accessor?u(o,w?"display":"long"):`${o.toFixed(1)}%`,(0,t.jsx)("span",{className:(0,l.clsx)("p-2 tabular-nums text-gray-900",n?"pr-2":"pr-10","right"===a.align?"text-right":"","left"===a.align?"text-left":"",h&&"text-gray-1000"),children:i},a.accessor)})]},e.key))}),M]})});var eW=e.i(5255926),eH=e.i(6774523);function eK(e){let{metricCount:a}=e;return(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 md:gap-4 lg:gap-4 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-2 md:gap-[72px] flex-initial pb-2 md:pb-0",children:[(0,t.jsx)(eW.Skeleton,{height:40,width:180}),(0,t.jsx)(eW.Skeleton,{height:22,width:125})]}),(0,t.jsx)(eW.Skeleton,{height:240,width:"100%"}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial pt-2",children:Array(a).fill(null).map((e,a)=>(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-between flex-initial p-2",children:[(0,t.jsx)(eW.Skeleton,{height:20,width:152-a%2*32}),(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-end",style:{flex:"0 0 50%"},children:[(0,t.jsx)("div",{className:"flex flex-col items-end justify-start geist-hide-on-mobile",style:{flex:"0 0 50%"},children:(0,t.jsx)(eW.Skeleton,{height:20,width:64+a%2*20})}),(0,t.jsx)("div",{className:"flex flex-col items-end justify-start",style:{flex:"0 0 50%"},children:(0,t.jsx)(eW.Skeleton,{height:20,width:64+a%2*20})})]})]},(0,eH.getUnsafeKey)(a)))})]})})}function eq(){return(0,t.jsx)(eW.Skeleton,{height:234,style:{marginTop:5},width:"100%"})}var eV=e.i(3513482);let eY=(e,t)=>{if(t?.kind==="custom"){let{singular:e,plural:a}=t;return(0,er.createCountFormatterWithUnit)({singular:e,plural:a})}return e},eX=(0,a.memo)(function(e){let{children:r}=e,[i,l]=(0,a.useState)(!1),[n,s]=(0,a.useState)(360),o=(0,a.useRef)(null);return((0,a.useEffect)(()=>{let e=o.current;if(!e)return;let t=new IntersectionObserver(t=>{let[a=null]=t;if(!a)return;let r=!1;l(e=>(r=e&&!a.isIntersecting,a.isIntersecting)),r&&s(e.clientHeight)},{rootMargin:"800px 0px"});return t.observe(e),()=>t.disconnect()},[]),i)?(0,t.jsx)("div",{ref:o,style:{minHeight:360,transition:"opacity 0.1s"},children:r}):(0,t.jsx)("div",{ref:o,style:{contentVisibility:"hidden",containIntrinsicHeight:n,height:n,minHeight:360,opacity:0}})}),eZ=(0,a.memo)(function(e){let{from:r,to:i,metricNames:l,data:n=[],metricColors:s,formatter:o,unit:c,granularity:u,reverseStack:d,lastUpdate:f,dataAvailableSince:h,selectedProjectId:p,disableGroupBy:m=!1,legendNote:x,groupingTypeEmptyValueTitles:g,groupingTypeOptions:y=["Ratio","Projects"],defaultGroupingType:v="Ratio",groupingTypeLinkStyles:j,onBarSelected:b,dimension:w,expanded:_=!1,viewAllHref:k=""}=e,S=eY(o,c),[N,{width:C}]=(0,et.default)(),{chartData:O,keys:D,truncatedKeys:T,range:M,dimension:P,groupingType:I,setGroupingType:E,isGroupingEnabled:A}=function(e){let{data:t=[],metricNames:r,formatter:i,defaultGroupingType:l,expanded:n=!1}=e,{groupingType:s,setGroupingType:o}=ev({defaultGroupingType:l,expanded:n}),{groupedData:c,keys:u,truncatedKeys:d}=(0,a.useMemo)(()=>{let e=(e,t)=>e||t;if("Ratio"===s||"Direction"===s||"Count"===s||"Origin"===s||"Build Machine"===s)return{groupedData:t.map(e=>{let{sum:t,date:a,resources:i,regions:l,...n}=e;return{data:Object.entries(n).reduce((e,t)=>{let[a,i]=t,l=r[Number.parseInt(a,10)];return l&&(e[l]="number"==typeof i?i:0),e},{}),sum:t,date:a,resources:i,regions:l}}),keys:r,truncatedKeys:r};let a="resources";switch(s){case"Regions":a="regions";break;case"Drains":a="logDrains";break;case"Sources":a="logSources";break;case"Event Types":a="eventType";break;case"Blob Stores":a="blobStores";break;case"Runtime":a="runtime";break;case"Type":a="cause";break;case"Network Type":a="networkTenancy";break;case"Traffic Source":a="trafficSource";break;case"Reader Projects":a="readerProjects";break;default:a="resources"}let i=new Map,l=new Set;for(let r of t)for(let{name:t,percent:n,title:s,count:o}of r[a]??[]){let a=e(t,s),c=o||(i.get(a)||0)+n/100*r.sum;i.set(a,c),c/r.sum>.05&&l.add(a)}let n=Array.from(i.entries()).sort((e,t)=>{let[,a]=e,[,r]=t;return a>r?-1:1}),o="other";if(l.size<10){for(let[e]of n)if(l.add(e),l.size>=10)break}let c=Array.from(l).sort((e,t)=>(i.get(t)??0)-(i.get(e)??0)),u=Object.fromEntries(n.map(e=>{let[t]=e;return[t,0]})),d=Object.keys(u);return c.length<d.length&&c.push(o),{groupedData:t.map(t=>{let r=t[a]?.reduce((a,r)=>{let{name:i,title:l,percent:n,count:s}=r,u=e(i,l),d=s||n/100*t.sum;return a[u]=(a[u]??0)+d,c.includes(u)||(a[o]=(a[o]??0)+d),a},{});return{data:{...u,...r},sum:t.sum,date:t.date,resources:t.resources,regions:t.regions,logDrains:t.logDrains,logSources:t.logSources,eventType:t.eventType,blobStores:t.blobStores,networkTenancy:t.networkTenancy,trafficSource:t.trafficSource,runtime:t.runtime,cause:t.cause,readerProjects:t.readerProjects}}),keys:d,truncatedKeys:c}},[t,s,r]),[f,h,p]=(0,a.useMemo)(()=>{let e={},t=0,a=0;for(let r of c)for(let i of(t<r.sum&&(t=r.sum),a+=r.sum,u))if(i in r.data){let t=r.data[i];if("number"==typeof t){let a=(i in e?e[i].total:0)+t;e[i]={total:a,percent:null}}}if(a>0)for(let[t,{total:r}]of Object.entries(e))e[t]={total:r,percent:(0,en.formatPercentage)(r,a)};return[(0,eg.roundUpAxisRange)(t,i),t>0,e]},[i,c,u]),m=(0,a.useMemo)(()=>c.map(e=>({date:e.date,value:e.sum,data:e.data,resources:e.resources,regions:e.regions,logDrains:e.logDrains,logSources:e.logSources,eventType:e.eventType,blobStores:e.blobStores,networkTenancy:e.networkTenancy,trafficSource:e.trafficSource,runtime:e.runtime,cause:e.cause})),[c]);return{chartData:m,keys:u,truncatedKeys:d,range:f,dimension:p,groupingType:s,setGroupingType:o,isGroupingEnabled:h&&m[0]&&("resources"in m[0]||"regions"in m[0]||"logDrains"in m[0]||"logSources"in m[0]||"eventType"in m[0]||"blobStores"in m[0]||"runtime"in m[0]||"networkTenancy"in m[0]||"trafficSource"in m[0]||"readerProjects"in m[0]||"cause"in m[0])}}({metricNames:l,data:n,formatter:S,defaultGroupingType:v,expanded:_}),L=O.length>0,{valueScale:F,dateScale:B,colorScale:R,tickYValues:$,tickXValues:z}=function(e){let{data:t=[],width:r}=e;return{dateScale:(0,a.useMemo)(()=>{let e=t.map(e=>{let{date:t}=e;return t});return(0,ej.scaleBand)({domain:e,range:[0,r-50],padding:.4375,paddingOuter:.3})},[t,r]),...ek(e)}}({data:n,width:C,range:M,keys:D,granularity:u,colors:"Projects"===I||"Regions"===I||"Drains"===I||"Sources"===I?eV.defaultMetricColors:s}),{usageTooltipProps:U,tooltipData:W,tooltipDimension:H,showTooltip:K,hideTooltip:q,cancelHideTooltip:V}=ex({from:r,to:i,granularity:u,showPercentage:D.length>1}),Y=(0,a.useMemo)(()=>{let e=y.indexOf(I);return j?.[e]??"none"},[I,y,j]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eM,{disableGroupBy:m||!A,groupingType:I,groupingTypeOptions:y,lastUpdate:f,noteText:x,selectedProjectId:p,setGroupingType:E}),(0,t.jsx)(e0,{chartRef:N,chartScales:{dateScale:B,valueScale:F},dataAvailableSince:h,formatter:S,granularity:u,isDataAvailable:L,tickXValues:z,tickYValues:$,usageTooltip:{cancelHideTooltip:V,hideTooltip:q,usageTooltipProps:U},width:C,children:(0,t.jsx)(G,{color:R,data:O,keys:T,order:d?"reverse":"none",value:(e,t)=>e.data[t]??0,x:e=>{let{date:t}=e;return t},xScale:B,yScale:F,children:e=>[e[d?0:e.length-1]?.bars.map(a=>(0,t.jsx)("rect",{className:el.default["bar-overlay"],height:F(0),onClick:b?e=>b({event:e,bar:a}):void 0,onMouseMove:()=>{if(!W||a.index!==W.index){let e=Math.round((F(a.bar[1])||0)-22),t=Math.round(a.x+50+a.width/2);K({tooltipData:{data:a.bar.data,index:a.index},tooltipTop:e,tooltipLeft:t})}},onTouchMove:t=>{V();let{x:r}=(0,J.localPoint)(t)||{x:0},i=~~(r/(a.width/.5625)),l=e[d?0:e.length-1].bars[i];if(l&&(!W||l.index!==W.index)){let e=Math.round((F(l.bar[1])||0)-22),t=Math.round(l.x+50+l.width/2);K({tooltipData:{data:l.bar.data,index:i},tooltipTop:e,tooltipLeft:t})}},width:a.width/.5625,x:a.x-.4375*a.width*.5/.5625,y:0},`bar-stack-${a.index}-overlay`)),...e.map(e=>e.bars.map(a=>(0,t.jsx)("rect",{className:el.default.bar,fill:a.color,height:a.height,width:a.width,x:a.x,y:a.y},`bar-stack-${e.index}-${a.index}`)))]})}),(0,t.jsx)(eG,{chartData:O,colorScale:R,dimension:H||w||P,expanded:_,formatter:S,groupingType:I,isDataAvailable:L,isHovered:!!H,keys:D,lastUpdate:f,linkStyle:Y,truncatedKeys:T,viewAllHref:k,emptyValueTitle:g?.[I]})]})}),eQ=(0,a.memo)(function(e){return(0,t.jsx)(eX,{children:(0,t.jsx)(eZ,{...e})})}),eJ=(0,a.memo)(function(e){let r,{from:i,to:l,metricNames:n,data:s=[],groupByProjectData:o,metricColors:c,formatter:u,unit:d,granularity:f,lastUpdate:h,dataAvailableSince:p,selectedProjectId:m,disableGroupBy:x=!1,legendNote:g,groupingTypeEmptyValueTitles:y,groupingTypeOptions:v=["Average","Projects"],defaultGroupingType:j="Average",groupingTypeLinkStyles:b,setGroupByProject:w,expanded:k=!1,viewAllHref:S=""}=e,N=eY(u,d),[C,{width:O}]=(0,et.default)(),{chartData:D,keys:T,range:M,dimension:P,groupingType:I,setGroupingType:E,isGroupingEnabled:A}=function(e){let{data:t=[],groupByProjectData:r,metricNames:i,formatter:l,defaultGroupingType:n,expanded:s=!1}=e,{groupingType:o,setGroupingType:c}=ev({defaultGroupingType:n,expanded:s}),{groupedData:u,keys:d}=(0,a.useMemo)(()=>{if("Projects"===o){let e=new Map;for(let t of r||[])for(let a of t.data){let[t,r]=e.get(a.name)??[0,0];e.set(a.name,[t+a.sum,r+a.count])}let a=[...e.entries()].sort((e,t)=>{let[,a]=e,[,r]=t;return a[0]/a[1]>r[0]/r[1]?-1:1}).map(e=>{let[t]=e;return t}),i=Object.fromEntries(a.map(e=>[e,[0,0]])),l=a.map(e=>{for(let a of t){let t=a.resources?.find(t=>{let{name:a}=t;return a===e});if(t)return{...t,title:t.name,sum:0,count:0}}}).filter(e=>void 0!==e);return{groupedData:(r||[]).map(e=>({data:{...i,...Object.fromEntries(e.data.map(e=>[e.name,[e.sum,e.count]]))},resources:l,date:e.date})),keys:a}}return{groupedData:t.map(e=>{let{date:t,resources:a,regions:r,...l}=e;return{data:Object.entries(l).reduce((e,t)=>{let[a,[r,l]]=t,n=i[Number.parseInt(a,10)];return n&&(e[n]=[r,l]),e},{}),date:t,resources:a,regions:r}}),keys:i}},[t,r,o,i]),[f,h,p]=(0,a.useMemo)(()=>{let e={},t=0;for(let a of u)for(let r of d)if(r in a.data){let[i,l]=a.data[r];t<i/l&&(t=i/l);let[n,s]=e[r]??[0,0];e[r]=[i+n,l+s]}let a=Object.fromEntries(Object.entries(e).map(e=>{let[t,[a,r]]=e;return[t,a/r]}));return[(0,eg.roundUpAxisRange)(t,l),t>0,a]},[l,u,d]),m=u.map(e=>{let t=Object.entries(e.data).map(e=>{let[t,[a,r]]=e;return[t,0!==r?a/r:void 0]});return{date:e.date,value:t.reduce((e,t)=>{let[a,r]=t;return Math.max(e,r??0)},0),data:Object.fromEntries(t),resources:e.resources}});return{chartData:m,keys:d,range:f,dimension:p,groupingType:o,setGroupingType:c,isGroupingEnabled:h&&m[0]&&("resources"in m[0]||"regions"in m[0]||"logDrains"in m[0]||"logSources"in m[0]||"eventType"in m[0]||"blobStores"in m[0]||"runtime"in m[0]||"cause"in m[0]||"readerProjects"in m[0])}}({metricNames:n,data:s,groupByProjectData:o,formatter:N,defaultGroupingType:j,expanded:k}),L="Projects"===I&&!o,F=D.length>0,{valueScale:B,dateScale:R,colorScale:$,tickYValues:z,tickXValues:U}=function(e){let{data:t=[],width:r}=e;return{dateScale:(0,a.useMemo)(()=>{let e=t.map(e=>{let{date:t}=e;return t});return(0,e_.scalePoint)({domain:e,range:[0,r-36],padding:.3})},[t,r]),...ek(e)}}({data:s,width:O,range:M,keys:T,granularity:f,colors:"Projects"===I||"Regions"===I?eV.defaultMetricColors:c}),{usageTooltipProps:G,tooltipData:W,tooltipDimension:K,showTooltip:q,hideTooltip:Y,cancelHideTooltip:X}=ex({from:i,to:l,granularity:f}),Z=(0,a.useCallback)(e=>{w?.("Projects"===e),E(e)},[w,E]),Q=(0,a.useMemo)(()=>{var e;let t,a,r;return t=(e=R).domain(),a=e(t[0])??0,r=e.step(),e=>Math.max(0,Math.min(Math.round((e-a)/r),t.length-1))},[R]),er=(0,a.useCallback)(e=>{let t;X();let{x:a,y:r}=(0,J.localPoint)(e)||{x:0,y:0},i=Q(a),l=D[i],n=Object.values(l.data).filter(e=>"number"==typeof e).sort((e,t)=>e-t);if(!n.length)return;let s=B.invert(r),o=(t=n.length-1,(0,ea.bisector)(e=>e).left(n,s,0,t));if(W&&i===W.index&&o===W.yIndex)return;let c=(B(n[o])||0)-22,u=(R(l.date)||0)+50;q({tooltipData:{data:l,index:i,yIndex:o},tooltipLeft:u,tooltipTop:c})},[X,D,R,Q,q,W,B]);void 0!==G.left&&(r=Q(G.left-50));let ei=(0,a.useMemo)(()=>{let e=v.indexOf(I);return b?.[e]??"none"},[I,v,b]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eM,{disableGroupBy:x||!L&&!A,groupingType:I,groupingTypeOptions:v,lastUpdate:h,noteText:g,selectedProjectId:m,setGroupingType:Z}),(0,t.jsxs)(e0,{chartRef:C,chartScales:{dateScale:R,valueScale:B},dataAvailableSince:p,formatter:N,granularity:f,isDataAvailable:F,loading:L,tickXValues:U,tickYValues:z,usageTooltip:{cancelHideTooltip:X,hideTooltip:Y,usageTooltipProps:G},width:O,children:[void 0!==G.left&&(0,t.jsx)(H,{from:{x:G.left-50,y:0},pointerEvents:"none",stroke:"var(--accents-2)",strokeWidth:1,to:{x:G.left-50,y:200}}),T.map(e=>{let i=$(e),l=D.map(t=>({date:t.date,value:t.data[e]})),n="number"==typeof r?l[r]?.value:void 0,s=void 0!==n?B(n):void 0;return(0,t.jsxs)(a.default.Fragment,{children:[(0,t.jsx)(V,{curve:ee.curveLinear,data:l.filter(e=>void 0!==e.value),stroke:i,strokeWidth:2,x:e=>{let{date:t}=e;return R(t)??0},y:e=>{let{value:t}=e;return B(t)}}),void 0!==G.left&&void 0!==s&&(0,t.jsx)("circle",{cx:G.left-50,cy:s,fill:i,pointerEvents:"none",r:4,stroke:"white",strokeWidth:2})]},e)}),(0,t.jsx)(_,{fill:"transparent",height:200,onMouseMove:er,onTouchMove:er,rx:0,width:O,x:0,y:0})]}),(0,t.jsx)(eG,{chartData:D,colorScale:$,dimension:K||P,expanded:k,formatter:N,groupingType:I,isDataAvailable:F,isHovered:!!K,keys:T,lastUpdate:h,linkStyle:ei,loading:L,viewAllHref:S,emptyValueTitle:y?.[I]})]})}),e0=(0,a.memo)(function(e){let{chartRef:r,chartScales:{dateScale:i,valueScale:l},children:n,dataAvailableSince:s,formatter:o,granularity:c,isDataAvailable:u,loading:d,tickXValues:f,tickYValues:h,usageTooltip:{cancelHideTooltip:p,hideTooltip:m,usageTooltipProps:x},width:g}=e,y=(0,a.useRef)(null),[v,j]=(0,a.useState)(400);if((0,a.useEffect)(()=>{let e=y.current;if(!e)return;let t=()=>{j(e.clientWidth)};requestAnimationFrame(()=>t());let a=new ResizeObserver(t);return a.observe(e),()=>{a.disconnect()}}),d)return(0,t.jsx)(eq,{});let b=6e4*new Date().getTimezoneOffset();return u?(0,t.jsxs)("figure",{className:el.default.figure,onMouseEnter:p,onMouseLeave:m,ref:r,style:{visibility:g?"visible":"hidden"},children:[(0,t.jsxs)("div",{className:el.default["auto-visibility"],children:[(0,t.jsx)("svg",{height:227,width:50,children:(0,t.jsx)(Q.AxisLeft,{hideAxisLine:!0,hideTicks:!0,left:8,scale:l,tickFormat:e=>o(e),tickLabelProps:()=>({fill:"var(--accents-5)",fontSize:14,textAnchor:"start"}),tickValues:h,top:5})}),(0,t.jsxs)("svg",{height:227,ref:y,width:"calc(100% - 50px)",children:[(0,t.jsx)(Z.AxisBottom,{hideAxisLine:!0,hideTicks:!0,scale:i,tickFormat:e=>(0,en.formatDate)(e+("hour"===c?0:b),c),tickLabelProps:()=>({fill:"var(--accents-5)",fontSize:14,textAnchor:"middle"}),tickValues:f,top:200}),(0,t.jsx)(X.GridRows,{scale:l,stroke:"var(--accents-2)",tickValues:h,width:v}),(0,t.jsx)(Y.Group,{children:n})]})]}),(0,t.jsx)(em,{...x,dataAvailableSince:s,width:g})]}):(0,t.jsx)(ei.Empty,{})}),e1=(0,a.memo)(function(e){return(0,t.jsx)(eX,{children:(0,t.jsx)(eJ,{...e})})});var e5=e.i(1875382),e2=e.i(7909933),e4=e.i(4758698),e9=e.i(5338940),e3=e.i(1683927),e7=e.i(1649649),e8=e.i(1987325),e6=e.i(6199768);e.i(2243470);var te=e.i(696150),tt=e.i(2560270),ta=e.i(7807066),tr=e.i(8530316),ti=e.i(4588576);function tl(e){let{imageOptimizations:r,selectedGroup:i,query:n,isLoading:s,className:c}=e,[u,d]=(0,a.useState)(i),[f,h]=(0,a.useState)(i);(0,a.useEffect)(()=>{d(i)},[i]);let[p,m]=(0,a.useState)({}),[x,g]=[n.startDatetime,n.endDatetime].map(Number);(0,a.useEffect)(()=>{m({})},[n.projectId,x,g,n.skip]);let{groupCounts:y,groups:v,offsets:j}=(0,a.useMemo)(()=>{let e={offsets:[],groups:[],groupCounts:[]};if(!r)return e;for(let{count:t,timestamp:a}of r){let r=e.groups.indexOf(a);-1===r&&(r=e.groups.push(a)-1,e.offsets[r]=e.groupCounts.reduce((e,t)=>e+t,0)),e.groupCounts[r]=(e.groupCounts[r]||0)+t}return e},[r]),[b,w]=(0,a.useState)(!1),[_,{height:k}]=(0,et.default)(),S=(0,ed.useSpring)({height:k||54,config:{mass:.15,tension:400,friction:30}}),N=(0,a.useRef)(null);null!==u&&N.current?.scrollToIndex({groupIndex:u,index:0,behavior:"smooth"});let C=(0,a.useMemo)(()=>{let e=[];for(let t=Math.max((f??1)-1,0),a=0,r=0;t<v.length&&null!==f;a+=y[t++],r++){let i=v[t].split(" ")[0].split("T")[0];if(r<3||a<=100)i in p||e.push(i);else break}return e},[y,p,v,f]),O=(0,tr.useUsageImageOptimizations)({...n,buckets:C});(0,a.useEffect)(()=>{if(O.data){if("error"in O.data||0===O.data.data.length)return;let e={};for(let{timestamp:t,sourceImages:a}of O.data.data)e[t.split(" ")[0].split("T")[0]]=a||[];m(t=>({...t,...e}))}},[O.data]);let D=s||O.data&&"error"in O.data||!r?.length;(0,a.useEffect)(()=>{null===u||D||w(!0)},[u,D]);let T=(0,a.useCallback)(e=>{e!==u&&d(null),h(e)},[u]);return(0,t.jsx)(eu.animated.div,{className:(0,l.clsx)(c,ti.default["animated-container"],{[ti.default.open]:b}),style:S,children:(0,t.jsxs)("details",{className:(0,l.clsx)(ti.default["src-images-container"],{[ti.default.open]:b,[ti.default.disabled]:D}),onClick:e=>{e.preventDefault(),!D&&(b||w(!0))},open:b,ref:_,children:[(0,t.jsx)("summary",{onClick:e=>{e.preventDefault(),D||(d(null),w(!1))},children:(0,t.jsxs)("div",{children:[b?(0,t.jsx)(tt.ChevronDown,{color:"gray-700",size:20}):(0,t.jsx)(ta.ChevronRight,{color:"gray-700",size:20}),(0,t.jsx)("span",{children:"View Source Images"})]})}),(0,t.jsx)("div",{children:(0,t.jsx)(e6.GroupedVirtuoso,{groupContent:function(e){let a=v[e],r=te.DateTime.fromISO(a.endsWith("Z")?a:`${a.split(" ").join("T")}.000Z`).toJSDate();return(0,t.jsxs)("div",{className:ti.default.rowHeader,children:[`${(0,es.format)(r,"MMM d, yyyy")}`,(0,t.jsxs)(o.Badge,{size:"sm",variant:"gray-subtle",children:[y[e].toLocaleString()," Images Optimized"]})]})},groupCounts:y,itemContent:function(e,a){let r=v[a].split(" ")[0].split("T")[0],i=j[a],l=p[r]?.[e-i];return l?(0,t.jsx)("div",{className:ti.default.row,children:l}):O.isLoading?(0,t.jsx)("div",{className:ti.default.row,children:(0,t.jsx)(eW.Skeleton,{width:"100%"})}):(0,t.jsx)("div",{className:ti.default.row,children:"Unknown"})},rangeChanged:(0,a.useMemo)(()=>(0,e8.default)(e=>{let{startIndex:t}=e,a=j.length;for(;a--&&!(t>j[a]););T(a+1)},100),[j,T]),ref:N,style:{height:400}})})]})})}var tn=e.i(5757634),ts=e.i(3086762),to=e.i(8735244),tc=e.i(7780974),tu=e.i(7837522),td=e.i(9071035);let tf={bandwidth:"sum(bandwidth_total)",execution_time:"sum(serverless_function_execution)",invocations:"sum(requests)",requests:"sum(requests)"};function th(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t?`/${t}/~/monitoring`:"/dashboard/monitoring";if(!e)return r;let{targetPath:i,host:l,range:n,pathKey:s}=e,o=tf[e.sortKey],c="request_path"===s?"request_path":"source_path",u=a?`match(${c}, '${i}')`:`${c} = '${i}'`;void 0!==l&&(u=`${u} AND host = '${l}'`),void 0!==e.pathType&&(u=`${u} AND path_type = '${e.pathType}'`),void 0!==e.status&&(u=`${u} AND status = '${e.status}'`);let d="",f="";if(n){let e=n.startDate.getTime(),t=Math.min(n.endDate.getTime(),Date.now())-n.startDate.getTime(),a=(0,td.getDefaultGranularity)(t);d=`&startTime=${e}&deltaTime=${t}`,f=`&g=${a}`}return`${r}?visualize=${encodeURIComponent(o)}&where=${encodeURIComponent(u)}${d}${f}`}function tp(e,t,a,r,i){return[{teamSlug:e,batchKey:a,filters:{to:t.to,from:t.from,projectId:t.projectId},isPage:r,options:i},"usage-metrics-action"]}var tm=e.i(2913410),tx=e.i(682502),tg=e.i(6939507),ty=e.i(5433449);let tv=[{value:"bandwidth",label:"Bandwidth",description:"Total incoming and outgoing bandwidth in GB from any unique path",icon:(0,t.jsx)(tx.ArrowCrossed,{})},{value:"execution_time",label:"Execution",description:"Execution in GB-Hrs from serverless functions",icon:(0,t.jsx)(tg.Lambda,{})},{value:"invocations",label:"Invocations",description:"Number of requests to serverless, ISR, and Edge functions",icon:(0,t.jsx)(tg.Lambda,{})},{value:"requests",label:"Requests",description:"Number of requests to any unique path",icon:(0,t.jsx)(ty.FileText,{})}],tj=[{label:"Request",value:"request_path"},{label:"Source",value:"target_path"}],tb={bandwidth:"size",execution_time:"computingTime",invocations:"count",requests:"count"},tw=["bandwidth","requests","invocations","execution_time"];function t_(e){let{filters:r,chartKey:i,batchKey:l,isPage:n,getData:s,initialData:o,cacheOnly:u}=e,d=(0,e5.useParams)(),[f,h]=(0,a.useState)("bandwidth"),[p,m]=(0,a.useState)("request_path"),[x,g]=(0,a.useState)(!1),{track:y}=(0,tu.useTrackActivity)(),v=d?.teamSlug??"";(0,a.useEffect)(()=>{g(!0)},[]);let j="bandwidth"===f&&"request_path"===p,b=tp(v,r,l,n,{usageType:f,pathType:p}),{data:w,isValidating:_}=(0,e2.default)(u?null:b,async e=>{let[t]=e,a=await s(t);return await a.promise},{refreshInterval:0,revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateOnMount:o.error?.code==="timeout",fallback:o.error?.code==="timeout"?{}:{[(0,e2.unstable_serialize)(tp(v,o.filters,l,n,{usageType:"bandwidth",pathType:"request_path"}))]:{[i]:o}}}),k=w?.[i]?.error,S=w?.[i]?.data?.data??[],N=!!S.length,C=(0,tm.useChartCache)({filters:r,teamSlug:v},i),O=C?.data,D=!!(j&&!_&&!k&&w);(0,a.useEffect)(()=>{D&&v&&(0,tm.setChartDataCache)(i,{key:{...b[0]},data:n?void 0:S,isValidating:!1})},[D,i,n,(0,e2.unstable_serialize)(b[0]),d?.teamSlug]),(0,a.useEffect)(()=>{if(!N)return;let e=async e=>{let t=tp(v,r,l,n,{usageType:f,pathType:p,...e});if(!ts.cache.get((0,e2.unstable_serialize)(t)))return(0,tn.preload)(t,async e=>{let[t]=e,a=await s(t);return await a.promise})};for(let t of(e({pathType:"target_path"===p?"request_path":"target_path"}),tw))if(t!==f){e({usageType:t});break}},[f,p,N]);let T=(0,a.useCallback)(e=>th({sortKey:f,targetPath:e.path,host:e.host,pathKey:"target_path"===p?"source_path":p,range:{startDate:r.from,endDate:r.to}},d?.teamSlug),[d?.teamSlug,p,f,r.from,r.to]),M=(0,e4.useChartLink)(d?.teamSlug??"",i),P=(0,a.useCallback)(e=>{let a=th({...function(e){try{if(!e.includes("."))return{targetPath:e};let t=new URL(e.startsWith("http")?e:`https://${e}`);return{host:t.host,targetPath:t.pathname}}catch{return{targetPath:e}}}(e),sortKey:f,pathKey:"target_path"===p?"source_path":p,range:{startDate:r.from,endDate:r.to}},d?.teamSlug,!0);return(0,t.jsxs)(t.Fragment,{children:["Your search did not match any paths in your Top 1,000 paths. You can look at all your paths with"," ",(0,t.jsx)(c.Link,{href:a,target:"_blank",variant:"highlight",children:"Monitoring"}),"."]})},[d?.teamSlug,p,f,r.from,r.to]);if(!u||O)return{error:k,type:"paths",formatter:tb[f],data:u?O:S,filters:tv,selectedFilter:f,onFilterChange:e=>{u||(h(e),y(tc.VercelActivityAction.UsageTopPathsFilterChange,{plan:d?.plan,planIteration:d?.planIteration,usageType:e,pathType:p}))},subFilters:tj,selectedSubFilter:p,onSubFilterChange:e=>{u||(m(e),y(tc.VercelActivityAction.UsageTopPathsFilterChange,{plan:d?.plan,planIteration:d?.planIteration,usageType:f,pathType:e}))},getRowHref:T,showSkeleton:_||!x,viewAllHref:M,footerNote:u?(0,t.jsx)("div",{className:"flex flex-row items-stretch justify-center flex-initial",children:(0,t.jsx)(to.Spinner,{})}):"Showing the top 1,000 paths within the selected time range",noDataMessage:P}}function tk(e){let{props:r,filters:i}=e,[l,n]=(0,a.useState)(null);if(!r||"bar"!==r.type)return;let s=r.data?.map(e=>({timestamp:new Date(e.date).toISOString(),count:e.sum,projectId:"",projectName:""}));return{...r,onBarSelected:e=>{let{bar:t}=e;n(t.index)},footer:(0,t.jsx)(tl,{className:j.default.imageOptimizationsTable,imageOptimizations:s,isLoading:!1,query:{startDatetime:i.from,endDatetime:i.to,projectId:i.projectId},selectedGroup:l})}}function tS(e){let{props:t,filters:r,chartKey:i}=e,l="edge-functions-cpu-time"===i?"edge-function":"middleware",[n,s]=(0,a.useState)(!1),{data:o}=(0,e3.useUsageGroupByProjectMetrics)({type:"edge_group_by_project",edgeInvocationType:l,start:r.from,end:r.to,skip:!n||!l});return t?.type==="line"?{...t,groupByProjectData:o?.data.workerExecutionAvg,setGroupByProject:s}:void 0}function tN(e){let{props:t,filters:a}=e,r=a.projectId?"When filtered by project local artifact usage is not attributed.":void 0;return t?{...t,legendNote:r}:void 0}function tC(e){let{props:r}=e,{isPlus:i,plan:l}=(0,e7.useIsWebAnalyticsBilling)(),{team:n}=(0,e9.useTeam)(),s=(0,a.useMemo)(()=>{if("pro"!==l)return;let e=n?.slug?`/${n.slug}/~/settings/billing#web-analytics`:"/account/billing#web-analytics";return i?(0,t.jsxs)("p",{className:"text-copy-14",children:["You have Web Analytics Plus enabled for your team."," ",(0,t.jsx)(c.Link,{href:"/docs/analytics/limits-and-pricing",variant:"highlight",children:"Manage in Billing"}),"."]}):(0,t.jsxs)("p",{className:"text-copy-14",children:["Enable the"," ",(0,t.jsx)(c.Link,{href:e,variant:"highlight",children:"Web Analytics Plus Add-on"})," ","to unlock 500k included events per month."]})},[i,l,n?.slug]);return r?{...r,additionalDescription:s}:void 0}function tO(e){let{chartKey:t,batchKey:r,filters:i,initialData:l,getData:n,noRevalidate:s,cacheOnly:o,isPage:c}=e,u=(0,e5.useParams)(),{hook:d,noSWR:f}=(0,a.useMemo)(()=>"image-optimization-source-image-optimizations"===t?{hook:tk}:"networking-top-paths"===t?{hook:t_,noSWR:!0}:"observability-web-analytics"===t?{hook:tC}:"edge-functions-cpu-time"===t||"edge-middleware-cpu-time"===t?{hook:tS}:t.startsWith("artifacts-")?{hook:tN}:{hook:e=>{let{props:t}=e;return t}},[t]),h=u?.teamSlug??"",p=tp(h,i,r,c),{data:m,isValidating:x}=(0,e2.default)(f||o?null:p,async e=>{let[t]=e;if(s)return{};let a=await n(t);return await a.promise},{refreshInterval:0,revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateOnMount:l.error?.code==="timeout",revalidateIfStale:!1,fallback:l.error?.code==="timeout"?{}:{[(0,e2.unstable_serialize)(tp(h,l.filters,r,c))]:{[t]:l}}}),{data:g,meterData:y,error:v}=m?.[t]??l,j=d({filters:i,props:g,chartKey:t,batchKey:r,getData:n,cacheOnly:o,initialData:l,isPage:c}),b=f?j?.error:v,w=(0,e4.useChartLink)(h,t),_=(0,a.useMemo)(()=>j?{...j,viewAllHref:w,formatter:en.formatters[j.formatter],selectedProjectId:i.projectId}:void 0,[i.projectId,j,w]),k=u?.teamSlug?(0,tm.getChartDataCache)(t,{...p[0]})?.data:void 0;return(0,a.useEffect)(()=>{!s&&!c&&!o&&u?.teamSlug&&(0,tm.setChartDataCache)(t,{key:{...p[0]},data:_,meterData:y,isValidating:x,error:b})},[s,t,_,o,c,p,x,y,b,u?.teamSlug]),{meterData:y,error:b,props:o&&!s?k:_,isValidating:x,footer:j?.footer??null}}e.s(["useChartData",()=>tO],6990379);var tD=e.i(9939117);function tT(e){let{skeleton:a,card:r,sectionKey:i,teamSlug:l,isPage:n}=e;return(0,t.jsx)(v,{accessory:a.hasMeter?(0,t.jsx)(eW.Skeleton,{height:20,width:120}):null,card:r,sectionKey:i,teamSlug:l,children:(0,t.jsx)(tM,{isPage:n,skeleton:a})})}function tM(e){let{skeleton:a,isPage:r}=e;switch(a.type){case"bar":case"line":return(0,t.jsx)(eK,{metricCount:a.metricCount});case"paths":return(0,t.jsx)(tD.PathsChart,{expanded:r,filters:a.filters,filtersClassName:r?j.default.stickyPathsFilters:void 0,selectedFilter:a.filters?.[0]?.value,selectedSubFilter:a.subFilters?.[0]?.value,showSkeleton:!0,subFilters:a.subFilters});default:return null}}var tP=e.i(9584456);function tI(e){let{type:a}=e;return(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial tailwind-preflight",children:(0,t.jsxs)("div",{className:(0,l.clsx)("flex flex-col items-center justify-center gap-5 flex-initial rounded-md border border-gray-400 bg-background-100",{"h-[392px]":"bar"===a||"line"===a,"h-[340px]":"paths"===a}),children:[(0,t.jsx)("div",{className:"flex flex-col items-center justify-center flex-initial size-10 rounded-full bg-red-100",children:(0,t.jsx)(tP.StopFill,{color:"red-900"})}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-start gap-1 flex-initial",children:[(0,t.jsx)("p",{className:"text-label-14 font-medium",children:"Something went wrong"}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"We couldnt load the data for your selection"})]})]})})}let tE=(0,a.memo)(function(e){let{teamSlug:a,skeleton:l,plan:n,card:s,sectionKey:o,isPage:c,planIteration:u,isReseller:d,scopedProject:f,...m}=e,g=(0,x.useUsageFilters)(m.initialData.filters,f?.id),{account:y}=(0,i.useAccount)(),{props:j,meterData:b,isValidating:w,error:_,footer:k}=tO({...m,filters:g,isPage:c});if(_&&!w)return c?(0,t.jsx)(tI,{type:l.type}):(0,t.jsx)(v,{card:s,sectionKey:o,teamSlug:a,children:(0,t.jsx)(tI,{type:l.type})});if(!j||w)return c?(0,t.jsx)(tM,{skeleton:l}):(0,t.jsx)(tT,{card:s,sectionKey:o,skeleton:l,teamSlug:a});if(c)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(tA,{...j,isPage:!0}),k]});let S=b?.limit||"hobby"===n,N=b?{...b,currency:y?.billing?.currency,formatter:j.formatter,used:b.value,hideOnTablet:!1,hidePrices:d}:void 0;return(0,t.jsx)(v,{accessory:N&&!N.hideChartMeter?(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-initial",children:[S?(0,t.jsx)(h,{...N}):(0,t.jsx)(r.Gauge,{className:"geist-hide-on-mobile",size:"tiny",value:0}),(0,t.jsx)(p,{...N,hideLimit:!S})]}):null,additionalDescription:j.additionalDescription,card:s,footer:k,plan:n,planIteration:u,sectionKey:o,teamSlug:a,children:(0,t.jsx)(tA,{...j})})}),tA=(0,a.memo)(function(e){let{isPage:a,...r}=e;switch(r.type){case"bar":return(0,t.jsx)(eQ,{...r,expanded:a});case"line":return(0,t.jsx)(e1,{...r,expanded:a});case"paths":return(0,t.jsx)(tD.PathsChart,{...r,expanded:a,filtersClassName:a?j.default.stickyPathsFilters:void 0});default:return null}});e.s(["UsageChart",0,tA,"UsageChartWrapper",0,tE],6527262)},6517252,e=>{"use strict";var t=e.i(8711407),a=e.i(9995129),r=e.i(6990379),i=e.i(6527262);function l(e){let{children:r,scopedProject:i,...l}=e,s=(0,a.useUsageFilters)(void 0,i?.id);return s?(0,t.jsx)(n,{...l,filters:s,children:r}):r}function n(e){let{children:a,chartKey:l,batchKey:n,filters:s,noRevalidate:o}=e,{props:c,footer:u}=(0,r.useChartData)({filters:s,isPage:!1,cacheOnly:!0,chartKey:l,batchKey:n,initialData:{filters:s,error:{code:"not_found",message:"Not found"}},noRevalidate:o,getData:async()=>({promise:Promise.resolve({})})});return(0,t.jsxs)(t.Fragment,{children:[c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.UsageChart,{...c,isPage:!0}),u]}):null,(0,t.jsx)("div",{style:c?{display:"none"}:void 0,children:a})]})}e.s(["ClientChartWrapper",()=>l])}]);

//# debugId=334dc647-b1cf-2c35-1944-57a47c428a27
//# sourceMappingURL=3f2ca7250325d778.js.map
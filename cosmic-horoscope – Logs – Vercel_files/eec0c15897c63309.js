;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="8e01e78f-affc-e5f6-f477-c7f8c46c8d08")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6079422,6489459,626404,7197081,e=>{"use strict";var t=e.i(1176592),i=e.i(7917902),a=e.i(271259);let r={slug:"hobby",title:"Hobby",description:"Start for free"},s={slug:"pro-trial",title:"Pro Trial",description:"Try all the Pro features free for 14 days"},l={slug:"pro",title:"Pro",description:"Everything you need to build and scale your project"},n={slug:"pro",title:"Pro",description:"Upgrade your Pro Trial"};function o(e){let t=e.length>1||e[0].description===n.description;return{actualTrialBehavior:e.some(e=>"pro-trial"===e.slug)?t?"choose":"force-trial":"disallow-trial",showSelector:t,validSelectorOptions:e}}function d(e){let{teamManager:d,desiredTrialBehavior:c="choose",disallowHobby:u}=e,[m,p]=(0,t.useState)("pro"),{canCreateHobbyTeam:g,ready:x,hasHobbyTeam:f}=function(){let{user:e,teams:t}=(0,i.useAccount)(),{ready:r,canCreateTrial:s}=(0,a.useCanCreateTrial)();if(!e||!t||!r)return{ready:!1};if("northstar"!==e.version)return{ready:!0,canCreateHobbyTeam:!1,hasHobbyTeam:!1};let l=t.some(e=>e.billing?.plan==="hobby");return{ready:!0,canCreateHobbyTeam:!l&&!s,hasHobbyTeam:l}}(),{canCreateTrial:h,ready:b}=(0,a.useCanCreateTrial)(),{actualTrialBehavior:y,validSelectorOptions:w,showSelector:v}=(0,t.useMemo)(()=>(function(e){let{teamManager:t,canCreateHobbyTeam:i,hasTrialsRemaining:a,desiredTrialBehavior:d}=e;if(t?.userIntent==="upgrade-existing"&&t.team.billing?.plan==="pro"&&t.team.billing?.status==="trialing")if(a)return o([n]);else return o([l]);if(t?.userIntent==="upgrade-existing"&&t?.team?.billing?.plan==="hobby")if(!a)return o([l]);else if("force-trial"===d)return o([s]);else if("choose"===d)return o([s,l]);else return o([l]);if(t?.userIntent==="create"){if(a){if("force-trial"===d)return o([s]);else if("choose"===d)return o([s,l])}else if(i&&"choose"===d)return o([r,l])}return o([l])})({teamManager:d,canCreateHobbyTeam:g&&!u,hasTrialsRemaining:!!h,desiredTrialBehavior:c}),[d,g,h,c,u]),j=(0,t.useMemo)(()=>{let e=w.find(e=>e.slug===m);return e?.slug??w[0].slug},[m,w]),N=(0,t.useMemo)(()=>{if("force-trial"===c&&c!==y)return h?f?"This team is not eligible for a Pro Trial upgrade, but you have one or more existing Hobby teams. Choose one of those to start a Pro Trial.":"You don't have an existing trial-eligible team. Create a new team to start a Pro Trial.":"Sorry, you're out of Pro Trials!"},[y,c,f,h]);return x&&b?{loading:!1,data:{selectedPlan:j,setSelectedPlan:p,showSelector:v,desiredTrialBehavior:c,actualTrialBehavior:y,validSelectorOptions:w,hasTrialsRemaining:h,userHelpMessage:N}}:{loading:!0,data:void 0}}e.s(["usePlanSelector",()=>d],6079422);var c=e.i(9182110);function u(e){let{forceCreateTeam:i,eligibleTeams:a,teamHint:r,teamInScope:s,teamsAreLoading:l}=e,[n,o]=(0,t.useState)(i?"create":"upgrade-existing"),[d,c]=(0,t.useState)(""),[u,p]=(0,t.useState)(void 0),g=(0,t.useCallback)((e,t)=>{if(0===a.length)return o("create");if(o(e),"create"===e){p(void 0),"string"==typeof t&&c(t);return}return(c(""),"object"==typeof t&&a.find(e=>e.id===t.id))?p(t):p(m({eligibleTeams:a,teamHint:r,teamIdInScope:s?.id}))},[a,r,s?.id]);return((0,t.useEffect)(()=>{l||("upgrade-existing"===n&&a.length>0&&void 0===u?(0,t.startTransition)(()=>{p(m({eligibleTeams:a,teamHint:r,teamIdInScope:s?.id}))}):"upgrade-existing"===n&&0===a.length&&void 0===u&&(0,t.startTransition)(()=>{o("create")}))},[a,r,s?.id,u,l,n]),"create"===n)?{loading:!1,data:{teamName:d,setTeamName:c,userIntent:n,setUserIntent:g}}:u?{loading:!1,data:{userIntent:n,setUserIntent:g,team:u}}:{loading:!0,data:void 0}}function m(e){let{eligibleTeams:t,teamHint:i,teamIdInScope:a}=e,r=t.find(e=>(0,c.isHintedTeam)({team:e,teamHint:i}));if(r)return r;let s=t.find(e=>e.id===a);if(s)return s;let l=t.find(e=>e.billing?.plan==="hobby");return l||t.at(0)}function p(e){let{team:i}=e,[a,r]=(0,t.useState)(""),s=()=>{};return(0,t.useMemo)(()=>void 0===i?{userIntent:"create",teamName:a,setTeamName:r,setUserIntent:s}:{userIntent:"upgrade-existing",team:i,setUserIntent:s},[i,a])}e.s(["useTeamManager",()=>u,"useTeamManagerFromTeam",()=>p],6489459);var g=e.i(8128646),x=e.i(119294),f=e.i(6352514),h=e.i(8248823);function b(e){let{steps:t,workflowName:i,immutableDisabledSteps:a=new Set,mutableDisabledSteps:r=new Set}=e;if(void 0===t.at(0))throw Error("Tried to initialize useSteps with no steps");let s=t.filter(e=>!a.has(e)&&!r.has(e)),l=s.at(0);if(void 0===l)throw Error("Tried to initialize useSteps with no enabled steps");return{step:l,allSteps:t,enabledSteps:s,immutableDisabledSteps:a,mutableDisabledSteps:r,isFirstEnabledStep:!0,workflowName:i}}function y(e,t,i,a){let r="next"===a?1:-1,s=i.indexOf(e),l=i[s+r];if(void 0===l)throw Error(`Tried to go to the ${a} step, but it doesn't exist. If this was thrown during hook initialization, it's likely because all steps are disabled.`);return t.includes(l)?l:y(l,t,i,a)}function w(e){var i;let[a,r]=(0,t.useReducer)((0,g.default)((e,t)=>{switch(t.type){case"next-step":{let t=y(e.step,e.enabledSteps,e.allSteps,"next");x.analytics.track(f.AnalyticsEvent.STEPPED_WORKFLOW_CHANGE_STEP,{workflowName:e.workflowName,fromStep:e.step,toStep:t,switchType:"next"}),e.step=t;break}case"previous-step":{let t=y(e.step,e.enabledSteps,e.allSteps,"previous");x.analytics.track(f.AnalyticsEvent.STEPPED_WORKFLOW_CHANGE_STEP,{workflowName:e.workflowName,fromStep:e.step,toStep:t,switchType:"previous"}),e.step=t;break}case"set-step":x.analytics.track(f.AnalyticsEvent.STEPPED_WORKFLOW_CHANGE_STEP,{workflowName:e.workflowName,fromStep:e.step,toStep:t.step,switchType:"direct"}),e.step=t.step;break;case"enable-step":e.mutableDisabledSteps.delete(t.step);break;case"disable-step":e.mutableDisabledSteps.add(t.step);break;default:(0,h.exhaustivenessCheck)(t)}let i=e.allSteps.filter(t=>!e.immutableDisabledSteps.has(t)&&!e.mutableDisabledSteps.has(t));(i.length!==e.enabledSteps.length||e.enabledSteps.some((e,t)=>e!==i[t]))&&(e.enabledSteps=i),e.isFirstEnabledStep=e.enabledSteps[0]===e.step}),e,b),{isFirstEnabledStep:s,step:l}=a,n=(0,t.useCallback)((i=()=>r({type:"previous-step"}),async e=>{s?await e():i()}),[s]),o=(0,t.useCallback)(t=>{r({type:"next-step"}),e.gotoCallback?.({goto:"next",currentStep:l,...t})},[l,e.gotoCallback]),d=(0,t.useCallback)((t,i)=>{r({type:"set-step",step:t}),e.gotoCallback?.({goto:"step",currentStep:l,step:t,...i})},[l,e.gotoCallback]),c=(0,t.useCallback)(e=>r({type:"disable-step",step:e}),[]),u=(0,t.useCallback)(e=>r({type:"enable-step",step:e}),[]);return{...a,backOrCancel:n,gotoNext:o,gotoStep:d,disableStep:c,enableStep:u}}e.s(["useSteps",()=>w],626404),e.s([],7197081)},7846892,e=>{"use strict";var t=e.i(8711407),i=e.i(5806401),a=e.i(2504781),r=e.i(6942035),s=e.i(6143247),l=e.i(3306538),n=e.i(5468328),o=e.i(57106),d=e.i(6318858),c=e.i(7749291),u=e.i(2988836);let m="flex flex-row items-center gap-3 rounded-sm py-2 pl-4 pr-3";var p=e.i(5255926),g=e.i(1176592),x=e.i(1136434),f=e.i(9386557),h=e.i(4956623),b=e.i(4860345),y=e.i(9789132),w=e.i(9089592),v=e.i(277234),j=e.i(7909933),N=e.i(7432042);function T(e){let{teamManager:i}=e;if(i?.userIntent!=="upgrade-existing")return null;let{team:a}=i;return a.billing?.plan!=="pro"||a.billing?.planIteration==="plus"||a.enableImageOptimizationNewPrice?null:(0,t.jsx)(I,{team:a})}function I(e){var i,r;let{team:c}=e,[T]=(0,g.useState)(Date.now()),[I,S]=(0,g.useState)(!1),C=new Date(T-(0,N.default)("1d")),P=new Date(T-(0,N.default)("31d")),A={revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateIfStale:!1,refreshInterval:0},k=c?.id||void 0,E=(i=k,r=A,(0,j.default)(i?`/api/image-optimization/prices?teamId=${i}`:null,e=>(0,v.fetchAPI)(e,{throwOnHTTPError:!0}),r)),O=P.toISOString(),_=C.toISOString(),L=(0,w.useLegacyImageUsage)({teamId:k,from:O,to:_}),D=(0,y.getOldPriceEstimate)(L.data,c?.billing?.plan),R=(0,b.useNewUsageMetrics)({metric:"image_transformations_preview",teamId:k,from:P.toISOString(),to:C.toISOString(),format:"scalar",views:{count:{groupBy:["billableRegion"]}},userAgent:"vercel-site.usage-estimate.image-transformations-preview"},A),M=(0,b.useNewUsageMetrics)({metric:"data_cache_reads",teamId:k,from:P.toISOString(),to:C.toISOString(),filterBy:{origin:["IMAGE_OPTIMIZATION_PREVIEW"]},format:"scalar",views:{count:{groupBy:["billableRegion"]}},userAgent:"vercel-site.usage-estimate.image-cache-reads"},A),F=(0,b.useNewUsageMetrics)({metric:"data_cache_writes",teamId:k,from:P.toISOString(),to:C.toISOString(),filterBy:{origin:["IMAGE_OPTIMIZATION_PREVIEW"]},format:"scalar",views:{count:{groupBy:["billableRegion"]}},userAgent:"vercel-site.usage-estimate.image-cache-writes"},A),{newPrice:B}=(0,h.getNewPriceEstimate)(E.data,R.data,M.data,F.data,c?.billing?.plan),U=E.isLoading||R.isLoading||M.isLoading||F.isLoading,$=!!(E.error||R.error||M.error||F.error),z=(0,t.jsxs)("span",{className:"text-label-14 flex items-center gap-2",children:["New Image Optimization pricing",(0,t.jsx)(l.Badge,{size:"sm",variant:"blue-subtle",children:"New"})]});if(U)return(0,t.jsx)("li",{className:m,children:(0,t.jsxs)("span",{className:"flex flex-1 flex-col gap-2",children:[z,(0,t.jsx)(p.Skeleton,{width:128,height:12})]})});if(!B||!D||$)return(0,t.jsxs)("li",{className:m,children:[(0,t.jsx)(d.Check,{color:"gray-1000"}),(0,t.jsxs)("span",{className:"flex flex-1 flex-col",children:[z,(0,t.jsxs)("span",{className:"text-label-14 text-gray-900",children:["Based on transformations, cache reads/writes"," ",(0,t.jsx)(n.Tooltip,{className:"inline",text:(0,t.jsx)(o.Link,{href:"https://vercel.com/changelog/faster-transformations-and-reduced-pricing-for-image-optimization",external:!0,className:"underline",children:"Learn more in the Changelog"}),children:(0,t.jsx)(u.InformationFillSmall,{className:"inline-block -mt-0.5",color:"gray-900"})})]})]})]});let W=Math.round((B-D)/D*100);return W<=0?(0,t.jsxs)("li",{className:m,children:[(0,t.jsx)(d.Check,{color:"gray-1000"}),(0,t.jsxs)("span",{className:"flex flex-1 flex-col",children:[z,(0,t.jsxs)("span",{className:"text-label-14 text-gray-900",children:["Save ",-W,"% by switching"]})]})]}):(0,t.jsxs)("li",{className:(0,s.cn)(m,"flex-col gap-3 items-start"),children:[(0,t.jsxs)("div",{className:"flex flex-row items-center gap-3 w-full",children:[(0,t.jsx)(f.WarningFill,{color:"amber-800"}),(0,t.jsxs)(a.Button,{variant:"unstyled",className:"flex flex-1 flex-col [&>span]:p-0 [&>span]:flex [&>span]:flex-col text-left",onClick:()=>S(!I),children:[z,(0,t.jsxs)("span",{className:"text-label-14 text-gray-900 flex flex-row items-center gap-1",children:["Cost increase projected",(0,t.jsx)(x.ChevronDownSmall,{className:I?"rotate-180":""})]})]})]}),I?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-full h-px bg-gray-alpha-400"}),(0,t.jsxs)("span",{className:"text-copy-14 text-gray-900",children:["Image Optimization cost is projected to increase by ",W,"%, see how to"," ",(0,t.jsx)(o.Link,{variant:"highlight",tab:!0,href:"https://vercel.com/docs/image-optimization/limits-and-pricing",children:"optimize cost on the new pricing"})]})]}):null]})}let S={title:"Flexible usage credit",description:"For use towards metered resources",isNew:!0},C={title:"Fast Data Transfer",description:"1 TB /month included"},P={title:"Edge Requests",description:"10M /month included"},A={title:"Free Viewer seats",description:"Collaborate with your team",isNew:!0},k={title:"Enterprise-grade paid add-ons",description:"SAML SSO, HIPAA BAA, and more",isNew:!0},E={title:"New Image Optimization Pricing",description:"Based on transformations, cache reads/writes",isNew:!0},O={title:"On-demand Concurrent Builds",description:"No build queuing by default",isNew:!0,tooltip:{text:"Learn more in the Changelog",href:"/changelog/no-build-queues-on-demand-concurrent-builds-now-on-by-default"}},_={title:"Enhanced build machines",description:"Get even faster builds",isNew:!0,tooltip:{text:"Learn more in the Changelog",href:"/changelog/faster-builds-now-available-with-compute-upgrades-on-paid-plans"}},L=[S,C,P,{title:"Global CDN",description:"Cold start prevention and skew protection"},{title:"Observability tools",description:"Advanced monitoring and longer retention"},{title:"Advanced WAF protection",description:"Custom rules and rate limiting"},O,_,A,k],D=[S,A,k,O,_,E,C,P];function R(e){let{teamManager:i,switchToNewPro:a,isTeamMembersStep:r}=e;return(0,t.jsxs)("div",{className:(0,s.cn)("flex-1 bg-background-200 border-r-gray-alpha-400 border-t smd:border-r border-solid flex-col smd:min-w-[355px] xl:min-w-[400px] shrink-0 order-2 smd:order-1 p-1.5 smd:overflow-y-auto smd:overflow-x-hidden smd:overscroll-contain",{"hidden smd:flex":r,flex:!r}),children:[(0,t.jsx)("div",{className:"py-3 px-4",children:(0,t.jsx)("span",{className:"text-copy-14 font-medium",children:"What's included"})}),(0,t.jsx)("ul",{className:"flex flex-col border-b border-b-gray-alpha-400 mb-1 pb-1 [&>*:nth-child(odd)]:bg-gray-100",children:(a?D:L).map(e=>{let{title:r,description:s,isNew:c,tooltip:p}=e;return r===E.title?(0,t.jsx)(T,{teamManager:i},r):(0,t.jsxs)("li",{className:m,children:[(0,t.jsx)(d.Check,{color:"gray-1000"}),(0,t.jsxs)("span",{className:"flex flex-1 flex-col",children:[(0,t.jsxs)("span",{className:"text-label-14 flex items-center gap-2",children:[r,a&&c?(0,t.jsx)(l.Badge,{size:"sm",variant:"blue-subtle",children:"New"}):null]}),(0,t.jsxs)("span",{className:"text-label-14 text-gray-900",children:[s,a&&p?(0,t.jsxs)(t.Fragment,{children:[" ",(0,t.jsx)(n.Tooltip,{className:"inline",text:(0,t.jsx)(o.Link,{href:p.href,external:!0,className:"underline",children:p.text}),children:(0,t.jsx)(u.InformationFillSmall,{className:"inline-block -mt-0.5",color:"gray-900"})})]}):null]})]})]},r)})}),(0,t.jsx)("div",{className:"py-2 px-4",children:(0,t.jsxs)(o.Link,{className:"flex gap-3 items-center hover:underline",href:a?"/blog/new-pro-pricing-plan":"/docs/pricing",tab:!0,children:[(0,t.jsx)(c.ExternalSmall,{}),(0,t.jsx)("span",{className:"text-label-14",children:"Learn more about pricing"})]})})]})}var M=e.i(4004502),F=e.i(8735244);function B(){return(0,t.jsx)("div",{className:"flex flex-col items-center justify-center gap-4 flex-initial w-full max-h-full",children:(0,t.jsx)(F.Spinner,{})})}var U=e.i(9722978);function $(e){let{open:s=!0,children:l,isLoading:n,onClose:o,teamManager:d,sheetWrapperRef:c,switchToNewPro:u,isTeamMembersStep:m}=e;return(0,t.jsx)(i.Sheet,{open:s,onOpenChange:e=>{e||o()},children:(0,t.jsxs)(i.SheetContent,{"data-testid":(0,M.tid)("team","upgrade-modal"),className:(0,U.clsx)("m-3 h-[calc(100%-1.5rem)] w-[calc(100%-1.5rem)] overflow-hidden rounded-[1rem] bg-white p-0 lg:w-11/12 xl:w-5/6 xl:max-w-6xl sm:max-w-[auto]"),side:"right",ref:c,children:[(0,t.jsx)(i.SheetClose,{asChild:!0,children:(0,t.jsx)(a.Button,{className:"absolute top-4 right-4 z-50","aria-label":"Close",shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(r.Cross,{})})}),(0,t.jsxs)("div",{className:"flex flex-col h-full overflow-y-auto smd:overflow-y-visible overscroll-contain smd:flex-row",children:[(0,t.jsx)(R,{teamManager:d,switchToNewPro:u,isTeamMembersStep:m}),(0,t.jsx)("div",{className:"flex flex-[2] p-4 smd:overflow-x-hidden order-1 smd:order-2 smd:overscroll-contain smd:px-0 smd:pt-8 smd:pb-4",children:n?(0,t.jsx)(B,{}):l})]})]})})}e.s(["SheetWrapper",()=>$],7846892)},5022130,e=>{"use strict";var t=e.i(8711407),i=e.i(4585051),a=e.i(3306538);function r(e){let{isProTrial:r,upgradingTeam:s,children:l}=e;return(0,t.jsxs)("div",{className:"flex flex-col gap-6 items-center",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[s?.id?(0,t.jsx)(i.Avatar,{hash:s.avatar,size:24,teamId:s.id}):null,(0,t.jsxs)(a.Badge,{size:"md",variant:"blue",children:["Pro",r?" Trial":""]})]}),(0,t.jsx)("div",{className:"flex flex-col gap-2 items-center text-center text-balance",children:l})]})}e.s(["HeaderWrapper",()=>r])},7109637,e=>{"use strict";var t=e.i(2924439);function i(e){let{modalTitle:i,enableFunction:a,buildLineItem:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.pricingMenu;return{...{...s[e],modalTitle:i??`enable ${s[e].title}`},enableFunction:a,buildLineItem(t){let{alreadyEnabledAddOns:i,addOnToBeEnabled:a}=t;return"function"==typeof r?r(s[e],{alreadyEnabledAddOns:i,addOnToBeEnabled:a}):{...s[e],count:1}}}}e.s(["createAddOn",()=>i])},7005176,144654,1686498,7519760,9989491,7534379,e=>{"use strict";var t=e.i(7109637);let i=(0,t.createAddOn)("concurrentBuilds",{modalTitle:"enable Additional Concurrent Builds",buildLineItem(e,t){let{alreadyEnabledAddOns:i}=t;if(!i?.concurrentBuilds)return null;let a=i.concurrentBuilds;return{...e,title:`${a+1} Concurrent Build${a+1>1?"s":""}`,count:a,subLineItems:[...e.subLineItems??[],{title:`${a} Additional Concurrent Build${a>1?"s":""}`,price:e.price*a,unit:"month"}]}}});e.s(["concurrentBuilds",0,i],7005176);let a=(0,t.createAddOn)("firewallRateLimit",{modalTitle:"use Rate Limits",buildLineItem(e,t){let{addOnToBeEnabled:i}=t;return i?.type!=="firewallRateLimit"?null:{...e,title:"Rate Limit",subLineItems:[{title:"Rate Limit: Allowed Requests",price:5,unit:"10k"},{title:"Rate Limit: Blocked Requests",price:0}],count:0}}});e.s(["firewallRateLimit",0,a],144654);var r=e.i(8248823),s=e.i(277234),l=e.i(4244280);let n=async e=>{let{enable:t,teamId:i,hobbyFlow:a}=e;try{let e=await (0,s.fetchAPI)(`${l.API_STRIPE_MONITORING}?teamId=${encodeURIComponent(i)}`,{method:"PUT",body:JSON.stringify({monitoring:t,hobbyFlow:a}),throwOnHTTPError:!0});return{kind:"ok",...e}}catch(e){return{kind:"error",error:(0,r.normalizeError)(e)}}},o=(0,t.createAddOn)("monitoring",{modalTitle:"enable Monitoring",async enableFunction(e){let{team:t}=e;await n({enable:!0,teamId:t.id})}});e.s(["monitoring",0,o],1686498),e.i(5202960);var d=e.i(6880199);let c="observabilityPlus",u=(0,t.createAddOn)(c,{modalTitle:"Enable Observability",async enableFunction(e){let{team:t,source:i}=e;await (0,d.patchObservabilityConfiguration)({team:t,source:i,enableTeam:!0})},buildLineItem(e,t){let{addOnToBeEnabled:i}=t;return i?.type!==c?null:{...e,count:1,subLineItems:[{title:"On-demand events",billedAfter:"Billed after 1M events",price:120,batch:1e6,threshold:1e6,unit:"1M"}]}}});e.s(["observabilityPlus",0,u],7519760);let m=(0,t.createAddOn)("passwordProtection");e.s(["passwordProtection",0,m],9989491);let p=(0,t.createAddOn)("previewDeploymentSuffix",{buildLineItem(e,t){let{alreadyEnabledAddOns:i}=t;return i?.previewDeploymentSuffix?{...e,count:1,subLineItems:[{title:i.previewDeploymentSuffix,price:e.price,unit:"month"}]}:null}});e.s(["previewDeploymentSuffix",0,p],7534379)},9568520,e=>{"use strict";var t=e.i(2793676),i=e.i(8042625),a=e.i(277234),r=e.i(7109637);let s="/api/v1/speed-insights",l=(0,r.createAddOn)("speedInsights",{async enableFunction(e){let{projectId:t,team:r}=e;t&&await (0,a.fetchAPI)(`${s}/toggle${(0,i.encode)({projectId:t,teamId:r.id})}`,{method:"POST",body:{value:!0},throwOnHTTPError:!0})},buildLineItem(e,i){let{alreadyEnabledAddOns:a,addOnToBeEnabled:r}=i;if(a?.speedInsights&&a.speedInsights.length>0||r?.type==="speedInsights"){let i=a?.speedInsights?.map(e=>e.name)??[];r?.type==="speedInsights"&&i.push(r.additionalConfigurations.projectName);let s=i.map(i=>({...(0,t.default)(e,["modalTitle","subLineItems"]),title:i??"",price:e.price,unit:e.unit}));return{...e,price:e.price*i.length,subLineItems:s.concat(e.subLineItems??[]),count:i.length}}return null}});e.s(["API_SPEED_INSIGHTS_PREFIX",0,s,"speedInsights",0,l])},1480217,2471796,e=>{"use strict";var t=e.i(7005176),i=e.i(144654),a=e.i(1686498),r=e.i(7519760),s=e.i(9989491),l=e.i(7534379),n=e.i(9568520),o=e.i(8482433),d=e.i(3798983),c=e.i(7109637);let u=(0,c.createAddOn)("storage",{modalTitle:"get more storage",buildLineItem(e,t){let{addOnToBeEnabled:i}=t;if(i?.type!=="storage")return null;let a=d.storeTitle[i.additionalConfigurations.storeType],r=(0,o.default)(d.storeOrDatabase[i.additionalConfigurations.storeType]);return{...e,title:`5 ${a} ${r}s`,count:1}}});e.i(1307729);var m=e.i(7416719);let p=(0,c.createAddOn)("webAnalytics",{modalTitle:"enable Web Analytics",enableFunction:m.enableWebAnalytics}),g=(0,c.createAddOn)("webAnalyticsPlus",{modalTitle:"add Web Analytics Plus",enableFunction(e){let{team:t,projectId:i,source:a}=e;return i?(0,m.enableWebAnalytics)({team:t,projectId:i,withPlus:!0}):(0,m.enableWebAnalyticsPlusAddOn)({teamId:t.id,source:a})}}),x={speedInsights:n.speedInsights,concurrentBuilds:t.concurrentBuilds,previewDeploymentSuffix:l.previewDeploymentSuffix,monitoring:a.monitoring,observabilityPlus:r.observabilityPlus,passwordProtection:s.passwordProtection,storage:u,webAnalytics:p,webAnalyticsPlus:g,firewallRateLimit:i.firewallRateLimit};e.s(["ADD_ONS",0,x],2471796);let f=Object.keys(x);function h(e){let{alreadyEnabledAddOns:t,addOnToBeEnabled:i}=e;if(!t&&!i)return[];let a=[];for(let e of f)if(t&&t[e]||i?.type===e){let r=x[e];if("function"==typeof r.buildLineItem){let e=r.buildLineItem({alreadyEnabledAddOns:t,addOnToBeEnabled:i});e&&a.push(e)}else a.push({...r,count:1})}return a}e.s(["generateAddOnLineItems",()=>h],1480217)},8378310,e=>{"use strict";var t=e.i(8711407),i=e.i(5022130);e.i(1480217);var a=e.i(2471796);function r(e){let{teamManager:r,addOn:s,switchToNewPro:l,isProTrial:n}=e,o="upgrade-existing"===r.userIntent?r.team:void 0;if(l)return(0,t.jsx)(i.HeaderWrapper,{upgradingTeam:o,isProTrial:n,children:(0,t.jsxs)("h1",{className:"text-label-20 font-medium",children:["Switch"," ",(0,t.jsx)("b",{className:"font-semibold",children:"upgrade-existing"===r.userIntent?r.team.name:""})," ","to the new Pro plan"]})});let d=s?` and ${a.ADD_ONS[s.type].modalTitle}`:"";return(0,t.jsxs)(i.HeaderWrapper,{upgradingTeam:o,isProTrial:n,children:["upgrade-existing"===r.userIntent?(0,t.jsxs)("h1",{className:"text-label-20 font-medium",children:["Upgrade ",(0,t.jsx)("b",{className:"font-semibold",children:r.team.name})," to Pro",n?" Trial":"",d]}):(0,t.jsxs)("h1",{className:"text-label-20 font-medium",children:["Create"," ",r.teamName?(0,t.jsx)("b",{className:"font-semibold",children:r.teamName}):"a team",d]}),(0,t.jsx)("p",{className:"text-copy-16",children:"Unlock collaboration and improved performance."})]})}e.s(["DefaultTitle",()=>r])},2401140,2514109,e=>{"use strict";var t=e.i(8711407),i=e.i(4004502),a=e.i(1176592),r=e.i(2504781),s=e.i(6143247);function l(e){let{children:i,onSubmit:a}=e,r="w-full max-h-full";return a?(0,t.jsx)("form",{className:r,onSubmit:a,children:i}):(0,t.jsx)("div",{className:r,children:i})}function n(e){let{title:n,subtitle:o,defaultCancelText:d,defaultContinueText:c,cancelButton:u,continueButton:m,loading:p=!1,onCancel:g,onContinue:x,children:f,contained:h,hideFooter:b,onSubmit:y,hideCancelButton:w}=e,{sentinelRef:v,isAtBottom:j}=function(){let[e,t]=(0,a.useState)(!1),i=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=i.current;if(!e)return;let a=new IntersectionObserver(e=>{let[i]=e;return t(i.isIntersecting)},{threshold:1});return a.observe(e),()=>a.disconnect()},[]),{sentinelRef:i,isAtBottom:e}}();return(0,t.jsx)(l,{onSubmit:y,children:(0,t.jsxs)("div",{className:"flex flex-col smd:block smd:max-h-full smd:relative",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col gap-6 items-center smd:overflow-y-auto smd:px-6",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,t.jsx)("span",{className:"text-label-20 w-fit font-medium",children:n}),o?(0,t.jsx)("span",{className:"text-copy-16 w-fit",children:o}):null]}),(0,t.jsx)("div",{className:h?"bg-background-200 p-4 w-full rounded-sm border border-solid border-gray-alpha-400":"w-full",children:f})]}),(0,t.jsx)("div",{ref:v,className:"hidden smd:block smd:relative smd:top-16 w-full h-[1px]"}),(0,t.jsxs)("div",{className:(0,s.cn)("flex flex-col gap-3 w-full shrink-0 pt-6 smd:sticky smd:-bottom-4 smd:pb-4 smd:w-[calc(100%-theme(spacing.12))] smd:inset-x-6 smd:bg-gradient-to-b smd:from-transparent smd:via-background-100 smd:to-background-100 smd:via-10% sm:pt-8 smd:transition-all smd:duration-150 smd:ease-in-out smd:delay-150",{"smd:opacity-0":b,"smd:opacity-100":!b}),children:[(0,t.jsx)(r.Button,{typeName:x?"button":"submit","data-testid":(0,i.tid)("upgrade-modal","save-button"),disabled:b||m?.disabled,loading:p,...x?{onClick:x}:{},children:m?.text??c}),w?null:(0,t.jsx)("div",{className:(0,s.cn)("flex flex-col w-full smd:grid smd:transition-all smd:duration-150 smd:ease-in-out",{"smd:grid-rows-[1fr] smd:opacity-100":j,"smd:grid-rows-[0fr] smd:opacity-0":!j}),children:(0,t.jsx)("div",{className:"flex flex-col w-full overflow-hidden",children:(0,t.jsx)(r.Button,{disabled:b||u?.disabled,onClick:()=>void g(),type:"tertiary",children:u?.text??d})})})]})]})})}e.s(["SheetStepWrapper",()=>n],2401140);let o=new Set(["VIEWER","BILLING","VIEWER_FOR_PLUS"]);e.s(["nonBillableRoles",0,o],2514109)},5342497,6969789,9239043,5450654,4907256,e=>{"use strict";var t=e.i(1480217),i=e.i(2514109),a=e.i(2924439);function r(e){let{user:r,existingTeamMembers:s=[],newTeamMembers:l,paidAddOns:n,addOnToBeEnabled:o}=e,d=[...s,...l.filter(e=>e.email.length>0)],c=d.length,u=1+d.filter(e=>i.nonBillableRoles.has(e.role)).length,m=d.map(e=>({title:e.email,price:i.nonBillableRoles.has(e.role)||e.uid===r.uid?0:a.pricingMenu.teamSeats.price,unit:"month",member:{role:e.role,isYourself:e.uid===r.uid,avatar:e.avatar,uid:e.uid}})),p={title:c>1?`${c} members`:"1 member",count:c,freeCount:u,price:a.pricingMenu.teamSeats.price,subLineItems:m,isMembersLineItem:!0},g=[{title:"Pro",price:a.pricingMenu.pro.price,count:1,creditTotal:a.pricingMenu.pro.credit},p];if(n||o){let e=(0,t.generateAddOnLineItems)({alreadyEnabledAddOns:n,addOnToBeEnabled:o});g.push(...e)}return g}function s(e){return e.reduce((e,t)=>{let{count:i,freeCount:a=0,price:r=0}=t;return e+(i-a)*r},0)}e.s(["generatePricingDataPlus",()=>r],5342497),e.s(["grandTotalFromPricingData",()=>s],6969789);var l=e.i(8711407),n=e.i(1176592),o=e.i(2753950),d=e.i(4788623),c=e.i(6143247),u=e.i(3306538),m=e.i(4585051),p=e.i(2466450),g=e.i(1235157);function x(e){let{role:t}=e;return(0,l.jsx)(u.Badge,{variant:"gray-subtle",size:"sm",children:(0,g.getRoleName)(t)})}function f(e){let{title:t,member:i,price:a,unit:r,currency:s="usd"}=e,n=r&&"month"!==r;return(0,l.jsxs)("div",{className:"flex items-center gap-2 py-2",children:[(0,l.jsxs)("div",{className:"flex-1 min-w-0 text-left flex gap-1 items-center",children:[i?(0,l.jsx)(m.Avatar,{size:20,hash:i.avatar,uid:i.uid}):null,(0,l.jsx)("span",{className:"text-label-14 truncate",children:t}),i?.isYourself?(0,l.jsx)("span",{className:"text-label-14",children:" (You)"}):null,i?(0,l.jsx)(x,{role:i.role}):null]}),(0,l.jsx)("div",{className:(0,c.cn)("text-right flex-shrink-0",{"w-16":!n,"w-24":n}),children:(0,l.jsxs)("span",{className:"text-label-14 text-gray-900",children:[function(e){let{price:t,isYourself:i,currency:a}=e;return 0===t?i?"Included":"Free":(0,p.formatCurrency)(t??0,a)}({price:a,isYourself:i?.isYourself,currency:s}),n?` per ${r}`:""]})})]})}function h(e){let{title:t,price:i,currency:a="usd",isMembersLineItem:r}=e;return(0,l.jsxs)("div",{className:"flex items-center gap-2 py-3 border-b border-gray-alpha-400",children:[(0,l.jsx)("div",{className:"flex-1 text-left flex gap-1 items-center",children:(0,l.jsx)("span",{className:"text-label-14",children:t})}),(0,l.jsx)("div",{className:"text-right flex-shrink-0 w-16",children:(0,l.jsx)("span",{className:"text-label-14 text-gray-900",children:function(e){let{price:t,isMembersLineItem:i,currency:a}=e;return 0===t?i?"Included":"Free":(0,p.formatCurrency)(t??0,a)}({price:i,isMembersLineItem:r,currency:a})})})]})}var b=e.i(6352514),y=e.i(119294);function w(){return(0,l.jsxs)("header",{className:"flex text-gray-900 pb-2 gap-2 border-b border-gray-alpha-400",children:[(0,l.jsx)("span",{className:"text-label-13 flex-1 text-left",children:"Product"}),(0,l.jsx)("span",{className:"text-label-13 text-right flex-shrink-0 w-16",children:"Cost"})]})}function v(e){let{items:t,source:i,currency:a}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(w,{}),(0,l.jsx)(d.CollapseGroup,{className:"border-none",children:t.map(e=>(0,l.jsx)(n.Fragment,{children:Array.isArray(e.subLineItems)&&e.subLineItems.length>0?(0,l.jsxs)(o.Collapse,{size:"xs",className:"[&_button>span:first-child]:py-3 [&_button>span]:font-normal [&_button>span:last-child]:py-3",onToggle:t=>{var a;return a=e.title,void(t?y.analytics.track(b.AnalyticsEvent.UPGRADE_MODAL_COLLAPSE_LINE_ITEM,{source:i,lineItem:a}):y.analytics.track(b.AnalyticsEvent.UPGRADE_MODAL_EXPAND_LINE_ITEM,{source:i,lineItem:a}))},title:e.title,titleSuffix:(0,l.jsx)("span",{className:"flex items-center gap-2",children:(0,l.jsx)("span",{className:"text-right flex-shrink-0 w-16",children:(0,l.jsx)("span",{className:"text-label-14 text-gray-900",children:(0,p.formatCurrency)((e.price??0)*(e.count-(e.freeCount??0)),a)})})}),children:[e.subLineItems.map(e=>(0,n.createElement)(f,{...e,currency:a,key:e.title})),e.isMembersLineItem?(0,l.jsx)("div",{className:"flex items-center gap-2 py-2 mb-2",children:(0,l.jsx)("span",{className:"text-copy-14 text-gray-900",children:"You can invite more members to your team in the next step."})}):null]}):(0,l.jsx)(h,{...e,currency:a,title:e.title})},e.title))})]})}function j(e){let{grandTotal:t,items:i=[],currency:a,source:r}=e;return(0,l.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,l.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,l.jsx)(v,{items:i,source:r,currency:a})}),(0,l.jsxs)("div",{className:"flex flex-row items-stretch justify-between flex-initial",children:[(0,l.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Total"}),(0,l.jsxs)("p",{className:"text-[14px] leading-[20px] font-medium",children:[t," / month"]})]})]})}e.s(["ItemizedReceipt",()=>j],9239043);var N=e.i(6347389),T=e.i(2988836),I=e.i(7807066),S=e.i(5468328),C=e.i(5255926),P=e.i(2504781);function A(e){let{creditText:t,showSkeleton:i,proratedCredit:a,currency:r,isProTrialAndRequirePayment:s}=e,[o,d]=(0,n.useState)(!1),u=i?(0,l.jsx)(C.Skeleton,{width:16,height:16}):void 0,m=(0,l.jsxs)("div",{className:(0,c.cn)("w-full flex border border-gray-alpha-400 py-3 px-4 rounded flex-col gap-3",{"cursor-pointer":a,"mb-4":!a}),children:[(0,l.jsxs)("div",{className:"flex w-full gap-4 justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex gap-4 flex-1 items-center",children:[u??(a?(0,l.jsx)(I.ChevronRight,{className:(0,c.cn)("transition-transform duration-100",{"rotate-90":o})}):(0,l.jsx)(N.Coins,{color:"blue-900"})),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("span",{className:"text-label-14 font-medium",children:[s?"Trial":"Included"," credit"]})," ",(0,l.jsx)(S.Tooltip,{className:"inline",text:s?"Pro Trial includes a $20 credit":"Monthly credit toward metered resources expires at the end of each billing cycle",children:(0,l.jsx)(T.InformationFillSmall,{className:"inline-block -mt-0.5",color:"gray-900"})})]})]}),i?(0,l.jsx)("span",{className:"inline-flex mt-1",children:(0,l.jsx)(C.Skeleton,{width:30,height:16})}):(0,l.jsx)("span",{className:"text-label-14 font-medium text-blue-900",children:t})]}),o&&a?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"w-full h-px bg-gray-alpha-400"}),(0,l.jsxs)("div",{className:"flex justify-between items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex gap-4 flex-1 items-center min-w-0",children:[(0,l.jsx)(N.Coins,{color:"blue-900"}),(0,l.jsx)("span",{className:"text-label-14 font-medium min-w-0 text-wrap",children:"Prorated included credit for the current cycle"})]}),(0,l.jsx)("span",{className:"text-label-14 font-medium text-blue-900",children:(0,p.formatCurrency)(a,r,"auto",100)})]})]}):null]});return a?(0,l.jsx)(P.Button,{onClick:()=>{d(!o)},className:"w-full [&>span]:w-full [&>span]:px-0 text-left mb-4 flex",typeName:"button",variant:"unstyled",children:m}):m}e.s(["CreditsCallout",()=>A],5450654);var k=e.i(8522580);function E(e){let{switchPreviewData:t,currency:i}=e,a=(0,n.useMemo)(()=>{let e=Math.round(100*(t.unsettledItems||[]).reduce((e,t)=>e+t.approximateCost,0))/100;return(0,p.formatCurrency)(e,i,"auto",100)},[t,i,100]);return(0,l.jsxs)("div",{children:[(0,l.jsxs)("header",{className:"flex text-gray-900 pb-2 gap-2 border-b border-gray-alpha-400",children:[(0,l.jsx)("span",{className:"text-label-13 flex-1 text-left",children:"Product"}),(0,l.jsx)("span",{className:"text-label-13 text-right flex-shrink-0 w-16",children:"Cost"})]}),(t.unsettledItems||[]).map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2 py-2  border-b border-gray-alpha-400",children:[(0,l.jsx)("span",{className:"text-label-14",children:"on-demand"===e.kind?"On-Demand Charges":`${`${e.quantity} `||""}New Team Member${(e?.quantity||0)>1?"s":""}`}),(0,l.jsx)("span",{className:"text-label-14 text-gray-900 text-right",children:(0,p.formatCurrency)(Math.round(100*e.approximateCost)/100,i,"auto",100)})]},e.kind)),(0,l.jsxs)("footer",{className:"flex py-2 gap-2 mb-5",children:[(0,l.jsx)("span",{className:"text-label-14 font-medium flex-1 text-left",children:"Due Today"}),(0,l.jsx)("span",{className:"text-label-14 font-medium text-right",children:a})]}),(0,l.jsx)(k.Note,{fill:!0,type:"secondary",children:"On-demand usage or team seats were added this cycle and must be settled to continue. An invoice will be issued after confirmation, and the final amount may differ slightly. Your billing cycle stays the same, with credits prorated for the remaining days."})]})}e.s(["SwitchPreviewTable",()=>E],4907256)},415788,e=>{"use strict";var t=e.i(1176592);let i=(0,t.createContext)(null);i.displayName="UpgradeModalContext",e.s(["UpgradeModalContext",0,i,"useUpgradeModalContext",0,()=>(0,t.useContext)(i)])},4736806,1450448,5786585,e=>{"use strict";var t=e.i(8711407),i=e.i(1176592),a=e.i(9957872),r=e.i(8522580),s=e.i(609109),l=e.i(2466450),n=e.i(5342497),o=e.i(6969789),d=e.i(9239043),c=e.i(6143247),u=e.i(5450654),m=e.i(4907256),p=e.i(8161149),g=e.i(2504781),x=e.i(57106),f=e.i(6401841),h=e.i(415788);function b(){let{close:e}=(0,h.useUpgradeModalContext)();return(0,t.jsx)(p.EmptyState.Root,{className:"border-none bg-transparent px-4 py-12",description:(0,t.jsxs)(t.Fragment,{children:["Please try again and"," ",(0,t.jsx)(x.Link,{variant:"highlight",href:"/help",tab:!0,children:"contact us"})," ","if the error persists."]}),icon:(0,t.jsx)(p.EmptyState.Icon,{icon:(0,t.jsx)(f.Stop,{size:32})}),title:"Something went wrong",children:(0,t.jsx)(g.Button,{typeName:"button",onClick:e,children:"Close"})})}function y(e){let{user:p,newTeamMembers:g,existingTeamMembers:x,paidAddOns:f,currency:h,trialEnd:y,setGrandTotal:w,upgrade:v,children:j,addOnToBeEnabled:N,source:T,skeleton:I,switchToNewPro:S,switchPreviewData:C,continueButtonText:P,isProTrialAndRequirePayment:A}=e,k=(0,i.useMemo)(()=>(0,n.generatePricingDataPlus)({newTeamMembers:g,existingTeamMembers:x,paidAddOns:f,addOnToBeEnabled:N,user:p}),[g,x,f,N,p]),E=(0,i.useMemo)(()=>(0,o.grandTotalFromPricingData)(k),[k]),O=(0,l.formatCurrency)(E,h),_=(0,i.useMemo)(()=>{if(C)return C.monthlyCredit?(0,l.formatCurrency)(C.monthlyCredit,h,"auto",100):"";let e=k.reduce((e,t)=>e+(t.creditTotal?t.creditTotal:0),0);return e>0?(0,l.formatCurrency)(e,h):""},[k,h,C]);(0,i.useEffect)(()=>{w?.(E)},[E,w]);let L=y&&!v?.forceImmediateUpgrade&&v?.selectedOption==="later"?`on ${(0,s.formatDate)(y,{dateStyle:"long"})}`:"immediately",D=S&&!C&&!I;return(0,t.jsxs)(t.Fragment,{children:[_&&!D?(0,t.jsx)(u.CreditsCallout,{creditText:_,showSkeleton:I,proratedCredit:C?.proratedCredit,currency:h,isProTrialAndRequirePayment:A}):null,(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:(0,t.jsxs)("div",{className:(0,c.cn)("flex flex-col gap-6 relative",{"min-h-screen overflow-hidden":I}),children:[I?(0,t.jsx)("div",{className:"flex flex-col",children:(0,t.jsx)("div",{className:"z-10 absolute top-0 -left-8 h-[calc(100%+32px)] w-[calc(100%+64px)] bg-gradient-to-b from-[hsla(var(--ds-background-200-value),0)_0px] to-[hsla(var(--ds-background-200-value),1)_92px]"})}):null,S&&C?.everythingSettled?(0,t.jsx)(r.Note,{fill:!0,type:"secondary",children:"Your billing cycle stays the same, and included usage will be prorated for the remaining days."}):(0,t.jsx)("div",{className:(0,c.cn)("flex flex-col gap-6",{"max-h-0 overflow-hidden":I}),children:S?C?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.SwitchPreviewTable,{switchPreviewData:C,currency:h}),j]}):(0,t.jsx)(b,{}):(0,t.jsxs)(t.Fragment,{children:[j,v&&y&&!v.forceImmediateUpgrade?(0,t.jsxs)(a.ChoiceboxGroup,{direction:"column",label:"When would you like to upgrade?",onChange:e=>v.setSelectedOption(e),type:"radio",value:v.selectedOption,children:[(0,t.jsx)(a.ChoiceboxGroup.Item,{title:"Upgrade immediately",value:"now"}),(0,t.jsx)(a.ChoiceboxGroup.Item,{title:"Upgrade at end of trial",value:"later"})]}):null,(0,t.jsx)("div",{className:"text-label-14 text-gray-900",children:A?(0,t.jsx)(t.Fragment,{children:"Continuing will start a free Pro trial. You will be charged in 14 days or once the included credit is used, whichever happens first. Cancel at any time."}):(0,t.jsxs)(t.Fragment,{children:["Upon clicking"," ",(0,t.jsx)("span",{className:"font-medium text-gray-1000",children:P||"Confirm"}),", you will be charged ",O,", plus any applicable taxes and fees, ",L," and then every month, until you cancel."]})}),(0,t.jsx)(d.ItemizedReceipt,{currency:h,grandTotal:O,items:k,source:T})]})})]})})]})}var w=e.i(3671642),v=e.i(5255926),j=e.i(4030453),N=e.i(9373142),T=e.i(9588822),I=e.i(8132352);function S(e){let{paymentMethodInfo:i,makeDefaultBillingAddress:a,onBillingFormReady:r,billingFormProps:s,isSubmitting:l,addressError:n,setUnparsedAddress:o,setTaxId:d,submissionError:c,scrollToRef:u}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"w-full",ref:u,children:["loading"===i.type?(0,t.jsx)(C,{}):null,"no-payment-method"===i.type?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial rounded-sm bg-background-200 p-4 border border-gray-alpha-400 border-solid",children:[(0,t.jsx)(T.BillingForm,{makeDefaultBillingAddress:a,breakLine:!0,onReady:r,captureTaxId:d,showTaxIdFieldIfNecessary:!0,...s}),a?null:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start flex-initial border-b border-gray-alpha-400",children:(0,t.jsx)("p",{className:"text-heading-14",children:"Team Billing Address"})}),(0,t.jsx)(I.FullBillingAddressForm,{captureAddress:o,captureTaxId:d,disabled:l||s.disabled,error:n})]})]}):null,"payment-method"===i.type?(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial rounded bg-background-100 p-3 border border-gray-alpha-400",children:[(0,t.jsx)(N.CreditCard,{}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[(0,t.jsxs)("p",{className:"text-heading-14",children:[i.cardBrand," ending in"," ",i.cardLast4]}),(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["exp. ",i.cardExpiry]}),i.userEmail?(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:i.userEmail}):null]})]}):null]}),c?(0,t.jsx)(j.Error,{children:c}):null]})}function C(){return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-1",children:(0,t.jsx)(w.Label,{value:"Card Number",children:(0,t.jsx)(v.Skeleton,{height:40,width:"100%"})})}),(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-5 flex-initial min-w-[calc(108px*2+var(--stack-gap))]",children:[(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-1",children:(0,t.jsx)(w.Label,{value:"Expires",children:(0,t.jsx)(v.Skeleton,{height:40,width:"100%"})})}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-1",children:(0,t.jsx)(w.Label,{value:"CVC",children:(0,t.jsx)(v.Skeleton,{height:40,width:"100%"})})})]})]}),(0,t.jsx)("div",{className:"flex flex-row items-stretch justify-start flex-initial",style:{"--small-input-width":"108px"},children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-1",children:(0,t.jsx)(w.Label,{value:"Country",children:(0,t.jsx)(v.Skeleton,{height:40,width:"100%"})})})})]})}function P(e){let{user:i,team:a,teamManager:r,setCartTotal:s,members:l,source:n,showSkeleton:o,paymentMethodInfo:d,makeDefaultBillingAddress:c,onBillingFormReady:u,billingFormProps:m,isSubmitting:p,addressError:g,scrollToRef:x,continueButtonText:f,isProTrialAndRequirePayment:h,...b}=e;return(0,t.jsx)(y,{user:i,addOnToBeEnabled:"upgrade-modal"===b.type&&"upgrade-existing"===r.userIntent?b.addOn:void 0,currency:a?.billing?.currency??"USD",existingTeamMembers:"upgrade-existing"===r.userIntent?l?.members:void 0,newTeamMembers:"create"===r.userIntent?[{email:i.email,role:"OWNER",uid:i.uid,avatar:i.avatar}]:[],paidAddOns:"upgrade-modal"===b.type&&"upgrade-existing"===r.userIntent?b.paidAddOns:void 0,setGrandTotal:s,source:n,teamManager:r,trialEnd:a?.billing?.trial?.end,isProTrialAndRequirePayment:h,upgrade:"upgrade-modal"===b.type&&"upgrade-existing"===r.userIntent?{selectedOption:b.upgradeTimingOption,setSelectedOption:b.setUpgradeTimingOption,forceImmediateUpgrade:b.forceImmediateUpgrade}:void 0,skeleton:o,switchPreviewData:"upgrade-modal"===b.type?b.switchPreviewData:void 0,switchToNewPro:"upgrade-modal"===b.type?b.switchToNewPro:void 0,continueButtonText:f,children:(0,t.jsx)(S,{paymentMethodInfo:d,makeDefaultBillingAddress:c,onBillingFormReady:u,billingFormProps:m,isSubmitting:p,addressError:g,submissionError:"upgrade-modal"===b.type?b.asyncStepError?.message:b.submissionError,scrollToRef:x,setUnparsedAddress:"upgrade-modal"===b.type?void 0:b.setUnparsedAddress,setTaxId:"upgrade-modal"===b.type?void 0:b.setTaxId})})}e.s(["PaymentInfoShared",()=>P],4736806);var A=e.i(8587921),k=e.i(8753873),E=e.i(6222316),O=e.i(8248823),_=e.i(9365938);function L(e){let t,a,{teamManager:r,switchToNewPro:s}=e,l="upgrade-existing"===r.userIntent?r.team:void 0,{data:n}=(0,A.useMembersForTeam)(l),[o,d]=(0,i.useState)(0),[c,u]=(0,i.useState)(!1),{scrollToRef:m,formResultErrorCallback:p}=(t=(0,i.useRef)(null),a=(0,i.useCallback)(()=>{t.current&&t.current.scrollIntoView({behavior:"smooth"})},[]),{scrollToRef:t,formResultErrorCallback:a}),g=(0,k.usePaymentMethodInfo)(l?.id),{switchPreviewData:x,isLoadingSwitchPreview:f}=(0,E.useSwitchToNewProPreview)({teamId:l?.id,switchToNewPro:s}),{showSkeleton:h,onBillingFormReady:b}=function(e){let{paymentMethodInfo:t,isLoadingSwitchPreview:a,ignorePaymentLoading:r}=e,[s,l]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{"payment-method"===t.type&&(0,i.startTransition)(()=>{l(!1)})},[t.type]),{showSkeleton:r?!!a:s||"loading"===t.type||!!a,onBillingFormReady:(0,i.useCallback)(()=>{l(!1)},[])}}({paymentMethodInfo:g,isLoadingSwitchPreview:f,ignorePaymentLoading:x?.everythingSettled}),{submit:y,makeDefaultBillingAddress:w,elements:v,...j}=(0,T.useBillingForm)({formResultErrorCallback:p}),[N,I]=(0,i.useState)();return(0,i.useEffect)(()=>{if(j.error?.sendToSentry){let e=(0,O.normalizeError)(j.error).message,{additionalStripeErrorInfo:t}=j.error;(0,_.trackLifecycleError)({type:"upgrade-existing"===r.userIntent?"upgrade":"create",error:Error(`Billing form error: ${e}`),attributes:{teamId:l?.id,...t?{stripeErrorType:t.type??"unknown",stripeErrorCode:t.code??"unknown"}:{}}})}},[j.error,l?.id,r.userIntent]),{team:l,members:n,cartTotal:o,setCartTotal:d,isSubmitting:c,setIsSubmitting:u,scrollToRef:m,paymentMethodInfo:g,showSkeleton:h,onBillingFormReady:b,switchPreviewData:x,submit:y,makeDefaultBillingAddress:w,elements:v,billingFormProps:j,addressError:N,setAddressError:I,isLoadingSwitchPreview:f}}e.s(["usePaymentInfoStep",()=>L],1450448);var D=e.i(7525322);let R="payment-info";function M(e){let{paymentMethodInfo:t,setIsSubmitting:a,makeDefaultBillingAddress:r,setAddressError:s,elements:l,submit:n,teamManager:o,cartTotal:d,team:c,...u}=e;return(0,i.useCallback)(async e=>{try{let i;if("loading"===t.type)return;a(!0);let c="no-payment-method"!==t.type||r?void 0:"new-flow"===u.type?(0,D.validateAddress)(u.unparsedAddress):e?(0,D.validateAddressFormData)(e):void 0;if(c instanceof Error){s(c),a(!1);return}if(r&&"no-payment-method"===t.type){if(!l){s("Failed to save billing address."),a(!1);return}let e=await l.getElement("address")?.getValue(),t=e?.value.address;if(!t){s("Failed to save billing address."),a(!1);return}c={line1:t.line1,line2:t.line2??void 0,city:t.city,state:t.state,zipCode:t.postal_code,country:t.country.toLowerCase()}}if(s(void 0),"new-flow"===u.type&&u.taxId?.value)i=u.taxId;else if("upgrade-modal"===u.type&&e){let t=e.get("tax-id-type"),a=e.get("tax-id-value");"string"==typeof t&&"string"==typeof a&&a&&(i={type:t,value:a})}if("upgrade-modal"===u.type&&u.switchToNewPro){u.submissionQueue.enqueue({stepName:R,work:()=>u.immediatelySwitchToNewPro(),tracing:{name:"upgrade-modal-switch-to-new-pro",flowType:"switch-to-new-pro"}}),u.gotoNext();return}let m=await F({submit:n,teamManager:o,paymentMethodInfo:t});if(void 0===m)return;if(await t.revalidateSources(),"new-flow"===u.type)return void await u.continueAction.onContinue({paymentMethodId:m,address:c,taxId:i,cartTotal:d});if("upgrade-modal"===u.type){"create"===o.userIntent?u.submissionQueue.enqueue({stepName:R,work:()=>u.createTeam({paymentMethodId:m,address:c,taxId:i,cartTotal:d}),tracing:{name:"upgrade-modal-create-team",attributes:{paymentMethodId:m},flowType:"create"}}):u.submissionQueue.enqueue({stepName:R,work:()=>u.upgradeTeam({upgradeTimingOption:u.upgradeTimingOption,paymentMethodId:m,address:c,taxId:i,cartTotal:d,paidAddOns:u.paidAddOns}),tracing:{name:"upgrade-modal-upgrade-team",attributes:{paymentMethodId:m,teamId:o.team.id},flowType:"upgrade"}}),u.gotoNext();return}}catch(e){"new-flow"===u.type&&u.setSubmissionError((0,O.normalizeError)(e).message),(0,_.trackLifecycleError)({type:"upgrade-existing"===o.userIntent?"upgrade":"create",error:e,attributes:{teamId:c?.id}})}finally{a(!1)}},[t,a,r,s,l,n,o,d,c,u.type,u.taxId,u.unparsedAddress,u.continueAction,u.setSubmissionError,u.switchToNewPro,u.submissionQueue,u.gotoNext,u.createTeam,u.upgradeTeam,u.immediatelySwitchToNewPro,u.paidAddOns,u.upgradeTimingOption])}async function F(e){let{submit:t,paymentMethodInfo:i,teamManager:a}=e;return"payment-method"===i.type?i.paymentMethodId:"create"===a.userIntent?await t({assignCardToEntity:!1,shouldUseTeam:!1})??void 0:await t({assignCardToEntity:!0,shouldUseTeam:!0,teamId:a.team.id})??void 0}e.s(["usePaymentInfoContinue",()=>M],5786585)},4976875,3238154,8668551,e=>{"use strict";var t=e.i(1176592),i=e.i(1628687);function a(e){let{teamManager:a}=e,[r,s]=(0,t.useState)(void 0),l=(0,t.useCallback)(()=>{if("create"===a.userIntent)return(0,i.validateTeamName)(a.teamName)},[a]),n=(0,t.useCallback)(()=>{let e=l();e?s(e):s(void 0)},[l,s]);return{validationError:r,setValidationError:s,validate:l,onBlur:n}}e.s(["useTeamNameInput",()=>a],4976875);var r=e.i(8711407),s=e.i(3500331),l=e.i(4004502);function n(e){let{validationError:t,onBlur:i,teamManager:a,isNewProjectFlow:n,frozen:o}=e,d=n?(0,l.tid)("import-flow","select-plan","team-name-input"):(0,l.tid)("upgrade-modal","team-name");return(0,r.jsx)(r.Fragment,{children:"create"===a.userIntent?(0,r.jsx)(s.Input,{autoFocus:!0,"data-testid":d,disabled:o,error:t,id:n?"new-flow-upgrade-team-name":"upgrade-modal-team-name",label:"Team Name",maxLength:48,onBlur:i,onChange:e=>a.setTeamName(e.currentTarget.value),onFocus:e=>e.currentTarget.select(),value:a.teamName,width:"100%"}):null})}e.s(["TeamNameInput",()=>n],3238154);var o=e.i(9957872),d=e.i(4030453);function c(e){let{planSelector:t,frozen:i,errorMessage:a,className:s}=e,l=t.showSelector,n=!!a;return l||n?(0,r.jsxs)("div",{className:s,children:[l?(0,r.jsx)(u,{planSelector:t,frozen:i}):null,n?(0,r.jsx)(d.Error,{children:a}):null]}):null}function u(e){let{planSelector:t,frozen:i}=e;return(0,r.jsx)(o.ChoiceboxGroup,{direction:{sm:"column",md:"row"},disabled:i,label:"Select plan type",onChange:e=>{t.setSelectedPlan(e)},type:"radio",value:t.selectedPlan,children:t.validSelectorOptions.map(e=>(0,r.jsx)(o.ChoiceboxGroup.Item,{description:e.description,disabled:i,title:e.title,value:e.slug,"data-testid":(0,l.tid)("select-plan",e.slug),optionClassName:"flex-1",titleDescriptionClassName:"self-start"},e.slug))})}e.s(["SelectorSection",()=>c],8668551)},2762499,6924689,1347988,e=>{"use strict";var t=e.i(1176592),i=e.i(5858269),a=e.i(277234),r=e.i(4244280),s=e.i(2020034),l=e.i(2674895),n=e.i(1434448),o=e.i(4361526),d=e.i(119294),c=e.i(6352514),u=e.i(6232213);async function m(e,t){let{name:i,slug:s,source:l,paymentMethodId:n,pricingExperiment:o,enablePreviewFeedback:u,bypassTrial:m=!1,plan:g="pro",orgId:x,fixSlugConflict:f=!1,attribution:h}=e,b=await (0,a.fetchAPI)(r.API_TEAMS,{method:"POST",body:JSON.stringify({slug:s,source:l,name:i,stripePaymentMethodId:n,pricingExperiment:o,enablePreviewFeedback:u,bypassTrial:m,plan:g,orgId:x,fixSlugConflict:f,attribution:h}),throwOnHTTPError:t});return m&&n?d.analytics.track(c.AnalyticsEvent.PRO_TEAM_CREATED,{newTeamId:"id"in b?b.id:void 0,source:l}):!m&&n?"billing"in b&&b.billing?.status==="trialing"?(p(l),d.analytics.track(c.AnalyticsEvent.INTENT_TO_GO_PRO,{billingStatus:"trialing",source:l})):d.analytics.track(c.AnalyticsEvent.INTENT_TO_GO_PRO,{billingStatus:"canceled or expired trial",source:l}):"pro"===g&&p(l),b}function p(e){d.analytics.track(c.AnalyticsEvent.START_PRO_TRIAL,{source:e}),(0,u.postToStatsigClient)({events:[{eventName:"start_pro_trial",metadata:{source:e,action:"create-team"}}]})}e.i(1480217);var g=e.i(2471796),x=e.i(455575);function f(e){let{teamManager:d,onConversionStart:c,planSelector:u,mutate:p,addOn:f,progressContextRef:h,onConversionError:b,deferredToasts:y,router:w,projectId:v,addOnMutate:j,mutateEnabledRoles:N,mutateBudget:T,customCreateTeamApiSource:I,customPostCreationFlow:S}=e;return(0,t.useCallback)(async function(){let{address:e,paymentMethodId:t,taxId:C,cartTotal:P}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cartTotal:0};if("create"!==d.userIntent)throw Error("Attempted to create a team when the user wanted to upgrade an existing one.");c?.({type:"create",team:void 0});let{teamName:A}=d;if(!A)throw Error("Team name is required.");let k=!!t,E=(0,i.default)(A),{selectedPlan:O,desiredTrialBehavior:_,actualTrialBehavior:L}=u,D=function(){let e=(0,l.getSessionReferrer)()||void 0,{pathname:t,utm:i}=(0,n.getSessionLandingPage)()||{},a=new URLSearchParams(window.location.search).get("gclid");if(!a){let e=localStorage?.getItem("gclid");if(e){let{value:t,expiration:i}=JSON.parse(e);new Date(i)>new Date&&(a=t)}}return{sessionReferrer:e,landingPage:t,pageBeforeConversionPage:document.referrer,utm:{utmSource:i?.utm_source,utmMedium:i?.utm_medium,utmCampaign:i?.utm_campaign,utmTerm:i?.utm_term},...a&&{gclid:a}}}(),R=await m({name:A,slug:E,source:I||"upgrade-modal",plan:"hobby"===O?"hobby":"pro",...k?{paymentMethodId:t}:{},bypassTrial:"pro"===O,fixSlugConflict:!0,attribution:D});if("error"in R)throw b?.({type:"create"}),Error(R.error.message);let M=await (0,a.fetchAPI)(`${r.API_TEAMS_V2}/${R.id}`);if(await p(),e&&(0,o.saveBillingDetails)(M.id,e,C).then(p).catch(()=>{(y?.push||x.toasts.error)({type:"error",text:"There was a problem saving your billing address. Please visit billing settings to update it.",action:"Go to Settings",onAction:()=>{w.replace(`/${M.slug}/~/settings/billing#billing-address`)},cancelAction:"Dismiss",preserve:!0})}),f&&g.ADD_ONS[f.type].enableFunction)try{await g.ADD_ONS[f.type].enableFunction?.({team:M,projectId:v,..."additionalConfigurations"in f?f.additionalConfigurations:{}}),j?.({projectId:v,teamId:M.id})}catch(e){throw b?.({type:"create",team:M}),e}if(M.billing?.plan!=="hobby"){let e,t=(e=M.id,`new_team_survey_${e}`);(0,s.setCookie)(t,"1","1d")}T&&(window?.localStorage?.setItem("budgetPolling","true"),T()),h&&(h.current.conversionDetails={type:"create",team:M,priorPlan:"hobby",newPlan:O,desiredTrialBehavior:_,actualTrialBehavior:L,cartTotal:P,existingTeamMembers:0}),N?.(),S?.({team:M,cartTotal:P,selectedPlan:O})},[d,c,u,p,f,h,b,y,w,v,j,N,T,I,S])}e.s(["useCreateTeam",()=>f],2762499);var h=e.i(2771361),b=e.i(7469204),y=e.i(8042625);async function w(e){let{teamId:t}=e;return await (0,a.fetchAPI)(`${r.API_PLANS_SWITCH_TO_NEW_PRO}${(0,y.encode)({teamId:t,immediate:!0})}`,{method:"POST",headers:{"Content-Type":"application/json"},throwOnHTTPError:!0})}function v(e){let{teamManager:i,onConversionStart:s,planSelector:l,deferredToasts:n,addOn:d,progressContextRef:c,pendingInvitations:u,source:m,onConversionError:p,mutate:f,router:y,projectId:v,addOnMutate:j,mutateEnabledRoles:N,mutateBudget:T,customPostUpgradeFlow:I,awaitMutate:S}=e;return(0,t.useCallback)(async function(){let e,{upgradeTimingOption:t,address:C,taxId:P,cartTotal:A,paidAddOns:k}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cartTotal:0};if("upgrade-existing"!==i.userIntent)throw Error("Attempted to upgrade a team when the user wanted to create a new one.");let{team:E}=i;s?.({type:"upgrade-existing",team:E});let{selectedPlan:O,desiredTrialBehavior:_,actualTrialBehavior:L}=l;if(E.billing?.status==="trialing"&&"now"!==t);else try{E.billing?.status==="trialing"&&"plus"!==E.billing.planIteration?await w({teamId:E.id}):await (0,h.changePlan)({source:m,teamId:E.id,to:O})}catch(e){throw p?.({type:"upgrade-existing",team:E}),e}if(C&&(0,o.saveBillingDetails)(E.id,C,P).then(f).catch(()=>{(n?.push||x.toasts.error)({type:"error",text:"There was a problem saving your billing address. Please visit billing settings to update it.",action:"Go to Settings",onAction:()=>{y.replace(`/${E.slug}/~/settings/billing#billing-address`)},cancelAction:"Dismiss",preserve:!0})}),S?await f():(async()=>{let e=0;do await f(),await new Promise(e=>setTimeout(e,2e3)),e++;while(E.billing?.cancelation&&e<5)})().catch(console.error),await (0,b.revalidateBillingData)(E.slug),T&&(window?.localStorage?.setItem("budgetPolling","true"),T()),e="pro"===O&&"now"===t?"Your team has been upgraded to Pro":"pro"===O?"Your team will automatically upgrade to Pro at the end of your Trial":"Your Pro Trial has started, and will expire in 14 days",(n?.push||x.toasts.success)({type:"success",text:e}),d&&g.ADD_ONS[d.type].enableFunction)try{await g.ADD_ONS[d.type].enableFunction?.({team:E,projectId:v,..."additionalConfigurations"in d?d.additionalConfigurations:{}}),j?.({projectId:v,teamId:E.id}),(n?.push||x.toasts.success)({type:"success",text:`${g.ADD_ONS[d.type].title} successfully enabled.`})}catch(e){throw p?.({type:"upgrade-existing",team:E}),e}let D=await (0,a.fetchAPI)(`${r.API_TEAMS_V2}/${E.id}`);c&&(c.current.conversionDetails={type:"upgrade-existing",team:D,priorPlan:(E.billing?.plan==="pro"&&"trialing"===E.billing.status?"pro-trial":E.billing?.plan)??"hobby",newPlan:O,desiredTrialBehavior:_,actualTrialBehavior:L,cartTotal:A,existingTeamMembers:(u||0)+(E.billing?.invoiceItems?.teamSeats?.quantity??1)-1,paidAddOns:k?{speedInsights:k.speedInsights?.length||0,additionalConcurrentBuilds:k.concurrentBuilds??0,previewDeploymentSuffix:!!k.previewDeploymentSuffix,passwordProtection:!!k.passwordProtection,monitoring:!!k.monitoring}:void 0}),N?.(),I?.({team:E,selectedPlan:O,cartTotal:A})},[i,s,l,n,d,c,u,m,p,f,y,v,j,N,T,I,S])}e.s(["fetchSwitchToNewPro",()=>w],6924689),e.s(["useUpgradeTeam",()=>v],1347988)},1108230,e=>{"use strict";var t=e.i(6232213);function i(e){let i,{priorPlan:a,newPlan:r,type:s,source:l}=e;if("hobby"===a&&"pro-trial"===r)i="upgrade_modal_hobby_to_pro_trial_conversion";else if("hobby"===a&&"pro"===r)i="upgrade_modal_hobby_to_pro_conversion";else{if("pro-trial"!==a||"pro"!==r)return;i="upgrade_modal_pro_trial_to_pro_conversion"}(0,t.postToStatsigClient)({events:[{eventName:i,metadata:{type:s,source:l}}]})}e.s(["trackConversionOnStatsig",()=>i])},3889303,e=>{"use strict";var t=e.i(6232213);function i(e){let{proTrialRequirePaymentFlagVal:i,proTrialRequirePaymentFlagRule:a,metadata:r={}}=e;null!==i&&a&&(0,t.postToStatsigClient)({exposures:[{experimentName:"card-required-trial",ruleID:a}],events:[{eventName:"card-required-trial-exposure",metadata:r}]})}e.s(["proTrialRequirePaymentExposure",()=>i])}]);

//# debugId=8e01e78f-affc-e5f6-f477-c7f8c46c8d08
//# sourceMappingURL=3c71186334620ba1.js.map
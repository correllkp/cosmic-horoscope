;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="52507dd8-6386-56d3-19d6-14ece1e54d4d")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5598924,5442212,e=>{"use strict";var t=e.i(8711407),i=e.i(9338892),l=e.i(1176592),n=e.i(5255926),s=e.i(6881349),a=e.i(119294),r=e.i(6352514),o=e.i(1991452),c=e.i(1875382),d=e.i(9031150),u=e.i(935882);let m=()=>{let e=(0,c.useSearchParams)();return{isReady:(0,o.useRouter)().isReady,filterBranch:e?.get("filterBranch")||void 0}};function h(){let{project:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=m(),[i,n]=(0,l.useState)(t.filterBranch||null);(0,l.useEffect)(()=>{n(t.filterBranch||null)},[t.isReady,t.filterBranch]);let s=(0,o.useRouter)(),a=(0,l.useCallback)(e=>{(0,d.awaitPaint)().then(()=>{n(e),function(e,t){let{teamSlug:i,project:l,slug:n,...s}=e.query;t?s.filterBranch=t:delete s.filterBranch,e.replace({pathname:window.location.pathname,query:s},void 0,{shallow:!0,scroll:!1})}(s,e)})},[s]),r=i?{ref:i}:void 0,c=(0,l.useCallback)(()=>{i&&(n(null),a(null))},[i,a]),h=!e||!t.isReady,p=null!==i,[x,f]=(0,l.useState)(p);return(0,u.default)(()=>{f(p)},[f,h,p]),{showBranchFilterBar:x,filteredBranch:i,setFilteredBranch:a,clearBranch:c,gitSource:r}}e.s(["useProjectFilteredBranch",()=>h,"useRouterFilteredBranch",0,m],5442212);var p=e.i(1947138),x=e.i(7401972);function f(e){let{skeletonStyle:i}=e;return(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)(y,{skeletonStyle:i}),children:(0,t.jsx)(g,{...e})})}let g=(0,l.memo)(e=>{let{loading:n,skeleton:o,onSelect:c,project:d,value:h,includeProductionBranch:f,placeholder:g,skeletonStyle:j,comboboxSize:b,clearable:v}=e,[k,w]=(0,l.useState)(!1),[S,N]=(0,l.useState)(!1),[E,C,{currentValue:D,setValueImmediate:P}]=(0,p.useDebounceState)(h||"",300);(0,l.useEffect)(()=>{h&&P(h)},[P,h]);let[,{branches:A,isValidating:I,fetchedQuery:R}]=(0,x.useProjectDeployedBranches)({project:d,includeProductionBranch:f,query:E},{revalidateOnFocus:!1,revalidateIfStale:!1,revalidateOnReconnect:!1}),T=(R||"")!==E,M=!!S&&!!k&&!!D&&T,{filterBranch:L}=m();(0,l.useEffect)(()=>{L&&P(L)},[P,L]),(0,l.useEffect)(()=>{P(h||"")},[P,h]),(0,l.useEffect)(()=>{k||A&&!I&&w(!0)},[k,A,I]);let[B,O]=(0,l.useState)([]);(0,l.useEffect)(()=>{I||void 0===A||(0!==$.current.query.indexOf(D)&&($.current={values:[],query:D}),O(A||[]))},[JSON.stringify(A),R]);let $=(0,l.useRef)({values:[],query:""}),_=I||D.length>=E.length&&D.length>=1?$.current.values:[],F=[...new Set([..._,...M?B:A||[]])],U=(0,l.useRef)(null);return((0,u.default)(()=>{D&&U.current?.setValue(D)},[D]),(0,u.default)(()=>{h||U.current?.clear()},[h]),o&&!k)?(0,t.jsx)(y,{skeletonStyle:j}):(0,t.jsxs)(s.Combobox,{clearable:v,filter:function(e,t){let l=""===t?e:(0,i.matchSorter)(e,t,{keys:["value","label"]}),n=[];for(let e of _)l.find(t=>t.value===e)&&n.push(e);let s=[...new Set([...n,...l.map(e=>e.value)])],a=s.map(e=>{let t=l.find(t=>t.value===e);if(!t)throw Error("impossible state");return t});return $.current={values:s,query:D},a},loading:M||n,onChange:e=>{e===L?setTimeout(()=>{c?.(null),U.current?.clear(),P("")}):(a.analytics.track(r.AnalyticsEvent.DEPLOYMENT_OVERVIEW_FILTERS_BRANCH,{value:e}),P(e||""),c?.(e))},onChangeOpen:e=>{N(e)},placeholder:g||"All Branches…",ref:U,size:b,children:[(0,t.jsx)(s.Combobox.Input,{loading:M||n,onChange:e=>{""===e.target.value?P(""):C(e.target.value)}}),(0,t.jsx)(s.Combobox.List,{children:F.map((e,i)=>(0,t.jsx)(s.Combobox.Option,{value:e,children:e},D?e:`${e}${i}`))})]})});function y(e){let{skeletonStyle:i}=e;return(0,t.jsx)(n.Skeleton,{style:i||{height:40},width:"100%"})}e.s(["BranchSearchCombobox",()=>f],5598924)},2645806,e=>{"use strict";var t=e.i(8711407),i=e.i(1176592),l=e.i(2111701),n=e.i(6891161),s=e.i(455575),a=e.i(277234),r=e.i(4244280),o=e.i(4470704);let c=i.default.memo(e=>{let{active:c,onClose:d,deployment:u,teamId:m}=e,[h,p]=(0,i.useState)(!1),x=(0,s.useToasts)(),f=(0,i.useCallback)(async()=>{if(!u)return;p(!0);let e=m?"?teamId="+m:"",t=await (0,a.fetchAPI)(`${(0,r.API_DEPLOYMENTS)("v12")}/${u.id}/cancel`+e,{throwOnHTTPError:!1,method:"PATCH"});t.error&&x.error(`Could not cancel the deployment, it's ${u.readyState}`),"CANCELED"===t.readyState&&(x.success("The deployment has been successfully canceled."),(0,l.mutate)((0,o.getUrl)(u.id),{...u,readyState:t.readyState,status:t.readyState,canceledAt:t.canceledAt,host:u.url,isPrivate:!u.public})),p(!1),d()},[u,m,x,d]);return(0,t.jsxs)(n.Modal.Modal,{active:c,onClickOutside:d,width:"500px",children:[(0,t.jsxs)(n.Modal.Body,{children:[(0,t.jsx)(n.Modal.Header,{children:(0,t.jsx)(n.Modal.Title,{children:"Cancel Deployment"})}),(0,t.jsx)("p",{className:"text-copy-16",children:"Canceling this deployment will immediately stop the build, with no way to resume."}),(0,t.jsx)("p",{className:"text-copy-16",style:{margin:0},children:"Are you sure you want to continue?"})]}),(0,t.jsxs)(n.Modal.Actions,{children:[(0,t.jsx)(n.Modal.Action,{loading:!1,onClick:d,type:"secondary",children:"Close"}),(0,t.jsx)(n.Modal.Action,{disabled:h,loading:h,onClick:f,children:"Cancel deployment"})]})]})});e.s(["default",0,c])},5229375,e=>{"use strict";var t=e.i(1176592),i=e.i(7909933),l=e.i(3924999),n=e.i(818351),s=e.i(8042625),a=e.i(277234),r=e.i(4244280),o=e.i(5338940);function c(e,t){let{deploymentId:i,teamId:l}=e;return(0,n.useIsomorphicSWR)(i?function(e){let{deploymentId:t,teamId:i}=e;return`${(0,r.API_DEPLOYMENTS)("v2")}/${t}/aliases${(0,s.encode)({teamId:i})}`}({deploymentId:i,teamId:l}):null,t)}function d(e,t){return(0,i.default)(()=>{if(!e)return null;let{team:t,id:i,teamId:l}=e;return`${(0,r.API_DEPLOYMENTS)("v2")}/${i}/aliases${(0,s.encode)({teamId:l??(t?t.id:null)})}`},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),t)}function u(e,i){let{limit:n=20,domains:s,rollbackDeploymentId:c}=e,{isReady:d,team:u}=(0,o.useTeam)(),h=(0,l.default)((e,t)=>{if(!d)return null;let i=`${r.API_ALIASES}`,l=s?.map(e=>`domain=${encodeURIComponent(e)}`).join("&")||null;if(!e)return`${i}${m({limit:n+1,teamId:u?.id,rollbackDeploymentId:c},l)}`;let a=t?.aliases&&t.aliases.length>n?t.aliases[n-1].createdAt:null;return a?`${i}${m({limit:n+1,teamId:u?.id,until:a},l)}`:null},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),i),p=(0,t.useMemo)(()=>h.data?[].concat(...h.data.filter(Boolean).map(e=>e.aliases.slice(0,n))):[],[h.data,n]),x=!!h.data&&!h.error,f=!!(h.data&&0===p.length),g=!!(h.data&&h.size>h.data.length),y=!!(h.data&&h.data[h.data.length-1]?.aliases.length<=n);return[h,{aliases:p,initialDataLoaded:x,isEmpty:f,loadMore:()=>h.setSize(e=>e+1),isLoadingMore:g,isReachingEnd:y}]}function m(e,t){let i=(0,s.encode)(e,!1),l=t?`&${t}`:"";return i?`?${i}${l}`:`?${l}`}e.s(["useAliases",()=>d,"useAliasesInfinite",()=>u,"useAliasesV2",()=>c],5229375)},7018452,e=>{"use strict";var t=e.i(1176592);function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",[i,l]=(0,t.useState)(!1),n=window.location.hash,s=e.startsWith("#")?e:`#${e}`;return(0,t.useEffect)(()=>{let e=()=>{window.location.hash!==s||i||l(!0)};return window.addEventListener("hashchange",e),()=>{window.removeEventListener("hashchange",e)}},[i,s]),n!==s||i||(l(!0),window.history.replaceState(null,""," ")),n!==s&&i&&(window.location.hash=s),[i,l]}e.s(["default",()=>i])},9719784,e=>{"use strict";var t=e.i(8711407),i=e.i(1176592),l=e.i(57106),n=e.i(822157),s=e.i(7018452),a=e.i(2405448),r=e.i(542164),o=e.i(1681029),c=e.i(4478191);let d=(0,i.memo)(function(e){let{url:d,truncate:u,defaultRoute:m,...h}=e,[p,x]=(0,s.default)("#wildcard"),[f,g]=(0,i.useState)(null),[y,j]=(0,i.useState)(!1),b=(0,i.useCallback)(()=>{g((0,a.default)(d)),x(!0)},[g,x,d]);return d?(0,r.default)(d)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Link,{className:"pt-px leading-[16px] hover:underline",onClick:b,...h,onMouseEnter:()=>j(!0),style:{minWidth:0,maxWidth:u?"100%":void 0},children:u?(0,t.jsx)("span",{className:"geist-ellipsis",children:d}):d}),y||p?(0,t.jsx)(n.default,{active:p,onCancel:()=>{x(!1)},url:f}):null]}):(0,t.jsx)(l.Link,{className:"pt-px leading-[16px] hover:underline",external:!0,href:(0,c.withDefaultRoute)((0,o.domainToUrl)(d),m),...h,style:{minWidth:0,maxWidth:u?"100%":void 0},children:u?(0,t.jsx)("span",{className:"geist-ellipsis",children:d}):d}):null});e.s(["default",0,d])},9365163,4904548,e=>{"use strict";var t=e.i(8711407),i=e.i(1176592),l=e.i(5338940),n=e.i(1717203),s=e.i(7557283),a=e.i(4670733),r=e.i(588428),o=e.i(4396019),c=e.i(762945),d=e.i(7749291),u=e.i(8735244),m=e.i(2504781),h=e.i(6891161),p=e.i(455575),x=e.i(8522580),f=e.i(8761240),g=e.i(5756088),y=e.i(9386557),j=e.i(4004502),b=e.i(8042625),v=e.i(277234),k=e.i(4244280),w=e.i(5140444),S=e.i(5757634),N=e.i(5802506),E=e.i(6641571);e.i(9623499);var C=e.i(5576066),D=e.i(3924999),P=e.i(5229375);e.i(5394896);var A=e.i(9668517);let I="[teamSlug]";var R=e.i(6060673),T=e.i(930810),M=e.i(7952834),L=e.i(1173672),B=e.i(8227242),O=e.i(9745887),$=e.i(3306538),_=e.i(5468328),F=e.i(9719784);function U(e){let{hidden:i,showIcon:l=!0,linkProps:n,defaultRoute:s}=e;return(0,t.jsx)(t.Fragment,{children:i.map(e=>(0,t.jsx)("div",{children:(0,t.jsx)(F.default,{defaultRoute:s,icon:l,title:e,truncate:!0,url:e,...n})},e))})}function z(e){let{hidden:i,linkProps:l}=e;return(0,t.jsx)(_.Tooltip,{text:(0,t.jsx)(U,{hidden:i,linkProps:l}),children:(0,t.jsx)($.Badge,{size:"sm",variant:"gray-subtle",children:`+${i.length}`})})}let H=function(e){let{className:i,defaultRoute:l,domains:n,firstOnly:s,showIcon:a=!0,style:r,linkProps:o}=e;if(!n)return(0,t.jsx)("span",{className:`text-copy-14 text-gray-900 ${i}`,style:r,children:"-"});let{visible:c,hidden:d}=n.reduce((e,t)=>(0===e.visible.length||!s&&1===e.visible.length&&e.visible[0].length<=20?e.visible.push(t):e.hidden.push(t),e),{visible:[],hidden:[]});return(0,t.jsx)("span",{className:`text-[14px] leading-[20px] font-medium ${i}`,children:(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-initial max-w-full",style:{...r},children:[c.map((e,i)=>{let n=i===c.length-1;return(0,t.jsx)(F.default,{defaultRoute:l,icon:a,style:{marginRight:n?void 0:"var(--geist-gap-half)",minWidth:0},truncate:!0,url:e,...o},e)}),d.length?(0,t.jsx)(z,{hidden:d,linkProps:o}):null]})})};e.s(["default",0,H],4904548);var G=e.i(8651268),W=e.i(2547843);function q(){return(0,t.jsx)(h.Modal.Header,{children:(0,t.jsx)(h.Modal.Title,{center:!0,children:"Instant Rollback"})})}function V(e){let{setStage:i}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.Modal.Body,{children:[(0,t.jsx)(q,{}),(0,t.jsx)("p",{className:"text-copy-14",style:{marginBottom:"24px"},children:"Error: You must select a deployment to roll back."})]}),(0,t.jsx)(h.Modal.Actions,{children:(0,t.jsx)(h.Modal.Action,{fullWidth:!0,onClick:()=>{i("initial")},type:"secondary",children:"Back"})})]})}function Y(){return(0,t.jsx)("div",{children:(0,t.jsx)(x.Note,{className:"bg-yellow-50 border-yellow-300 border text-amber-700",fill:!0,label:!1,type:"warning",variant:"contrast",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-4 flex-initial",style:{padding:4},children:[(0,t.jsx)(c.Warning,{style:{flexShrink:0}}),(0,t.jsxs)("div",{className:"flex flex-col items-start justify-start flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14 text-inherit",children:"Make sure the domains listed above are correct."}),(0,t.jsx)("p",{className:"text-copy-14 text-inherit",children:"This deployment has custom aliases not included in the project's domain settings."})]})]})})})}function K(e){var n;let s,{hasFloatingAliases:o,onCancel:c,previousDeployment:u,productionAliases:p,productionDeployment:f,project:y,rollbackCandidates:b,setStage:v,selectedDeployment:k,setSelectedDeployment:w,deploymentSwr:S,rollbackReason:N,setRollbackReason:E}=e,D=(n="/[teamSlug]",s=(0,A.useTeamSlug)(),(0,i.useMemo)(()=>n.includes(I)?n.replace(`/${I}`,s?`/${s}`:""):n,[s,n])),[P,R]=(0,i.useState)(!1),{team:M}=(0,l.useTeam)(),L=!M||M.billing?.plan==="hobby",{value:B}=(0,a.useInstantRollbackHobbyRestrictionFlag)(),{value:$}=(0,r.useInstantRollbackHobbyRestrictionTeamFlag)();return b.length&&u&&k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.Modal.Body,{children:[(0,t.jsx)(q,{}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-16",children:["Rolling back"," ",(0,t.jsx)(H,{domains:p,firstOnly:!0,style:{display:"inline-flex",fontWeight:"500"}})]}),o?(0,t.jsx)(Y,{}):null,(0,t.jsx)("div",{children:(0,t.jsx)(O.DeploymentCardSmall,{deployment:f,isProductionDeployment:!0,selectedDeployment:k,setSelectedDeployment:w})})]}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-16",children:"To the following deployment:"}),P?(0,t.jsx)("div",{children:(0,t.jsx)(T.ChooseDeploymentList,{deployments:b,previousDeployment:u,productionDeployment:f,rolledBackDeploymentId:y?.lastAliasRequest?.type==="rollback"?y.lastAliasRequest.fromDeploymentId:void 0,selectedDeployment:k,setSelectedDeployment:w,swr:S})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:(0,t.jsx)(O.DeploymentCardSmall,{deployment:k,isForm:P,isPreviousDeployment:k.uid===u.uid,selectedDeployment:k,setSelectedDeployment:w})}),(B||$)&&L?(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial mt-6",children:(0,t.jsx)(x.Note,{className:"bg-blue-50 border border-blue-500 text-blue-600",fill:!0,label:!1,size:"small",variant:"contrast",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-4 flex-initial p-2",children:[(0,t.jsx)(g.LockClosed,{style:{transform:"translateX(1px)"}}),(0,t.jsxs)("div",{className:"flex flex-col items-start justify-start flex-initial",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"Looking for an earlier deployment?"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(C.Link,{className:"inline-flex items-center justify-center gap-1 text-current no-underline",href:"/"===D?"/dashboard?createTeam=instant-rollback":`${D}?upgradeTeam=instant-rollback`,target:"_blank",children:(0,t.jsx)("span",{className:"text-copy-14 text-inherit",children:"Upgrade to Pro"})}),(0,t.jsx)(d.ExternalSmall,{className:"ml-1"}),(0,t.jsx)("span",{className:"text-copy-14 text-inherit",style:{whiteSpace:"nowrap"},children:"to roll back to an earlier deployment"})]})]})]})})}):(0,t.jsx)(m.Button,{onClick:()=>{R(!0)},type:"secondary",width:"100%",size:"small",children:"Choose another deployment"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("label",{htmlFor:"rollback-reason",className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:(0,t.jsx)("span",{className:"text-copy-16",children:"Share a reason for this rollback:"})}),(0,t.jsx)(T.RollbackDescriptionTextarea,{value:N,onChange:E,id:"rollback-reason"})]})]})]}),(0,t.jsxs)(h.Modal.Actions,{children:[(0,t.jsx)(h.Modal.Action,{onClick:c,type:"secondary",children:"Cancel"}),(0,t.jsx)(h.Modal.Action,{"data-testid":(0,j.tid)("deployment","rollback-modal","continue-button"),disabled:N.length>=T.REASON_MAX_CHARACTER_LENGTH,onClick:()=>{v("selected")},children:"Continue"})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.Modal.Body,{children:[(0,t.jsx)(q,{}),(0,t.jsx)("p",{className:"text-copy-14",children:"This project does not have any valid deployments to roll back to."})]}),(0,t.jsx)(h.Modal.Actions,{children:(0,t.jsx)(h.Modal.Action,{onClick:c,type:"secondary",children:"Cancel"})})]})}function J(e){let{selectedDeployment:i,setStage:l,requestRollback:n,project:s,rollbackReason:a,rollbackCandidates:r}=e,{user:o}=(0,w.useUser)();if(!i)return(0,t.jsx)(V,{setStage:l});let c=a.length>=T.REASON_MAX_CHARACTER_LENGTH,u=(0,T.getMostRecentlyPromotedDeployment)(r);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.Modal.Body,{children:[(0,t.jsx)(q,{}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-16",children:"Rolling back to:"}),(0,t.jsx)(O.DeploymentCardSmall,{deployment:i,isPreviousDeployment:i.uid===u?.uid,selectedDeployment:i,setSelectedDeployment:()=>null})]}),a.trim()&&(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:(0,t.jsx)(T.RollbackDescriptionCard,{rollbackDescription:{description:a.trim(),userId:o?.uid??"",username:o?.username??"",deploymentId:i.uid,projectId:s?.id??"",createdAt:new Date().getTime()},project:s,preview:!0})}),(0,t.jsxs)(E.UL,{className:"mb-0",children:[(0,t.jsx)(E.LI,{children:"Instant Rollback assigns domains to a previous deployment. All Environment Variables from the original build will remain. Cron jobs will be reverted to the state of the previous deployment."}),(0,t.jsxs)(E.LI,{children:[(0,t.jsxs)(C.Link,{className:"inline-flex items-center text-[var(--geist-success)] no-underline",href:`https://${i.url}`,target:"_blank",children:["View the selected deployment ",(0,t.jsx)(d.ExternalSmall,{className:"ml-1"})]})," ","before rolling back—external APIs, databases, and CMS platforms may not behave as expected."]}),(0,t.jsx)(E.LI,{children:"You can update the rollback reason from the project overview."})]}),(s?.autoAssignCustomDomains??!0)||s?.lastAliasRequest?.type==="rollback"?(0,t.jsx)(x.Note,{fill:!0,type:"secondary",children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-4 flex-initial",children:(0,t.jsx)("div",{className:"flex flex-col items-start justify-start flex-initial",children:(0,t.jsx)("p",{className:"text-copy-14 text-inherit",children:"After rolling back, production deployments will not be automatically promoted until the rollback is removed."})})})}):null]})]}),(0,t.jsxs)(h.Modal.Actions,{children:[(0,t.jsx)(h.Modal.Action,{onClick:()=>{l("initial")},type:"secondary",children:"Back"}),(0,t.jsx)(h.Modal.Action,{"data-testid":(0,j.tid)("deployment","rollback-modal","rollback-button"),disabled:c,onClick:()=>{n(i.uid),l("processing")},children:"Confirm Rollback"})]})]})}function X(e){let{jobStatus:l,rollbackDeploymentId:n,rollbackCandidates:s,selectedDeployment:a,setStage:r,onCancel:o,statusSwr:c,requestRollback:d,rollbackReason:p}=e,{user:x}=(0,w.useUser)();if((0,i.useEffect)(()=>{n===a?.uid&&("failed"===l?r("error"):"succeeded"===l&&r("done"))},[n,l,a,r]),!a)return(0,t.jsx)(V,{setStage:r});let g=(0,T.getMostRecentlyPromotedDeployment)(s);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.Modal.Body,{children:[(0,t.jsx)(q,{}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14",children:"Assigning production domains:"}),(0,t.jsx)(O.DeploymentCardSmall,{deployment:a,isPreviousDeployment:a.uid===g?.uid,selectedDeployment:a,setSelectedDeployment:()=>null})]}),""!==p?(0,t.jsxs)("div",{className:"rounded bg-background-200 px-4 py-3 shadow-border",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["“",(0,t.jsx)(B.LinkParser,{text:p.trim()}),"”"]}),(0,t.jsxs)("div",{className:"flex gap-1 pt-1",children:[(0,t.jsx)("p",{className:"text-copy-14",children:"Rolled back by"}),x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(G.PrincipalAvatar,{size:20,principalId:x.uid,principal:{type:"user",uid:x.uid,username:x.username}}),(0,t.jsx)("p",{className:"text-copy-14",children:x.username})]}):null]})]}):null,(0,t.jsxs)(E.UL,{className:"mx-4 my-0 list-none pt-2",children:[c.aliases.map(e=>{let i="loading";return"completed"===e.status?i="success":"failed"===e.status&&(i="error"),(0,t.jsx)(E.LI,{children:(0,t.jsxs)("div",{className:"h-6 flex items-center gap-2",children:["loading"===i&&(0,t.jsx)(u.Spinner,{className:"shrink-0",size:16}),"error"===i&&(0,t.jsx)(y.WarningFill,{className:"shrink-0",color:"amber-800",size:16}),"success"===i&&(0,t.jsx)(f.CheckCircleFill,{className:"shrink-0",color:"blue-700",size:16}),(0,t.jsx)("span",{className:"text-copy-14 truncate",children:e.alias})]})},e.alias)}),!c.isReachingEnd&&c.initialDataLoaded?(0,t.jsx)(E.LI,{children:(0,t.jsx)(m.Button,{loading:c.isLoadingMore,onClick:()=>{c.loadMore()},style:{marginTop:24},type:"secondary",width:"100%",children:"Show More"})}):null]})]})]}),(0,t.jsx)(h.Modal.Actions,{children:(0,t.jsx)(h.Modal.Action,{"data-testid":(0,j.tid)("deployment","rollback-modal","finish-button"),fullWidth:!0,loading:"failed"!==l&&"succeeded"!==l,onClick:()=>{"failed"===l?d(a.uid):"succeeded"===l&&(r("initial"),o())},children:"failed"===l?"Retry":"Done"})})]})}function Q(e){let{active:n,initialSelectedDeployment:s,onCancel:a,productionBranch:r,productionDeployment:o,projectId:c,rollbackCandidates:d,swr:u,rollbackDescription:m}=e,{mutate:x}=(0,S.useSWRConfig)(),[f,g]=(0,i.useState)("initial"),[y,w]=(0,i.useState)(""),{isReady:E,team:C}=(0,l.useTeam)(),A=(0,p.useToasts)(),I=(0,i.useMemo)(()=>{let e=d.filter(e=>e.uid!==o.id);return(0,T.getMostRecentlyPromotedDeployment)(e)},[d,o]),[B,O]=(0,i.useState)(null),$=B??s??I??null,_=(0,i.useCallback)(g,[g]),F=(0,i.useCallback)(O,[O]),[,{aliases:U}]=(0,P.useAliasesInfinite)({rollbackDeploymentId:o.id}),{data:z}=(0,R.useProject)(c),{lastAliasRequest:H,hasFloatingAliases:G}=z||{lastAliasRequest:void 0,hasFloatingAliases:!1},{toDeploymentId:q,jobStatus:V}=H||{toDeploymentId:null,jobStatus:null},[,Y]=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,{isReady:s,team:a}=(0,l.useTeam)(),r=(0,D.default)((t,i)=>{if(!s)return null;let l={teamId:a?.id,limit:n};return t?i?.next?`${(0,k.API_PROJECTS_ROLLBACK_ALIAS_STATUS)(e)}${(0,b.encode)({...l,until:i.next})}`:null:`${(0,k.API_PROJECTS_ROLLBACK_ALIAS_STATUS)(e)}${(0,b.encode)(l)}`},e=>(0,v.fetchAPI)(e,{throwOnHTTPError:!0}),{refreshInterval:t}),o=(0,i.useMemo)(()=>r.data?[].concat(...r.data.filter(Boolean).map(e=>e.aliases.slice(0,n))):[],[r.data,n]),c=!!r.data,d=c&&0===o.length,u=c&&r.data&&r.size>r.data.length,m=c&&r.data&&r.data[r.data.length-1]?.aliases.length<n;return[r,{aliases:o,initialDataLoaded:c,isEmpty:d,loadMore:()=>r.setSize(e=>e+1),isLoadingMore:u,isReachingEnd:m,mutate:r.mutate}]}(c,2e3),Q=(0,i.useMemo)(()=>o,[n]),Z=()=>{g("initial"),O(s||I||null),a()},ee=(0,i.useCallback)(async e=>{if(!E)return;let t=`${(0,k.API_DEPLOYMENT_ROLLBACK)(c,e)}${(0,b.encode)({teamId:C?.id,description:y.trim()})}`;try{await (0,v.fetchAPI)(t,{throwOnHTTPError:!0,method:"POST",body:{}}),C&&(void 0!==z&&(0,M.revalidateProject)(x,z),await x((0,L.getProjectProductionDeploymentKey)({projectIdOrName:c,teamId:C.slug})),x((0,W.getRollingReleaseEndpoint)(C.slug,c)))}catch(e){A.error({text:"Something went wrong - please try requesting an Instant Rollback again",key:"rollback-deployment"}),(0,N.captureError)(e)}},[E,c,A,y,x,C,z]),et={rollbackDeploymentId:q,hasFloatingAliases:!!G,jobStatus:V,onCancel:Z,previousDeployment:I,productionBranch:r,productionDeployment:Q,productionAliases:U.map(e=>{let{alias:t}=e;return t}),project:z,rollbackCandidates:d,setStage:_,selectedDeployment:$,setSelectedDeployment:F,deploymentSwr:u,statusSwr:Y,requestRollback:ee,rollbackWarningText:"New deployments will not be automatically assigned production domains until this rollback is removed.",rollbackReason:y,setRollbackReason:w,rollbackDescription:m};return(0,t.jsxs)(h.Modal.Modal,{active:n,"data-testid":(0,j.tid)("deployment","rollback-modal"),onClickOutside:Z,sticky:!0,width:"500px",children:["initial"===f&&(0,t.jsx)(K,{...et}),"selected"===f&&(0,t.jsx)(J,{...et}),["processing","error","done"].includes(f)&&(0,t.jsx)(X,{...et})]})}var Z=e.i(5771992),ee=e.i(5645345),et=e.i(3981247);e.i(3182268);var ei=e.i(7849855);function el(e){let{team:t}=(0,l.useTeam)(),n=!t||t.billing?.plan==="hobby",{value:s}=(0,a.useInstantRollbackHobbyRestrictionFlag)(),{value:c}=(0,r.useInstantRollbackHobbyRestrictionTeamFlag)(),d=s||c,u=e?.name,{deployment:m,isLoading:h}=(0,o.useProjectProductionDeployment)(u);return(0,i.useMemo)(()=>{let t=(0,ee.asListDeployment)(e),i=n&&!t?.isRollbackCandidate;return t?h?"Loading…":"readyState"in t&&"READY"!==t.readyState?"Only Deployments that are Ready can be rolled back.":"readySubstate"in t&&"PROMOTED"!==t.readySubstate?"Only Deployments previously aliased to a Production domain can be rolled back.":t.uid===m?.id?"This Deployment is already in Production.":d?t.isRollbackCandidate||"production"===t.target?i?"Hobby customers can only roll back to the previous deployment.":"":"Only Deployments previously aliased to a Production domain can be rolled back.":t.isRollbackCandidate?"":"Only Deployments previously aliased to a Production domain can be rolled back.":""},[e,n,h,m?.id,d])}function en(e){let{onClose:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[a,r]=(0,i.useState)(!1),[c,d]=(0,i.useState)(),{teamSlug:u,projectSlug:m}=(0,ei.useProjectAndTeamSlug)(),{data:h}=(0,R.useProject)(c?.name),p=m??c?.name,x=e??h,{data:f}=(0,et.useRollingRelease)({teamIdOrSlug:u,projectSlug:p}),g=f?.rollingRelease?f?.rollingRelease?.canaryDeployment?.id:void 0,{deployment:y,rollbackDescription:j,mutate:b}=(0,o.useProjectProductionDeployment)(x?.name),{can:v}=(0,n.default)({projectIdOrName:x?.name}),k=v(s.Action.Create,s.Resource.DeploymentRollback),w=x?.link?.productionBranch?x.link.productionBranch:void 0,[S,N]=(0,Z.useDeploymentsInfinite)({projectId:x?x.id:"",requireProject:!0,limit:10,rollbackCandidate:!0},{}),{deployments:E,initialDataLoaded:C}=N,D=E.filter(e=>!!e.isRollbackCandidate&&e.uid!==g),P=!!(C&&x&&!D.length),A=(0,i.useCallback)(e=>{d((0,ee.asListDeployment)(e)),r(!0)},[]),I=(0,i.useCallback)(()=>{r(!1),b().finally(()=>null),l?.()},[b,l]);return{rollbackModal:(0,i.useMemo)(()=>k&&a&&y&&x?(0,t.jsx)(Q,{active:a,initialSelectedDeployment:c,onCancel:I,productionBranch:w,productionDeployment:y,projectId:x.id,rollbackCandidates:D,rollbackDescription:j,swr:N}):null,[k,a,c,w,y,D,x,N,I,j]),closeRollbackModal:I,openRollbackModal:A,canRollbackDeployment:k,noRollbackCandidates:P}}e.s(["useInstantRollbackModal",()=>en,"useRollbackTooltip",()=>el],9365163)},5023172,e=>{"use strict";var t=e.i(8711407),i=e.i(1176592),l=e.i(6891161),n=e.i(455575),s=e.i(277234),a=e.i(4244280),r=e.i(57106);function o(e){let[o,c]=(0,i.useState)(!1),d=(0,n.useToasts)(),u=(0,i.useCallback)(async()=>{if(!e.deploymentId||!e.teamId)return;c(!0);let t=new URLSearchParams;t.append("teamId",e.teamId);let i=`${(0,a.API_DEPLOYMENTS)("v13")}/${e.deploymentId}/skip-queue?${t.toString()}`;200===(await (0,s.fetchAPI)(i,{method:"POST",body:void 0,throwOnHTTPError:!1,returnStatus:!0})).status?(d.success("Deployment will start building now."),e.onSuccess?.()):d.error("Something went wrong"),c(!1),e.onClose()},[e,d]);return(0,t.jsxs)(l.Modal.Modal,{active:e.active,onClickOutside:e.onClose,width:"500px",children:[(0,t.jsxs)(l.Modal.Body,{children:[(0,t.jsx)(l.Modal.Header,{children:(0,t.jsx)(l.Modal.Title,{children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:"Start Building Now"})})}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:["This will bypass the regular queue and start your build immediately. On-demand builds are billed in 1 minute increments."," ",(0,t.jsx)(r.Link,{href:"/docs/deployments/managing-builds#on-demand-concurrent-builds",target:"_blank",variant:"highlight",children:"Learn more."})]}),e.teamId&&e.projectName?(0,t.jsxs)("p",{className:"text-copy-14",children:["If you frequently need faster builds for this project, consider enabling"," ",(0,t.jsx)(r.Link,{as:`/${e.teamId}/${encodeURIComponent(e.projectName)}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",variant:"highlight",children:"On-Demand Concurrent Builds"})," ","at the project level."]}):null,(0,t.jsx)("p",{className:"text-copy-14",children:'By clicking "Confirm" you agree to be charged for on-demand concurrency.'})]})]}),(0,t.jsxs)(l.Modal.Actions,{children:[(0,t.jsx)(l.Modal.Action,{loading:!1,onClick:e.onClose,type:"secondary",children:"Close"}),(0,t.jsx)(l.Modal.Action,{disabled:o,loading:o,onClick:u,children:"Confirm"})]})]})}e.s(["StartBuildingNowModal",()=>o])},3008300,e=>{"use strict";e.s(["DEFAULT_USE_IGNORE_BUILD_STEP_PROMOTE",0,!1,"DEFAULT_USE_IGNORE_BUILD_STEP_REDEPLOY",0,!0,"DeploymentOverviewParams",0,{automaticAliases:!0}])},1840726,e=>{"use strict";function t(e){let{commandForIgnoringBuildStep:t}=e||{};return"string"==typeof t&&t.trim().length>0}function i(e){let{project:i,deployment:l}=e;return t(i)||t(l?.projectSettings)}e.s(["useShowIgnoreBuildStep",()=>i])},7713873,e=>{"use strict";var t=e.i(5927860);function i(e){return e.startsWith("env_")}function l(e){return i(e.id)}function n(e){return l(e)?e.slug:e.name}let s={id:t.EnvTarget.Production,name:"Production",slug:t.EnvTarget.Production,description:"Primary project environment meant to serve qualified, promoted deployments to real users",branchMatcher:void 0,domains:[],createdAt:void 0,updatedAt:void 0},a={id:t.EnvTarget.Preview,name:"Preview",slug:t.EnvTarget.Preview,description:"Standard environment — included with all Vercel projects — for previewing changes before promoting them to production",branchMatcher:void 0,domains:[],createdAt:void 0,updatedAt:void 0},r={id:t.EnvTarget.Development,name:"Development",slug:t.EnvTarget.Development,branchMatcher:void 0,description:"Standard environment — included with all Vercel projects — used to supply environment variables in local development",createdAt:void 0,updatedAt:void 0},o="[all-environments]",c="[all-custom-environments]";function d(e){return e===o||e===c||Object.values(t.EnvTarget).includes(e.replace(/^\[|\]$/g,""))||i(e)}function u(e){return i(e)?e:`[${e}]`}e.s(["DevelopmentEnvironment",0,r,"PreviewEnvironment",0,a,"ProductionEnvironment",0,s,"allCustomEnvironmentsFilter",0,c,"allEnvironmentsFilter",0,o,"brandCustomEnvId",0,e=>e,"envName",()=>n,"isCustomEnvId",()=>i,"isCustomEnvironment",()=>l,"isEnvFilter",()=>d,"mapToEnvFilter",()=>u])},7957424,e=>{"use strict";var t=e.i(7909933),i=e.i(8042625),l=e.i(277234),n=e.i(4244280),s=e.i(9668517),a=e.i(7713873);function r(e,a){let r=(0,s.useTeamSlug)(),o=(0,i.encode)({slug:r}),{skip:c,...d}=a||{},u=async e=>{try{let t=await (0,l.fetchAPI)(e,{throwOnHTTPError:!0});return{customEnvironments:t.environments,accountLimit:t.accountLimit}}catch(e){return{customEnvironments:[],accountLimit:{total:0}}}};return(0,t.default)(e&&!c?`${(0,n.API_ENVIRONMENTS)(e)}${o}`:null,u,d)}function o(e,i){let l=r(e,i),{data:n,error:s,isLoading:o,isValidating:c,mutate:d}=(0,t.default)(e?[e,"allEnvironments",l.data]:null,()=>({environments:[a.ProductionEnvironment,a.PreviewEnvironment,...l.data?.customEnvironments||[],a.DevelopmentEnvironment]}),{...i,fallbackData:{environments:[a.ProductionEnvironment,a.PreviewEnvironment,a.DevelopmentEnvironment]}});return{data:n,error:l.error||s,isLoading:l.isLoading||o,isValidating:l.isValidating||c,mutate:d}}e.s(["useAllEnvironments",()=>o,"useCustomEnvironments",()=>r])},1516738,e=>{"use strict";var t=e.i(8711407),i=e.i(3753138),l=e.i(2634426),n=e.i(6107899),s=e.i(3394346),a=e.i(5927860);function r(e){let{id:r}=e;return r?r===a.EnvTarget.Production?(0,t.jsx)(i.ArrowCircleUp,{}):r===a.EnvTarget.Preview?(0,t.jsx)(n.PreviewEye,{}):r===a.EnvTarget.Development?(0,t.jsx)(s.Wrench,{}):(0,t.jsx)(l.Layers,{}):null}e.s(["EnvironmentIcon",()=>r])},1773657,e=>{"use strict";var t=e.i(8711407),i=e.i(3306538);function l(e){let{type:l,size:n}=e;return(0,t.jsx)(i.Badge,{size:n,variant:"production"===l?"blue-subtle":"teal-subtle",children:(0,t.jsx)("span",{style:{textTransform:"none"},children:"production"===l?"Production":"Pre-Production"})})}e.s(["EnvironmentBadge",()=>l])},5129431,e=>{"use strict";var t=e.i(8711407),i=e.i(1875382),l=e.i(1176592),n=e.i(57106),s=e.i(2504781),a=e.i(3869281),r=e.i(4030453),o=e.i(6891161),c=e.i(5323212),d=e.i(8522580),u=e.i(455575),m=e.i(3306538),h=e.i(6850581),p=e.i(3978547),x=e.i(4345845),f=e.i(5479400),g=e.i(4004502),y=e.i(5140444),j=e.i(5338940),b=e.i(2560270),v=e.i(3228096),k=e.i(1848296),w=e.i(5927860),S=e.i(9358876),N=e.i(7713873),E=e.i(1717203),C=e.i(7557283),D=e.i(8042625),P=e.i(277234),A=e.i(4244280);async function I(e){let{deployment:t,includeBuildCache:i=!1,skipIgnoreBuildStep:l=!1,project:n,team:s,target:a,customEnvironmentSlugOrId:r}=e,o=s?.id;if("prebuilt"in t&&t.prebuilt)throw{message:"Prebuilt deployments cannot be redeployed because they will not use the latest environment variables and project settings. Please create a new deployment instead.",action:"Learn More",link:"https://vercel.com/docs/cli/deploy#prebuilt"};if(await (async()=>{if("production"!==t.target||!n.targets?.production?.id)return!1;let e=n.targets.production;return!("READY"!==e.readyState||(await (0,P.fetchAPI)(`${(0,A.API_DEPLOYMENTS)("v6")}${(0,D.encode)({teamId:o,projectId:n.id,target:"production",since:t.createdAt+1,limit:30})}`,{throwOnHTTPError:!0})).deployments.every(e=>e.meta?.action==="redeploy"))&&(t.id||t.uid)!==e.id})())throw{message:"A more recent Production Deployment has been created, so the one you are looking at cannot be redeployed anymore.",action:"Learn More",link:"https://vercel.link/redeploy-production-deployment"};return await (0,P.fetchAPI)(`${(0,A.API_DEPLOYMENTS)("v13")}${(0,D.encode)({teamId:o,forceNew:"1",...i&&{withCache:"1"},skipIgnoreBuildStep:l?"1":null})}`,{method:"POST",body:JSON.stringify({deploymentId:t.uid||t.id,meta:{action:"redeploy"},name:n.name,target:a||void 0,customEnvironmentSlugOrId:r}),throwOnHTTPError:!0})}var R=e.i(9375869),T=e.i(542164),M=e.i(8518548),L=e.i(1840726),B=e.i(7957424),O=e.i(1773657),$=e.i(1516738),_=e.i(3008300);function F(e){let{current:i,data:l}=e;return(0,t.jsx)(k.RadioGroup.Item,{className:"cursor-pointer items-start rounded-none border border-solid border-gray-400 p-3 text-sm [&:first-of-type]:rounded-t-md [&:last-of-type]:rounded-b-md",value:l.id,children:(0,t.jsxs)("div",{className:"grid grid-cols-[1fr,auto] gap-1",children:[(0,t.jsx)("div",{className:"overflow-hidden text-ellipsis font-medium",children:(0,t.jsx)("span",{className:"truncate",children:l.url})}),i?(0,t.jsx)(m.Badge,{className:"w-fit p-2 normal-case",size:"sm",variant:"blue-subtle",children:"Current"}):null,(0,t.jsxs)("div",{className:"gray-900 col-start-1 flex items-baseline gap-x-2 font-mono",children:[(0,t.jsx)(x.GitBranch,{className:"translate-y-1"}),l.meta.githubCommitRef]}),(0,t.jsxs)("div",{className:"gray-900 col-start-1 flex items-baseline gap-x-2",children:[(0,t.jsx)(f.GitCommit,{className:"translate-y-1"}),(0,t.jsx)("span",{style:{wordBreak:"break-word"},children:l.meta.githubCommitMessage})]}),(0,t.jsxs)("div",{className:"gray-900 col-start-1 flex items-center gap-x-2",children:[(0,t.jsx)(p.ClockDashed,{}),(0,h.useShortTimeAgo)(l.createdAt)]})]})},l.id)}function U(e){let{deployments:i,onSelect:n}=e,[a,r]=(0,l.useState)(!1),[o,c]=(0,l.useState)(i[0].id);return(0,t.jsx)(k.RadioGroup,{onChange:e=>{c(e),n(e)},value:o,children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)(F,{current:!0,data:i[0]}),i.length>1&&a?i.slice(1).map(e=>(0,t.jsx)(F,{data:e},e.id)):null,i.length>1&&!a?(0,t.jsx)(s.Button,{className:"mt-3",onClick:()=>r(!a),type:"secondary",children:"Choose a Deployment"}):null]})})}function z(e){let[s,m]=(0,l.useState)(!1),[h,p]=(0,l.useState)(!1),[x,f]=(0,l.useState)(null),[k,D]=(0,l.useState)(null),[P,A]=(0,l.useState)(void 0),[F,z]=(0,l.useState)(void 0),[H,G]=(0,l.useState)(!1),[W,q]=(0,l.useState)(void 0),V=(0,L.useShowIgnoreBuildStep)({project:e,deployment:x}),[Y,K]=(0,l.useState)(_.DEFAULT_USE_IGNORE_BUILD_STEP_REDEPLOY),J=(0,u.useToasts)(),X=(0,i.useRouter)(),{user:Q}=(0,y.useUser)(),{team:Z}=(0,j.useTeam)(),{can:ee}=(0,E.default)({projectIdOrName:e?.name}),et=ee(C.Action.Create,C.Resource.Deployment),ei=ee(C.Action.Create,C.Resource.DeploymentFromProductionBranch)&&et,{data:el}=(0,B.useCustomEnvironments)(e?.id??""),en=(0,l.useMemo)(()=>el?.customEnvironments??[],[el]),es=(0,l.useMemo)(()=>x?Array.from(new Set(Array.isArray(x.alias)?x.alias:[])):null,[x]),{data:ea}=(0,M.useProjectDomains)(e?.id??"",{limit:13,production:"true",redirects:"false",verified:"true",order:"ASC"}),er=(0,l.useMemo)(()=>{if("production"===W)return ea?.map(e=>e.name)||[];if("preview"===W){if(x)return Array.from(new Set(x.alias))}else if(W&&(0,N.isCustomEnvId)(W)){let e=en.find(e=>{let{id:t}=e;return t===W});if(e)return e.domains?.map(e=>{let{name:t}=e;return t})||[]}return[]},[en,x,ea,W]),eo=(0,l.useCallback)((e,t)=>{let i=Array.isArray(e)?e:[e],l=i[0];D(i),f(l),q(l.customEnvironment?.id??l.target??"preview"),A(t),m(!0),G(!1),K(_.DEFAULT_USE_IGNORE_BUILD_STEP_REDEPLOY)},[]),ec=(0,l.useCallback)(()=>{m(!1)},[]),ed=(0,l.useCallback)(()=>{p(!1),f(null),q(void 0),z(void 0)},[]),eu=(0,l.useCallback)(async()=>{let t,i;p(!0),z(void 0),x&&e&&("production"===W||"staging"===W?t=W:"preview"===W?t=void 0:W&&(0,N.isCustomEnvId)(W)?i=W:x.customEnvironment?i=x.customEnvironment.id:t=x.target,I({deployment:x,includeBuildCache:H,project:e,target:t,skipIgnoreBuildStep:!!V&&!Y,team:Z,customEnvironmentSlugOrId:i}).then(e=>{if(!e)return;P?.onCreated?.(e);let t=(0,R.pathFromDeployment)(e,{user:Q,team:Z});!P||P.redirect?(J.success("Deployment created."),X.push(t)):J.success({text:"Deployment created.",action:"View Deployment",onAction:()=>{X.push(t)}}),ec()}).catch(e=>{e.status>=500?z({message:`Unexpected error (${e.status}). Please try again later.`}):z(e)}).finally(()=>{p(!1),G(!1),K(_.DEFAULT_USE_IGNORE_BUILD_STEP_REDEPLOY)}))},[W,x,e,J,X,Q,Z,ec,H,P,Y,V]),em=e?.autoAssignCustomDomains??!0,eh=(0,l.useMemo)(()=>{let e;return W?"production"===W?e=(0,t.jsx)(O.EnvironmentBadge,{size:"sm",type:"production"}):"production"!==W&&(e=(0,t.jsx)(O.EnvironmentBadge,{size:"sm",type:"preproduction"})):e=null,(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-copy-16 m-0 text-gray-1000",children:P?.copy?P.copy:"Create a new deployment with the same source code as your current one but with the latest Project Settings."}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:(0,t.jsxs)("label",{children:[(0,t.jsx)("div",{className:"text-gray-900 text-sm mb-2",children:"Choose Environment"}),(0,t.jsxs)(c.Select,{"aria-label":"Environments",onChange:e=>{q(e.target.value)},prefix:(0,t.jsx)($.EnvironmentIcon,{id:W}),suffix:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial",children:[e," ",(0,t.jsx)(b.ChevronDown,{})]}),value:W,children:[(0,t.jsxs)("optgroup",{label:"System Environments",children:[(0,t.jsx)("option",{disabled:!ei,value:"production",children:"Production"}),(0,t.jsx)("option",{value:w.EnvTarget.Preview,children:"Preview"})]}),en.length>0?(0,t.jsx)("optgroup",{label:(0,S.pluralize)("Custom Environment",en.length),children:en.sort((e,t)=>e.slug.localeCompare(t.slug)).map(e=>(0,t.jsx)("option",{value:e.id,children:e.slug},e.id))}):(0,t.jsx)("option",{disabled:!0,children:"Your project has no custom environments"})]})]})})]})},[en,W,ei,P]),ep=(0,l.useMemo)(()=>em||"production"!==W?er.length<=0?null:(0,t.jsxs)("div",{className:"space-y-[6px]",children:[(0,t.jsx)("p",{className:"text-copy-14 m-0",style:{color:"var(--accents-6)"},children:"Assigned domains:"}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[er.slice(0,2).map(e=>(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)("div",{className:"text-gray-900",children:(0,t.jsx)(v.Globe,{size:16})}),(0,T.default)(e)?(0,t.jsx)("p",{className:"text-copy-16",children:"name"}):(0,t.jsx)(n.Link,{href:`https://${e}`,target:"_blank",className:"hover:underline underline-offset-2",children:e})]},e)),e&&er.length-2>0&&er.length<13?(0,t.jsx)("p",{className:"text-copy-16 m-0",children:(0,t.jsxs)(n.Link,{href:`/${Z?Z.slug:Q?.username}/${encodeURIComponent(e.name)}/settings/domains`,style:{fontSize:13},tab:!0,variant:"highlight",children:["...and ",er.length-2," more."]})}):null,e&&er.length>=13?(0,t.jsx)("p",{className:"text-copy-16 m-0",children:(0,t.jsxs)(n.Link,{href:`/${Z?Z.slug:Q?.username}/${encodeURIComponent(e.name)}/settings/domains`,style:{fontSize:13},tab:!0,variant:"highlight",children:["...and over ",10," more."]})}):null]})]}):(0,t.jsx)(d.Note,{fill:!0,size:"small",type:"warning",children:(0,t.jsxs)("p",{className:"text-copy-14 m-0",children:["Custom domains won't be assigned—auto-assignment is disabled."," ",(0,t.jsx)(n.Link,{external:!0,href:"/docs/deployments/managing-deployments#promote-deployment-to-production",variant:"highlight",children:"Learn about promoting deployments"})]})}),[e,Q,Z,em,er,W]);return{modal:(0,l.useMemo)(()=>(0,t.jsxs)(o.Modal.Modal,{active:s,"data-testid":(0,g.tid)("redeploy-modal","modal"),onAnimationDone:ed,onClickOutside:ec,width:"600px",children:[(0,t.jsxs)(o.Modal.Body,{className:"[&>hr]:w-full",children:[(0,t.jsx)(o.Modal.Header,{children:(0,t.jsx)(o.Modal.Title,{children:"Redeploy"})}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-7 flex-initial",children:[eh,k?(0,t.jsx)(U,{deployments:k,onSelect:e=>f(k.filter(t=>t.uid===e)[0])}):null,er.length>0&&ep,F?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(r.Error,{error:F})}):null,(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsxs)(a.Checkbox,{checked:H,onChange:()=>{G(!H)},children:["Use existing Build Cache."," "]}),(0,t.jsx)(n.Link,{external:!0,href:"/docs/deployments/troubleshoot-a-build#understanding-build-cache",style:{fontSize:13},variant:"highlight",children:"Learn about Build Cache"})]}),V?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(a.Checkbox,{checked:Y,fullWidth:!0,onChange:()=>{K(!Y)},children:"Use project's Ignore Build Step"})}):null]})]}),(0,t.jsxs)(o.Modal.Actions,{children:[(0,t.jsx)(o.Modal.Action,{loading:!1,onClick:ec,type:"secondary",children:"Cancel"}),(0,t.jsx)(o.Modal.Action,{"data-testid":(0,g.tid)("redeploy-modal","redeploy-button"),disabled:!es&&!ea&&!x,loading:h,onClick:eu,children:"Redeploy"})]})]}),[s,ed,ec,x,k,er,eh,ep,F,H,V,Y,es,ea,h,eu]),close:ec,open:eo}}e.s(["default",()=>z],5129431)},8366444,e=>{"use strict";var t=e.i(4496450);let i={enabled:!0,disabledReason:void 0},l=e=>({enabled:!1,disabledReason:e});function n(e,n){if(!e||!e.billing)return l("other");if("enterprise"===e.billing.plan)return(0,t.isLegacyPlanIteration)(e.billing.planIteration)?l("enterprise-non-unbundled"):n?i:l("no-permission");if("pro"===e.billing.plan)return"active"===e.billing.status?n?i:l("no-permission"):l("pro-non-active");return l("hobby-plan")}e.s(["useOnDemandConcurrentBuilds",()=>n])},7966665,(e,t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});let l=e.r(2795167);function n(e){return/^[a-f0-9]{40}$/i.test(e)}i.default=function(e,t){let i,s;if("string"!=typeof e||!e.length)return null;if(e.startsWith("git@"))switch(!0){case e.startsWith("git@github.com:"):i="github",s=e.replace("git@github.com:","");break;case t&&e.startsWith(`git@${t}:`):i="ghes",s=e.replace(`git@${t}:`,"");break;case e.startsWith("git@gitlab.com:"):i="gitlab",s=e.replace("git@gitlab.com:","");break;case e.startsWith("git@bitbucket.org:"):i="bitbucket",s=e.replace("git@bitbucket.org:","");break;default:return null}else{let n=l.parse(e);if(!n.pathname)return null;switch(n.hostname){case"github.com":case"www.github.com":i="github";break;case t:i="ghes";break;case"gitlab.com":case"www.gitlab.com":i="gitlab";break;case"bitbucket.org":case"www.bitbucket.org":i="bitbucket";break;default:return null}s=n.pathname.replace(/(^\/|\/$)/g,"")}let a=(s=s.replace(/\.git$/,"")).split("/").filter(Boolean);if(a.length<2)return null;if(2===a.length)return{type:i,owner:a[0],name:a[1],branch:"",sha:"",subdir:""};let r="",o="",c="",d=a[0],u=a[1];if("github"===i)if("blob"!==a[2]&&"tree"!==a[2]&&"commit"!==a[2])return null;else n(a[3])?o=a[3]:r=a[3],c=a.slice(4).join("/");else if("ghes"===i)if("blob"!==a[2]&&"tree"!==a[2]&&"commit"!==a[2])return null;else n(a[3])?o=a[3]:r=a[3],c=a.slice(4).join("/");else if("gitlab"===i)if("-"===a[2])("blob"===a[3]||"tree"===a[3]||"commit"===a[3])&&(n(a[4])?o=a[4]:r=a[4],c=a.slice(5).join("/"));else{let e=a.indexOf("-");-1===e?u=a.slice(1).join("/"):(u=a.slice(1,e).join("/"),("blob"===a[e+1]||"tree"===a[e+1]||"commit"===a[e+1])&&(n(a[e+2])?o=a[e+2]:r=a[e+2],c=a.slice(e+3).join("/")))}else if("bitbucket"===i)if("src"!==a[2]&&"commits"!==a[2])return null;else n(a[3])?o=a[3]:r=a[3],c=a.slice(4).join("/");return{type:i,owner:d,name:u,branch:r,sha:o,subdir:c}}},3023251,e=>{"use strict";var t=e.i(7966665);function i(e){if(!e||"error"in e)return null;switch(e.type){case"github-limited":case"github":return{org:e.org||"",repo:e.repo};case"gitlab":if("projectUrl"in e){let i=(0,t.default)(e.projectUrl);if(i)return{org:i.owner,repo:i.name}}break;case"bitbucket":if("slug"in e)return{org:e.owner,repo:e.slug}}return null}function l(e){let{includeOrg:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=i(e);return l?t?`${l.org}/${l.repo}`:l.repo:""}e.s(["getOrgAndRepoFromLink",()=>i,"getRepoFromLink",()=>l])},913614,e=>{"use strict";var t=e.i(7966665);function i(e){let{type:i,org:l,repo:n,projectUrl:s,owner:a,slug:r,host:o}=e;switch(i){case"github-limited":case"github":return`https://github.com/${l}/${n}`;case"gitlab":{let e=(0,t.default)(s||"");return`https://gitlab.com/${e?.owner}/${e?.name}`}case"bitbucket":return`https://bitbucket.org/${a}/${r}`;case"github-custom-host":if(!o)throw Error("Custom host is required for github-custom-host");return`https://${o}/${l}/${n}`;default:return""}}e.s(["getGitRepoUrlFromLink",()=>i])},9204765,4095738,e=>{"use strict";var t=e.i(8711407),i=e.i(1987325),l=e.i(1176592),n=e.i(2504781),s=e.i(2064047),a=e.i(6891161),r=e.i(8522580),o=e.i(7087273),c=e.i(9318197),d=e.i(455575),u=e.i(57106),m=e.i(7749291),h=e.i(4345845),p=e.i(7218483),x=e.i(5614970),f=e.i(913614),g=e.i(3023251),y=e.i(7401972),j=e.i(5598924),b=e.i(5761705),v=e.i(5479400),k=e.i(6401841),w=e.i(3306538),S=e.i(3500331),N=e.i(5255926),E=e.i(8735244);function C(e){let{loading:i,onChange:n,onPaste:s,size:a,state:r,...o}=e;return(0,t.jsx)(S.Input,{...o,id:(0,l.useId)(),onChange:n,onPaste:s,size:a,suffix:(0,t.jsx)(D,{loading:i,size:"small"===a?16:void 0,state:r}),suffixStyling:!1})}function D(e){let{loading:i,state:l,size:n}=e;return i?(0,t.jsx)(E.Spinner,{size:n}):"success"===l?(0,t.jsx)(b.CheckCircle,{color:"blue-700",size:n}):"error"===l?(0,t.jsx)(k.Stop,{color:"red-900",size:n}):null}function P(e){let{branchName:i,commitMessage:l,commitSha:n,createdAt:s=Date.now(),isProductionDeployment:a,loading:r}=e,o=(0,p.useAgo)(s,{long:!0,justNowLabel:"just now"}),c=r||"string"==typeof i,d=n?.substring(0,7);return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-0.5 flex-1 translate-y-[3px] rounded-[10px] border border-solid border-[var(--accents-2)] px-3 py-[7px]",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-1",children:[(0,t.jsx)(h.GitBranch,{color:"gray-900",style:{flexShrink:0}}),(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-1 flex-1",children:r?(0,t.jsx)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-1 pt-1 pb-1",children:(0,t.jsx)(N.Skeleton,{height:16,width:150})}):(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-1",children:[c?(0,t.jsxs)("div",{className:"text-copy-14-mono truncate",style:{maxWidth:370},children:[i," "]}):(0,t.jsx)("div",{className:"min-w-[180px] max-w-[250px]",children:i}),!0===a&&(0,t.jsx)(w.Badge,{size:"md",variant:"blue-subtle",children:"Production"}),!1===a&&(0,t.jsx)(w.Badge,{size:"md",variant:"gray-subtle",children:"Preview"})]})})]}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-1",children:[(0,t.jsx)("div",{className:"flex flex-col items-center justify-start flex-initial",children:(0,t.jsx)(v.GitCommit,{color:"gray-900",size:16,style:{flexShrink:0}})}),r?(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-1 pt-1 pb-1",children:[(0,t.jsx)(N.Skeleton,{height:16,width:95}),(0,t.jsx)(N.Skeleton,{height:16,width:"56%"})]}):(0,t.jsxs)("div",{className:"text-copy-14 truncate",children:[(0,t.jsx)("span",{className:"text-copy-14-mono",children:d}),` ${l??""} `,(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:o})]})]})]})}function A(e){return(0,t.jsx)(r.Note,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[(0,t.jsxs)("div",{children:["This commit has already been built—",(0,t.jsx)(u.Link,{external:!0,href:e.deploymentId.replace(/dpl_/,""),tab:!0,type:"primary",children:"view here"})]}),e.isProductionDeployment?(0,t.jsx)("div",{children:"It is the current production deployment"}):null]})})}function I(e){let{branchName:i,isProductionDeployment:l}=e;return(0,t.jsx)(r.Note,{fill:!0,type:"warning",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"This commit exists on multiple branches"}),(0,t.jsxs)("p",{className:"text-copy-14 text-inherit",children:["Please verify this deployment should be built from"," ",(0,t.jsx)("span",{className:"text-copy-14-mono text-inherit",children:i}),l?" with Production configuration.":"."]})]})})}function R(e){let{children:i,id:l}=e;return i?(0,t.jsx)(r.Note,{fill:!0,id:l,style:{alignSelf:"start"},type:"error",children:i}):null}var T=e.i(7909933),M=e.i(7966665),L=e.i(277234);let B=RegExp(/[0-9a-f]{7,40}/,"i");function O(e,t){return e.toLowerCase()===t.toLowerCase()}function $(e){let{projectId:t,branchName:i,sha:l,teamId:n}=e,s=new URLSearchParams;i&&s.set("branchName",i),n&&s.set("teamId",n),l&&s.set("sha",l);let a=`/v1/integrations/git-commit-details/${t}?${s.toString()}`;return(0,L.fetchAPI)(a,{throwOnHTTPError:!0})}async function _(e,t,i,l,n,s,a){let r=function(e,t,i,l){let n=e.startsWith("http")?e:`https://${e}`,s=(0,M.default)(n);if(s){if(s.type!==t||!O(s.owner,i)||!O(s.name,l))return{type:"error",message:"The provided link points to a different repository than what is connected to the Vercel project."};if(!s.sha&&!s.branch)return{type:"production"};if(s.branch)return{type:"branch",ref:s.branch};if(s.sha)return{type:"sha",sha:s.sha}}return B.exec(e)?{type:"sha",sha:e}:{type:"branch",ref:e}}(e,n,t,i);switch(r.type){case"production":{if(!s)throw Error("There is no production branch defined for this project");let e=await $({projectId:l,branchName:s,teamId:a});return{branch:s,commitDate:new Date(e.commitDate).getTime(),commitMessage:e.commitMessage,sha:e.commitSha,requestedBy:r.type,recentDeploymentId:e.recentDeploymentId}}case"branch":{let e=await $({projectId:l,branchName:r.ref,teamId:a});return{branch:r.ref,commitDate:new Date(e.commitDate).getTime(),commitMessage:e.commitMessage,sha:e.commitSha,requestedBy:r.type,recentDeploymentId:e.recentDeploymentId}}case"sha":{let e=await $({projectId:l,sha:r.sha,teamId:a}),t=[...new Set(e.branches)].sort(e=>+(e===s));return{branch:t[0],commitDate:new Date(e.commitDate).getTime(),commitMessage:e.commitMessage,multiBranches:t.length>1?t:void 0,sha:e.commitSha,requestedBy:r.type,recentDeploymentId:e.recentDeploymentId}}case"error":throw Error(r.message)}}var F=e.i(4005781),U=e.i(4244280);function z(e){return(!e||"PENDING"!==e.state&&("RUNNING"!==e.state||void 0!==e.deploymentId||void 0!==e.url))&&!0}function H(e,t){let i=(0,f.getGitRepoUrlFromLink)(e);return t&&"github"===e.type?`${i}/tree/${t}`:t&&"gitlab"===e.type?`${i}/-/tree/${t}`:t&&"bitbucket"===e.type?`${i}/src/${t}`:i}function G(e){let{active:i,onCancel:l,projectId:n,projectLink:s,teamId:r}=e;if(!s)return null;let o=(0,g.getOrgAndRepoFromLink)(s);return o?(0,t.jsx)(a.Modal.Modal,{active:i,onClickOutside:l,children:(0,t.jsx)(W,{linkedOrg:o.org,linkedRepo:o.repo,onCancel:l,projectId:n,projectLink:s,teamId:r})}):null}function W(e){let n,{linkedOrg:s,linkedRepo:u,onCancel:m,projectId:h,projectLink:p,teamId:x}=e,f=(0,l.useId)(),b=(0,l.useId)(),[v,k]=(0,l.useState)(""),[w,S]=(0,l.useState)(""),[N,E]=(0,l.useState)(""),[D,M]=(0,l.useState)(!1),B=(0,d.useToasts)(),O=p.updatedAt||0,{isValidating:$,error:G,data:W}=function(e,t){let{linkedOrg:i,linkedRepo:l,productionBranch:n,projectId:s,projectType:a,teamId:r}=t;return(0,T.default)(""===e?null:[e,i,l,s,a,n,r],e=>_(...e),{throwOnError:!1,shouldRetryOnError:!1,revalidateOnFocus:!1})}(v,{linkedOrg:s,linkedRepo:u,productionBranch:p.productionBranch,projectId:h,projectType:p.type,teamId:x}),[,{branches:Y=[]}]=(0,y.useProjectDeployedBranches)({includeProductionBranch:!1,project:{id:h},limit:5,query:""!==w?w:void 0,active:!0}),{error:K,createDeployment:J,isLoading:X,reset:Q}=function(e){var t,i,l;let n,{onSuccess:s,projectId:a,teamId:r}=e,{data:o,isMutating:c,trigger:d,error:u,reset:m}=(t={throwOnError:!1},(0,F.default)(U.API_GIT_TRIGGER,(e,t)=>{let{arg:i}=t;if(!a)throw Error("No projectId passed");let{branch:l,sha:n}=i,s=r?`?${new URLSearchParams({teamId:r}).toString()}`:"",o=`${e}/${a}/sha/${encodeURIComponent(l)}/${n}${s}`;return(0,L.fetchAPI)(o,{method:"POST",body:{},throwOnHTTPError:!0})},t)),{data:h,error:p,isLoading:x}=(i=o?.job,l={onSuccess(e){z(e)&&"ERRORED"!==e.state&&s?.()},refreshInterval:3e3},(0,T.default)(i?`/v1/integrations/job/${i}`:null,e=>(0,L.fetchAPI)(e),l)),f=x||!z(h);return u&&(n=Error(u.message)),p&&(n=Error(p.message)),h?.state==="ERRORED"&&(n=Error(h.error??"Could not create a deployment for this reference.")),{error:n,createDeployment:e=>{m(),d(e)},isLoading:c||f,reset:m}}({onSuccess(){B.success("Deployment created successfully."),m()},projectId:h,teamId:x}),Z=(0,l.useMemo)(()=>(0,i.default)(e=>{k(e),S(e),Q()},500,{leading:!1,trailing:!0}),[k,Q,S]);(0,l.useEffect)(()=>{M($)},[$]),(0,l.useEffect)(()=>{W?.branch&&E(W.branch)},[W?.branch]);let ee="initial";!D&&W&&(ee="success"),(G||K)&&(ee="error",n=G?.message||K?.message);let et=!D&&"error"===ee,ei=N===p.productionBranch;return(0,t.jsxs)("form",{children:[(0,t.jsxs)(a.Modal.Body,{children:[(0,t.jsx)(a.Modal.Header,{children:(0,t.jsx)(a.Modal.Title,{children:"Create Deployment"})}),(0,t.jsx)(q,{connectedAt:O,projectLink:p}),(0,t.jsx)(c.Spacer,{}),(0,t.jsxs)("div",{"aria-labelledby":f,role:"group",children:[(0,t.jsxs)("p",{className:"text-copy-14",id:f,children:["Paste a valid commit reference to create a new deployment in addition to those auto-generated from"," ",(0,t.jsx)("span",{className:"text-copy-14-mono",children:(0,g.getRepoFromLink)(p,{includeOrg:!0})}),"."]}),(0,t.jsx)(c.Spacer,{}),(0,t.jsx)(C,{"aria-errormessage":et?b:void 0,autoCapitalize:"none",bypassCasing:!0,disabled:X,error:et?"yes":null,label:"Commit or Branch Reference",loading:D,onChange:e=>{let{value:t}=e.target,i=t.trim();if(""===i){E(""),M(!1),k(i),S(i);return}v!==i&&(E(""),M(!0),Z(i),S(i))},onPaste:e=>{Z.cancel();let t=e.clipboardData.getData("text");t&&v===t||(E(""),M(!0),Q())},placeholder:H(p),showErrorMessage:!1,size:"small",state:ee,value:w}),(0,t.jsx)(c.Spacer,{y:.5}),"success"===ee||D||0!==w.length?null:(0,t.jsx)(o.Scroller,{height:0===Y.length?"0px":"66px",overflow:"x",scrollerClassName:"mx-[-4px] px-[1px]",width:"100%",children:(0,t.jsx)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-initial p-1",children:[p.productionBranch||"main",...Y.filter(e=>e!==p.productionBranch)].map(e=>(0,t.jsx)(V,{label:e,onClick:()=>{k(e),S(H(p,e))}},e))})}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[W?.multiBranches&&W.multiBranches.length>0?(0,t.jsx)(I,{branchName:N,isProductionDeployment:ei}):null,et?(0,t.jsx)("div",{className:"flex flex-row items-stretch justify-start flex-initial min-h-[66px] pt-2",children:(0,t.jsx)(R,{id:b,children:n})}):null,D||!W||"sha"!==W.requestedBy||W.branch?null:(0,t.jsx)(r.Note,{fill:!0,type:"secondary",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"Branch could not be determined."}),(0,t.jsx)("p",{className:"text-copy-14 text-inherit",children:"Please select the branch you would like to deploy to."})]})}),D||"success"===ee?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P,{branchName:W?.requestedBy!=="sha"||W.branch?W?.branch:(0,t.jsx)(j.BranchSearchCombobox,{comboboxSize:"small",includeProductionBranch:!0,onSelect:e=>{null===e?E(""):E(e)},placeholder:"Select branch…",project:{id:h,link:p},skeletonStyle:{margin:"0.4rem 0",height:"2.0rem"},value:N}),commitMessage:W?.commitMessage,commitSha:W?.sha,createdAt:W?.commitDate,isProductionDeployment:N?ei:void 0,loading:D}),W?.recentDeploymentId?(0,t.jsx)(A,{deploymentId:W.recentDeploymentId,isProductionDeployment:ei}):null]}):null]})]})]}),(0,t.jsxs)(a.Modal.Actions,{children:[(0,t.jsx)(a.Modal.Action,{onClick:m,type:"secondary",children:"Cancel"}),(0,t.jsx)(a.Modal.Action,{disabled:!["success","error"].includes(ee)||!N||!W?.sha,loading:X,onClick:()=>{W?.sha&&J({sha:W.sha,branch:N||W.branch})},children:"Create Deployment"})]})]})}function q(e){let{connectedAt:i,projectLink:l}=e,n=(0,p.useAgo)(i,{justNowLabel:"just now"});return(0,t.jsx)(s.Entity,{left:(0,t.jsx)(x.default,{gitType:l.type,height:32,width:32}),padding:0,children:(0,t.jsx)(s.Entity.Content,{description:(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Connected ",n]}),title:(0,t.jsxs)(u.Link,{className:"inline-flex max-w-full items-center [&>svg]:min-w-4",href:(0,f.getGitRepoUrlFromLink)(l),tab:!0,variant:"primary",children:[(0,t.jsx)("span",{className:"geist-ellipsis",children:(0,g.getRepoFromLink)(l,{includeOrg:!0})}),(0,t.jsx)(c.Spacer,{inline:!0,x:.2}),(0,t.jsx)(m.ExternalSmall,{})]})})})}function V(e){let{label:i,onClick:l}=e;return(0,t.jsx)(n.Button,{onClick:l,prefix:(0,t.jsx)(h.GitBranch,{size:14,style:{transform:"translateX(2px)"}}),shape:"rounded",size:"small",type:"secondary",typeName:"button",children:(0,t.jsx)("span",{className:"text-copy-14-mono",children:i})})}e.s(["GitDeploymentTriggerModal",()=>G],4095738),e.s([],9204765)},492520,9172735,e=>{"use strict";var t=e.i(7909933),i=e.i(5802506);function l(e){let{data:l,isLoading:n}=(0,t.default)(e?"/api/feature-flags/deployment-outage-banner":null,e=>fetch(e).then(e=>e.json()),{async onError(e){await (0,i.captureError)(e)}}),s="github-limited"===e?"github":e,a=s?l?.providers?.[s]:void 0;return s&&a?.enabled?{data:{link:a.learnMoreLink||"https://www.vercel-status.com",customMessage:a.customMessage||void 0,isVercelOnly:l?.showToVercelianOnly??!1},isLoading:n}:{data:null,isLoading:n}}function n(e){let l=e.length>0,{data:n,isLoading:s}=(0,t.default)(l?"/api/feature-flags/deployment-outage-banner":null,e=>fetch(e).then(e=>e.json()),{async onError(e){await (0,i.captureError)(e)}}),a=n?.providers?.marketplace;if(a?.enabled&&a.affectedSlugs?.length){let t=new Set(a.affectedSlugs);if(e.some(e=>t.has(e)))return{data:{link:a.learnMoreLink||void 0,customMessage:a.customMessage||void 0,showRedeployCta:a.showRedeployCta,isVercelOnly:n?.showToVercelianOnly??!1},isLoading:s}}return{data:null,isLoading:s}}e.s(["useDeploymentOutageBanner",()=>l,"useMarketplaceOutageBanner",()=>n],492520);var s=e.i(8711407),a=e.i(762945),r=e.i(57106),o=e.i(1335111);function c(e){let{actionOnClick:t,gitType:i,link:l,customMessage:n,hideAction:c=!1,isVercelOnly:d=!1}=e;if(!i&&!n)return null;let u=i?function(e){switch(e){case"github":return"GitHub";case"gitlab":return"GitLab";case"bitbucket":return"Bitbucket";default:return""}}(i):"",m=u?`Automatic deployments from ${u} are temporarily unavailable. You can manually create a new deployment.`:"",h=n||m,p=d?`[Vercel-only] ${h}`:h,x=(0,s.jsxs)(s.Fragment,{children:[p,l?(0,s.jsxs)(s.Fragment,{children:[" ",(0,s.jsx)(r.Link,{external:!0,href:l,children:"Learn more"})]}):null]});return(0,s.jsx)(o.CompatBanner,{callToAction:!c&&t?{label:"Create Deployment",onClick:t}:void 0,icon:(0,s.jsx)(a.Warning,{className:"shrink-0"}),label:x,variant:"warning",sticky:!1})}e.s(["OutageBanner",()=>c],9172735)}]);

//# debugId=52507dd8-6386-56d3-19d6-14ece1e54d4d
//# sourceMappingURL=b57225893b12a09c.js.map
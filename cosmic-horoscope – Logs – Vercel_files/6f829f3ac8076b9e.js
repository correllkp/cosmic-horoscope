;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="db97e271-3668-3318-90a5-2607ef479dcc")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9263987,e=>{e.v({bounce:"deploying-module__iZpPmG__bounce",buttonsContainer:"deploying-module__iZpPmG__buttonsContainer",chevron:"deploying-module__iZpPmG__chevron",commitMessage:"deploying-module__iZpPmG__commitMessage",commitMessageContainer:"deploying-module__iZpPmG__commitMessageContainer",error:"deploying-module__iZpPmG__error",header:"deploying-module__iZpPmG__header",logs:"deploying-module__iZpPmG__logs",logsError:"deploying-module__iZpPmG__logsError",logsText:"deploying-module__iZpPmG__logsText",logsTimestamp:"deploying-module__iZpPmG__logsTimestamp",panel:"deploying-module__iZpPmG__panel",pop:"deploying-module__iZpPmG__pop",root:"deploying-module__iZpPmG__root",slideDown:"deploying-module__iZpPmG__slideDown",slideUp:"deploying-module__iZpPmG__slideUp",step:"deploying-module__iZpPmG__step",warning:"deploying-module__iZpPmG__warning"})},2148480,e=>{"use strict";var t=e.i(8711407),r=e.i(2573600),a=e.i(2111701),i=e.i(9722978),o=e.i(8248823),s=e.i(1991452),n=e.i(2504781),l=e.i(9318197),u=e.i(455575),c=e.i(57106),d=e.i(1176592),m=e.i(119294),p=e.i(6352514),f=e.i(8042625),g=e.i(277234),y=e.i(4244280),h=e.i(5338940),x=e.i(5140444),S=e.i(3322724),v=e.i(4787991),P=e.i(6038905),b=e.i(2695633);e.i(5224197);var j=e.i(7442785),w=e.i(855127),_=e.i(6060673),C=e.i(5466001),T=e.i(2574789),E=e.i(9375869),R=e.i(9263987);function A(e){let A,{flow:N,deployment:I,mutateDeployment:k,dispatch:D,isVercelTutor:O,vercelTutorPrUrl:M,clonedFrom:L,flowId:G,microfrontendsGroupId:$}=e,z=(0,u.useToasts)(),F=(0,s.useRouter)(),{active:q}=(0,P.useCardContext)(),[U,B]=(0,d.useState)(!1),{expandedSteps:V,setExpandedSteps:Z}=(0,w.useExpandedSteps)(I),{team:Y}=(0,h.useTeam)(),{user:H}=(0,x.useUser)(),W=(0,d.useCallback)(async()=>{B(!0);try{let e=await (0,g.fetchAPI)(`${(0,y.API_DEPLOYMENTS)("v12")}/${I?.id}/cancel${(0,f.encode)({teamId:I?.team?.id})}`,{method:"PATCH",throwOnHTTPError:!0});"CANCELED"===e.readyState&&(z.success("Deployment canceled."),(0,a.mutate)(I?.id??""),"import"===N&&D&&D({type:"SET_DEPLOYING",deploying:!1}))}catch(e){z.error((0,o.errorToString)(e))}finally{B(!1)}},[I,z,D,N]),J=I&&["ERROR","CANCELED","READY"].includes(I.readyState)||!q;I?.meta?.githubDeployment?A=(0,b.getGithubMetaInfo)(I.meta):I?.meta?.gitlabDeployment?A=(0,b.getGitlabMetaInfo)(I.meta):I?.meta?.bitbucketDeployment&&(A=(0,b.getBitbucketMetaInfo)(I.meta));let{data:Q}=(0,_.useProject)(I?.projectId),X=(0,v.useNewProjectLink)(),{mutate:K}=(0,C.useRemainingEligibleProjects)(),ee=(0,T.useLogImportProgressEvent)();(0,d.useEffect)(()=>{F.prefetch(`${X}/success`)},[F,X]);let et=(0,d.useCallback)(()=>{m.analytics.track(p.AnalyticsEvent.PROJECT_CREATION_SUCCESS,{version:3,flow:N}),m.analytics.track(p.AnalyticsEvent.CREATE_PROJECT,{onboarding:"true"===F.query.onboarding});let e=F.query.remainingProjects,t=F.query.totalProjects;"string"==typeof e&&"string"==typeof t&&ee(Number.parseInt(e)-1,Number.parseInt(t),"import");let a=(0,r.stringify)({"auto-redirect":!0,"developer-id":F.query["developer-id"],"external-id":F.query["external-id"],"redirect-url":F.query["redirect-url"],branch:Q?.link?.productionBranch??"master",deploymentUrl:I?.url??"",projectName:Q?.name??"",s:F.query.s??A?.branchUrl,gitOrgLimit:F.query.gitOrgLimit,hasTrialAvailable:F.query.hasTrialAvailable,totalProjects:F.query.totalProjects,...O?{"vercel-tutor":!0}:{},...M?{"vercel-tutor-pr-url":M}:{},...L?{"cloned-from":L}:{},...G?{"flow-id":G}:{},..."1"===F.query.microfrontends?{microfrontends:"1"}:{},...$?{microfrontendsGroupId:$}:{}});K().then(()=>{F.push(`${X}/success?${a}`)})},[L,N,F,Q?.link?.productionBranch,Q?.name,I?.url,A?.branchUrl,K,ee,X,O,M,G,$]),er=!!A,ea=(0,S.useIsMobile)(),ei=I?.readyState==="ERROR",eo=(0,d.useMemo)(()=>{let e=`/${Y?.slug??H?.username??""}`;return`${e}/${Q?.name??""}`},[Q?.name,Y,H?.username]),es=(0,E.useDeploymentLink)(I);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.DeploySteps,{creationFlow:!0,deployment:I,expandedSteps:V,mutateDeployment:k,onComplete:et,onExpandedStepsChange:e=>Z(e),teamSlug:Y?.slug,context:"new-project-flow"}),(0,t.jsx)(l.Spacer,{expand:!0}),(0,t.jsxs)("div",{className:(0,i.clsx)("flex flex-col items-stretch gap-4 flex-initial",ea?"flex-col":"flex-row",er&&!ea?"justify-between":"justify-center"),children:[A?(0,t.jsxs)("div",{className:(0,i.clsx)("flex flex-row items-center justify-start gap-2 flex-1",R.default.commitMessageContainer),children:[(0,t.jsx)(c.Link,{external:!0,href:A.commitUrl}),(0,t.jsxs)("span",{className:`text-copy-16 font-normal m-0 ${(0,i.clsx)(R.default.commitMessage)}`,style:{color:q?"var(--accents-5)":"var(--accents-3)"},title:A.commitMessage,children:[A.commitMessage.split("\n")[0]," - ",A.sha.slice(0,6)]})]}):(0,t.jsx)("div",{style:{height:21}}),ei||"import"===N?(0,t.jsxs)("div",{className:(0,i.clsx)("flex flex-col items-stretch justify-end gap-2 flex-initial md:flex-row",R.default.buttonsContainer),children:[ei?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.ButtonLink,{href:eo,size:"small",type:"secondary",children:"Go to Project"}),(0,t.jsx)(c.ButtonLink,{href:es,size:"small",children:"Inspect Deployment"})]}):null,ei||"import"!==N?null:(0,t.jsx)(n.Button,{disabled:J,loading:U||I?.readyState==="READY",onClick:()=>void W(),size:"small",type:"secondary",children:I?.readyState==="READY"?"Completing Deployment…":"Cancel Deployment"})]}):null]})]})}e.s(["default",()=>A])},8492314,e=>{"use strict";var t=e.i(1176592),r=e.i(6625227),a=e.i(100247),i=e.i(7783521),o=e.i(229875);function s(e){let[s,n]=(0,t.useState)(0),l=(0,r.default)(e,{refreshInterval:s},{automaticAliases:!0}),{data:u,mutate:c}=l,d=u?.readyState,m=u?.aliasAssigned||"ERROR"===d||"CANCELED"===d,p=(0,t.useMemo)(()=>(0,o.withThrottle)(e??"",()=>{c()}),[e,c]),{isListening:f}=(0,i.useDeploymentStatusPing)(m?void 0:u,p),{areChecksRunning:g,areDomainsAssigning:y}=(0,a.getDeploymentStatus)(u),h=(!u||m)&&!g&&!y||f,x=u?.readyState==="QUEUED";return(0,t.useEffect)(()=>{x?n(1e3):n(3e3*!h)},[h,x]),l}e.s(["useNewDeploymentInterval",()=>s])},4963367,e=>{e.v({deployCard:"deploy-card-module__wIQjha__deployCard"})},9187364,e=>{"use strict";var t=e.i(8711407),r=e.i(1176592),a=e.i(1991452),i=e.i(8735244),o=e.i(6232213),s=e.i(7218483),n=e.i(100247),l=e.i(2148480),u=e.i(6038905),c=e.i(8492314),d=e.i(4963367),m=e.i(4422059);function p(e){let{deploymentId:p,flow:f,resetDeploying:g,isVercelTutor:y,vercelTutorPrUrl:h,clonedFrom:x,flowId:S,microfrontendsGroupId:v,...P}=e,b=(0,a.useRouter)(),{data:j,mutate:w}=(0,c.useNewDeploymentInterval)(p);(0,r.useEffect)(()=>{if(p){let e=b.query.deploymentId,t=Array.from(new Set(Array.isArray(e)?e.concat([p]):[e??p,p]));b.replace({query:{...b.query,deploymentIds:t}},void 0,{shallow:!0})}},[p]);let{areChecksRunning:_,areDomainsAssigning:C}=(0,n.getDeploymentStatus)(j),T=(0,s.useAgo)(j?.createdAt,{justNowThreshold:0}),E=(0,r.useMemo)(()=>{if(!j)return"Preparing deployment…";switch(j.readyState){case"QUEUED":return(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(i.Spinner,{size:16}),"Deployment queued..."]});case"READY":if(_||C)return(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(i.Spinner,{size:16}),"Deployment started ",T,"..."]});return"Deployment completed.";case"ERROR":return"Deployment failed with error.";case"CANCELED":return"Deployment canceled.";default:return(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(i.Spinner,{size:16}),"Deployment started ",T,"..."]})}},[j,T,_,C]);return!function(e){let{callback:t,deployment:a}=e,i=(0,m.usePrevious)(a?.id),o=(0,m.usePrevious)(a?.readyState);(0,r.useEffect)(()=>{a?.id&&i&&o&&i===a.id&&o!==a.readyState&&("CANCELED"===a.readyState||"ERROR"===a.readyState)&&t(a.readyState)},[a?.readyState,t,a?.id,i,o])}({callback:(0,r.useCallback)(()=>{(0,o.postToStatsigClient)({events:[{eventName:`${f}_deploy_error`}]}),g?.()},[f,g]),deployment:j}),(0,t.jsx)(u.default,{className:d.default.deployCard,subtitle:E,title:"Deployment",...P,children:(0,t.jsx)(l.default,{deployment:j,flow:f,isVercelTutor:y,mutateDeployment:w,vercelTutorPrUrl:h,clonedFrom:x,flowId:S,microfrontendsGroupId:v})})}e.s(["default",()=>p])},7374478,e=>{"use strict";var t=e.i(8711407),r=e.i(9739627);function a(){return(0,t.jsx)(r.Image,{alt:"Slash Divider",height:40,srcDark:"https://assets.vercel.com/image/upload/v1689795055/front/new/slash-divider-dark.svg",srcLight:"https://assets.vercel.com/image/upload/v1689795055/front/new/slash-divider-light.svg",width:40})}e.s(["SlashDivider",()=>a])},7691989,e=>{"use strict";var t=e.i(8042625),r=e.i(277234),a=e.i(4244280);e.s(["displayError",0,e=>e?.code==="tarball_not_found"?"Your codebase could not be retrieved. Please check that your repository is not empty.":e?.keyword==="additionalProperties"?"Additional property `"+e.params?.additionalProperty+"` is not allowed. Please check the `vercel.json` or `now.json` file in your repository.":e?.message||e?.toString?.(),"getProject",0,e=>{let{id:i,teamId:o}=e;return(0,r.fetchAPI)(`${a.API_PROJECTS}/${i}${(0,t.encode)({teamId:o})}`,{throwOnHTTPError:!0})},"getProjectInfo",0,e=>{let{name:i,teamId:o}=e;return(0,r.fetchAPI)(`${a.API_PROJECTS}/${encodeURIComponent(i||"")}${(0,t.encode)({teamId:o,deploymentInfo:0})}`,{throwOnHTTPError:!0})}])},5394280,e=>{"use strict";var t=e.i(8042625),r=e.i(277234),a=e.i(4244280);async function i(e){let{type:i,source:o,target:s,teamId:n,branch:l}=e;return(0,r.fetchAPI)(`${a.API_INTEGRATION_CONTROLLER}/push-to-repo${(0,t.encode)({teamId:n})}`,{method:"POST",body:JSON.stringify({type:i,source:o,repo:s,branch:l}),throwOnHTTPError:!0,wrapErrorsLegacy:!0})}e.s(["pushRepo",()=>i])},1801538,e=>{"use strict";function t(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[r,a]of e)if(!Object.is(a,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let r of e)if(!t.has(r))return!1;return!0}let r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(let a of r)if(!Object.prototype.hasOwnProperty.call(t,a)||!Object.is(e[a],t[a]))return!1;return!0}e.s(["shallow",()=>t])},5680277,e=>{"use strict";var t=e.i(8914449),r=e.i(1176592),a=e.i(1801538);let i={loading:!1,gitType:void 0,repoNameStates:{},isPrivate:!0,gitError:null,isTeamRepo:!1},o=(0,t.create)(e=>({...i,setLoading:t=>e(e=>({...e,loading:t})),setGitType:t=>e(e=>({...e,gitType:t})),setRepoNameStates:t=>{e(e=>{let r=t(e.repoNameStates);return{...e,repoNameStates:r}})},setIsPrivate:t=>e(e=>({...e,isPrivate:t})),setGitError:t=>e(e=>({...e,gitError:t})),reset:()=>e(i),setIsTeamRepo:t=>e({isTeamRepo:t})}));e.s(["useGitInputStore",0,o,"useNewNamespace",0,()=>{let e=o((0,r.useCallback)(e=>e.gitType,[]),a.shallow),t=o((0,r.useCallback)(e=>e.repoNameStates,[]),a.shallow)[e||""];return Array.isArray(t)?t[0]:null},"useNewRepo",0,()=>{let e=o((0,r.useCallback)(e=>e.gitType,[]),a.shallow),t=o((0,r.useCallback)(e=>e.repoNameStates,[]),a.shallow)[e||""];return Array.isArray(t)?t[1]:null}])},5432439,e=>{"use strict";var t=e.i(9385057),r=e.i(1176592),a=e.i(1801538),i=e.i(8248823),o=e.i(134877),s=e.i(7691989),n=e.i(5680277);function l(){let{setLoading:e,setGitError:l}=(0,n.useGitInputStore)((0,r.useCallback)(e=>({setLoading:e.setLoading,setGitError:e.setGitError}),[]),a.shallow),u=(0,n.useNewRepo)();return async(r,a)=>{if(!u&&!a)return;let n=(0,t.customAlphabet)("123456789abcdefghijklmnopqrstuvwxyz",4),c=u?u.slice(0,95):"",d=a??c;try{await (0,s.getProject)({id:d,teamId:r}),d=`${d}-${n()}`}catch(t){if((0,o.isAPIError)(t)&&"not_found"!==t.code){e(!1),l((0,i.normalizeError)(t));return}}return d}}e.s(["useGetProjectName",()=>l])},6475061,8334396,e=>{"use strict";var t=e.i(8711407),r=e.i(1176592),a=e.i(1875382),i=e.i(5338940),o=e.i(5140444);function s(e){let[t,a]=(0,r.useState)(!1),i=(0,r.useRef)(!1),o=(0,r.useRef)(e),s=(0,r.useCallback)(r=>{a(r),i.current=t,o.current=e},[e,t]);return(0,r.useMemo)(()=>({data:t?o.current:e,frozen:t,setFrozen:s}),[e,t,s])}var n=e.i(5255926);function l(){return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,t.jsx)(n.Skeleton,{className:"flex-1",height:"68px"}),(0,t.jsx)(n.Skeleton,{className:"flex-1",height:"68px"})]}),(0,t.jsx)(n.Skeleton,{height:"24px",width:"auto"}),(0,t.jsx)(n.Skeleton,{height:"40px",width:"auto"})]})}var u=e.i(6079422),c=e.i(6489459),d=e.i(455575),m=e.i(1991452),p=e.i(5523169);e.i(7197081);var f=e.i(626404),g=e.i(6352514),y=e.i(119294),h=e.i(8631221),x=e.i(3196486),S=e.i(1628687);let v=e=>{y.analytics.track(g.AnalyticsEvent.NEW_FLOW_CONVERTED,e),(0,x.sendToSnowflake)(h.Topic.VercelAppV0NewFlowConverted,{conversion_type:(0,S.snowflakeify)(e.conversionType),source:e.source,actor_id:e.actorId,team_id:e.teamId,team_created_at:(0,S.floor)(e.teamCreatedAt),prior_plan:(0,S.snowflakeify)(e.priorPlan),new_plan:(0,S.snowflakeify)(e.newPlan),cart_total:(0,S.floor)(e.cartTotal)},"vercel-app")};var P=e.i(9588822),b=e.i(7846892),j=e.i(8378310),w=e.i(2401140),_=e.i(4736806),C=e.i(1450448),T=e.i(5786585);let E=(0,P.withStripe)(function(e){let{user:a,active:i,source:o,teamManager:s,close:n,continueAction:l,isProTrialAndRequirePayment:u}=e,{team:c,members:d,cartTotal:m,setCartTotal:p,isSubmitting:f,setIsSubmitting:g,scrollToRef:y,paymentMethodInfo:h,showSkeleton:x,onBillingFormReady:S,submit:v,makeDefaultBillingAddress:P,elements:E,billingFormProps:R,addressError:A,setAddressError:N}=(0,C.usePaymentInfoStep)({teamManager:s}),[I,k]=(0,r.useState)(),[D,O]=(0,r.useState)({}),[M,L]=(0,r.useState)(),G=(0,T.usePaymentInfoContinue)({type:"new-flow",team:c,setIsSubmitting:g,submit:v,makeDefaultBillingAddress:P,elements:E,setAddressError:N,cartTotal:m,continueAction:l,paymentMethodInfo:h,taxId:M,teamManager:s,unparsedAddress:D,setSubmissionError:k});return(0,t.jsx)(b.SheetWrapper,{open:i,onClose:n,teamManager:s,children:(0,t.jsx)(w.SheetStepWrapper,{hideFooter:x,title:(0,t.jsx)(j.DefaultTitle,{teamManager:s,isProTrial:u}),defaultCancelText:"Cancel",defaultContinueText:l.text,cancelButton:{text:"Cancel",onClick:n,disabled:f},continueButton:{text:l.text,onClick:()=>void G(),disabled:"loading"===h.type},loading:f,onCancel:n,onContinue:()=>void G(),children:(0,t.jsx)(_.PaymentInfoShared,{user:a,team:c,teamManager:s,setCartTotal:p,members:d,source:o,showSkeleton:x,paymentMethodInfo:h,makeDefaultBillingAddress:P,onBillingFormReady:S,billingFormProps:R,isSubmitting:f,addressError:A,scrollToRef:y,type:"new-flow",setUnparsedAddress:O,setTaxId:L,submissionError:I,continueButtonText:l.text,isProTrialAndRequirePayment:u})})})});var R=e.i(2504781),A=e.i(8248823),N=e.i(4976875),I=e.i(3238154),k=e.i(8668551);function D(e){let{teamManager:a,planSelector:i,continueAction:o,frozen:s}=e,{validationError:n,setValidationError:l,validate:u,onBlur:c}=(0,N.useTeamNameInput)({teamManager:a}),[d,m]=(0,r.useState)(),[p,f]=(0,r.useState)(!1),g=(0,r.useCallback)(async()=>{m(void 0),f(!0);try{let e=u();if(e)return void l(e);await o.onContinue()}catch(e){m((0,A.normalizeError)(e).message)}finally{f(!1)}},[o,u,l]);return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)(I.TeamNameInput,{validationError:n,onBlur:c,teamManager:a,isNewProjectFlow:!0,frozen:s}),(0,t.jsx)(k.SelectorSection,{planSelector:i,errorMessage:d,className:"flex flex-col gap-3",frozen:s}),(0,t.jsx)(R.Button,{loading:p||s,onClick:()=>void g(),typeName:"button",children:o.text})]})}function O(e){let{user:r,continueAction:a,teamManager:i,stepState:o,planSelector:s,source:n,frozen:l,isProTrialAndRequirePayment:u}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D,{continueAction:a,frozen:l,planSelector:s,teamManager:i}),(0,t.jsx)(E,{user:r,active:"payment-info"===o.step,close:()=>{o.gotoStep("select-team-and-plan")},continueAction:a,source:n,teamManager:i,isProTrialAndRequirePayment:u})]})}var M=e.i(2762499),L=e.i(1347988),G=e.i(4597921),$=e.i(4429918),z=e.i(8851095),F=e.i(1108230),q=e.i(3889303);function U(e){return(0,t.jsx)(z.SafeSuspense,{error:(0,t.jsx)(V,{...e,proTrialRequirePaymentFlagVal:null,proTrialRequirePaymentFlagRule:null}),loading:null,children:(0,t.jsx)(B,{...e})})}function B(e){let{value:r,rule:a}=(0,G.useServerFlag)("card-required-trial",(0,$.statsigOption)(null));return(0,t.jsx)(V,{...e,proTrialRequirePaymentFlagRule:a,proTrialRequirePaymentFlagVal:r})}function V(e){let{user:i,teamManager:o,planSelector:s,source:n,onConversionError:l,onConversionSuccess:u,onConversionStart:c,mutate:g,frozen:y,setFrozen:h,proTrialRequirePaymentFlagVal:x,proTrialRequirePaymentFlagRule:S}=e,P=(0,f.useSteps)({steps:["select-team-and-plan","payment-info"],workflowName:"new-flow-upgrade"}),b=(0,m.useRouter)(),j=(0,a.useSearchParams)(),w=(0,a.usePathname)(),_=(0,r.useRef)(null),C=!!(x&&"pro-trial"===s.selectedPlan),T=(0,M.useCreateTeam)({teamManager:o,onConversionStart:c,planSelector:s,mutate:g,onConversionError:l,router:b,customCreateTeamApiSource:"new-flow-upgrade",customPostCreationFlow:e=>{let{team:t,cartTotal:r,selectedPlan:a}=e;_.current=t,v({conversionType:"create",source:n,actorId:i.uid,teamId:t.id,teamCreatedAt:t.createdAt,priorPlan:"hobby",newPlan:a,cartTotal:r});let o=new URLSearchParams(j?.toString());o.set("teamSlug",t.slug),b.replace(`${w}?${o.toString()}`,void 0,{scroll:!1}),d.toasts.success({text:"Your team has been created."})}}),E=(0,L.useUpgradeTeam)({teamManager:o,onConversionStart:c,planSelector:s,mutate:g,onConversionError:l,router:b,source:n,customPostUpgradeFlow:e=>{let{team:t,selectedPlan:r,cartTotal:a}=e;v({conversionType:"upgrade-existing",source:n,actorId:i.uid,teamId:t.id,teamCreatedAt:t.createdAt,priorPlan:"hobby",newPlan:r,cartTotal:a})},awaitMutate:!0}),R="pro"===s.selectedPlan||C,A=(0,r.useMemo)(()=>"pro-trial"===s.selectedPlan?"Start Pro Trial and Deploy":"select-team-and-plan"===P.step&&R?"Continue":"create"===o.userIntent?"Create Team and Deploy":"Upgrade and Deploy",[R,P.step,o.userIntent,s.selectedPlan]),N=(0,r.useCallback)(async e=>{if("pro-trial"===s.selectedPlan&&(0,q.proTrialRequirePaymentExposure)({proTrialRequirePaymentFlagVal:x,proTrialRequirePaymentFlagRule:S,metadata:{userIntent:o.userIntent,step:P.step,source:n,type:"new-flow",proTrialRequirePaymentFlagVal:x?.toString()||"null"}}),"select-team-and-plan"===P.step&&R)return void P.gotoStep("payment-info");h(!0),await c();try{"create"===o.userIntent?await T(e):await E(e?{upgradeTimingOption:"now",...e}:{upgradeTimingOption:"now",cartTotal:0}),await u(_.current??void 0),(0,F.trackConversionOnStatsig)({priorPlan:"hobby",newPlan:s.selectedPlan,type:o.userIntent,source:n})}catch(e){throw h(!1),await l().catch(p.default),e}},[T,R,l,c,u,h,P.gotoStep,P.step,o.userIntent,E,n,s.selectedPlan,x,S]),I=(0,r.useMemo)(()=>({onContinue:N,text:A}),[A,N]);return(0,t.jsx)(O,{user:i,continueAction:I,frozen:y,planSelector:s,source:n,stepState:P,teamManager:o,isProTrialAndRequirePayment:C})}function Z(e){let{user:r,team:a,disallowHobby:i,source:o,onConversionError:n,onConversionSuccess:d,onConversionStart:m,mutate:p,frozen:f,setFrozen:g}=e,{data:y,frozen:h,setFrozen:x}=s((0,c.useTeamManagerFromTeam)({team:a})),{data:S,frozen:v,setFrozen:P}=s((0,u.usePlanSelector)({teamManager:y,disallowHobby:i}));return S.loading?(0,t.jsx)(l,{}):(0,t.jsx)(U,{frozen:f||h||v,mutate:p,onConversionError:n,onConversionStart:m,onConversionSuccess:d,planSelector:S.data,setFrozen:e=>{g(e),x(e),P(e)},source:o,teamManager:y,user:r})}let Y=()=>Promise.resolve();function H(e){let{selectedTeamSlug:r,disallowHobby:a,source:n,onConversionError:u=Y,onConversionSuccess:c=Y,onConversionStart:d=Y}=e,{user:m,isLoading:p,mutate:f}=(0,o.useUser)(),{team:g,isLoading:y,mutate:h}=(0,i.useTeam)(r),{data:x,frozen:S,setFrozen:v}=s(g),P=async()=>{await Promise.all([f(),h()])};return p||y?(0,t.jsx)(l,{}):!m||x&&x.billing?.plan!=="hobby"?null:(0,t.jsx)(Z,{disallowHobby:a,frozen:S,mutate:P,onConversionError:u,onConversionStart:d,onConversionSuccess:c,setFrozen:v,source:n,team:x??void 0,user:m})}let W=e=>{switch(e){case"github":return"GitHub organization";case"gitlab":return"GitLab group";case"bitbucket":return"Bitbucket workspace";default:return"organization"}};function J(e){let{disallowHobby:i,selectedTeamSlug:o,onSubmit:s,setFreezeUpgradeUI:n}=e,l=(0,a.usePathname)(),u=(0,r.useMemo)(()=>l?l.includes("import")?"import":l.includes("clone")?"new-clone":l.replace(/\/|\s/g,"-"):"unknown",[l]),c=(0,r.useMemo)(()=>{if(""!==o)return o??void 0},[o]);return(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:(0,t.jsx)(H,{disallowHobby:i,onConversionError:()=>Promise.resolve(n(!1)),onConversionStart:()=>Promise.resolve(n(!0)),onConversionSuccess:s,selectedTeamSlug:c,source:u})})}e.s(["getGitProviderNameAndOrg",0,W],8334396),e.s(["UpgradeCTA",()=>J,"useUpgradeCTA",0,e=>{let{isCreatingTeam:a,isTeamRepo:o,isPrivate:s,gitType:n,selectedTeamSlug:l}=e,{teams:u,team:c,isReady:d}=(0,i.useTeam)(l),m=s&&o,p=c?.billing&&"hobby"!==c.billing.plan,f=d&&u?.length===0,g=m&&!p&&!!c?.billing||a||f,[y,h]=(0,r.useState)(!1),x=g||y;return{upgradeMessage:x?(0,t.jsxs)(t.Fragment,{children:["Deploying from a ",s?"private ":"",W(n)," requires a Vercel Pro plan. Switch to an existing Pro team or"," ",a?"create a new one":(0,t.jsxs)(t.Fragment,{children:["upgrade"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:c?.name})]})," ","to continue."]}):null,showUpgradeCTA:x,setFreezeUpgradeUI:h,disallowHobby:m}}],6475061)},6913536,e=>{"use strict";var t=e.i(6532114);function r(e,r,a){if(null===e)return"";let i=(0,t.getRepoTree)(e.type);return`${e.url}${a?`${e.subdir?"":`/${i}/${e.branch||r||"main"}`}/${a}`:""}`}e.s(["default",()=>r])},8276950,e=>{e.v({comboboxLabel:"team-selector-module__POX1Da__comboboxLabel",input:"team-selector-module__POX1Da__input",tooltip:"team-selector-module__POX1Da__tooltip"})},4909757,e=>{"use strict";var t=e.i(8711407),r=e.i(1176592),a=e.i(6881349),i=e.i(5468328),o=e.i(4585051),s=e.i(5255926),n=e.i(5756088),l=e.i(5883567),u=e.i(5338940),c=e.i(8977282),d=e.i(1875382),m=e.i(5140444),p=e.i(6228447),f=e.i(4600551),g=e.i(1717203),y=e.i(7557283),h=e.i(4004502),x=e.i(2661670),S=e.i(8276950);let v="create-team-sentinel";function P(e){let{gitProvider:i,gitNamespaceId:o,gitNamespaceSlug:n,disabled:c,onChange:d,value:m,loading:p}=e,f=(0,u.useSortedTeams)(),[g,y]=(0,r.useState)(!1);return(0,t.jsx)(s.Skeleton,{show:p,style:p?{overflow:"hidden"}:void 0,children:(0,t.jsxs)(a.Combobox,{clearable:!1,"data-testid":(0,h.tid)("import-flow","team-selector","combobox-root"),disabled:c,displaySelectedSuffix:!0,noRawSelectedValue:!0,onChange:d,placeholder:"Select a Vercel Team",value:m,children:[(0,t.jsx)(a.Combobox.Input,{className:S.default.input,"data-testid":(0,h.tid)("import-flow","team-selector","combobox-value")}),(0,t.jsx)(a.Combobox.List,{children:(0,t.jsxs)(t.Fragment,{children:[f.map(e=>(0,t.jsx)(b,{disabled:c,gitNamespaceId:o,gitNamespaceSlug:n,gitProvider:i,setShowMissingPermissions:y,team:e},e.slug)),(0,t.jsx)(a.Combobox.Option,{prefix:(0,t.jsx)(l.PlusCircle,{color:"gray-900",size:16}),value:v,children:"Create a Team"}),g?(0,t.jsx)(a.Combobox.Option,{className:S.default.comboboxLabel,disabled:!0,value:"missing-permissions",children:(0,t.jsx)("p",{className:"text-copy-13",children:"Missing Permissions"})}):null]})})]})})}function b(e){let{gitProvider:s,gitNamespaceId:l,gitNamespaceSlug:u,team:c,setShowMissingPermissions:d,disabled:m}=e,h=c.permissions?(0,g.buildCan)(new Map(Object.entries(c.permissions))):()=>!0,{data:v}=(0,x.useVerifyGitExclusivity)({gitProvider:s,gitNamespaceId:l,gitNamespaceSlug:u}),P=h(y.Action.Create,y.Resource.Project),b=(0,p.getTeamLimitedBy)(c),j=1===b.length&&b.includes("mfa"),w=v&&!v.hasAccess||!P||j;(0,r.useEffect)(()=>{w&&d(!0)},[w,d]);let _=(0,r.useMemo)(()=>P?c.limited?j?"You must enable 2FA on your account to create project in this team.":"Re-authentication required.":v&&!v.hasAccess?(0,t.jsxs)(t.Fragment,{children:["This team does not have permission to deploy from"," ",(0,t.jsx)("span",{style:{fontWeight:600},children:u})," as it is a Protected Git Scope."]}):void 0:"You do not have permission to create a project in this team.",[P,v,u,c,j]);return(0,t.jsx)(i.Tooltip,{className:S.default.tooltip,position:"right",style:{display:"inherit"},text:_,children:(0,t.jsx)(a.Combobox.Option,{disabled:w,displayLast:w,label:c.name,prefix:(0,t.jsx)(o.Avatar,{size:16,teamId:c.id}),suffix:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(f.PlanBadge,{disabled:m,team:c}),_?(0,t.jsx)(i.Tooltip,{text:_,children:(0,t.jsx)(n.LockClosed,{size:16})}):null]}),value:c.slug,children:c.name})})}e.s(["TeamSelector",()=>P,"useSelectedTeamSlug",0,e=>{let{gitProvider:a,gitNamespaceId:i,gitNamespaceSlug:o}=e,{teams:s,team:n,isReady:l}=(0,u.useTeam)(),{user:f}=(0,m.useUser)(),h=(0,d.useRouter)(),S=(0,d.useSearchParams)(),P=(0,d.usePathname)(),[b,j]=(0,r.useState)(null),{can:w}=(0,g.default)(),{data:_}=(0,x.useVerifyGitExclusivity)({gitProvider:a,gitNamespaceId:i,gitNamespaceSlug:o}),C=w(y.Action.Create,y.Resource.Project);(0,r.useEffect)(()=>{if(null===b&&l&&S&&f?.defaultTeamId&&s){let e=(0,c.getScope)(),t=s.find(e=>e.id===f.defaultTeamId)?.slug,r=n?.slug??e??t;j(r??v);let a=S.get("teamSlug");if(a&&a!==r){let e=new URLSearchParams(S.toString());r?e.set("teamSlug",r):e.delete("teamSlug"),h.replace(`${P}?${e.toString()}`,{scroll:!1})}}},[s,b,S,P,h,f,n,l,j]),(0,r.useEffect)(()=>{let e=S?.get("teamSlug");if(b&&e!==b){let e=new URLSearchParams(S?.toString());b===v?e.delete("teamSlug"):(e.set("teamSlug",b),(0,c.setScope)(b)),h.replace(`${P}?${e.toString()}`,{scroll:!1})}},[b]);let T=(0,r.useCallback)(e=>{let t=s?.find(t=>t.slug===e);if(t?.limited){let e=new URLSearchParams(S?.toString());return e.set("teamSlug",t.slug),(0,p.requireAuthentication)({slug:t.slug,next:`${P}?${e.toString()}`,push:e=>{h.push(e)}})}j(e)},[j,s,S,P,h]),E=(0,r.useMemo)(()=>{if(b&&b===n?.slug){if(!C)return(0,t.jsxs)(t.Fragment,{children:["You do not have the required permission to create a project in"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:n.name}),". Select a different Vercel team to continue."]});if(_&&!_.hasAccess)return(0,t.jsxs)(t.Fragment,{children:["This team does not have permission to deploy from"," ",(0,t.jsx)("span",{style:{fontWeight:600},children:o})," as it is a Protected Git Scope. Select a different Vercel team, or change the Git scope to continue."]})}},[C,_,o,b,n?.slug,n?.name]);return{isSelectedTeamSlugReady:"string"==typeof b,isCreatingTeam:b===v,selectedTeamSlug:b,onTeamSlugChange:T,selectedTeamError:E}}])},2138061,e=>{"use strict";let t=/^(?!.*---)[a-z0-9-_.]+$/;function r(e){return t.test(e)&&e.length>0&&e.length<=100}e.s(["PROJECT_NAME_ERROR_MESSAGE",0,"A Project name can only contain up to 100 lowercase letters, digits, and the characters '.', '_', and '-'.","isValidProjectName",()=>r,"sanitizeProjectName",()=>function e(t){return r(t)?t:e(t.slice(0,100).toLowerCase().replace(/[^a-z0-9-_.]|---/g,"-"))}])},3495961,1315623,6979900,e=>{"use strict";var t=e.i(1991452),r=e.i(5140444);function a(){let e=(0,t.useRouter)(),{data:a,isLoading:i}=(0,r.useUser)();i||a||e.replace("/new")}e.s(["useShouldRedirectToNew",()=>a],3495961);var i=e.i(8711407),o=e.i(9739627),s=e.i(6038905);function n(){return(0,i.jsx)(s.default,{active:!1,className:"relative overflow-hidden border-0 border-y border-solid border-gray-400 md:border-0",subtitle:"Once you're ready, start deploying to see the progress here…",title:"Deployment",children:(0,i.jsx)(o.Image,{alt:"Globe",className:"relative -bottom-2 -m-8 mt-4 w-[calc(100%+34px)] max-w-none",height:256,priority:!0,srcDark:"https://assets.vercel.com/image/upload/v1689795055/front/new/globe-outline-dark-2.svg",srcLight:"https://assets.vercel.com/image/upload/v1689795055/front/new/globe-outline-light.svg",width:688})})}e.s(["DeploymentPlaceholderCard",()=>n],1315623);var l=e.i(57106);function u(){return(0,i.jsxs)("div",{className:"mt-4 flex flex-col items-center gap-y-4 px-2",children:[(0,i.jsx)(l.Link,{href:"/new",type:"secondary",children:"Import a different Git Repository →"}),(0,i.jsx)(l.Link,{href:"/new/templates",type:"secondary",children:"Browse Templates →"})]})}e.s(["ImportFooter",()=>u],6979900)},2251791,e=>{"use strict";var t=e.i(7780974),r=e.i(7837522),a=e.i(7562527),i=e.i(1176592),o=e.i(9871375),s=e.i(1177040),n=e.i(9385057),l=e.i(1875382);function u(e){let t=(0,i.useRef)((0,n.nanoid)());return(0,i.useEffect)(()=>{(0,i.startTransition)(()=>{e({type:"SET_FLOW_ID_ONCE",flowId:t.current})})},[e]),t.current}function c(){let e=(0,l.useSearchParams)(),t=(0,a.useRepoQuery)(),r=t?.template===a.VERCEL_TUTOR_TEMPLATE_NAME,o=(0,i.useMemo)(()=>t?`${t.owner}/${t.name}${t.subdir?`/${t.subdir}`:""}`:void 0,[t]),s=e?.get("from")==="templates";return{isVercelTutor:r,clonedFrom:o,templateSlug:e?.get("repository-name")??void 0,isTemplate:s}}function d(){let{track:e}=(0,r.useTrackActivity)(),a=c(),{status:s,cloneRepoStatus:n,dispatch:l}=(0,o.useProjectCloneContext)(),d=(0,i.useRef)(null),m=(0,i.useRef)(n),p=u(l);(0,i.useEffect)(()=>{d.current!==s&&(d.current=s,e(t.VercelActivityAction.NewProjectCloneStatusChanged,{...a,flowId:p,status:s})),m.current!==n&&(m.current=n,e(t.VercelActivityAction.NewProjectCloneRepoStatusChanged,{...a,flowId:p,status:n}))},[p,n,a,s,e])}function m(){let{track:e}=(0,r.useTrackActivity)(),{deploying:a,dispatch:o}=(0,s.useProjectImportContext)(),n=(0,i.useRef)(null),l=u(o);(0,i.useEffect)(()=>{n.current!==a&&null!==a&&(n.current=a,e(t.VercelActivityAction.NewProjectImportDeployingChanged,{deploying:a,flowId:l}))},[a,e,l])}e.s(["useCloneTrackBaseParams",()=>c,"useCloneTrackStatusChanges",()=>d,"useImportTrackStatusChanges",()=>m])}]);

//# debugId=db97e271-3668-3318-90a5-2607ef479dcc
//# sourceMappingURL=43b2a34359e12f40.js.map
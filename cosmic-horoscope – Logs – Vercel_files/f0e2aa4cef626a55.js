;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="9aabed39-fcb9-0040-3d16-a97f788ffee8")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8587921,7873387,e=>{"use strict";var t=e.i(1176592),r=e.i(7909933),i=e.i(3924999),s=e.i(8042625),a=e.i(277234),n=e.i(4244280),o=e.i(9668517),l=e.i(5338940),d=e.i(1717203),u=e.i(7557283);let c=e=>(r,i,s)=>{let a=(0,t.useRef)(void 0),n=e(r,i,s);(0,t.useEffect)(()=>{void 0!==n.data&&(a.current=n.data)},[n.data]);let o=(0,t.useCallback)(()=>{a.current=void 0},[]);return{...n,data:void 0===n.data?a.current:n.data,isLagging:void 0===n.data&&void 0!==a.current,resetLaggy:o}};function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{search:m,limit:g,role:f,eligibleMembersForProjectId:h,sort:p="date_desc",filterByUserIds:R,includeEntitlements:v,mfaStateFilter:x,includePermissionRequests:b}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},E=arguments.length>2&&void 0!==arguments[2]&&arguments[2],M=arguments.length>3&&void 0!==arguments[3]&&arguments[3],{isReady:T,team:S}=(0,l.useTeam)(),{isLoading:I,can:L}=(0,d.default)(),P=!I&&L(u.Action.List,u.Resource.TeamFellowMembership),y=(0,o.useTeamSlug)(),A=g||20,j=(0,i.default)((e,t)=>{if(!T||!S||!P)return null;if(0===e)return`${n.API_TEAMS_MEMBERS_V3}/${S.id}/members${(0,s.encode)({sort:p,limit:A,search:m,role:f,eligibleMembersForProjectId:h,filterByUserIds:R,includeEntitlements:!!v||void 0,filterByMfaState:"all"!==x?x:void 0,includePermissionRequests:b})}`;let r=t?.pagination.nextPageCursor;return r?`${n.API_TEAMS_MEMBERS_V3}/${S.id}/members${(0,s.encode)({sort:p,limit:A,nextPageCursor:r,search:m,role:f,eligibleMembersForProjectId:h,includeEntitlements:!!v||void 0,filterByMfaState:"all"!==x?x:void 0,includePermissionRequests:b})}`:null},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),{...e,use:E?[c]:[]});(0,t.useEffect)(()=>{E&&j.resetLaggy()},[y,E]);let $=(0,t.useMemo)(()=>j.data?.flatMap(e=>e.members.slice(0,A))||[],[j.data,A]),_=(0,t.useMemo)(()=>j.data?.flatMap(e=>e.permissionRequests||[])||[],[j.data]),w=!!j.data,k=w&&0===$.length,q=!!(w&&j.data&&j.size>j.data.length),C=!!(w&&j.data&&!j.data[j.data.length-1]?.pagination?.nextPageCursor);return(0,r.default)(()=>{if(!M||!j.data||C||!T||!S)return null;let e=j.data[j.data.length-1].pagination.nextPageCursor;return`${n.API_TEAMS_MEMBERS_V3}/${S.id}/members${(0,s.encode)({sort:p,limit:A,nextPageCursor:e,search:m,role:f,eligibleMembersForProjectId:h,includeEntitlements:v,filterByMfaState:"all"!==x?x:void 0,includePermissionRequests:b})}`},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0})),[j,{members:$,permissionRequests:_.filter(e=>null!=e),initialDataLoaded:w,isEmpty:k,loadMore:()=>j.setSize(j.size+1),isLoadingMore:q,isReachingEnd:C,isLagging:j.isLagging}]}function g(){let{sort:e="date_desc",limit:t=20,filterByUserIds:i,until:o,role:c,includeEntitlements:m,includePermissionRequests:g}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{isReady:h,team:p}=(0,l.useTeam)(),{isLoading:R,can:v}=(0,d.default)(),x=!R&&v(u.Action.List,u.Resource.TeamFellowMembership);return(0,r.default)(()=>h&&p&&x?`${n.API_TEAMS_MEMBERS_V3}/${p.id}/members${(0,s.encode)({sort:e,until:o,limit:t,role:c,filterByUserIds:i,includeEntitlements:m,includePermissionRequests:g})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),f)}function f(e){let{limit:t=20,until:i,role:o,sort:l="date_desc"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,r.default)(()=>e?`${n.API_TEAMS_MEMBERS_V3}/${e.id}/members${(0,s.encode)({until:i,limit:t,role:o,sort:l})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),d)}function h(){let{limit:e=25,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{can:n,isLoading:c}=(0,d.default)(),m=!c&&n(u.Action.Create,u.Resource.TeamFellowMembership),{isReady:g,team:f}=(0,l.useTeam)(),h=(0,o.useTeamSlug)(),p=(0,i.default)((t,r)=>{if(!g||!f||!m)return null;if(!t)return`/api/teams/${h}/members/suggested${(0,s.encode)({limit:e})}`;let i=r?.members,a=i?.length===e?i[i.length-1].email:null;return a?`/api/teams/${h}/members/suggested${(0,s.encode)({limit:e,from:a})}`:null},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),r),R=(0,t.useMemo)(()=>p.data?.flatMap(t=>t.members.slice(0,e))||[],[p.data,e]),v=!!p.data,x=v&&0===R.length,b=!!(v&&p.data&&p.size>p.data.length),E=!!(v&&p.data&&p.data[p.data.length-1]?.members.length<e);return[p,{members:R,initialDataLoaded:v,isEmpty:x,loadMore:()=>p.setSize(p.size+1),isLoadingMore:b,isReachingEnd:E}]}e.s(["default",0,c],7873387),e.s(["MEMBERS_LIMIT",0,20,"default",()=>g,"useMembersForTeam",()=>f,"useMembersInfinite",()=>m,"useSuggestedMembersInfinite",()=>h],8587921)},4723202,e=>{"use strict";var t=e.i(8711407),r=e.i(1176592),i=e.i(2504781),s=e.i(5255926),a=e.i(455575),n=e.i(5468328),o=e.i(277234),l=e.i(5338940),d=e.i(8587921),u=e.i(5140444),c=e.i(8248823),m=e.i(57106);function g(e){let{teamRole:o,variant:g="card"}=e,{team:h,isLoading:p}=(0,l.useTeam)(),{hasRequestedRole:R,mutate:v,isLoading:x}=function(e){let{user:t,isLoading:r}=(0,u.useUser)(),{data:i,mutate:s,isLoading:a}=(0,d.default)({includePermissionRequests:!0}),n=i?.permissionRequests;return{hasRequestedRole:n?.some(r=>r.uid===t?.uid&&r.requestedTeamRole.includes(e))??!1,mutate:s,isLoading:r||a}}(o),[b,E]=(0,r.useState)(!1),[M,T]=(0,r.useState)(!1);if(h?.membership?.role!=="VIEWER_FOR_PLUS")return null;let S=R||M;return(0,t.jsx)(s.Skeleton,{show:x||p,children:(0,t.jsx)(n.Tooltip,{disableTriggers:!S,text:(0,t.jsxs)(t.Fragment,{children:["An Owner of the team can accept your request. Requests are managed in the"," ",(0,t.jsx)(m.Link,{href:`/${h?.slug}/~/settings/members`,type:"highlight",children:"team members page"}),"."]}),children:(0,t.jsx)(i.Button,{disabled:S,loading:b,className:"card"===g?"text-label-14 font-medium":void 0,onClick:async()=>{if(h?.id){E(!0);try{await f(h.id,o),v(),T(!0),a.toasts.success("Request for the Member role has been sent")}catch(e){a.toasts.error((0,c.errorToString)(e,"Failed to send request"))}finally{E(!1)}}},size:"card"===g?"small":void 0,type:"card"===g?"tertiary":void 0,children:S?"Access Requested":"Request Access"})})})}async function f(e,t){await (0,o.fetchAPI)(`/api/teams/${e}/role-requests?teamId=${e}`,{method:"POST",body:JSON.stringify({teamRoles:[t]}),throwOnHTTPError:!0})}e.s(["RequestRoleButton",()=>g])},8556491,e=>{"use strict";var t=e.i(8711407),r=e.i(4723202),i=e.i(57106),s=e.i(1235157),a=e.i(119294),n=e.i(6352514);function o(e){let{role:o,team:l,actionLabel:d,dataTestId:u}=e;return(0,t.jsx)("div",{className:"absolute inset-0 z-[100] flex items-center justify-center bg-[rgba(255,255,255,0.5)] dark:bg-[rgba(0,0,0,0.5)]",children:(0,t.jsx)("div",{className:"absolute top-0 md:top-[80px] left-1/2 -translate-x-1/2 z-[101] w-full max-w-[560px] animate-[fadeIn_300ms_ease-in-out_forwards] pointer-events-auto","data-testid":u,children:(0,t.jsxs)("div",{className:"shadow-lg md:rounded-lg max-w-full bg-white overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-6 p-6",children:[(0,t.jsx)("span",{className:"text-heading-24",children:"Additional Permissions Required"}),(0,t.jsxs)("div",{children:["As a ",(0,t.jsx)("strong",{children:o?(0,s.getRoleName)(o):"Viewer"})," user on the ",(0,t.jsx)("strong",{children:l?.name})," team, you do not have permission to ",d,"."]}),(0,t.jsxs)("div",{className:"text-center break-words pt-2 text-gray-900",children:["Learn more about"," ",(0,t.jsx)(i.Link,{external:!0,href:"/docs/rbac/access-roles",onClick:()=>{a.analytics.track(n.AnalyticsEvent.PERMISSIONS_CLICKED_LEARN_MORE)},type:"highlight",children:"Roles and Permissions"})]})]}),"VIEWER_FOR_PLUS"===o?(0,t.jsx)("div",{className:"flex justify-end items-center bg-background-200 p-4 border-t mt-2",children:(0,t.jsx)(r.RequestRoleButton,{teamRole:"MEMBER",variant:"modal"})}):null]})})})}e.s(["AdditionalPermissionsRequiredModal",()=>o])},1068837,e=>{"use strict";var t=e.i(8711407),r=e.i(1717203),i=e.i(8556491);function s(e){let{actionLabel:s,permissionChecks:a}=e,{can:n,isLoading:o,accessInfo:l}=(0,r.default)(),d=a.every(e=>{let[t,r]=e;return n(t,r)});return o||d?null:(0,t.jsx)(i.AdditionalPermissionsRequiredModal,{role:l?.role,team:l?.team??void 0,actionLabel:s})}e.s(["AdditionalPermissionsRequiredModalClient",()=>s])},6214714,4830608,e=>{"use strict";var t=e.i(8711407),r=e.i(1176592),i=e.i(7909933);e.i(5463680);var s=e.i(6769352),a=e.i(15312);e.i(5628754);var n=e.i(9691190),o=e.i(5757634),l=e.i(4244280),d=e.i(8042625),u=e.i(9171423);async function c(e){let t=await (0,u.fetchApi)(e,{throwOnHTTPError:!0,returnStatus:!0,cache:"default",headers:{"cache-control":"private, max-age=45",vary:"Cookie"}});if("object"!=typeof t.body)throw Error(`Invalid fetch response(${t.status}), returned ${typeof t.body} at ${e}`);if(200!==t.status)throw Error(`Fetch failed with status ${t.status} at ${e}`);return t.body}let m=e=>{let t=`${l.API_EXPERIMENTATION}/items?${(0,d.encode)({teamId:e.teamSlug,resourceId:e.resourceId})}`;return{get key(){return t},fetch:c,process:t=>e.resourceId?t.items.filter(t=>t.resourceId===e.resourceId):e.resourceIds?t.items.filter(t=>e.resourceIds?.includes(t.resourceId)):t.items}};function g(e){if(!e.resourceId)return;let t=m(e);(0,o.preload)(t.key,t.fetch)}function f(e){let t=(0,r.useMemo)(()=>m(e),[e]),s=(0,i.default)(t.key,t.fetch);return(0,r.useMemo)(()=>({items:s.data?t.process(s.data):[],isLoading:s.isLoading,error:s.error}),[s.data,s.isLoading,t,s.error])}e.s(["preloadExperimentItems",()=>g,"useExperimentItems",()=>f],4830608);var h=e.i(7557283),p=e.i(1068837),R=e.i(4011256);function v(e){let t=(0,r.useMemo)(()=>{let t;return t=`${l.API_STORE}/stores/${e.resourceId}${(0,d.encode)({teamId:e.teamSlug})}`,{get key(){return t},fetch:c,process:e=>e.store}},[e]),s=(0,i.default)(t.key,t.fetch);return(0,r.useMemo)(()=>({resource:s.data?t.process(s.data):null,isLoading:s.isLoading}),[s.data,s.isLoading,t])}function x(e){let{children:r}=e;return(0,t.jsx)(a.ResourceModalsProvider,{protocolType:"experimentation",children:r})}function b(){return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(s.CreateResourceButton,{onSuccess:e=>{},protocolType:"experimentation"})})}function E(){return(0,t.jsx)(n.ResourceList,{protocolType:"experimentation",resourceLinkFunc:()=>"#"})}function M(e){let i=(0,r.use)(e.params),s=(0,r.useRef)({}),a=(0,r.useCallback)(e=>{if(e){let t=e=>{let t=e.target.closest("[data-resource-item]");if(!t)return;let r=t.getAttribute("data-resource-item");!r||s.current[r]||(s.current[r]=!0,g({teamSlug:i.teamSlug,resourceId:r}))};return e.addEventListener("mouseover",t),()=>{e.removeEventListener("mouseover",t)}}},[i.teamSlug]);return(0,t.jsxs)("div",{ref:a,children:[(0,t.jsx)(n.ResourceList,{protocolType:"experimentation",resourceLinkFunc:e=>i.project?(0,R.getProjectResourceDashboardLink)(e,{teamSlug:i.teamSlug,projectSlug:i.project}):(0,R.getResourceDashboardLink)(e,{teamSlug:i.teamSlug})}),(0,t.jsx)(p.AdditionalPermissionsRequiredModalClient,{actionLabel:"view or manage experiment integrations",permissionChecks:[[h.Action.Read,h.Resource.IntegrationConfiguration]]})]})}e.s(["ExperimentsResourceHeadingButtons",()=>b,"ExperimentsResourceListFallback",()=>E,"ExperimentsResourceListWithParams",()=>M,"ExperimentsResourceModalsProvider",()=>x,"useExperimentResource",()=>v],6214714)}]);

//# debugId=9aabed39-fcb9-0040-3d16-a97f788ffee8
//# sourceMappingURL=a34208ae4fa73048.js.map
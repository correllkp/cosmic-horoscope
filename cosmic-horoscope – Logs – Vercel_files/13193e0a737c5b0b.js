;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="5e93c2dd-64a1-c3ae-677b-de5cf8b7d7fb")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5963711,7212454,e=>{"use strict";var t=e.i(4708200),a=e.i(3863657),i=e.i(6493958),l=e.i(3538015);function r(e){return e?e.rules.filter(e=>"value"in e&&e.value.action?.mitigate?.action==="rate_limit"&&!!e.value.action.mitigate.rateLimit&&!!e.value.active).length:0}function n(e,i,l,r){let n=new Map,s=e=>{let l=[];for(let a of i){let i=e[a];if(null==i||("wafAction"===a?i=m(i||"allow"):"wafRuleId"===a&&(i||="default_web_traffic"),!i&&r.groupBy===a))return t.hideDataKey;l.push(i)}return l.join(a.SEPARATOR)},o=!0,c=new Set;for(let a of e){let e=s(a);e!==t.hideDataKey&&(o=!1),n.has(e)||e===t.hideDataKey||n.set(e,[]);let i=a.timestamp;c.add(i.toISOString()),n.get(e)?.push({...a,date:i,key:e})}if(i.every(e=>["wafRuleId","wafAction"].includes(e))){let e=Array.from(c.values()).map(e=>new Date(e));for(let t of l){let i=[t.value,t.action].join(a.SEPARATOR);n.has(i)||"all_rules"===t.value||n.set(i,e.map(e=>({date:e,timestamp:e,key:i,value:0})))}}return o?new Map:n}function s(e){return(0,i.countFormatter)(e,"short-precision").replace(/\s/g,"")}function o(e,t){let a=e.find(e=>e.value===t);return a?a.label:t}function c(e){let{teamPlan:t,config:a,bypassRules:i,type:n}=e;if(!t)return!0;let s=l.firewallPlanLimits[t][n];return"ipBypass"===n?"hobby"===t||!!i&&i.length>=s:null!==a&&(void 0===a||("ipBlocks"===n?a.currentConfig.ips.length>=s:"rateLimit"===n?r(a)>=s:a.rules.length>=s))}function u(e){switch(e){case"ip":case"ja4":return!0;default:return e.startsWith("header:")}}function d(e){let t=e,a=0;for(;t;)a+=t.offsetTop,t=t.offsetParent;return a}function m(e){return"rate-limit"===e?"rate_limit":e}function p(e){return"rate_limit"===e?"rate-limit":e}function f(e){return void 0===e?"":m(e).replace("_"," ")}function h(e){return RegExp(`(Others(${a.SEPARATOR})?)+`).test(e)}function g(e){return"string"==typeof e&&(e.startsWith("rule_")||"deployment_defined_rules"===e)}function x(e){return"default_web_traffic"===e?"":"managed_bot_filter"===e?"managed_bot_protection":e}e.s(["countRateLimitRules",()=>r],7212454),e.s(["denormalizeFirewallAction",()=>p,"formatFirewallActionForDisplay",()=>f,"formatShortPrecision",()=>s,"formatTableHeader",()=>o,"getOffsetTop",()=>d,"getSonarSeriesData",()=>n,"isCustomRuleId",()=>g,"isOthersAggregate",()=>h,"isPlanLimitReached",()=>c,"isValidEdgeRateLimitKey",()=>u,"normalizeFirewallAction",()=>m,"wafRuleId",()=>x],5963711)},388027,e=>{"use strict";var t=e.i(6950223);e.s(["max",()=>t.default])},8594561,9541744,7823055,1575714,e=>{"use strict";var t=e.i(4893216),a=e.i(3607787),i=e.i(4742629),l=e.i(383598),r=e.i(6603859),n=e.i(4411560),s=e.i(6191442),o=e.i(2854),o=o,c=e.i(8587618),u=e.i(7500952),d=e.i(8074820),m=(0,d.default)(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});m.every=function(e){return isFinite(e=Math.floor(e))&&e>0?e>1?(0,d.default)(function(t){t.setTime(Math.floor(t/e)*e)},function(t,a){t.setTime(+t+a*e)},function(t,a){return(a-t)/e}):m:null},m.range;var p=e.i(5422208),f=e.i(6638429),h=e.i(8698404),g=e.i(4816246),x=e.i(1146510),y=e.i(2951555),v=e.i(7002069),b=e.i(987865),w=e.i(9960377),j=e.i(6874652),C=e.i(8342947),S=e.i(7957080);function _(e,t,a,i,l,r){let n=[[p.default,1,u.durationSecond],[p.default,5,5*u.durationSecond],[p.default,15,15*u.durationSecond],[p.default,30,30*u.durationSecond],[r,1,u.durationMinute],[r,5,5*u.durationMinute],[r,15,15*u.durationMinute],[r,30,30*u.durationMinute],[l,1,u.durationHour],[l,3,3*u.durationHour],[l,6,6*u.durationHour],[l,12,12*u.durationHour],[i,1,u.durationDay],[i,2,2*u.durationDay],[a,1,u.durationWeek],[t,1,u.durationMonth],[t,3,3*u.durationMonth],[e,1,u.durationYear]];function s(t,a,i){let l=Math.abs(a-t)/i,r=(0,o.default)(e=>{let[,,t]=e;return t}).right(n,l);if(r===n.length)return e.every((0,c.tickStep)(t/u.durationYear,a/u.durationYear,i));if(0===r)return m.every(Math.max((0,c.tickStep)(t,a,i),1));let[s,d]=n[l/n[r-1][2]<n[r][2]/l?r-1:r];return s.every(d)}return[function(e,t,a){let i=t<e;i&&([e,t]=[t,e]);let l=a&&"function"==typeof a.range?a:s(e,t,a),r=l?l.range(e,+t+1):[];return i?r.reverse():r},s]}let[N,I]=_(e.i(2766852).default,S.default,C.utcSunday,j.default,w.default,b.default),[A,k]=_(v.default,y.default,x.sunday,g.default,h.default,f.default);e.s(["timeTickInterval",()=>k,"timeTicks",()=>A,"utcTickInterval",()=>I,"utcTicks",()=>N],9541744);var T=e.i(9827209),E=e.i(7824140),R=e.i(2448719);function P(e,t){e=e.slice();var a,i=0,l=e.length-1,r=e[i],n=e[l];return n<r&&(a=i,i=l,l=a,a=r,r=n,n=a),e[i]=t.floor(r),e[l]=t.ceil(n),e}function D(e){return new Date(e)}function L(e){return e instanceof Date?+e:+new Date(+e)}function O(e,t,a,i,l,r,n,s,o,c){var u=(0,E.default)(),d=u.invert,m=u.domain,p=c(".%L"),f=c(":%S"),h=c("%I:%M"),g=c("%I %p"),x=c("%a %d"),y=c("%b %d"),v=c("%B"),b=c("%Y");function w(e){return(o(e)<e?p:s(e)<e?f:n(e)<e?h:r(e)<e?g:i(e)<e?l(e)<e?x:y:a(e)<e?v:b)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?m(Array.from(e,L)):m().map(D)},u.ticks=function(t){var a=m();return e(a[0],a[a.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?w:c(t)},u.nice=function(e){var a=m();return e&&"function"==typeof e.range||(e=t(a[0],a[a.length-1],null==e?10:e)),e?m(P(a,e)):u},u.copy=function(){return(0,E.copy)(u,O(e,t,a,i,l,r,n,s,o,c))},u}function M(){return R.initRange.apply(O(A,k,t.timeYear,a.timeMonth,i.timeWeek,l.timeDay,r.timeHour,n.timeMinute,s.timeSecond,T.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}e.s(["default",()=>P],7823055),e.s(["calendar",()=>O,"default",()=>M],1575714);var z=(0,e.i(8777499).default)("domain","range","reverse","clamp","interpolate","nice","round");function B(e){return z(M(),e)}e.s(["default",()=>B],8594561)},9629316,4085287,e=>{"use strict";var t=e.i(8594561);function a(e,t){let a,i;if(void 0===t)for(let t of e)null!=t&&(void 0===a?t>=t&&(a=i=t):(a>t&&(a=t),i<t&&(i=t)));else{let l=-1;for(let r of e)null!=(r=t(r,++l,e))&&(void 0===a?r>=r&&(a=i=r):(a>r&&(a=r),i<r&&(i=r)))}return[a,i]}e.s(["scaleTime",()=>t.default],9629316),e.s(["extent",()=>a],4085287)},4708200,3863657,e=>{"use strict";var t=e.i(8295952),a=e.i(3489437),i=e.i(9629316),l=e.i(8125826),r=e.i(4085287),n=e.i(388027),s=e.i(2480776),o=e.i(5727994),o=o;let c="__hidden",u="__others";function d(e){return e?.date}function m(e){return e.value}function p(e){return Array.from(e.values()).reduce((e,t)=>e.concat(t),[])}function f(e,t){let a=new Map(e.map(e=>{let{time:a,date:i}=e;return[a,{time:a,date:i,...Object.fromEntries(t.map(e=>[e,0]))}]}));return e.forEach(e=>{let{time:t,key:i,value:l}=e,r=a.get(t);r&&(r[i]=l)}),[...a.values()].sort((e,t)=>e.date.getTime()-t.date.getTime())}function h(e,l,c,p,f,h,g,x,y){let v=(0,n.max)(e,m)??0,b=(0,i.scaleTime)({domain:(0,r.extent)(e,d),range:[0,p]}),w=(0,a.scaleLinear)({domain:[0,v],range:y||[f,0]}),j=(0,a.scaleLinear)({domain:[0,v*(x??1)],range:y||[f,0]}),C=(0,n.max)(l,e=>{var t;return t=e,c.reduce((e,a)=>"number"==typeof t[a]?e+t[a]:e,0)})??0,S=(0,a.scaleLinear)({domain:[0,C],range:[f,0]}),_=(0,a.scaleLinear)({domain:[0,C*(x??1)],range:[f,0]}),N=(0,t.scaleBand)({domain:e.map(e=>d(e)??new Date).sort((e,t)=>e.getTime()-t.getTime()),paddingInner:.3,range:[0,p]}),I={};return g&&(I[u]=g),{lineXScale:b,lineYScale:w,lineYAxisScale:j,barStackYScale:S,barDateScale:N,barYAxisScale:_,colorScale:function(e){let t=(0,s.scaleOrdinal)({domain:e.domain.filter(t=>!(t in e.special)),range:e.range,unknown:e.unknown||o.implicit});function a(a){return e.special[a]??t(a)}return Object.assign(a,t),a}({domain:c,range:h,special:I})}}function g(e,t){let a=e.getTime(),i=(0,l.bisector)((e,t)=>e.date.getTime()-t).center(t,a);return t[i]}function x(e){return e.filter((t,a)=>{let i=e[a-1]||{value:null},l=e[a+1]||{value:null};return null!==t.value&&null===i.value&&null===l.value})}e.s(["findNearestDataPointByDate",()=>g,"flatten",()=>p,"getScales",()=>h,"getX",()=>d,"getY",()=>m,"groupByTime",()=>f,"hideDataKey",0,c,"othersDataKey",0,u,"singletons",()=>x],4708200);var y=e.i(9534247);function v(e,t){let a=t.filter(e=>"projectId"!==e),i=new Map,l=!0;for(let t of e.data||[]){"edgeNetworkRegion"in t&&(t.edgeNetworkRegion=(0,y.friendlyRegionFormatter)(t.edgeNetworkRegion)),"projectId"in t&&"projectName"in t&&""!==t.projectName&&(t.projectId=t.projectName);let e=b(a,t);e!==c&&(l=!1),i.has(e)||i.set(e,[]);let{timestamp:r,value:n,...s}=t,o=r.toISOString();i.get(e)?.push({...s,date:r,time:o,key:e,value:n})}if(l)return new Map;let r=new Map;return e.summary.map(e=>[b(a,e),e.value]).sort((e,t)=>{let[a,i]=e,[l,r]=t;return r-i}).map(e=>{let[t,a]=e;return t}).forEach(e=>{r.set(e,i.get(e)||[])}),r}function b(e,t){let a=e.filter(e=>"projectId"!==e);if(0===a.length)return"All Data";let i=a.map(e=>t[e]);return i.includes("Others")?u:i.every(e=>!e)?c:i.join("$$")}e.s(["SEPARATOR",0,"$$","getSeriesKey",()=>b,"toSeriesMap",()=>v],3863657)},421794,e=>{"use strict";let t={gen:{name:"Generic Attack",description:"Provide broad protection from various undefined or novel attack vectors."},java:{name:"Java Attack",description:"Mitigate risks of exploitation targeting Java-based applications or components."},lfi:{name:"Local File Inclusion Attack",description:"Prevent unauthorized access to local files through web applications."},ma:{name:"Multipart Attack",description:"Block attempts to bypass security controls using multipart/form-data encoding."},php:{name:"PHP Attack",description:"Safeguard against vulnerability exploits in PHP-based applications."},rce:{name:"Remote Execution Attack",description:"Prevent unauthorized execution of remote scripts or commands."},rfi:{name:"Remote File Inclusion Attack",description:"Prohibit unauthorized upload or execution of remote files."},sd:{name:"Scanner Detection",description:"Detect and prevent reconnaissance activities from network scanning tools."},sf:{name:"Session Fixation Attack",description:"Prevent unauthorized takeover of user sessions by enforcing unique session IDs."},sqli:{name:"SQL Injection Attack",description:"Prohibit unauthorized use of SQL commands to manipulate databases."},xss:{name:"XSS Attack",description:"Prevent injection of malicious scripts into trusted webpages."}};function a(e){return t[e]}function i(e){return e.endsWith("update")?"modified":e.endsWith("insert")?"created":e.endsWith("remove")?"deleted":e.endsWith("priority")?"reordered":"firewallEnabled"===e?"changed":""}function l(e,t,a){let l=a?"You":e.username,{id:r,action:n}=e;return"crs.update"===e.action?{id:r||"",principal:l,rule:r?t.owasp.ruleGroups?.[r].name??r:"",actionTaken:i(n)}:"ip.insert"===e.action||"ip.remove"===e.action?{id:r||"",principal:l,rule:(e.action,"IP Blocking Rule"),actionTaken:i(n)}:"rules.insert"===e.action||"rules.update"===e.action?{id:r||"",principal:l,rule:e.value.name,actionTaken:i(n)}:"rules.remove"===e.action?{id:r||"",principal:l,rule:"a Custom Rule",actionTaken:i(n)}:"rules.priority"===e.action?{id:r||"",principal:l,rule:"Rule",actionTaken:i(n)}:"managedRules.update"===e.action?{id:r||"",principal:l,rule:(()=>{if(!r)return"";let e=c(t,r);return e?e.name:r})(),actionTaken:e.value.active?"enabled":"disabled"}:"botId.toggle"===e.action?{id:r||"",principal:l,rule:"BotID Deep Analysis",actionTaken:e.value?"enabled":"disabled"}:{principal:l,id:r||"",rule:"Firewall",actionTaken:i(n)}}function r(e){return"bot_filter"===e||"bot_protection"===e}function n(e){return"managed_bot_filter"===e||"managed_bot_protection"===e}function s(e){let t=e?.managedRules;return t?.bot_filter??t?.bot_protection}function o(e){return e.bot_filter??e.bot_protection}function c(e,t){return"bot_filter"===t?e.bot_filter??e.bot_protection:"bot_protection"===t?e.bot_protection??e.bot_filter:e[t]}e.s(["RULES_TO_NAMES",0,t,"botProtectionFromConfig",()=>s,"botProtectionFromRulesets",()=>o,"createActionConfig",()=>l,"crsRuleToConfig",()=>a,"getRulesetFromRulesets",()=>c,"isBotProtectionData",()=>n,"isBotProtectionManagedRuleset",()=>r])},3538015,e=>{"use strict";var t=e.i(421794);let a=JSON.stringify({name:"",description:"",active:!0,conditionGroup:[{conditions:[{type:"path",op:"eq",value:""}]}],action:{mitigate:{action:"rate_limit",rateLimit:{action:"rate_limit",algo:"fixed_window",window:"60",limit:"100",keys:["ip"]}}}}),i={sys_dos_mitigation:{label:"DDoS Mitigation",groupBy:"System",rank:11},ip_blocking:{label:"IP Blocking",groupBy:"System",rank:12}},l={owasp_anomaly_detection:{label:"OWASP Anomaly Detection",groupBy:"System",rank:3,keys:["gen","java","ma","sd"]},owasp_xss_detection:{label:"OWASP XSS Detection",groupBy:"System",rank:4,keys:["xss"]},owasp_sqli_detection:{label:"OWASP SQL Injection Detection",groupBy:"System",rank:5,keys:["sqli"]},owasp_rfi_detection:{label:"OWASP RFI Detection",groupBy:"System",rank:6,keys:["rfi"]},owasp_lfi_detection:{label:"OWASP LFI Detection",groupBy:"System",rank:7,keys:["lfi"]},owasp_rce_detection:{label:"OWASP RCE Detection",groupBy:"System",rank:8,keys:["rce"]},owasp_php_detection:{label:"OWASP PHP Injection Detection",groupBy:"System",rank:9,keys:["php"]},owasp_session_fixation_detection:{label:"OWASP Session Fixation Detection",groupBy:"System",rank:10,keys:["sf"]}},r={default_web_traffic:{label:"Allowed Requests",groupBy:"System",rank:1},challenge_mode:{label:"Attack Mode",groupBy:"System",rank:2},...l,...i},n={hobby:{customRules:3,ipBlocks:10,ipBypass:0,rateLimit:1},pro:{customRules:40,ipBlocks:100,ipBypass:25,rateLimit:40},enterprise:{customRules:1e3,ipBlocks:1e3,ipBypass:100,rateLimit:1e3}},s={pro:{customRules:{title:"Need more custom rules?",description:"Upgrade to Enterprise Plan"},ipBlocks:{title:"Need to block more IPs?",description:"Upgrade to Enterprise Plan"},ipBypass:{title:"Need to allow more IPs?",description:"Upgrade to Enterprise Plan"},rateLimit:{title:"Need more rate limit rules?",description:"Upgrade to Enterprise Plan"}},hobby:{customRules:{title:"Need more custom rules?",description:`Upgrade to pro to add up to ${n.pro.customRules} custom rules`},ipBlocks:{title:"Need to block more IPs?",description:`Upgrade to pro to block up to ${n.pro.ipBlocks} IPs`},ipBypass:{title:"Need to setup an IP bypass?",description:`Upgrade to pro to allow up to ${n.pro.ipBypass} IPs`},rateLimit:{title:"Need more rate limit rules?",description:`Upgrade to pro to add up to ${n.pro.rateLimit} rate limit rules`}}},o=[{label:r.default_web_traffic.label,value:"default_web_traffic",action:"allow"},{label:r.challenge_mode.label,value:"challenge_mode",action:"challenge"},...Object.entries(i).map(e=>{let[t,a]=e;return{label:a.label,value:t,action:"deny"}})],c=Object.entries(r).reduce((e,t)=>{let[a,i]=t;return Object.assign(e,{[a]:i.rank})},{});function u(e,t){let[a]=e.split("$"),[i]=t.split("$"),l=c[a],r=c[i];return l&&r?l-r:l?-l:r||e.localeCompare(t)}function d(e){return e in i}function m(e){return Object.entries(l).reduce((t,a)=>{let[i,l]=a,r=e.filter(e=>l.keys.includes(e.id)&&e.active);if(r.length>0){let e=Array.from(r.reduce((e,t)=>(e.add(t.action),e),new Set));t.push({label:l.label,value:i,action:e.join(" / ")})}return t},[])}function p(e,t){let a=[{value:"log",label:"Log",subtext:"Log traffic and do nothing more"},{value:"deny",label:t?"Deny (403)":"Deny",subtext:"Block traffic from accessing your site"},{value:"challenge",label:"Challenge",subtext:"Verify traffic at a security checkpoint before allowing access to your site"}];return t||a.push({value:"bypass",label:"Bypass",subtext:"Bypass existing rules and allow traffic access to your site"}),e&&a.push({value:"rate_limit",label:t?"Too Many Requests (429)":"Rate Limit",subtext:"Enforce frequency limitations on traffic"}),t||a.push({value:"redirect",label:"Redirect",subtext:"Redirect traffic to a different page"}),a}function f(e,a,i){if(i&&e.startsWith("managed_")){let[,a]=e.split("managed_"),l=(0,t.getRulesetFromRulesets)(i,a);if(l)return l.name}let l=[];a&&(l.push(...a.rules),l.push(...a.crsRules),l.push(...a.currentConfig.ips.map(e=>({id:e.id,name:`IP Block ${"*"===e.hostname?"":e.hostname} ${e.ip}`}))));let n=l.find(t=>t.id===e);if(n)return n.name;let s=r[e];return s?s.label:"deployment_rules"===e?"Deployment Rules":"deployment_defined_rules"===e?"Deployment Defined Rules":e}e.s(["allowedFirewallActions",()=>p,"defaultFilter",0,[{label:"User Agent",value:"clientUserAgent"},{label:"Country",value:"clientIpCountry"},{label:"IP Address",value:"clientIp"},{label:"Request Path",value:"requestPath"},{label:"Vercel Region",value:"edgeNetworkRegion"},{label:"Route",value:"sourcePath"},{label:"JA4 Digest",value:"clientJa4Digest"},{label:"Host",value:"requestHostname"}],"defaultShowSystemRules",0,o,"firewallPlanLimits",0,n,"getRuleName",()=>f,"isLimitedSystemRule",()=>d,"owaspToCrsConfig",()=>m,"planLimitText",0,s,"rateLimitTemplate",0,a,"ruleToMappings",0,r,"stableSort",()=>u,"systemFilter",0,[{label:"IP Address",value:"clientIp"},{label:"Country",value:"clientIpCountry"},{label:"JA4 Digest",value:"clientJa4Digest"},{label:"Host",value:"requestHostname"}]])},9937599,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M11.5253 10.2634L8 13.8578L4.47471 10.2634C2.50843 8.25857 2.50843 4.99627 4.47471 2.99144C6.42507 1.00285 9.57493 1.00285 11.5253 2.99144C13.4916 4.99627 13.4916 8.25857 11.5253 10.2634ZM12.5962 11.3137L9.05051 14.9289L8 16L6.94949 14.9289L3.40381 11.3137C0.865397 8.72554 0.865399 4.52929 3.40381 1.94113C5.94222 -0.647042 10.0578 -0.647042 12.5962 1.94113C15.1346 4.52929 15.1346 8.72554 12.5962 11.3137ZM9 6.5C9 7.05228 8.55228 7.5 8 7.5C7.44772 7.5 7 7.05228 7 6.5C7 5.94772 7.44772 5.5 8 5.5C8.55228 5.5 9 5.94772 9 6.5ZM8 9C9.38071 9 10.5 7.88071 10.5 6.5C10.5 5.11929 9.38071 4 8 4C6.61929 4 5.5 5.11929 5.5 6.5C5.5 7.88071 6.61929 9 8 9Z" fill="currentColor"/>');e.s(["Location",0,t])},5164288,e=>{"use strict";var t=e.i(9979783);async function a(e){let{team:a,enableTeam:i}=e;await (0,t.typedFetchData)("/v1/security/plus","post",{teamId:a.id},{enabled:i},{throwOnHTTPError:!0})}function i(e){let{team:t}=e;return t?.securityPlus?.enabled??!1}e.s(["isSecurityPlusEnabled",()=>i,"patchSecurityPlusConfiguration",()=>a])},1743600,e=>{"use strict";var t=e.i(5394896),a=e.i(455575);let i=null,l=null,r=null;async function n(){try{let e=await fetch("https://bots.fyi/bots");if(!e.ok)throw Error("Failed to fetch verified bots");let t=await e.json(),a={names:[],categories:[]},r=new Set;for(let e of t)a.names.push({label:e.displayName,value:e.name}),r.has(e.category)||(a.categories.push({label:e.category.replace(/\bai\b|_(.)|^\w/g,(e,t)=>t?t.padStart(2," ").toUpperCase():e.toUpperCase()),value:e.category}),r.add(e.category));return i=a,l=Date.now(),a}catch(e){if(e instanceof Error){if("production"!==t.default.env.VERCEL_ENV)throw e;return a.toasts.error("Error fetching bot data"),{categories:[],names:[]}}throw e}}async function s(){return i&&l&&Date.now()-l<6e5?i:r||(r=n().catch(e=>{throw i=null,l=null,e}).finally(()=>{r=null}))}e.s(["fetchVerifiedBots",()=>s])},5812308,e=>{"use strict";e.i(3512434);var t=e.i(9835407),a=e.i(423255);let i=t.z.string().nullable(),l=t.z.string().min(1,"Requires a value"),r=t.z.string().min(1,"Requires a value").refine(e=>RegExp("^(?!-)[A-Za-z0-9-]{1,63}(?<!-)(?:\\.(?!-)[A-Za-z0-9-]{1,63}(?<!-))*$").test(e),{message:"Invalid host name provided"}),n=t.z.string().min(1,"Requires a value").refine(e=>{try{return new RegExp(e),!0}catch(e){return!1}},{message:"Invalid regular expression provided"}),s=t.z.string().min(1,"Requires a value").superRefine((e,i)=>{if(!a.default.isIP(e)){if(a.default.isIPRange(e)){let[a,l]=e.split("/"),r=Number.parseInt(l,10);return a.includes(".")?r<0?void i.addIssue({code:t.z.ZodIssueCode.custom,message:"IPv4 CIDR cannot have a net mask less than /0"}):{isValid:!0,errorMsg:""}:void(r>32&&i.addIssue({code:t.z.ZodIssueCode.custom,message:"IPv6 CIDR cannot have a net mask greater than /32"}))}i.addIssue({code:t.z.ZodIssueCode.custom,message:"Invalid IP address or CIDR"})}}),o=t.z.string().min(1,"Requires a value").refine(e=>e.startsWith("/"),'Path must start with a "/"').refine(e=>{try{return new URL(e,"https://example.com"),!0}catch{return!1}},"Path must be a valid URL path"),c=t.z.string().min(1,"Requires a value").refine(e=>/^\d+$/.test(e));e.s(["digitSchema",0,c,"hostnameSchema",0,r,"ipAndCidrsSchema",0,s,"optionalString",0,i,"pathSchema",0,o,"regexSchema",0,n,"stringSchema",0,l])},6284227,e=>{"use strict";var t=e.i(5812308);let a={value:"sub",label:"Contains",schema:t.stringSchema},i={value:"!sub",label:"Does not contain",schema:t.stringSchema},l={value:"pre",label:"Starts with",schema:t.stringSchema},r={value:"!pre",label:"Does not start with",schema:t.stringSchema},n={value:"suf",label:"Ends with",schema:t.stringSchema},s={value:"!suf",label:"Does not end with",schema:t.stringSchema},o={value:"re",label:"Matches expression",schema:t.regexSchema},c={value:"!re",label:"Does not match expression",schema:t.regexSchema},u={value:"ex",label:"Exists",schema:t.optionalString},d={value:"!ex",label:"Does not exist",schema:t.optionalString};e.s(["keyExistsOperator",0,[u,d],"stringMatchOperators",0,[a,i,l,r,n,s,o,c],"stringOperators",0,[{value:"eq",label:"Equals"},{value:"!eq",label:"Does not equal"},{value:"inc",label:"Is any of"},{value:"!inc",label:"Is not any of"}],"withIdOperator",0,{value:"eq",label:"with rate limit ID"}])},2627313,e=>{"use strict";var t=e.i(8711407),a=e.i(1176592);let i=(0,a.createContext)(null);function l(){let e=(0,a.useContext)(i);if(null===e)throw Error("Filter context should be wrapped in Provider");return e}function r(e){let{children:l,state:r,index:n,moduleConfig:s,groupId:o}=e,c=(0,a.useMemo)(()=>({state:r,moduleConfig:s,index:n,groupId:o}),[r,s,n,o]);return(0,t.jsx)(i.Provider,{value:c,children:l})}i.displayName="ItemStateContextProvider",e.s(["FilterItemStateProvider",()=>r,"useItemStateContext",()=>l])},467779,e=>{"use strict";var t=e.i(8711407),a=e.i(1176592),i=e.i(8914449),l=e.i(9544652);let r=(0,a.createContext)(null);function n(){let e=(0,a.useContext)(r);if(null===e)throw Error("Filter context should be wrapped in Provider");return(0,i.useStore)(e)}function s(e){let{children:a,disabled:i,store:n}=e;return(0,t.jsx)(r.Provider,{value:n,children:(0,t.jsx)(l.DisabledContext.Provider,{value:!!i,children:a})})}r.displayName="FilterContextProvider",s.displayName="FilterProvider",e.s(["FilterProvider",()=>s,"useFilterContext",()=>n])},3957279,e=>{"use strict";var t=e.i(8711407),a=e.i(9689002),i=e.i(3869281),l=e.i(3306538),r=e.i(1821888),n=e.i(9376050),s=e.i(9550268),o=e.i(5883567),c=e.i(1176592),u=e.i(9722978);let d={values:[],valueSet:new Set,initialSet:new Set,options:[]};function m(e,t){switch(t.type){case"INITIALIZE":return{...e,...t.payload};case"TOGGLE_VALUE":{let{item:a,allowMulti:i}=t.payload,l=new Set(e.valueSet);if(l.has(a.value))return l.delete(a.value),{...e,values:e.values.filter(e=>e.value!==a.value),valueSet:l,initialSet:i?e.initialSet:new Set([])};return l.add(a.value),{...e,values:i?[...e.values,a]:[a],valueSet:i?l:new Set([a.value]),initialSet:i?e.initialSet:new Set}}case"ADD_NEW":{let a=new Set(e.valueSet),i=new Set(e.initialSet),l=Array.isArray(t.payload.item)?t.payload.item.map(e=>({value:e,label:`"${e}"`})):[{value:t.payload.item,label:`"${t.payload.item}"`}];return l.forEach(e=>{i.add(e.value),a.add(e.value)}),{...e,values:t.payload.allowMulti?[...e.values,...l]:l,valueSet:t.payload.allowMulti?a:new Set(l.map(e=>e.value)),initialSet:t.payload.allowMulti?i:new Set(l.map(e=>e.value))}}case"CLOSE_SELECT":{let t=new Set(e.values.map(e=>e.value));return{...e,initialSet:t}}default:return e}}function p(e){let{errors:o,initialValue:p,allowAdd:h,allowMulti:g=!1,filterName:x,disabled:y,onChange:v,getOptions:b,labels:w,placeholder:j,updateOnChange:C}=e,[S,_]=(0,c.useReducer)(m,d),[N,I]=(0,c.useState)(!1),[A,k]=(0,c.useState)(""),T=(0,c.useRef)(null);(0,c.useEffect)(()=>{(async()=>{let e=Array.isArray(p)?p:[p],t=new Set(e.map(e=>`${e}`)),a=new Set(t),i=[],l=[];if(void 0===b)i=e.map(e=>({value:`${e}`,label:`"${e}"`}));else{if(l=await b(),h)for(let t of e.filter(Boolean))l.some(e=>e.value===`${t}`)||l.push({value:`${t}`,label:w?.[t]||`"${t}"`});i=l.filter(e=>t.has(e.value))}_({type:"INITIALIZE",payload:{values:i,valueSet:t,initialSet:a,options:l}})})()},[p,h,g,x,b,o,w]);let E=(0,c.useMemo)(()=>o?new Set(o.map(e=>e.value)):new Set,[o]),R=(0,c.useMemo)(()=>S.values.filter(e=>S.valueSet.has(e.value)),[S.values,S.valueSet]),P=S.values.filter(e=>S.initialSet.has(e.value)),D=(0,c.useCallback)(e=>{_({type:"TOGGLE_VALUE",payload:e})},[]),L=(0,c.useMemo)(()=>Array.from(new Set([...S.options,...S.values])),[S.options,S.values]),O=(0,c.useCallback)(e=>{v?.(e)},[v]);(0,c.useEffect)(()=>{C&&O([...S.valueSet])},[S.valueSet,O,C]);let M=L.filter(e=>S.initialSet.has(e.value)),z=S.options.filter(e=>!S.initialSet.has(e.value));return(0,t.jsxs)(r.Root,{onOpenChange:e=>{e||(_({type:"CLOSE_SELECT"}),k(""),v?.([...S.valueSet])),I(e)},open:N,children:[(0,t.jsx)(r.Anchor,{className:"flex w-full items-center",children:(0,t.jsx)(r.Trigger,{className:(0,u.clsx)("my-0 size-full min-h-[32px] items-center rounded border-gray-alpha-400 bg-background-100 px-3 py-0 outline outline-1 outline-gray-alpha-400 data-[state=open]:bg-gray-100 data-[state=open]:shadow-focus-border focus-visible:shadow-focus-ring disabled:border-gray-400 disabled:bg-gray-100 disabled:text-gray-700",{"data-[state=open]:shadow-focus-border data-[state=open]:border-gray-alpha-400 shadow-[0_0_0_1px_var(--ds-red-900),0_0_0_4px_var(--ds-red-300)]":o}),disabled:y,children:(0,t.jsxs)("div",{className:"flex h-full items-center gap-x-2",children:[(0,t.jsx)("span",{children:(0,t.jsx)(s.ListUnordered,{size:16})}),(0,t.jsx)("div",{className:"grid",children:(0,t.jsxs)("p",{className:"text-copy-14 truncate text-inherit","aria-disabled":y,children:[g&&R.length>0?(0,t.jsx)("span",{className:"text-sm text-gray-900",children:`${R.length} ${1===R.length?x:function(e){for(let[t,a]of[[/ss$/,"sses"],[/s$/,"s"],[/s$/,"es"],[/(?![aeiou])y$/,"ies"]])if(t.test(e))return e.replace(t,a);return`${e}s`}(x)}: `}):null,R.length>0?R.map((e,a)=>E.has(e.value)?(0,t.jsxs)("span",{className:"text-red-900",children:[e.label.replaceAll('"',""),`${a<R.length-1?", ":""}`]},e.value):`${e.label.replaceAll('"',"")}${a<R.length-1?", ":""}`):(0,t.jsx)("span",{className:"text-gray-700",children:`Add option${g?"s":""}`})]})})]})})}),(0,t.jsx)(r.Portal,{children:(0,t.jsx)(r.Content,{className:"tailwind-preflight",side:"bottom",sideOffset:8,children:(0,t.jsxs)(n.Command,{className:"w-[var(--radix-popover-trigger-width)] min-w-[320px] justify-between rounded-lg border-gray-alpha-400 bg-background-100 shadow-menu",children:[(0,t.jsxs)("div",{className:(0,u.clsx)("-mb-px flex w-full items-center justify-between px-4 py-3",(P.length>0||A||S.options.length>0)&&"border-b"),children:[(0,t.jsx)(n.Command.Input,{className:"w-full border-none bg-transparent text-sm outline-none",onPaste:e=>{if(!h)return;e.preventDefault();let t=e.clipboardData.getData("text").split("\n").map(e=>e.trim());g?_({type:"ADD_NEW",payload:{item:t,allowMulti:g}}):_({type:"ADD_NEW",payload:{item:t[0],allowMulti:g}})},onValueChange:k,placeholder:j&&j.length>0?j:"Search…",ref:T,value:A}),(0,t.jsx)(a.Kbd,{small:!0,children:"Esc"})]}),(0,t.jsxs)(n.Command.List,{className:"flex max-h-[288px] flex-col gap-y-5 overflow-y-auto border-gray-alpha-400",children:[P.length>0?(0,t.jsx)(n.Command.Group,{className:"p-2",children:M.map(e=>(0,t.jsx)(n.Command.Item,{className:"w-full rounded *:aria-selected:bg-gray-100 data-[selected=true]:bg-gray-100 hover:bg-gray-100 focus-visible:bg-gray-100 active:bg-gray-100",onSelect:()=>D({item:e,allowMulti:g}),value:`${e.label}-${e.value}`,children:(0,t.jsxs)("div",{className:"flex w-full gap-2 rounded p-2",children:[(0,t.jsx)(i.Checkbox,{checked:S.valueSet.has(e.value),className:"pointer-events-none gap-1 text-sm",onChange:()=>{},tabIndex:-1,children:e.label}),E.has(e.value)?(0,t.jsx)(l.Badge,{size:"sm",variant:"red-subtle",children:"Invalid Option"}):null]})},e.value))}):null,z.length>0?(0,t.jsx)(n.Command.Group,{className:(0,u.clsx)("p-2",z.length&&"border-t"),children:z.map(e=>(0,t.jsx)(n.Command.Item,{className:"w-full rounded *:aria-selected:bg-gray-100 data-[selected=true]:bg-gray-100 hover:bg-gray-100 focus:bg-gray-100 active:bg-gray-100",onSelect:()=>D({item:e,allowMulti:g}),value:`${e.label}-${e.value}`,children:(0,t.jsx)("div",{className:"w-full rounded p-2",children:(0,t.jsx)(i.Checkbox,{checked:S.valueSet.has(e.value),className:"pointer-events-none gap-1 text-sm",onChange:()=>{},tabIndex:-1,children:e.label})})},`${e.value}-${e.label}`))}):[],(0,t.jsx)(n.Command.Group,{children:h?(0,t.jsx)(f,{onAddNew:e=>{_({type:"ADD_NEW",payload:{item:e,allowMulti:g}}),T.current?.focus(),k("")},search:A}):null}),A.length?(0,t.jsx)(n.Command.Empty,{className:"px-4 py-3 text-sm text-gray-900",children:`No results match "${A}"`}):null]}),(0,t.jsx)(n.Command.Group,{className:"border-t border-gray-alpha-400 p-2",children:(0,t.jsx)(n.Command.Item,{className:"cursor-default rounded p-2 aria-disabled:opacity-100",children:(0,t.jsxs)("span",{className:"text-xs text-gray-700",children:["Limits are calculated by the combination of"," ",(0,t.jsx)("strong",{children:"all"})," selected keys"]})})})]})})})]})}function f(e){let{search:a,onAddNew:i}=e;return 0===a.length?null:(0,t.jsx)("div",{className:"p-2",children:(0,t.jsx)(n.Command.Item,{"aria-label":`add ${a}`,className:"w-full rounded *:aria-selected:bg-gray-100 data-[selected=true]:bg-gray-100 hover:bg-gray-100 focus:bg-gray-100 active:bg-gray-100",onSelect:()=>i(a),children:(0,t.jsxs)("div",{className:"flex items-center  gap-x-2 rounded p-2 text-gray-900",children:[(0,t.jsx)(o.PlusCircle,{size:14}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:`Add "${a}"`})]})})})}e.s(["FilterSelectComponent",()=>p])},1900286,e=>{"use strict";var t=e.i(364533);function a(e){return["inc","!inc","ninc"].includes(e)}function i(e){return["ex","!ex","nex"].includes(e)}function l(e,t){return e.moduleMap.get(t)}function r(e){let i=Array.from(Object.keys(e)),l=new Map(Object.entries(e)),r=i[0],n=l.get(r);return n?{defaultState:[{id:(0,t.v4)(),filters:[{filterId:r,value:n.allowMultiSelect||a(n.allowedOperators[0].value)?[]:"",operator:n.allowedOperators[0].value,fieldId:(0,t.v4)(),...n.allowKey?{key:""}:{}}]}],moduleKeys:i,moduleMap:l}:{moduleKeys:i,moduleMap:l}}function n(e,t){let a=[];for(;e.length;){let{path:i,message:l}=e[0];if(Array.isArray(t)){let e=t[Number(i[0])];a.push({value:e,error:l})}else a.push({value:t,error:l});e.shift()}return a}e.s(["getDefaultState",()=>r,"getFieldModule",()=>l,"isExistsOperator",()=>i,"isMultiOperator",()=>a,"isZodError",0,e=>Array.isArray(e?.errors),"mapZodErrorToValue",()=>n,"parseErrorSchema",0,e=>{let t={};for(;e.length;){let a=e[0],{code:i,message:l,path:r}=a,n=r.join(".");if(!t[n])if("unionErrors"in a){let e=a.unionErrors[0].errors[0];t[n]={message:e.message,type:e.code}}else t[n]={message:l,type:i};"unionErrors"in a&&a.unionErrors.forEach(t=>t.errors.forEach(t=>e.push(t))),e.shift()}return t}])},6783963,e=>{"use strict";var t=e.i(1176592);e.i(3512434);var a=e.i(9835407),i=e.i(6461317),l=e.i(1900286),r=e.i(5812308);let n={algo:"fixed_window",window:"60",limit:"100",keys:["ip"]};function s(e){return e.rateLimit.keys.includes("header:x-vercel-rate-limit-key")}function o(e,t){switch(t.type){case"INITIALIZE":case"INITIALIZE_TEAM_PLAN":return{...e,...t.payload};case"UPDATE_FILTER":{if(t.payload.some(e=>"rate_limit_api_id"===e.filterId))return{...e,rateLimit:{...e.rateLimit,keys:["header:x-vercel-rate-limit-key"]},type:"rate_limit",action:"rate_limit"};let a=e.rateLimit.keys.filter(e=>"header:x-vercel-rate-limit-key"!==e);if(0===a.length&&a.push("ip"),!e.wasActionSet)return{...e,type:"default",action:"log",rateLimit:{...e.rateLimit,keys:a}};return{...e,rateLimit:{...e.rateLimit,keys:a}}}case"UPDATE_ACTION":if("rate_limit"!==e.type&&"rate_limit"===t.payload.action)return{...e,action:t.payload.action,type:"rate_limit",showRateLimitModal:!1,wasActionSet:!0};return{...e,action:t.payload.action,wasActionSet:!0};case"UPDATE_NAME":return{...e,name:t.payload.name};case"UPDATE_DESCRIPTION":return{...e,description:t.payload.description};case"UPDATE_RATE_LIMIT":return{...e,rateLimit:t.payload.rateLimit};case"REMOVE_RATE_LIMIT":return{...e,type:"default",action:"rate_limit"!==e.action?e.action:"log"};case"UPDATE_REDIRECT":return{...e,redirectTo:t.payload.redirectTo};case"UPDATE_ACTION_DURACTION":return{...e,actionDuration:t.payload.actionDuration};case"VALIDATE":try{let t=d.parse(e);return{...e,...t,errors:{},isSubmitted:!0}}catch(a){if((0,l.isZodError)(a)){let r=(0,l.parseErrorSchema)(a.errors),n=t.payload?.fieldName;if(n){let t=(0,i.default)(r,n);return{...e,errors:{...e.errors||{},[n]:t}}}return{...e,errors:r,isSubmitted:!0}}}return e;default:return e}}let c={type:"default",action:"log",actionDuration:null,showRateLimitModal:!0,showUpgradeModal:!1,name:"",description:"",rateLimit:n,isSubmitted:!1,wasActionSet:!1};function u(e){let{selectedRule:a,teamPlan:i,showRateLimitModal:l,showUpgradeModal:r,templateAction:s}=e,[u,m]=(0,t.useReducer)(o,{...c,showRateLimitModal:l,showUpgradeModal:r});(0,t.useEffect)(()=>{if(i&&!a)return void("rate_limit"===s?m({type:"INITIALIZE",payload:{teamPlan:i,showRateLimitModal:l,showUpgradeModal:r,type:"rate_limit",action:"rate_limit",name:"",description:"",rateLimit:n,isSubmitted:!1,actionDuration:null,wasActionSet:!0}}):m({type:"INITIALIZE_TEAM_PLAN",payload:{teamPlan:i,showRateLimitModal:l}}));if(!a)return;let e=a.action?.mitigate?.rateLimit,t=a.action?.mitigate?.action==="rate_limit"?a.action.mitigate.rateLimit?.action||"log":a.action?.mitigate?.action||"log";m({type:"INITIALIZE",payload:{teamPlan:i,showRateLimitModal:l,showUpgradeModal:r,type:a.action?.mitigate?.action==="rate_limit"?"rate_limit":"default",action:t,name:a.name,description:a.description||"",redirectTo:a.action?.mitigate?.redirect?.location,rateLimit:e?{algo:e.algo,limit:`${e.limit}`,window:`${e.window}`,keys:e.keys}:n,isSubmitted:!1,actionDuration:a.action?.mitigate?.actionDuration||null,wasActionSet:!0}})},[a,m,i,l,r,s]);let p=(0,t.useCallback)(()=>{try{return m({type:"VALIDATE"}),d.parse(u)}catch(e){return null}},[u]);return[u,m,p]}let d=a.z.object({teamPlan:a.z.enum(["pro","enterprise","hobby"]).optional(),type:a.z.enum(["rate_limit","default"]),action:a.z.enum(["challenge","deny","log","bypass","rate_limit","redirect"]),name:a.z.string().min(1,"Name is required"),description:a.z.string().optional(),rateLimit:a.z.object({algo:a.z.enum(["fixed_window","token_bucket"]),window:a.z.coerce.number().min(10),limit:a.z.coerce.number().min(1).max(1e7),keys:a.z.array(a.z.string().superRefine((e,t)=>{!["ip","ja4"].includes(e)&&(e.startsWith("header:")||t.addIssue({code:a.z.ZodIssueCode.custom,message:"Key must start with header:"}))}))}).passthrough().optional(),redirectTo:a.z.union([a.z.string().url(),r.pathSchema]).optional()}).passthrough().superRefine((e,t)=>{if("rate_limit"===e.type){let i="enterprise"===e.teamPlan?3600:600;e.rateLimit?e.rateLimit.window>i&&t.addIssue({code:a.z.ZodIssueCode.too_big,inclusive:!0,maximum:i,message:`Window must not exceed ${i} seconds`,path:["rateLimit","window"],type:"number"}):t.addIssue({code:a.z.ZodIssueCode.custom,message:"Rate limit is required",path:["rateLimit"]})}"redirect"!==e.action||e.redirectTo||t.addIssue({code:a.z.ZodIssueCode.custom,message:"Redirect to is required",path:["redirectTo"]})});e.s(["isApiControlledRateLimit",()=>s,"useRuleBuilderState",()=>u])},3771277,8229016,e=>{"use strict";var t=e.i(8711407),a=e.i(7047540),i=e.i(588428),l=e.i(9722978),r=e.i(3306538),n=e.i(2504781),s=e.i(6881349),o=e.i(3500331),c=e.i(8674454),u=e.i(6694387),d=e.i(4991687),m=e.i(5326905),p=e.i(8459493),f=e.i(5257834),h=e.i(2713868),g=e.i(5468328),x=e.i(5232300),y=e.i(455575),v=e.i(9544652),b=e.i(6318858),w=e.i(2560270),j=e.i(7749365),C=e.i(109803),S=e.i(923772),_=e.i(1176592),N=e.i(2627313),I=e.i(467779),A=e.i(3957279),k=e.i(1900286);e.i(6483798);var T=e.i(8287059),E=e.i(3538015),R=e.i(6783963),P=e.i(6891161);function D(e){let{isLoading:a,open:i,onClose:l,onConfirm:r}=e;return(0,t.jsxs)(P.Modal.Modal,{active:i,onClickOutside:l,children:[(0,t.jsxs)(P.Modal.Body,{className:"tailwind-preflight",children:[(0,t.jsx)(P.Modal.Header,{children:(0,t.jsx)(P.Modal.Title,{children:"Rate Limit Pricing"})}),(0,t.jsx)(P.Modal.P,{children:"Rate limiting is enforced at the network edge, adding less than 1ms of latency to requests. Only allowed requests are charged. Blocked requests based on your rule are free."}),(0,t.jsxs)("div",{className:"flex flex-col text-gray-900 divide-y",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between py-2",children:[(0,t.jsx)("p",{children:"Allowed Request"}),(0,t.jsx)("p",{children:"$0.50 per 1M"})]}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between py-2",children:[(0,t.jsx)("p",{children:"Blocked Requests"}),(0,t.jsx)("p",{children:"Free"})]})]})]}),(0,t.jsxs)(P.Modal.Actions,{children:[(0,t.jsx)(P.Modal.Action,{onClick:l,type:"secondary",children:"Cancel"}),(0,t.jsx)(P.Modal.Action,{loading:a,onClick:r,children:"Continue"})]})]})}e.s(["RateLimitModal",()=>D],8229016);var L=e.i(5963711),O=e.i(9386557);function M(e){var a,i;let r,{className:n,disabled:s,error:o,id:c,onChange:u,value:d,...m}=e,[p,f]=(0,_.useState)(d?.toString()??""),h=(0,_.useRef)(null),x=(0,_.useRef)(null),y=(0,_.useCallback)(()=>{let{current:e}=x,{current:t}=h,a=getComputedStyle(document.documentElement).getPropertyValue("--geist-form-small-height");e&&t&&(e.style.height=a||"40px",e.style.height=`${e.scrollHeight}px`,t.style.height=e.style.height)},[h,x]);a=x,i=y,r=(0,_.useRef)(null),(0,_.useEffect)(()=>{let e=a.current;if(e&&"undefined"!=typeof ResizeObserver)return r.current=new ResizeObserver(i),r.current.observe(e),()=>{r.current?.disconnect()}},[i,a]),(0,_.useEffect)(y,[p]);let v=(0,_.useMemo)(()=>{let e=p.startsWith(" "),t=p.endsWith(" ");return e&&t?"This value starts and ends with whitespace.":e?"This value starts with whitespace.":t?"This value ends with whitespace.":null},[p]),b=(0,_.useMemo)(()=>p.split(/( )/).filter(Boolean),[p]),w=(0,_.useMemo)(()=>s?"cursor-not-allowed text-gray-700 bg-gray-100 shadow-[0_0_0_1px_var(--ds-gray-400),_0_0_0_1px_var(--ds-background-200)]":o?"shadow-[0_0_0_1px_var(--ds-red-900),0_0_0_4px_var(--ds-red-300)] hover:shadow-[0_0_0_1px_var(--ds-red-900),0_0_0_4px_var(--ds-red-500)] focus-within:!shadow-[0_0_0_1px_var(--ds-red-900),0_0_0_4px_var(--ds-red-300)]":"shadow-[0_0_0_1px_var(--border-color,var(--ds-gray-alpha-400))] hover:shadow-[0_0_0_1px_var(--ds-gray-alpha-500)] focus-within:!shadow-[0_0_0_1px_var(--ds-gray-alpha-600),0px_0px_0px_4px_#00000029]",[o,s]);return(0,t.jsxs)("div",{className:(0,l.clsx)(`
      w-full grid grid-cols-1 grid-rows-1 items-center rounded px-2 transition-shadow
      *:text-sm *:font-mono relative *:p-0 *:py-2 *:rounded *:leading-none *:tracking-normal *:col-span-full *:row-span-full
      `,{[w]:!0,[n??""]:!!n}),id:c,children:[(0,t.jsx)("textarea",{ref:x,className:"text-transparent caret-foreground resize-none overflow-hidden outline-none z-10 bg-transparent",value:p,onChange:e=>{f(e.target.value),u?.(e)},disabled:s,...m,spellCheck:"false",autoComplete:"off"}),(0,t.jsx)("p",{ref:h,className:"text-foreground pointer-events-none wrap-break-word whitespace-pre-wrap",children:b.map((e,a)=>" "!==e?(0,t.jsx)("span",{children:e}):(0,t.jsx)("span",{className:(0,l.clsx)("relative after:content-['⎵'] after:absolute after:-left-[1px] after:top-1.5 after:text-[0.8rem]  text-gray-900",{"text-geist-warning bg-amber-100":0===a||a===b.length-1}),children:" "}))}),(0,t.jsx)("div",{className:(0,l.clsx)("absolute right-0 bottom-0 translate-y-1.5 translate-x-0.5 z-10 transition-opacity duration-75",v?"pointer-events-auto opacity-1":"opacity-0 pointer-events-none"),children:(0,t.jsx)(g.Tooltip,{position:"top",text:v,tabIndex:-1,children:(0,t.jsx)(O.WarningFill,{color:"amber-600"})})})]})}var z=e.i(57106);function B(){let e=(0,I.useFilterContext)(),{state:a,moduleConfig:i}=(0,N.useItemStateContext)(),l=(0,v.useDisabled)(),r=i.allowedOperators.find(e=>e.value===a.operator)?.label;return(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial w-full @lg-page:max-w-[175px]",children:i.allowedOperators.length>1?(0,t.jsxs)(d.MenuContainer,{position:"bottom-start",children:[(0,t.jsx)(u.MenuButton,{align:"flex-grow","aria-label":`Operator ${r||""}`,disabled:l,size:"small",suffix:(0,t.jsx)(w.ChevronDown,{}),type:"secondary",width:"100%",children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start flex-1 w-full",children:(0,t.jsx)("span",{children:r??""})})}),(0,t.jsx)(c.Menu,{className:"w-full overflow-y-auto lg:min-w-[200px]",portalClassName:"tailwind-preflight",useNewListHeightBehavior:{maxHeight:240,numberOfChildren:i.allowedOperators.length},children:i.allowedOperators.map(i=>(0,t.jsx)(p.MenuItem,{onClick:()=>{e.updateCondition(a.fieldId,{type:"operator",value:i.value})},value:i.value,children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-3 flex-1",children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start flex-1",children:(0,t.jsx)("span",{children:i.label})}),i.value===a.operator?(0,t.jsx)(b.Check,{}):null]})},i.value))})]}):(0,t.jsx)(u.MenuButton,{align:"flex-grow","aria-label":`Operator ${r||""}`,disabled:!0,size:"small",type:"secondary",width:"100%",children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start flex-1 w-full",children:(0,t.jsx)("span",{children:r??""})})})})}function $(){let e=(0,I.useFilterContext)(),{state:a,moduleConfig:i}=(0,N.useItemStateContext)(),l=(0,v.useDisabled)(),r=!!i.resolveValues,n=(0,k.isMultiOperator)(a.operator),s=(0,k.isExistsOperator)(a.operator),o=i.placeholder?.value||"";"re"===a.operator&&(o="Type a regular expression..");let c=e.allErrors[`${a.fieldId}-value`];if(r||n)return(0,t.jsx)(A.FilterSelectComponent,{allowAdd:i.allowCustomValue||n&&!r||!1,allowMulti:n,disabled:l,errors:c,filterName:i.title,getOptions:i.resolveValues,initialValue:a.value,onChange:t=>{n?e.updateCondition(a.fieldId,{type:"value",value:t}):e.updateCondition(a.fieldId,{type:"value",value:t[0]})},placeholder:o});let u=Array.isArray(a.value)?`${a.value.length>0?a.value[0]:""}`:`${a.value}`;return(0,t.jsx)(M,{className:"w-full",disabled:!!s||l,error:c?"errors":null,id:a.fieldId,name:`${a.filterId}-${a.fieldId}`,onChange:t=>e.updateCondition(a.fieldId,{type:"value",value:t.target.value}),placeholder:s?"Any value":o,value:s?"":u})}function F(e){let{initialState:a,onChange:i,teamPlan:r}=e,n=(0,v.useDisabled)(),s=(0,I.useFilterContext)(),o=s.state;return(0,t.jsxs)("div",{className:"mt-2 min-h-[320px] w-full rounded border border-gray-alpha-400 bg-background-200 p-10",children:[o.map((e,a,i)=>(0,t.jsxs)(_.Fragment,{children:[e.filters.map((a,i,r)=>(0,t.jsx)("div",{className:(0,l.clsx)("flex flex-col gap-2 @lg-page:flex-row @lg-page:items-center",{"mb-2":i!==r.length-1}),children:(0,t.jsx)(V,{groupId:e.id,index:i,state:a})},a.fieldId)),a!==i.length-1?(0,t.jsxs)("div",{className:"relative flex w-full items-center justify-center",children:[(0,t.jsx)("div",{className:"h-[80px] w-px bg-gray-400"}),(0,t.jsx)(h.SplitButton,{buttonProps:{disabled:!0,size:"small",type:"secondary"},className:"absolute",menuButtonLabel:"Add a condition or condition group",menuItems:(0,t.jsx)(h.SplitButtonMenuItem,{description:"Add a condition",menuItemProps:{disabled:n,onClick:()=>s.addCondition(a)},title:"AND"}),menuProps:{width:230},children:"OR"})]}):null]},`group-${e.id}`)),(0,t.jsx)(ee,{isButton:!0}),"rate_limit"===a.type?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(K,{initialState:a,onChange:i,teamPlan:r}),(0,t.jsx)(ee,{})]}):null,(0,t.jsx)(W,{initialState:a,onChange:i,teamPlan:r})]})}function U(){let e=(0,I.useFilterContext)(),{state:a,moduleConfig:i}=(0,N.useItemStateContext)(),l=i.placeholder?.key||"",r=e.allErrors[`${a.fieldId}-key`],n=(0,v.useDisabled)();return(0,t.jsx)(t.Fragment,{children:i.allowKey?(0,t.jsx)("div",{className:"w-full @lg-page:max-w-[175px]",children:(0,t.jsx)(o.Input,{className:"w-full",disabled:n,error:r?"error":void 0,id:a.fieldId,name:`${a.filterId}-${a.fieldId}-key`,onChange:t=>e.updateCondition(a.fieldId,{type:"key",value:t.target.value}),placeholder:l,showErrorMessage:!1,size:"small",value:a.key,width:"100%"})}):null})}function q(){let e=(0,I.useFilterContext)(),{state:i,moduleConfig:l}=(0,N.useItemStateContext)(),r=(0,v.useDisabled)(),n=(0,_.useMemo)(()=>e.moduleKeys.map(t=>{let a=(0,k.getFieldModule)(e,t);return{label:a.title,value:t,icon:a.icon,badge:a.badge,description:a.description,deprecated:a.deprecated}}),[e]);return(0,t.jsxs)("div",{className:"jsx-4f438cb26d60b0d9 flex flex-col items-stretch justify-start flex-initial w-full tailwind-preflight",children:[(0,t.jsx)(a.default,{id:"4f438cb26d60b0d9",children:".firewall-components-module-configuration-components-module-select-component [class*=combobox-module]>button{min-height:var(--geist-form-small-height,32px)!important;max-height:var(--geist-form-small-height,32px)!important;height:var(--geist-form-small-height,32px)!important}"}),(0,t.jsxs)(s.Combobox,{"aria-label":`rule type ${l.title}`,disabled:r,displaySelectedSuffix:!0,noRawSelectedValue:!0,onChange:t=>{t&&e.updateCondition(i.fieldId,{type:"filter",value:t})},placeholder:"Select attribute…",prefixIcon:l.icon,size:"small",value:i.filterId,width:"100%",className:"firewall-components-module-configuration-components-module-select-component",children:[(0,t.jsx)(s.Combobox.Input,{}),(0,t.jsx)(s.Combobox.List,{className:"overflow-x-hidden min-w-60",align:"start",children:(0,t.jsxs)(t.Fragment,{children:[n.filter(e=>!e.deprecated?.(i.filterId)).map(e=>{let{value:a,label:i,icon:l,description:r,badge:n}=e;return(0,t.jsx)(s.Combobox.Option,{label:i,value:a,className:"!h-auto min-h-0 max-h-40 !p-2.5 [&_>_span]:self-start",suffix:n||null,children:(0,t.jsxs)("div",{className:"jsx-4f438cb26d60b0d9 flex flex-col gap-1",children:[(0,t.jsxs)("header",{className:"jsx-4f438cb26d60b0d9 flex gap-2",children:[l?(0,t.jsx)("span",{className:"jsx-4f438cb26d60b0d9",children:l}):null,(0,t.jsx)("p",{className:"jsx-4f438cb26d60b0d9 font-medium text-gray-1000",children:i})]}),r?(0,t.jsx)("p",{className:"jsx-4f438cb26d60b0d9 text-label-13 text-gray-900",children:r}):null]})},a)}),(0,t.jsx)("div",{className:"jsx-4f438cb26d60b0d9 sticky top-0",children:(0,t.jsx)(z.Link,{className:"flex justify-between text-label-12 bg-background-200 hover:bg-gray-100 transition-colors text-gray-900 p-2.5 w-[calc(100%+20px)] -translate-x-2 -translate-y-2 rounded-t-md",external:!0,href:"/docs/vercel-firewall/vercel-waf/rule-configuration",children:"Rule Configuration Docs"})})]})})]})]})}function H(){let e=(0,I.useFilterContext)(),{state:a,index:i,groupId:l}=(0,N.useItemStateContext)(),r=(0,v.useDisabled)(),s=e.state.find(e=>e.id===l),o=e.state.length>1||(s?.filters??[]).length>1;return(0,t.jsxs)("div",{className:"min-h-[80px] w-full rounded-md border bg-white p-6 flex flex-col @lg-page:flex-row gap-3 items-start",children:[(0,t.jsxs)("div",{className:"flex gap-2 items-center w-full @lg-page:max-w-[240px]",children:[(0,t.jsx)("p",{className:"text-copy-14 text-left capitalize pe-1",children:0===i?"if":"and"}),(0,t.jsx)(q,{}),o?(0,t.jsx)(n.Button,{"aria-label":"remove rule",disabled:r,onClick:()=>{s?.filters.length===1?e.deleteConditionGroup(l):e.deleteCondition(a.fieldId)},shape:"square",size:"small",svgOnly:!0,type:"error",typeName:"button",className:"size-[30px]",children:(0,t.jsx)(S.Trash,{size:16})}):null]}),(0,t.jsx)(U,{}),(0,t.jsx)(B,{}),(0,t.jsx)($,{})]})}function V(e){let{index:a,state:i,groupId:l}=e,r=(0,I.useFilterContext)(),n=(0,k.getFieldModule)(r,i.filterId);return n?(0,t.jsx)(N.FilterItemStateProvider,{groupId:l,index:a,moduleConfig:n,state:i,children:(0,t.jsx)(n.Component,{})}):null}function W(e){let{initialState:a,onChange:r,teamPlan:n}=e,s=(0,v.useDisabled)(),m=(0,i.useFirewallRateLimitTeamFlag)(),f=(0,T.useOpenUpgradeModal)(),[h,g]=(0,_.useState)(!1),x=(0,y.useToasts)(),[j,C]=(0,_.useState)(!1),S=(0,_.useMemo)(()=>(0,E.allowedFirewallActions)(!0,"rate_limit"===a.type),[a.type]),N=S.find(e=>e.value===a.action)?.label;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-start gap-3 flex-initial h-fit grow rounded-md border bg-white p-6 @lg-page:h-[80px]",children:[(0,t.jsxs)("div",{className:"flex w-full flex-1 flex-row items-center gap-x-3",children:[(0,t.jsx)("p",{className:"text-copy-14 capitalize",children:"then"}),(0,t.jsx)("div",{className:"w-full",children:(0,t.jsxs)(d.MenuContainer,{position:"bottom-start",children:[(0,t.jsx)(u.MenuButton,{align:"flex-grow","aria-label":`Action to take based on created rules ${N||""}`,disabled:s,size:"small",suffix:(0,t.jsx)(w.ChevronDown,{}),type:"secondary",width:"100%",children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start flex-1 w-full",children:(0,t.jsx)("span",{children:N||""})})}),(0,t.jsx)(c.Menu,{className:"w-full min-w-[300px] lg:min-w-[400px]",portalClassName:"tailwind-preflight",children:S.map(e=>{let{value:i,label:s,subtext:o,badge:c}=e;return(0,t.jsxs)(p.MenuItem,{height:70,innerMenuItemClassName:(0,l.clsx)("min-h-[60px]"),onClick:()=>{"hobby"===n&&"rate_limit"===i&&a.showUpgradeModal?f({source:"firewall-rate-limit",onConversionSuccess:()=>{r({type:"UPDATE_ACTION",payload:{action:i}})}}):"rate_limit"!==a.type&&"rate_limit"===i&&a.showRateLimitModal&&!m.value?g(!0):r({type:"UPDATE_ACTION",payload:{action:i}})},value:i,children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-between gap-3 flex-1",children:(0,t.jsx)("div",{className:"flex flex-col",children:(0,t.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,t.jsx)("p",{className:"font-medium text-gray-1000",children:s}),c||null]}),(0,t.jsx)("p",{className:"text-[13px] font-normal text-gray-900",children:o})]})})}),i===a.action?(0,t.jsx)(b.Check,{}):null]},i)})})]})})]}),"hobby"!==n&&["deny","challenge","rate_limit"].includes(a.action)?(0,t.jsx)(Z,{initialState:a,onChange:r}):null,"redirect"===a.action?(0,t.jsxs)("div",{className:"flex h-[80px] w-full flex-1 flex-row items-center gap-x-3",children:[(0,t.jsx)("p",{className:"text-copy-14 w-full max-w-[36px] @lg-page:max-w-[12px]",children:"to"}),(0,t.jsx)(o.Input,{"aria-label":"redirect location",className:"w-full @lg-page:min-w-[565px]",disabled:s,error:a.errors?.redirectTo?"error":void 0,onBlur:()=>r({type:"VALIDATE",payload:{fieldName:"redirectTo"}}),onChange:e=>r({type:"UPDATE_REDIRECT",payload:{redirectTo:e.target.value}}),placeholder:"https://",showErrorMessage:!1,size:"small",value:a.redirectTo||"",width:"100%"})]}):null]}),(0,t.jsx)(D,{isLoading:j,onClose:()=>g(!1),onConfirm:()=>{C(!0);try{r({type:"UPDATE_ACTION",payload:{action:"rate_limit"}})}catch(e){x.error(e.message)}finally{C(!1),g(!1)}},open:h})]})}function Z(e){let{initialState:a,onChange:i}=e,r=(0,v.useDisabled)()||(0,R.isApiControlledRateLimit)(a),n=(0,_.useMemo)(()=>[{value:"1m",label:"1 minute"},{value:"5m",label:"5 minutes"},{value:"15m",label:"15 minutes"},{value:"30m",label:"30 minutes"},{value:"1h",label:"1 hour"}],[]),s=n.find(e=>e.value===a.actionDuration)?.label,o=null===a.actionDuration;return(0,t.jsxs)("div",{className:"flex w-full items-center gap-x-3 lg:w-fit",children:[o?null:(0,t.jsx)("p",{className:"w-full max-w-[36px] lg:max-w-4",children:"for"}),(0,t.jsx)("div",{className:"w-full lg:min-w-[190px] lg:max-w-[190px]",children:(0,t.jsxs)(d.MenuContainer,{position:"bottom-start",children:[(0,t.jsx)(G,{children:(0,t.jsx)(u.MenuButton,{align:"flex-grow","aria-label":"Timeframe for action",disabled:r,size:"small",suffix:o?null:(0,t.jsx)(w.ChevronDown,{}),type:"secondary",width:"100%",children:(0,t.jsx)("div",{className:(0,l.clsx)("flex flex-row items-center gap-2 flex-1 w-full",o?"justify-between":""),children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.Clock,{size:16}),(0,t.jsx)("span",{children:"Add Persistent Action"})]}):(0,t.jsx)("span",{className:"text-left",children:s})})})}),(0,t.jsxs)(c.Menu,{className:"w-full min-w-[180px] lg:min-w-[180px]",portalClassName:"tailwind-preflight",children:[n.map(e=>{let{value:r,label:n}=e;return(0,t.jsx)(p.MenuItem,{height:40,innerMenuItemClassName:(0,l.clsx)("min-h-[40px]"),onClick:()=>{i({type:"UPDATE_ACTION_DURACTION",payload:{actionDuration:r}})},value:r,children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-3 flex-1",children:[(0,t.jsx)("div",{className:"flex flex-col items-center justify-start flex-initial",children:n}),r===a.actionDuration?(0,t.jsx)(b.Check,{}):null]})},r)}),o?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.MenuDivider,{}),(0,t.jsx)(p.MenuItem,{height:40,innerMenuItemClassName:(0,l.clsx)("mt-1 min-h-[40px] text-red-800"),onClick:()=>{i({type:"UPDATE_ACTION_DURACTION",payload:{actionDuration:null}})},value:"",children:"Remove Timeframe"})]})]})]})})]})}function G(e){let{children:a}=e,{state:{open:i}}=(0,x.useMenu)();return(0,t.jsx)(g.Tooltip,{className:"w-full",delay:!1,desktopOnly:!0,forceHide:i,position:"top",text:(0,t.jsxs)("p",{className:"flex h-full flex-col justify-start text-left",children:[(0,t.jsx)("span",{className:"text-left text-gray-900",children:"Optional"}),"Prevent further activity from a client device generating requests that match this rule for a specified time"]}),children:a})}function K(e){let{initialState:a,onChange:i,teamPlan:l}=e,[r,s]=(0,_.useState)(a.rateLimit.algo),[c,u]=(0,_.useState)(`${a.rateLimit.window}`),[d,m]=(0,_.useState)(`${a.rateLimit.limit}`),[p,f]=(0,_.useState)([...a.rateLimit.keys]),h=(0,v.useDisabled)();(0,_.useEffect)(()=>{i({type:"UPDATE_RATE_LIMIT",payload:{rateLimit:{algo:r,window:c,limit:d,keys:p}}})},[r,p,d,i,c]);let[x,y]=(0,_.useMemo)(()=>"enterprise"===l?[10,3600]:[10,600],[l]);return(0,t.jsx)("div",{className:"flex w-full",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-start gap-3 flex-initial w-full grow rounded-md border bg-white p-6 lg:h-[80px]",children:[(0,t.jsx)("div",{className:"w-full lg:max-w-fit",children:(0,t.jsx)("p",{className:"text-copy-14 text-nowrap text-left",children:"Rate Limit"})}),(0,t.jsx)("div",{className:"flex flex-col items-start justify-start gap-1 flex-initial w-full lg:max-w-[175px]",children:(0,t.jsx)(J,{initialAlgorithm:r,onChangeAlgorithm:s,teamPlan:l})}),(0,t.jsx)("div",{className:"flex flex-col items-start justify-start gap-1 flex-initial w-full lg:max-w-[132px]",children:(0,t.jsx)(g.Tooltip,{className:"w-full",delay:!1,desktopOnly:!0,position:"top",text:`Time window for rate limit in seconds (min: ${x}, max: ${y})`,children:(0,t.jsx)(o.Input,{"aria-label":`time window for rate limit in seconds (min: ${x}, max: ${y})`,className:"w-full",disabled:h,error:a.errors?.["rateLimit.window"]?"error":void 0,id:"rate-limit-window",name:"Window",onBlur:()=>i({type:"VALIDATE",payload:{fieldName:"rateLimit.window"}}),onChange:e=>{u(e.target.value)},showErrorMessage:!1,size:"small",suffix:"seconds",value:c.toString(),width:"100%"})})}),(0,t.jsx)("div",{className:"flex flex-col items-start justify-start gap-1 flex-initial w-full lg:max-w-[132px]",children:(0,t.jsx)(g.Tooltip,{className:"w-full",delay:!1,desktopOnly:!0,position:"top",text:`Request Limit
(min: 1, max: 10,000,000)`,children:(0,t.jsx)(o.Input,{"aria-label":"request rate limit",className:"w-full",disabled:h,error:a.errors?.["rateLimit.limit"]?"error":void 0,id:"rate-limit-limit",name:"Limit",onBlur:()=>i({type:"VALIDATE",payload:{fieldName:"rateLimit.limit"}}),onChange:e=>{m(e.target.value)},showErrorMessage:!1,size:"small",suffix:"requests",value:d.toString(),width:"100%"})})}),(0,t.jsx)("div",{className:"flex flex-col items-start justify-start gap-1 flex-initial w-full",children:(0,t.jsx)(g.Tooltip,{className:"w-full",delay:!1,desktopOnly:!0,position:"top",text:"Rate Limit By",children:(0,t.jsx)(X,{apiControlled:(0,R.isApiControlledRateLimit)(a),initialKeys:a.rateLimit.keys,onChangeKeys:e=>{f(e)},readOnly:(0,R.isApiControlledRateLimit)(a)})})}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,t.jsx)(n.Button,{"aria-label":"remove rule",className:"hidden min-w-[32px] lg:block",disabled:h||(0,R.isApiControlledRateLimit)(a),onClick:()=>i({type:"REMOVE_RATE_LIMIT"}),shape:"square",size:"small",svgOnly:!0,type:"error",children:(0,t.jsx)(S.Trash,{size:16})})})]})})}function J(e){let{initialAlgorithm:a,onChangeAlgorithm:i,teamPlan:n}=e,[s,o]=(0,_.useState)(a||"fixed_window"),h=(0,v.useDisabled)();(0,_.useEffect)(()=>{i(s)},[i,s]);let x=(0,_.useMemo)(()=>[{value:"fixed_window",label:"Fixed Window",disabled:!1,badge:null,subtext:"Use when strict limits are necessary and bursts at the time boundaries are okay"},{value:"token_bucket",label:"Token Bucket",disabled:"enterprise"!==n,badge:"enterprise"!==n?(0,t.jsx)(r.Badge,{size:"sm",variant:"purple-subtle",children:"Enterprise Only"}):null,subtext:"Use when occasional bursts need to be accommodated without exceeding average rate limits"}],[n]),y=x.find(e=>e.value===s)?.label;return(0,t.jsxs)(d.MenuContainer,{position:"bottom-start",children:[(0,t.jsx)(g.Tooltip,{className:"w-full",delay:!1,desktopOnly:!0,position:"top",text:"Algorithm",children:(0,t.jsx)(u.MenuButton,{align:"flex-grow","aria-label":`Rate limit algorithm ${y||""}`,disabled:h,size:"small",suffix:(0,t.jsx)(w.ChevronDown,{}),type:"secondary",width:"100%",children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start flex-1 w-full",children:(0,t.jsx)("span",{children:y||""})})})}),(0,t.jsxs)(c.Menu,{className:"w-full lg:min-w-[400px]",portalClassName:"tailwind-preflight",children:[x.map(e=>{let{value:a,label:i,subtext:r,disabled:n,badge:c}=e;return(0,t.jsx)(p.MenuItem,{disabled:n,innerMenuItemClassName:(0,l.clsx)("min-h-[78px] aria-disabled:bg-gray-100 aria-disabled:opacity-60"),onClick:()=>{o(a)},value:a,children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-3 flex-1",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,t.jsx)("p",{className:"font-medium text-gray-1000",children:i}),c||null]}),(0,t.jsx)("p",{className:"text-[13px] font-normal text-gray-900",children:r})]}),s===a?(0,t.jsx)(b.Check,{}):null]})},a)}),(0,t.jsx)(m.MenuDivider,{}),(0,t.jsx)(f.MenuLink,{href:"/docs/security/vercel-waf",innerMenuItemClassName:"min-h-[40px]",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between flex-1",children:[(0,t.jsx)("p",{className:"font-medium text-gray-1000",children:"Learn more about rate limits"}),(0,t.jsx)("span",{children:(0,t.jsx)(C.External,{size:16})})]})})]})]})}let Y={"header:x-vercel-rate-limit-key":"API controlled"},Q=[{value:"ip",label:"IP Address"},{value:"ja4",label:"JA4 Digest"},{value:"header:user-agent",label:"User Agent"}];function X(e){let{apiControlled:a,initialKeys:i,onChangeKeys:l,readOnly:r}=e,[n,s]=(0,_.useState)(i||["ip"]),[o,c]=(0,_.useState)(a);(0,_.useEffect)(()=>{a!==o&&(s(i||["ip"]),c(a))},[a,o,i]);let u=(0,v.useDisabled)()||r;return(0,_.useEffect)(()=>{l(n)},[l,n]),(0,t.jsx)(A.FilterSelectComponent,{allowAdd:!0,allowMulti:!0,disabled:u,filterName:"Keys",getOptions:()=>Q,initialValue:n,labels:Y,onChange:e=>{let t=e.map(e=>e.trim().toLowerCase()).filter(L.isValidEdgeRateLimitKey);t.length||t.push("ip"),s(t)},placeholder:"e.g. header:authorization"})}function ee(e){let{isButton:a}=e,i=(0,v.useDisabled)(),r=(0,I.useFilterContext)();return(0,t.jsxs)("div",{className:"relative flex w-full items-center justify-center",children:[(0,t.jsx)("div",{className:(0,l.clsx)("w-px bg-gray-400",a?"h-[80px]":"h-[40px]")}),a?(0,t.jsx)(h.SplitButton,{buttonProps:{disabled:i,onClick:()=>r.addCondition(r.state.length-1),size:"small",type:"secondary"},className:"absolute",menuButtonLabel:"Add a condition or condition group",menuItems:(0,t.jsx)(h.SplitButtonMenuItem,{description:"Add a condition group",menuItemProps:{disabled:i,onClick:r.addConditionGroup},title:"OR"}),menuProps:{width:230},children:"AND"}):null]})}e.s(["BaseComponent",()=>H,"FilterBuilder",()=>F],3771277)},5120783,e=>{"use strict";var t=e.i(8711407),a=e.i(9937599),i=e.i(8626589),l=e.i(8486711),r=e.i(764581),n=e.i(2375916),s=e.i(6675233);e.i(3512434);var o=e.i(9835407),c=e.i(455575),u=e.i(7429602),d=e.i(1637579),m=e.i(1361980),p=e.i(5164288),f=e.i(1743600),h=e.i(5812308),g=e.i(6284227),x=e.i(3771277);let y=[...g.stringOperators,...g.stringMatchOperators],v={title:"Country",icon:(0,t.jsx)(a.Location,{}),Component:x.BaseComponent,description:"Client country derived from IP address",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Country cannot be empty")]),resolveValues:()=>m.default.getCountries().map(e=>({label:e.name,value:e.iso2.toUpperCase()})),allowedOperators:g.stringOperators,placeholder:{value:"Type a country name.."}},b={title:"Hostname",icon:(0,t.jsx)(r.WindowGlobe,{}),Component:x.BaseComponent,description:"Hostname of the incoming request",schema:o.z.union([h.hostnameSchema,o.z.array(h.hostnameSchema).min(1,"Hostname cannot be empty")]),allowedOperators:y,placeholder:{value:"Type a hostname.."}},w={title:"Request Header",icon:(0,t.jsx)(i.Hash,{}),Component:x.BaseComponent,description:"HTTP header key and value from request",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Request header cannot be empty")]),allowedOperators:[...y,...g.keyExistsOperator],allowKey:!0,placeholder:{value:"Type a value..",key:"X-Request-Header"}},j={title:"IP Address",icon:(0,t.jsx)(r.WindowGlobe,{}),Component:x.BaseComponent,description:"Client IP address or CIDR block",schema:o.z.union([h.ipAndCidrsSchema,o.z.array(h.ipAndCidrsSchema).min(1,"IP address cannot be empty")]),allowedOperators:g.stringOperators,placeholder:{value:"e.g. 10.0.0.1, 10.0.0.1/32"}},C={title:"Method",icon:(0,t.jsx)(i.Hash,{}),Component:x.BaseComponent,description:"HTTP method of the incoming request",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Method cannot be empty")]),resolveValues:()=>[{label:"GET",value:"GET"},{label:"HEAD",value:"HEAD"},{label:"POST",value:"POST"},{label:"DELETE",value:"DELETE"},{label:"PATCH",value:"PATCH"},{label:"PUT",value:"PUT"},{label:"CONNECT",value:"CONNECT"},{label:"OPTIONS",value:"OPTIONS"},{label:"TRACE",value:"TRACE"},{label:"DEBUG",value:"DEBUG"},{label:"QUERY",value:"QUERY"}],allowedOperators:g.stringOperators},S={title:"Environment",icon:(0,t.jsx)(r.WindowGlobe,{}),Component:x.BaseComponent,description:"Vercel deployment environment",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Vercel environment cannot be empty")]),resolveValues:()=>[{label:"Preview",value:"preview"},{label:"Production",value:"production"}],allowedOperators:g.stringOperators},_={title:"Request Path",icon:(0,t.jsx)(l.Route,{}),Component:x.BaseComponent,description:"Normalized URL path of the request excluding query",schema:o.z.union([h.pathSchema,o.z.array(h.pathSchema).min(1,"Path cannot be empty")]),allowedOperators:y,placeholder:{value:"e.g. /api, /signup/new"}},N={title:"Route",icon:(0,t.jsx)(l.Route,{}),Component:x.BaseComponent,description:"Framework determined route pattern",schema:o.z.union([h.pathSchema,o.z.array(h.pathSchema).min(1,"Path cannot be empty")]),allowedOperators:y,placeholder:{value:"e.g. /blog/[slug]"}},I={title:"Server Action Name",icon:(0,t.jsx)(l.Route,{}),Component:x.BaseComponent,description:"Next.js server action invoked",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Server action name cannot be empty")]),allowedOperators:y,placeholder:{value:"e.g. app/lib/action.ts#getLogin"}},A={title:"Raw Path",icon:(0,t.jsx)(l.Route,{}),Component:x.BaseComponent,description:"Raw URL path of the request excluding query",schema:o.z.union([h.pathSchema,o.z.array(h.pathSchema).min(1,"Path cannot be empty")]),allowedOperators:y,placeholder:{value:"e.g. /api/, /signup/new/"}},k={title:"User Agent",icon:(0,t.jsx)(i.Hash,{}),Component:x.BaseComponent,description:"HTTP User-Agent header from client",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"User Agent cannot be empty")]),allowedOperators:y,placeholder:{value:"e.g. curl"}},T={title:"Query",icon:(0,t.jsx)(i.Hash,{}),Component:x.BaseComponent,description:"Query parameter key and value",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Query cannot be empty")]),allowedOperators:[...y,...g.keyExistsOperator],allowKey:!0,placeholder:{key:"e.g. id, postId",value:"Type a value.."}},E={title:"Cookie",icon:(0,t.jsx)(i.Hash,{}),Component:x.BaseComponent,description:"Cookie name and value from request",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Cookie cannot be empty")]),allowedOperators:[...y,...g.keyExistsOperator],allowKey:!0,placeholder:{key:"Cookie-Name",value:"Type a value.."}},R={title:"Continent",icon:(0,t.jsx)(a.Location,{}),Component:x.BaseComponent,description:"Client continent derived from IP address",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Continent cannot be empty")]),resolveValues:()=>[{label:"Africa",value:"AF"},{label:"Antarctica",value:"AN"},{label:"Asia",value:"AS"},{label:"Europe",value:"EU"},{label:"North America",value:"NA"},{label:"Oceania",value:"OC"},{label:"South America",value:"SA"}],allowedOperators:g.stringOperators},P={title:"City",icon:(0,t.jsx)(a.Location,{}),Component:x.BaseComponent,description:"Client city derived from IP address",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"City cannot be empty")]),allowedOperators:y,placeholder:{value:"Type a city name.."}},D={title:"State",icon:(0,t.jsx)(a.Location,{}),Component:x.BaseComponent,description:"Client state derived from IP address",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"State cannot be empty")]),allowedOperators:y,placeholder:{value:"Type a state abbreviation.."}},L={title:"AS Number",icon:(0,t.jsx)(a.Location,{}),Component:x.BaseComponent,description:"Autonomous System Number from client IP",schema:o.z.union([h.digitSchema,o.z.array(h.digitSchema).min(1,"AS Number cannot be empty")]),allowedOperators:y,placeholder:{value:"Digits only, ex. 12345"}},O={title:"Vercel Region",icon:(0,t.jsx)(a.Location,{}),Component:x.BaseComponent,description:"Vercel region that handled request",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Vercel Region cannot be empty")]),resolveValues:()=>Object.values(d.regions).map(e=>({label:`${e.key} - ${e.name}`,value:e.key})),allowedOperators:g.stringOperators},M={title:"Protocol",icon:(0,t.jsx)(r.WindowGlobe,{}),Component:x.BaseComponent,description:"HTTP protocol version",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Protocol cannot be empty")]),resolveValues:()=>[{label:"HTTP/1.1",value:"HTTP/1.1"},{label:"HTTP/2.0",value:"HTTP/2.0"}],allowedOperators:g.stringOperators},z={title:"JA3 Digest",icon:(0,t.jsx)(n.Shield,{}),Component:x.BaseComponent,description:"JA3 TLS fingerprint of client connection",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"JA3 cannot be empty")]),allowedOperators:y,placeholder:{value:"Type a value.."},allowedPlans:["enterprise"]},B={title:"JA4 Digest",icon:(0,t.jsx)(n.Shield,{}),Component:x.BaseComponent,description:"JA4 TLS fingerprint of client connection",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"JA4 cannot be empty")]),allowedOperators:y,placeholder:{value:"Type a value.."}},$={title:"@vercel/firewall",icon:(0,t.jsx)(n.Shield,{}),Component:x.BaseComponent,description:"Rate limit ID from @vercel/firewall package",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Rate-limit ID cannot be empty")]),allowedOperators:[g.withIdOperator],placeholder:{value:"Rate limit ID"}},F={path:_,route:N,server_action:I,raw_path:A,method:C,user_agent:k,header:w,query:T,bot_name:{title:"Bot Name",icon:(0,t.jsx)(s.Robot,{}),badge:(0,t.jsx)(u.default,{size:"sm"}),Component:x.BaseComponent,description:"Common name of the identified known bot",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Bot name cannot be empty")]),resolveValues:()=>(0,f.fetchVerifiedBots)().then(e=>e.names).catch(e=>(c.toasts.error(`Error fetching Bot Name: ${e instanceof Error?e.message:String(e)}`),[])),allowedOperators:y,placeholder:{value:"Type a bot name…"},accessControl:e=>{let{team:t,flags:a}=e;return(0,p.isSecurityPlusEnabled)({team:t})||!!a?.get("securityPlusAccess")}},bot_category:{title:"Bot Category",icon:(0,t.jsx)(s.Robot,{}),badge:(0,t.jsx)(u.default,{size:"sm"}),Component:x.BaseComponent,description:"Category identified known bot",schema:o.z.union([h.stringSchema,o.z.array(h.stringSchema).min(1,"Bot category cannot be empty")]),resolveValues:()=>(0,f.fetchVerifiedBots)().then(e=>e.categories).catch(e=>(c.toasts.error(`Error fetching Bot Category: ${e instanceof Error?e.message:String(e)}`),[])),allowedOperators:y,placeholder:{value:"Type a bot category…"},accessControl:e=>{let{team:t,flags:a}=e;return(0,p.isSecurityPlusEnabled)({team:t})||!!a?.get("securityPlusAccess")}},cookie:E,host:b,environment:S,ip_address:j,protocol:M,region:O,geo_continent:R,geo_country:v,geo_country_region:D,geo_city:P,geo_as_number:L,ja4_digest:B,ja3_digest:z,rate_limit_api_id:$,target_path:{...N,deprecated:e=>"target_path"!==e}};e.s(["baseModules",0,F])}]);

//# debugId=5e93c2dd-64a1-c3ae-677b-de5cf8b7d7fb
//# sourceMappingURL=7f27fa295d615e10.js.map
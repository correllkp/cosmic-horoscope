;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="01f9d4e3-705f-980c-fd16-adfa9415af38")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4047734,e=>{"use strict";var t=e.i(8711407),i=e.i(1176592),n=e.i(7137884),l=e.i(8517043),a=e.i(1232681),s=e.i(7917902),r=e.i(1717203),c=e.i(7557283),d=e.i(5633797),o=e.i(6214931),u=e.i(9983553),h=e.i(2789918),m=e.i(1877305),p=e.i(5807088);function g(){let e=(0,s.useAccount)(),{isLoading:i}=(0,r.default)();return!e||e.isLoading||!e.user||i?(0,t.jsx)(p.default,{height:108}):(0,t.jsx)(b,{})}function b(){let e=(0,s.useAccount)(),{can:p}=(0,r.default)(),g=p(c.Action.Update,c.Resource.ConcurrentBuilds),{team:b}=e,x=b?.billing?.plan,f=function(e){if(!e?.billing?.plan)return null;let t=e.billing.plan,i=e.resourceConfig?.concurrentBuilds;if("enterprise"===t&&i)return i;let n=d.LIMITS[t];return("concurrentBuilds"in n?n.concurrentBuilds:null)||null}(b),j="enterprise"===x,C=b?.billing?.plan==="pro"&&"plus"===b.billing.planIteration,y=(0,u.useToggleConcurrentBuilds)("billing-settings-concurrent-builds"),T=!g||j,S=(0,i.useMemo)(()=>C?"Concurrent Builds are being replaced by On-Demand Build Minutes and can no longer be added, only removed.":"hobby"===x?"Concurrent Builds are not available on the Hobby plan.":j?"The number of included concurrent builds is specified by your Enterprise contract.":g?`Your plan grants you ${f} free Concurrent Build${1!==(f||0)?"s":""}.`:"You need additional permissions to manage your team's concurrent builds.",[x,j,g,f,C]);return b&&(!C||y.isConcurrentBuildsEnabled)?(0,t.jsx)("div",{children:(0,t.jsxs)(l.Fieldset,{disabled:T,children:[(0,t.jsx)(n.FieldsetContent,{disabled:T,noBottomPadding:!0,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsx)(m.FieldsetTitle,{id:o.TEAM_SETTINGS_NAVIGATION_TITLES.billing.concurrentBuilds,children:o.TEAM_SETTINGS_NAVIGATION_TITLES.billing.concurrentBuilds}),(0,t.jsx)(h.PaidAddOn,{addOn:"concurrentBuilds",descriptionOverride:y.addOn.description,disable:y.disableConcurrentBuilds,enableOrUpdate:y.enableConcurrentBuilds,isEnabled:y.isConcurrentBuildsEnabled,modal:y.ConcurrentBuildsModal,pricingCopy:y.pricingCopy,showPrice:!1,showTitle:!1,team:b})]})}),(0,t.jsx)(a.FieldsetFooter,{disabled:!1,highlight:T,children:(0,t.jsx)(a.FieldsetFooter.Status,{children:S})})]})}):null}e.s(["default",()=>g])},7507224,e=>{"use strict";var t=e.i(8711407),i=e.i(1176592),n=e.i(7137884),l=e.i(8517043),a=e.i(1232681),s=e.i(3306538),r=e.i(57106),c=e.i(7812221),d=e.i(7917902),o=e.i(1717203),u=e.i(7557283),h=e.i(6214931),m=e.i(5338940),p=e.i(277234),g=e.i(3848416),b=e.i(4244280),x=e.i(7909933),f=e.i(2466450),j=e.i(364898),C=e.i(8042625),y=e.i(1574218);let T=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return async t=>{let{team:i}=t;if(!i)throw Error(y.IS_DEV?"`team` not found in `generateToggleOnDemandConcurrentBuildsFunction`":"Error enabling On-Demand Concurrency");await (0,p.fetchAPI)(`${b.API_PROJECTS_BULK_UPDATE_ELASTIC_CONCURRENCY}${(0,C.encode)({teamId:i.id})}`,{method:"PATCH",body:{elasticConcurrencyEnabled:e},throwOnHTTPError:!0})}},S=T(!0),v=T(!1);var A=e.i(1821888),N=e.i(4004502),w=e.i(9376050),_=e.i(9689002),E=e.i(5255926),O=e.i(8735244),I=e.i(6143247);function B(e){let{swr:n}=e,l=(0,i.useRef)(null),[a,s]=(0,i.useState)(!1),{loadMore:r,isReachingEnd:c,isLoadingMore:d,initialDataLoaded:o}=n;return((0,i.useEffect)(()=>{o&&!c&&!d&&a&&r()},[o,a,d,c,r]),(0,i.useEffect)(()=>{let e=l.current;if(!e)return;let t=new IntersectionObserver(e=>{s(e[0].isIntersecting)});return t.observe(e),()=>{t.disconnect()}},[s]),!o||c)?null:(0,t.jsx)("div",{ref:l,className:"flex justify-center pt-1 pb-3 text-xs text-gray-500",children:(0,t.jsx)("span",{className:"ml-2",children:"Loading more…"})})}function k(e){let{label:n,options:l,isLoading:a,isSelected:s,onChange:r,onSearch:c,parseNewValue:d,getId:o,getValue:u,value:h,open:m,reverse:p,hasMore:g,swr:b,...x}=e,[f,j]=(0,i.useState)(""),[C,y]=(0,i.useState)(!1),[T,S]=(0,i.useState)(!1),v=(0,i.useRef)(null),A=(0,i.useRef)(null),k=(0,i.useRef)(0);(0,i.useEffect)(()=>{h&&m&&setTimeout(()=>{let e=A.current?.querySelector(`[data-value="${u(h)}"]`);e?.scrollIntoView({block:"start"})},50)},[m]);let F=(0,i.useMemo)(()=>l?.length?`Find ${n}...`:`Enter ${n}`,[l,n]),{selected:P,menuItems:R}=(0,i.useMemo)(()=>{let e={selected:[],menuItems:[]},t=new Set;for(let i of l??[]){let n=o(i);t.has(n)||(t.add(n),"menu"===i.type?e.menuItems.push(i):e.selected.push(i))}return e},[l,s,o]),L=(0,i.useCallback)(e=>{j(e),y(!1),clearTimeout(k.current),c&&(k.current=setTimeout(()=>{S(!0),c(e).finally(()=>S(!1))},250))},[c]),D=(0,i.useCallback)(e=>{if("Tab"===e.key)e.key=e.shiftKey?"ArrowUp":"ArrowDown";else if(" "===e.key&&0===f.trim().length){e.preventDefault();let t=A.current?.querySelector('[aria-selected="true"] input[type="checkbox"]');t?.click()}},[f]);return(0,t.jsxs)(w.Command,{className:(0,I.cn)("w-100 rounded-lg border-gray-alpha-400 bg-background-100 shadow-menu flex",p?"flex-col-reverse":"flex-col"),loop:!0,onKeyDown:D,children:[(0,t.jsxs)("div",{className:(0,I.cn)("flex w-full items-center justify-between px-4 py-3",l?.length!==0&&"border-b"),children:[(0,t.jsx)(w.Command.Input,{className:(0,I.cn)("w-full border-none bg-transparent text-sm outline-none",C&&"text-[--geist-error]"),onValueChange:L,placeholder:F,ref:v,value:f}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-[14px] flex justify-center",children:T&&(0,t.jsx)(O.Spinner,{size:14})}),(0,t.jsx)(_.Kbd,{small:!0,children:"Esc"})]})]}),(0,t.jsxs)(w.Command.List,{className:"flex max-h-[288px] w-full flex-col overflow-y-auto",ref:A,children:[P.length>0&&!a?(0,t.jsxs)(t.Fragment,{children:[R.length?(0,t.jsx)(M,{addBorder:!0,getId:o,getValue:u,items:R,onChange:r,setSearch:j,...x},"menu"):null,(0,t.jsx)(M,{getId:o,getValue:u,items:P,onChange:r,setSearch:j,...x}),(0,t.jsx)(B,{swr:b})]}):null,a?(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2 p-2","data-testid":(0,N.tid)("command-menu","loading"),children:[(0,t.jsx)(E.Skeleton,{className:"h-4",width:"100%"}),(0,t.jsx)(E.Skeleton,{className:"h-4",width:"100%"}),(0,t.jsx)(E.Skeleton,{className:"h-4",width:"100%"})]}):null,!a&&!T&&l&&(0,t.jsxs)(w.Command.Empty,{className:"px-4 py-3 text-center text-sm text-gray-900",children:["No matching ",n.toLowerCase()]})]})]})}function M(e){let{heading:i,items:n,setSearch:l,renderItem:a,getId:s,getValue:r,onChange:c,addBorder:d}=e;return n.length?(0,t.jsx)(w.Command.Group,{className:(0,I.cn)("h-full p-1.5  [&>[cmdk-group-heading]]:px-2 [&>[cmdk-group-heading]]:pb-1 [&>[cmdk-group-heading]]:pt-0.5 [&>[cmdk-group-heading]]:text-xs [&>[cmdk-group-heading]]:text-gray-800",d&&"border-b"),heading:i,children:n.map(e=>(0,t.jsx)(w.Command.Item,{className:"w-full cursor-pointer rounded-md text-sm *:aria-selected:rounded  *:aria-selected:bg-gray-100 focus-visible:bg-gray-100 active:bg-gray-100",onSelect:()=>{c(e),l("")},value:r(e),children:a(e)},s(e)))}):null}var F=e.i(2107254),P=e.i(3869281),R=e.i(455575),L=e.i(2121538);let D=e=>{let{id:t}=e;return t},$=e=>{let{label:t,group:i}=e;return`${t}${i?` ${i}`:""}`},U=e=>"menu"===e.type?(0,t.jsxs)("div",{className:"flex w-full items-center gap-2 rounded px-2 py-1.5",children:[e?.icon?e.icon():null,e.label]}):(0,t.jsx)("div",{className:"flex w-full items-center gap-2 rounded px-2 py-1.5",children:(0,t.jsx)(P.Checkbox,{checked:e.selected,className:"text-sm",disabled:e.loading,readOnly:!0,children:e.label})});function H(e){let{label:n,value:l,onOpenChange:a,open:s,onChange:r,isLoading:c,children:d,showAllProjectsOption:o}=e,[u,h]=(0,i.useState)([]),[m,p]=(0,i.useState)(!1),b=(0,i.useRef)(""),[x,f]=(0,F.useProjectListInfinite)({limit:10,latestDeployments:0,search:b.current,sortByElasticConcurrency:"desc"},{},!1,!0),{mutate:j}=x,C=(0,g.useRevalidateBuildMachinesCache)(),y=(0,R.useToasts)(),T=f.projects,S=(0,i.useMemo)(()=>[...o?[{id:"all-projects",label:"All Projects",type:"menu",icon:()=>(0,t.jsx)(L.DoubleCheck,{size:16})}]:[],...T?.map(e=>{let t=u.includes(e.id)||m,i=e.resourceConfig?.elasticConcurrencyEnabled??!1;return{id:e.id,label:e.name,group:"Projects",type:"checkbox",selected:!!m||(t?!i:i),loading:t}})||[]],[T,u,m,o]),v=async e=>{if("menu"===e.type&&"all-projects"===e.id){p(!0);try{let t=await r(e);return await j(e=>e?e.map(e=>({...e,projects:e.projects.map(e=>({...e,resourceConfig:{...e.resourceConfig,elasticConcurrencyEnabled:!0}}))})):[],{revalidate:!1}),await C(),y.success("Enabled On-Demand Concurrent Builds for all projects"),t}catch(e){throw y.error("Failed to enable On-Demand Concurrent Builds for all projects"),e}finally{p(!1)}}{let t=!e.selected;h(t=>[e.id,...t]);try{let i=await r(e);return await j(e=>e?e.map(e=>({...e,projects:e.projects.map(e=>e.id===i.id?i:e)})):[],{revalidate:!1}),await C(),y.success(`${t?"Enabled":"Disabled"} On-Demand Concurrent Builds for project ${e.label}`),i}catch(i){throw y.error(`Failed to ${t?"enable":"disable"} On-Demand Concurrent Builds for project ${e.label}`),i}finally{h(t=>t.filter(t=>t!==e.id))}}},N=async e=>{b.current=e,await x.mutate()};return(0,t.jsxs)(A.Root,{modal:!0,onOpenChange:a,open:s,children:[(0,t.jsx)(A.Anchor,{className:"flex",children:(0,t.jsx)(A.Trigger,{asChild:!0,children:d})}),(0,t.jsx)(A.Portal,{children:(0,t.jsx)(A.Content,{align:"start",className:"tailwind-preflight",sideOffset:8,children:(0,t.jsx)(k,{getId:D,getValue:$,isLoading:c,label:n,onChange:v,open:s,options:S,renderItem:U,value:l,isSelected:e=>{let{selected:t}=e;return!!t},hasMore:!f.isReachingEnd,swr:f,onSearch:N})})})]})}let G=(e,t)=>{let i,n=e?(i=new URLSearchParams({teamId:e}),t&&i.append("elasticConcurrencyEnabled","1"),`${b.API_PROJECTS_COUNT}?${i.toString()}`):null;return(0,x.default)(n,async e=>(0,p.fetchAPI)(e),{revalidateOnFocus:!1,revalidateOnReconnect:!1})};async function V(e){let{elasticConcurrencyEnabled:t,projectId:i,teamId:n}=e,l=new URLSearchParams;return n&&l.append("teamId",n),await (0,p.fetchAPI)(`${(0,b.API_PROJECTS_VERSION)("v9")}/${i}?${l.toString()}`,{method:"PATCH",body:JSON.stringify({resourceConfig:{elasticConcurrencyEnabled:t}}),throwOnHTTPError:!0})}let z={name:"onDemandConcurrentBuilds",disable:v,price:.014,enable:S,enableSteps:{confirm:{lineItems:[{name:"On-Demand Concurrent Builds",price:.014,priceDescriptor:"per build minute"}]}}};var K=e.i(2789918),Y=e.i(8366444);e.i(6483798);var q=e.i(8287059),W=e.i(6468432),J=e.i(1877305),Q=e.i(5807088);function X(){let e=(0,d.useAccount)(),{isLoading:i}=(0,o.default)();return!e||e.isLoading||!e.user||i?(0,t.jsx)(Q.default,{height:108}):(0,t.jsx)(Z,{})}function Z(){let e=(0,d.useAccount)(),{can:p}=(0,o.default)(),b=(0,q.useOpenUpgradeModal)(),x=p(u.Action.Update,u.Resource.ConcurrentBuilds),C=(0,Y.useOnDemandConcurrentBuilds)(e.team,x),y=(e=>{let{team:n}=(0,m.useTeam)(),l=(0,g.useRevalidateBuildMachinesCache)(),{data:a,isLoading:s,mutate:r}=G(n?.id,!0),{data:c,isLoading:d,mutate:o}=G(n?.id),[u,h]=(0,i.useState)(!1),[p,b]=(0,i.useState)("disabled"),x="number"==typeof a?.count&&"number"==typeof c?.count&&a.count>=c.count;(0,i.useEffect)(()=>{b((a?.count??0)>0?"enabled":"disabled")},[a?.count]);let C="setup"===p?"Select Projects":"number"==typeof a?.count?x?"All Projects":`${a.count} ${1===a.count?"project":"projects"}`:void 0,y={...z,isEnabled:()=>"enabled"===p||"setup"===p,analyticsEventSource:e,disableSteps:{disable:{customDisableCopy:"Disabling On-Demand Concurrent Builds will disable it for all projects."}},currentAddOnValue:a?.count??0,onSuccess:async()=>{b("disabled"),await r(),await o(),await l()}},{isEnabled:T,openDisableModal:v,AddOnModal:A}=(0,j.useTogglePaidAddOn)(y);return{configureUIText:C,configureUIWrapper:e=>(0,t.jsx)(H,{label:"Project",open:u,onOpenChange:e=>{h(e),!1===e&&"setup"===p&&b("disabled")},onChange:async e=>{if("menu"===e.type&&"all-projects"===e.id){await S({team:n,addOnValue:0}),await r(),await l();return}let t=await V({elasticConcurrencyEnabled:!e.selected,projectId:e.id,teamId:n?.id});if(a){let t=e.selected?-1:1,i=Math.max(0,a.count+t);await r({...a,count:i},{revalidate:!0})}else await r();return await l(),t},showAllProjectsOption:!x,children:e}),addOn:y,isOnDemandConcurrentBuildsEnabled:!s&&!d&&T,enableOnDemandConcurrentBuilds:function(){"disabled"===p&&b("setup"),h(!0)},disableOnDemandConcurrentBuilds:v,OnDemandConcurrentBuildsModal:A,pricingCopy:`Starts at ${(0,f.formatCurrency)(.014,"usd","auto",100)} per build minute`}})("billing-settings-on-demand-concurrent-builds"),{team:T}=e,v=(0,W.isHobby)(T),A=(0,i.useMemo)(()=>(0,W.isHobby)(T)?(0,t.jsxs)("p",{children:["Learn more about"," ",(0,t.jsx)(r.Link,{external:!0,href:"/docs/deployments/managing-builds#on-demand-concurrent-builds",type:"highlight",children:"On-Demand Concurrent Builds"})]}):"enterprise-non-unbundled"===C.disabledReason?(0,t.jsxs)("p",{children:["To enable On-Demand Concurrent Builds"," ",(0,t.jsx)(r.Link,{external:!0,href:c.CONTACT_SALES_DASHBOARD_HREF,type:"highlight",children:"Contact Sales"})]}):C.enabled?(0,t.jsxs)("p",{children:["Learn more about"," ",(0,t.jsx)(r.Link,{external:!0,href:"/docs/deployments/managing-builds#on-demand-concurrent-builds",type:"highlight",children:"On-Demand Concurrent Builds"})]}):(0,t.jsx)("p",{children:"You need additional permissions to manage your team's On-Demand Concurrent Builds."}),[C,T]),N=!C.enabled&&!(0,W.isHobby)(T);return T?(0,t.jsx)("div",{children:(0,t.jsxs)(l.Fieldset,{disabled:N,children:[(0,t.jsx)(n.FieldsetContent,{disabled:N,noBottomPadding:!0,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsx)(J.FieldsetTitle,{id:h.TEAM_SETTINGS_NAVIGATION_TITLES.billing.onDemandConcurrentBuilds,suffix:v?(0,t.jsx)(s.Badge,{className:"self-center cursor-pointer",onClick:()=>{b({teamHint:T?.id,source:"on-demand-concurrent-builds-settings-badge"})},size:"sm",variant:"blue",children:"Pro"}):null,children:h.TEAM_SETTINGS_NAVIGATION_TITLES.billing.onDemandConcurrentBuilds}),(0,t.jsx)(K.PaidAddOn,{addOn:"onDemandConcurrentBuilds",allowUpgrade:!0,configureUIText:y.configureUIText,configureUIWrapper:y.configureUIWrapper,disabled:N,disable:y.disableOnDemandConcurrentBuilds,enableOrUpdate:y.enableOnDemandConcurrentBuilds,isEnabled:y.isOnDemandConcurrentBuildsEnabled,modal:y.OnDemandConcurrentBuildsModal,pricingCopy:y.pricingCopy,showLearnMore:!1,showPrice:!1,showTitle:!1,team:T})]})}),(0,t.jsx)(a.FieldsetFooter,{disabled:!1,highlight:N,children:(0,t.jsx)(a.FieldsetFooter.Status,{children:A})})]})}):null}e.s(["BillingOnDemandConcurrentBuilds",()=>X],7507224)},5534317,e=>{e.v({actionContainer:"index-module__bhtKBq__actionContainer",modalTitle:"index-module__bhtKBq__modalTitle"})},3971538,e=>{"use strict";var t=e.i(8711407),i=e.i(1176592),n=e.i(7137884),l=e.i(4030453),a=e.i(5063443),s=e.i(8517043),r=e.i(1232681),c=e.i(6891161),d=e.i(3895030),o=e.i(1906681),u=e.i(57106),h=e.i(4004502),m=e.i(119294),p=e.i(6352514),g=e.i(5802506),b=e.i(277234),x=e.i(4244280),f=e.i(5338940),j=e.i(5140444),C=e.i(1717203),y=e.i(7557283),T=e.i(4787360),S=e.i(5807088),v=e.i(1877305),A=e.i(5534317),N=e.i(9722978);function w(){let{team:e,isTeam:i,isReady:n}=(0,f.useTeam)(),{user:l}=(0,j.useUser)(),{isLoading:a}=(0,C.default)(),s=i?e?.remoteCaching?.enabled:l?.remoteCaching?.enabled;return n||a?(0,t.jsx)(E,{isEnabled:!!s,isTeam:i,team:e}):(0,t.jsx)(S.default,{height:108})}function _(e){let{error:i,canUpdate:n}=e;return i?.message?(0,t.jsx)(a.ErrorText,{children:(0,t.jsx)(l.Error,{error:i})}):n?(0,t.jsxs)("span",{children:["Learn more about"," ",(0,t.jsx)(u.Link,{external:!0,href:"https://vercel.com/docs/monorepos/remote-caching",onClick:()=>m.analytics.track(p.AnalyticsEvent.REMOTE_CACHING_LEARN_MORE),variant:"highlight",children:"Remote Caching"})]}):(0,t.jsx)("span",{children:"You need additional permissions to manage your team's remote caching configuration."})}function E(e){let{isEnabled:l,team:a,isTeam:c}=e,{can:u}=(0,C.default)(),[f,j]=(0,i.useState)(l),[S,w]=(0,i.useState)(null),[E,I]=(0,i.useState)(!1),B=!c||u(y.Action.Update,y.Resource.Team),k=u(y.Action.Update,y.Resource.RemoteCaching),M=B&&k,F=async e=>{let t=c?`${x.API_TEAMS}/${a?.id||""}`:x.API_USER;j(e);try{await (0,b.fetchAPI)(`${t}`,{method:"PATCH",body:{remoteCaching:{enabled:e}}})}catch(t){w(t),j(!e)}finally{m.analytics.track(p.AnalyticsEvent.REMOTE_CACHING_TOGGLE,{enabled:e})}};return(0,t.jsxs)("div",{children:[(0,t.jsxs)(s.Fieldset,{disabled:!M,children:[(0,t.jsxs)(n.FieldsetContent,{disabled:!M,children:[(0,t.jsx)(v.FieldsetTitle,{id:T.PERSONAL_ACCOUNT_SETTINGS_NAVIGATION_TITLES.billing.remoteCaching,children:T.PERSONAL_ACCOUNT_SETTINGS_NAVIGATION_TITLES.billing.remoteCaching}),(0,t.jsx)(d.FieldsetSubtitle,{children:c?"Allows you to share a single cache with your team.":"Allows you to share a cache of artifacts to optimize speed."}),(0,t.jsxs)("div",{className:(0,N.default)("flex flex-row items-center justify-between flex-initial",A.default.actionContainer),children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-14",children:`Remote caching is ${f?"enabled":"disabled"}.`}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Remote caching allows you to share a single cache across multiple machines."})]}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,t.jsx)(o.Toggle,{checked:f,"data-testid":(0,h.tid)("remote-caching","toggle"),disabled:!M,onChange:()=>{let e=!f;e?F(e):I(!0)},size:"large"})})]})]}),(0,t.jsx)(r.FieldsetFooter,{disabled:!1,highlight:!M,children:(0,t.jsx)(r.FieldsetFooter.Status,{children:(0,t.jsx)(_,{canUpdate:M,error:S})})})]}),(0,t.jsx)(O,{active:E,isTeam:c,onConfirm:()=>{F(!1).catch(g.captureError)},setActive:I})]})}function O(e){let{active:i,setActive:n,isTeam:l,onConfirm:a}=e;return(0,t.jsxs)(c.Modal.Modal,{active:i,onClickOutside:()=>{m.analytics.track(p.AnalyticsEvent.REMOTE_CACHING_CONFIRMATION_CLOSE),n(!1)},width:"500px",children:[(0,t.jsxs)(c.Modal.Body,{children:[(0,t.jsx)("div",{className:(0,N.default)("flex flex-col items-stretch justify-start flex-initial",A.default.modalTitle),children:(0,t.jsx)(c.Modal.Title,{children:"Disable Remote Caching"})}),(0,t.jsxs)(c.Modal.Subtitle,{children:[l?"Disabling remote caching will reduce your monorepo's performance across your team.":"Disabling remote caching can reduce your monorepo's build performance."," ",(0,t.jsx)(u.Link,{external:!0,href:"https://vercel.com/docs/monorepos/remote-caching",variant:"highlight",children:"Learn more"})]})]}),(0,t.jsxs)(c.Modal.Actions,{children:[(0,t.jsx)(c.Modal.Action,{onClick:()=>{m.analytics.track(p.AnalyticsEvent.REMOTE_CACHING_CONFIRMATION_CANCEL),n(!1)},type:"secondary",children:"Cancel"}),(0,t.jsx)(c.Modal.Action,{onClick:()=>{n(!1),a()},children:"Continue"})]})]})}e.s(["RemoteCaching",()=>w,"RemoteCachingFieldSet",()=>E])},8264957,e=>{"use strict";var t=e.i(8711407),i=e.i(1176592),n=e.i(7137884),l=e.i(8517043),a=e.i(57106),s=e.i(5338940),r=e.i(5140444),c=e.i(7812221),d=e.i(9041876),o=e.i(7539829),u=e.i(1877305),h=e.i(5807088),m=e.i(1232681),p=e.i(2504781),g=e.i(9358876),b=e.i(5072965);function x(e){let{saveState:i}=e,{handleSave:n,handleCancel:l,saving:s,saveError:r,dirtyCount:c}=i;return(0,t.jsxs)(m.FieldsetFooter,{children:[(0,t.jsx)(m.FieldsetFooter.Status,{children:r?(0,t.jsx)("span",{className:"text-red-900",children:r}):c?(0,t.jsxs)("span",{className:"text-gray-1000",children:[c," ",(0,g.pluralize)("project",c)," modified"]}):(0,t.jsxs)("span",{children:["Learn more about the types of"," ",(0,t.jsx)(a.Link,{external:!0,href:"/docs/builds/managing-builds#build-machine-types",type:"highlight",children:"Build Machines"})]})}),(0,t.jsxs)(m.FieldsetFooter.Actions,{className:"gap-x-2",children:[c?(0,t.jsx)(p.Button,{type:"secondary",size:"small",onClick:l,disabled:s,...(0,b.createTrackingAttributes)({element:"button",name:"settings_build_machines_cancel",projectCount:c.toString()}),children:"Cancel"}):null,(0,t.jsx)(p.Button,{size:"small",onClick:n,loading:s,disabled:s||!c,...(0,b.createTrackingAttributes)({element:"button",name:"settings_build_machines_save",projectCount:c.toString()}),children:"Save"})]})]})}var f=e.i(3306538);e.i(6483798);var j=e.i(8287059);function C(){let e=(0,j.useOpenUpgradeModal)(),{team:i}=(0,s.useTeam)();return(0,t.jsxs)(l.Fieldset,{children:[(0,t.jsx)(n.FieldsetContent,{children:(0,t.jsxs)("div",{className:"grid gap-3",children:[(0,t.jsx)(u.FieldsetTitle,{suffix:(0,t.jsx)(f.Badge,{className:"self-center cursor-pointer",onClick:()=>{e({teamHint:i?.id,source:"build-machines-settings-badge"})},size:"sm",variant:"blue",children:"Pro"}),children:"Build Machines"}),(0,t.jsx)("p",{children:"This feature is only available for Pro and Enterprise accounts."})]})}),(0,t.jsx)(m.FieldsetFooter,{disabled:!1,highlight:!0,children:(0,t.jsx)(m.FieldsetFooter.Status,{children:(0,t.jsxs)("span",{children:["Learn more about"," ",(0,t.jsx)(a.Link,{external:!0,href:"/docs/builds/managing-builds#build-machine-types",type:"highlight",children:"Build Machines"})]})})})]})}var y=e.i(1688950),T=e.i(2879936),S=e.i(8923565),v=e.i(6870754),A=e.i(5468328),N=e.i(8835183),w=e.i(3169345),_=e.i(9992076),E=e.i(6143247),O=e.i(2107254),I=e.i(4884125),B=e.i(2689512),k=e.i(6357175),M=e.i(7557283),F=e.i(4844919),P=e.i(455575),R=e.i(8248823);let L={q:T.parseAsString,filter:T.parseAsString};function D(n){let{team:l,defaultBuildMachine:s,allowedBuildMachines:r,onSaveStateChange:c}=n,[o,u]=(0,i.useState)({}),[{q:h,filter:m},p]=(0,T.useQueryStates)(L,{history:"replace",shallow:!0}),g=m&&Object.keys(I.BUILD_MACHINES).includes(m)?m:null,x=(0,k.useDebouncedValueWithTransition)(h,150),[f,j]=(0,i.useState)(10),C=(0,i.useMemo)(()=>{if(g)return g===s?"standard"===s?["default"]:[g,"default"]:[g]},[g,s]),[{error:y,mutate:D},{projects:$,loadMore:U,isLoadingMore:H,isReachingEnd:G,initialDataLoaded:V}]=(0,O.useProjectListInfinite)({slug:l?.slug,limit:20,search:x??void 0,buildMachineTypes:C,includePermissions:!0},{revalidateOnFocus:!1},!1,!0),{saving:z,saveError:K,dirtyCount:Y,handleSave:q,handleCancel:W}=function(t){let{team:n,projectsById:l,pendingBuildMachines:a,setPendingBuildMachines:s,onSaveSuccess:r}=t,c=(0,P.useToasts)(),[o,u]=(0,i.useState)(!1),[h,m]=(0,i.useState)(null),p=(0,i.useMemo)(()=>{let e=[];return Object.entries(a).forEach(t=>{let[i,a]=t,s=l[i];if(!s)return;let r=(0,d.getProjectBuildMachine)(s,n);a!==r&&e.push({project:s,prevMachine:r,newMachine:a})}),e},[a,l,n]),g=p.length,b=(0,i.useCallback)(async()=>{if(0!==p.length&&n?.id){u(!0),m(null);try{let{updateProjectSettingsV9:t}=await e.A(8768757),i=await Promise.allSettled(p.map(async e=>{let{project:i,newMachine:l}=e,a=await t(i.name,n.id,{resourceConfig:{buildMachineType:"standard"===l?null:l}});return{project:i,newMachine:l,response:a}})),l=i.filter(e=>"fulfilled"===e.status).length,a=i.filter(e=>"rejected"===e.status).length;if(l>0&&c.success(`Successfully updated ${l} project${1===l?"":"s"}`),a>0){let e=i.map((e,t)=>"rejected"===e.status?p[t].project.name:null).filter(Boolean);m(`Failed to update ${a} project${1===a?"":"s"}: ${e.join(", ")}`),c.error(`Failed to update ${a} project${1===a?"":"s"}`)}await r(),s(e=>{let t={...e};return i.forEach((e,i)=>{"fulfilled"===e.status&&delete t[p[i].project.id]}),t})}catch(t){let e=(0,R.errorToString)(t);m(e),c.error(`Failed to update projects: ${e}`)}finally{u(!1)}}},[p,n?.id,c,s,r]);return{saving:o,saveError:h,dirtyCount:g,handleSave:b,handleCancel:(0,i.useCallback)(()=>{s(()=>({})),m(null)},[s])}}({team:l,projectsById:(0,i.useMemo)(()=>Object.fromEntries($.map(e=>[e.id,e])),[$]),pendingBuildMachines:o,setPendingBuildMachines:u,onSaveSuccess:D});(0,i.useEffect)(()=>{c({saving:z,saveError:K,dirtyCount:Y,handleSave:q,handleCancel:W})},[z,K,Y,q,W,c]);let J=(0,i.useMemo)(()=>$.map(e=>({project:e,buildMachine:(0,d.getProjectBuildMachine)(e,l)})),[$,l]),Q=(0,i.useMemo)(()=>J.slice(0,f),[J,f]),X=f<J.length,Z=!G&&f>=$.length,ee=(0,i.useCallback)(async()=>{Z&&await U(),j(e=>e+20)},[Z,U]),et=(0,i.useCallback)((e,t)=>{u(i=>({...i,[e]:t}))},[u]);return((0,i.useEffect)(()=>{j(10)},[h,g]),y)?(0,t.jsx)("div",{children:"We couldn't load your projects. Refresh the page or try again in a moment."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-gray-1000 text-heading-16 mt-2",children:"Search Projects"}),(0,t.jsxs)("div",{className:"flex flex-row items-center gap-4 flex-wrap",children:[(0,t.jsx)("div",{className:"flex-grow",children:(0,t.jsx)(N.SearchInput,{value:h??"",placeholder:"Search projects…",onChange:e=>{p({q:e.target.value||null})},width:"100%",...(0,b.createTrackingAttributes)({element:"input",name:"settings_build_machines_search"})})}),(0,t.jsxs)(S.Switch,{name:"filter",style:{alignSelf:"flex-start"},children:[(0,t.jsx)(S.Switch.Control,{checked:null===g,label:"All",onClick:()=>{p({filter:null})},value:"all",...(0,b.createTrackingAttributes)({element:"button",name:"settings_build_machines_filter",buildMachine:"all"})}),(0,t.jsx)(t.Fragment,{children:r.map(e=>(0,t.jsx)(S.Switch.Control,{checked:g===e,label:e.charAt(0).toUpperCase()+e.slice(1),onClick:()=>{p({filter:e})},value:e,...(0,b.createTrackingAttributes)({element:"button",name:"settings_build_machines_filter",buildMachine:e})},e))})]})]}),V?Q.length>0?(0,t.jsx)("div",{className:"relative rounded border border-solid border-gray-alpha-400 bg-background-100",children:(0,t.jsx)("div",{className:"overflow-hidden rounded",children:(0,t.jsxs)(w.Table,{className:"[&>tbody:first-of-type]:hidden",children:[(0,t.jsxs)(w.Table.Colgroup,{children:[(0,t.jsx)(w.Table.Col,{className:"w-[30%] max-w-[180px]"}),r.map(e=>(0,t.jsx)(w.Table.Col,{className:"w-[15%]"},e))]}),(0,t.jsx)(w.Table.Header,{children:(0,t.jsxs)(w.Table.Row,{className:"bg-background-200",children:[(0,t.jsx)(w.Table.Head,{className:"pl-5 font-medium",children:"Project"}),r.map(e=>(0,t.jsx)(w.Table.Head,{className:"font-medium text-center last:text-center",children:(0,F.default)(e)},e))]})}),(0,t.jsx)(w.Table.Body,{bordered:!0,virtualize:!0,children:Q.map((e,i)=>{let{project:n,buildMachine:s}=e,c=`/${l?.slug}/${encodeURIComponent(n.name)}/settings/build-and-deployment#build-machine`,d=o[n.id]||s,u=d!==s,h=n.permissions?.buildMachine?.includes(M.Action.Update);return(0,t.jsxs)(w.Table.Row,{className:(0,E.cn)("transition-[box-shadow,background-color] duration-150 ease-in-out",u?"bg-blue-50 shadow-[inset_2px_0_0_var(--ds-blue-700)]":"shadow-[inset_2px_0_0_transparent]",i===Q.length-1&&"!border-b-0"),children:[(0,t.jsx)(w.Table.Cell,{className:"pl-5",children:(0,t.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[(0,t.jsx)(a.Link,{href:c,...(0,b.createTrackingAttributes)({element:"link",name:"settings_build_machines_project",clickTarget:"avatar",projectId:n.id,buildMachine:s}),className:"[&>div]:flex",children:(0,t.jsx)(B.ProjectAvatar,{project:n})}),(0,t.jsx)(a.Link,{href:c,variant:"underline",className:"text-gray-1000",...(0,b.createTrackingAttributes)({element:"link",name:"settings_build_machines_project",clickTarget:"name",projectId:n.id,buildMachine:s}),children:n.name})]})}),r.map(e=>(0,t.jsx)(w.Table.Cell,{children:(0,t.jsx)("label",{htmlFor:`build-machine-${n.id}-${e}`,className:"cursor-pointer flex items-center w-fit mx-auto",children:(0,t.jsx)(A.Tooltip,{text:"You don't have permissions to update this project's build machine",disableTriggers:h,children:(0,t.jsx)(_.Radio,{checked:d===e,value:e,name:`build-machine-${n.id}`,id:`build-machine-${n.id}-${e}`,disabled:!h||z,onChange:()=>{et(n.id,e)},...(0,b.createTrackingAttributes)({element:"radio",name:"settings_build_machines_select",projectId:n.id,buildMachine:e})})})})},e))]},n.id)})})]})})}):(0,t.jsx)("div",{className:"flex items-center justify-center py-8 text-gray-900",children:g?"No projects match your current filters.":"No projects found."}):null,(X||Z)&&Q.length>0?(0,t.jsx)(v.LoadMoreButton,{disabled:H,onClick:ee,...(0,b.createTrackingAttributes)({element:"button",name:"settings_build_machines_load_more",currentDisplayCount:f.toString(),totalProjects:J.length.toString()})}):null]})}var $=e.i(1717203);function U(){let{team:e,isLoading:i}=(0,s.useTeam)(),{isLoading:n}=(0,$.default)(),l=e?.billing?.plan==="pro",a=e?.billing?.plan==="hobby",r=e?.billing?.plan==="enterprise",c=e&&(l||r),{data:o}=(0,y.useCopperPrices)(c?e?.slug:void 0,{onDemandConcurrencyMinutes:{model:"matrix"}});if(i||n)return(0,t.jsx)(h.default,{height:400});if(!e)return null;if(a)return(0,t.jsx)(C,{});let u=(0,d.getDefaultBuildMachine)(e);return(0,t.jsx)(H,{team:e,defaultBuildMachine:u,prices:o})}function H(e){let{team:s,defaultBuildMachine:d,prices:h}=e,{user:m}=(0,r.useUser)(),[p,g]=(0,i.useState)({saving:!1,saveError:null,dirtyCount:0,handleSave:async()=>{},handleCancel:()=>{}}),b=(0,i.useMemo)(()=>{let e=[];return"enhanced"!==d&&e.push("standard"),e.push("enhanced"),e.push("turbo"),e},[d]);return(0,t.jsxs)(l.Fieldset,{children:[(0,t.jsx)(n.FieldsetContent,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)(u.FieldsetTitle,{children:"Build Machines"}),(0,t.jsx)("p",{className:"text-gray-1000 text-copy-14",children:"Choose build machine performance for projects."}),(0,t.jsx)("div",{className:"grid divide-y divide-solid [&>div]:py-3",children:b.map(e=>{let i=e===d;return(0,t.jsx)(o.BuildMachineSpecs,{buildMachine:e,isSelected:i,isDefault:i,team:s,prices:h},e)})}),(0,t.jsxs)("p",{className:"text-gray-900 text-label-14",children:["Your default build machine is specified by your plan or contract."," ",(0,t.jsx)(a.Link,{external:!0,href:`${c.CONTACT_SALES_DASHBOARD_HREF}&${new URLSearchParams({content:"I'd like to learn more about default build machines.",...m?.email?{email:m.email}:{}}).toString()}`,type:"highlight",children:"Contact Sales"})]}),(0,t.jsx)(D,{team:s,defaultBuildMachine:d,allowedBuildMachines:b,onSaveStateChange:g})]})}),(0,t.jsx)(x,{saveState:p})]})}e.s(["BuildMachines",()=>U],8264957)}]);

//# debugId=01f9d4e3-705f-980c-fd16-adfa9415af38
//# sourceMappingURL=d30d401d9d275f74.js.map